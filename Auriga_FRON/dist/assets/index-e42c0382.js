var _u=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var G=(e,t,r)=>(_u(e,t,"read from private field"),r?r.call(e):t.get(e)),Le=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},Oe=(e,t,r,a)=>(_u(e,t,"write to private field"),a?a.call(e,r):t.set(e,r),r);var hc=(e,t,r,a)=>({set _(n){Oe(e,t,n,r)},get _(){return G(e,t,a)}}),et=(e,t,r)=>(_u(e,t,"access private method"),r);function Hw(e,t){for(var r=0;r<t.length;r++){const a=t[r];if(typeof a!="string"&&!Array.isArray(a)){for(const n in a)if(n!=="default"&&!(n in e)){const s=Object.getOwnPropertyDescriptor(a,n);s&&Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:()=>a[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();function Vw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Qg={exports:{}},K0={},Kg={exports:{}},Je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jl=Symbol.for("react.element"),Ww=Symbol.for("react.portal"),Gw=Symbol.for("react.fragment"),Xw=Symbol.for("react.strict_mode"),qw=Symbol.for("react.profiler"),Qw=Symbol.for("react.provider"),Kw=Symbol.for("react.context"),Yw=Symbol.for("react.forward_ref"),Jw=Symbol.for("react.suspense"),Zw=Symbol.for("react.memo"),ek=Symbol.for("react.lazy"),Ip=Symbol.iterator;function tk(e){return e===null||typeof e!="object"?null:(e=Ip&&e[Ip]||e["@@iterator"],typeof e=="function"?e:null)}var Yg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Jg=Object.assign,Zg={};function po(e,t,r){this.props=e,this.context=t,this.refs=Zg,this.updater=r||Yg}po.prototype.isReactComponent={};po.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};po.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function e1(){}e1.prototype=po.prototype;function Jf(e,t,r){this.props=e,this.context=t,this.refs=Zg,this.updater=r||Yg}var Zf=Jf.prototype=new e1;Zf.constructor=Jf;Jg(Zf,po.prototype);Zf.isPureReactComponent=!0;var Lp=Array.isArray,t1=Object.prototype.hasOwnProperty,eh={current:null},r1={key:!0,ref:!0,__self:!0,__source:!0};function a1(e,t,r){var a,n={},s=null,o=null;if(t!=null)for(a in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)t1.call(t,a)&&!r1.hasOwnProperty(a)&&(n[a]=t[a]);var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];n.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps,l)n[a]===void 0&&(n[a]=l[a]);return{$$typeof:Jl,type:e,key:s,ref:o,props:n,_owner:eh.current}}function rk(e,t){return{$$typeof:Jl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function th(e){return typeof e=="object"&&e!==null&&e.$$typeof===Jl}function ak(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Mp=/\/+/g;function Tu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?ak(""+e.key):t.toString(36)}function Hc(e,t,r,a,n){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Jl:case Ww:o=!0}}if(o)return o=e,n=n(o),e=a===""?"."+Tu(o,0):a,Lp(n)?(r="",e!=null&&(r=e.replace(Mp,"$&/")+"/"),Hc(n,t,r,"",function(u){return u})):n!=null&&(th(n)&&(n=rk(n,r+(!n.key||o&&o.key===n.key?"":(""+n.key).replace(Mp,"$&/")+"/")+e)),t.push(n)),1;if(o=0,a=a===""?".":a+":",Lp(e))for(var l=0;l<e.length;l++){s=e[l];var c=a+Tu(s,l);o+=Hc(s,t,r,c,n)}else if(c=tk(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=a+Tu(s,l++),o+=Hc(s,t,r,c,n);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function pc(e,t,r){if(e==null)return e;var a=[],n=0;return Hc(e,a,"","",function(s){return t.call(r,s,n++)}),a}function nk(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Mr={current:null},Vc={transition:null},sk={ReactCurrentDispatcher:Mr,ReactCurrentBatchConfig:Vc,ReactCurrentOwner:eh};function n1(){throw Error("act(...) is not supported in production builds of React.")}Je.Children={map:pc,forEach:function(e,t,r){pc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return pc(e,function(){t++}),t},toArray:function(e){return pc(e,function(t){return t})||[]},only:function(e){if(!th(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Je.Component=po;Je.Fragment=Gw;Je.Profiler=qw;Je.PureComponent=Jf;Je.StrictMode=Xw;Je.Suspense=Jw;Je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sk;Je.act=n1;Je.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=Jg({},e.props),n=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=eh.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)t1.call(t,c)&&!r1.hasOwnProperty(c)&&(a[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)a.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}return{$$typeof:Jl,type:e.type,key:n,ref:s,props:a,_owner:o}};Je.createContext=function(e){return e={$$typeof:Kw,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Qw,_context:e},e.Consumer=e};Je.createElement=a1;Je.createFactory=function(e){var t=a1.bind(null,e);return t.type=e,t};Je.createRef=function(){return{current:null}};Je.forwardRef=function(e){return{$$typeof:Yw,render:e}};Je.isValidElement=th;Je.lazy=function(e){return{$$typeof:ek,_payload:{_status:-1,_result:e},_init:nk}};Je.memo=function(e,t){return{$$typeof:Zw,type:e,compare:t===void 0?null:t}};Je.startTransition=function(e){var t=Vc.transition;Vc.transition={};try{e()}finally{Vc.transition=t}};Je.unstable_act=n1;Je.useCallback=function(e,t){return Mr.current.useCallback(e,t)};Je.useContext=function(e){return Mr.current.useContext(e)};Je.useDebugValue=function(){};Je.useDeferredValue=function(e){return Mr.current.useDeferredValue(e)};Je.useEffect=function(e,t){return Mr.current.useEffect(e,t)};Je.useId=function(){return Mr.current.useId()};Je.useImperativeHandle=function(e,t,r){return Mr.current.useImperativeHandle(e,t,r)};Je.useInsertionEffect=function(e,t){return Mr.current.useInsertionEffect(e,t)};Je.useLayoutEffect=function(e,t){return Mr.current.useLayoutEffect(e,t)};Je.useMemo=function(e,t){return Mr.current.useMemo(e,t)};Je.useReducer=function(e,t,r){return Mr.current.useReducer(e,t,r)};Je.useRef=function(e){return Mr.current.useRef(e)};Je.useState=function(e){return Mr.current.useState(e)};Je.useSyncExternalStore=function(e,t,r){return Mr.current.useSyncExternalStore(e,t,r)};Je.useTransition=function(){return Mr.current.useTransition()};Je.version="18.3.1";Kg.exports=Je;var D=Kg.exports;const s1=Vw(D),ik=Hw({__proto__:null,default:s1},[D]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ok=D,lk=Symbol.for("react.element"),ck=Symbol.for("react.fragment"),uk=Object.prototype.hasOwnProperty,dk=ok.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fk={key:!0,ref:!0,__self:!0,__source:!0};function i1(e,t,r){var a,n={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(a in t)uk.call(t,a)&&!fk.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)n[a]===void 0&&(n[a]=t[a]);return{$$typeof:lk,type:e,key:s,ref:o,props:n,_owner:dk.current}}K0.Fragment=ck;K0.jsx=i1;K0.jsxs=i1;Qg.exports=K0;var i=Qg.exports,wd={},o1={exports:{}},ia={},l1={exports:{}},c1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(se,z){var xe=se.length;se.push(z);e:for(;0<xe;){var be=xe-1>>>1,O=se[be];if(0<n(O,z))se[be]=z,se[xe]=O,xe=be;else break e}}function r(se){return se.length===0?null:se[0]}function a(se){if(se.length===0)return null;var z=se[0],xe=se.pop();if(xe!==z){se[0]=xe;e:for(var be=0,O=se.length,J=O>>>1;be<J;){var W=2*(be+1)-1,V=se[W],le=W+1,we=se[le];if(0>n(V,xe))le<O&&0>n(we,V)?(se[be]=we,se[le]=xe,be=le):(se[be]=V,se[W]=xe,be=W);else if(le<O&&0>n(we,xe))se[be]=we,se[le]=xe,be=le;else break e}}return z}function n(se,z){var xe=se.sortIndex-z.sortIndex;return xe!==0?xe:se.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,h=3,p=!1,x=!1,m=!1,w=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(se){for(var z=r(u);z!==null;){if(z.callback===null)a(u);else if(z.startTime<=se)a(u),z.sortIndex=z.expirationTime,t(c,z);else break;z=r(u)}}function k(se){if(m=!1,v(se),!x)if(r(c)!==null)x=!0,ge(_);else{var z=r(u);z!==null&&Z(k,z.startTime-se)}}function _(se,z){x=!1,m&&(m=!1,g(S),S=-1),p=!0;var xe=h;try{for(v(z),f=r(c);f!==null&&(!(f.expirationTime>z)||se&&!T());){var be=f.callback;if(typeof be=="function"){f.callback=null,h=f.priorityLevel;var O=be(f.expirationTime<=z);z=e.unstable_now(),typeof O=="function"?f.callback=O:f===r(c)&&a(c),v(z)}else a(c);f=r(c)}if(f!==null)var J=!0;else{var W=r(u);W!==null&&Z(k,W.startTime-z),J=!1}return J}finally{f=null,h=xe,p=!1}}var F=!1,b=null,S=-1,C=5,B=-1;function T(){return!(e.unstable_now()-B<C)}function U(){if(b!==null){var se=e.unstable_now();B=se;var z=!0;try{z=b(!0,se)}finally{z?K():(F=!1,b=null)}}else F=!1}var K;if(typeof y=="function")K=function(){y(U)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,oe=de.port2;de.port1.onmessage=U,K=function(){oe.postMessage(null)}}else K=function(){w(U,0)};function ge(se){b=se,F||(F=!0,K())}function Z(se,z){S=w(function(){se(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(se){se.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,ge(_))},e.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<se?Math.floor(1e3/se):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(se){switch(h){case 1:case 2:case 3:var z=3;break;default:z=h}var xe=h;h=z;try{return se()}finally{h=xe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(se,z){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var xe=h;h=se;try{return z()}finally{h=xe}},e.unstable_scheduleCallback=function(se,z,xe){var be=e.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?be+xe:be):xe=be,se){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=xe+O,se={id:d++,callback:z,priorityLevel:se,startTime:xe,expirationTime:O,sortIndex:-1},xe>be?(se.sortIndex=xe,t(u,se),r(c)===null&&se===r(u)&&(m?(g(S),S=-1):m=!0,Z(k,xe-be))):(se.sortIndex=O,t(c,se),x||p||(x=!0,ge(_))),se},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(se){var z=h;return function(){var xe=h;h=z;try{return se.apply(this,arguments)}finally{h=xe}}}})(c1);l1.exports=c1;var hk=l1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pk=D,na=hk;function Ne(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u1=new Set,ul={};function ci(e,t){to(e,t),to(e+"Capture",t)}function to(e,t){for(ul[e]=t,e=0;e<t.length;e++)u1.add(t[e])}var An=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kd=Object.prototype.hasOwnProperty,xk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bp={},Up={};function mk(e){return kd.call(Up,e)?!0:kd.call(Bp,e)?!1:xk.test(e)?Up[e]=!0:(Bp[e]=!0,!1)}function gk(e,t,r,a){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return a?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function vk(e,t,r,a){if(t===null||typeof t>"u"||gk(e,t,r,a))return!0;if(a)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Br(e,t,r,a,n,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=a,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var fr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){fr[e]=new Br(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];fr[t]=new Br(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){fr[e]=new Br(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){fr[e]=new Br(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){fr[e]=new Br(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){fr[e]=new Br(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){fr[e]=new Br(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){fr[e]=new Br(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){fr[e]=new Br(e,5,!1,e.toLowerCase(),null,!1,!1)});var rh=/[\-:]([a-z])/g;function ah(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(rh,ah);fr[t]=new Br(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(rh,ah);fr[t]=new Br(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(rh,ah);fr[t]=new Br(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){fr[e]=new Br(e,1,!1,e.toLowerCase(),null,!1,!1)});fr.xlinkHref=new Br("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){fr[e]=new Br(e,1,!1,e.toLowerCase(),null,!0,!0)});function nh(e,t,r,a){var n=fr.hasOwnProperty(t)?fr[t]:null;(n!==null?n.type!==0:a||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(vk(t,r,n,a)&&(r=null),a||n===null?mk(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=r===null?n.type===3?!1:"":r:(t=n.attributeName,a=n.attributeNamespace,r===null?e.removeAttribute(t):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,a?e.setAttributeNS(a,t,r):e.setAttribute(t,r))))}var Rn=pk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xc=Symbol.for("react.element"),ki=Symbol.for("react.portal"),bi=Symbol.for("react.fragment"),sh=Symbol.for("react.strict_mode"),bd=Symbol.for("react.profiler"),d1=Symbol.for("react.provider"),f1=Symbol.for("react.context"),ih=Symbol.for("react.forward_ref"),Ed=Symbol.for("react.suspense"),Sd=Symbol.for("react.suspense_list"),oh=Symbol.for("react.memo"),zn=Symbol.for("react.lazy"),h1=Symbol.for("react.offscreen"),zp=Symbol.iterator;function No(e){return e===null||typeof e!="object"?null:(e=zp&&e[zp]||e["@@iterator"],typeof e=="function"?e:null)}var Tt=Object.assign,ju;function Ro(e){if(ju===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);ju=t&&t[1]||""}return`
`+ju+e}var Au=!1;function Fu(e,t){if(!e||Au)return"";Au=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var a=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){a=u}e.call(t.prototype)}else{try{throw Error()}catch(u){a=u}e()}}catch(u){if(u&&a&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),s=a.stack.split(`
`),o=n.length-1,l=s.length-1;1<=o&&0<=l&&n[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(n[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||n[o]!==s[l]){var c=`
`+n[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Au=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ro(e):""}function yk(e){switch(e.tag){case 5:return Ro(e.type);case 16:return Ro("Lazy");case 13:return Ro("Suspense");case 19:return Ro("SuspenseList");case 0:case 2:case 15:return e=Fu(e.type,!1),e;case 11:return e=Fu(e.type.render,!1),e;case 1:return e=Fu(e.type,!0),e;default:return""}}function Nd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case bi:return"Fragment";case ki:return"Portal";case bd:return"Profiler";case sh:return"StrictMode";case Ed:return"Suspense";case Sd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case f1:return(e.displayName||"Context")+".Consumer";case d1:return(e._context.displayName||"Context")+".Provider";case ih:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case oh:return t=e.displayName||null,t!==null?t:Nd(e.type)||"Memo";case zn:t=e._payload,e=e._init;try{return Nd(e(t))}catch{}}return null}function wk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Nd(t);case 8:return t===sh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function vs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function p1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function kk(e){var t=p1(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(o){a=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(o){a=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function mc(e){e._valueTracker||(e._valueTracker=kk(e))}function x1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=p1(e)?e.checked?"true":"false":e.value),e=a,e!==r?(t.setValue(e),!0):!1}function s0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Cd(e,t){var r=t.checked;return Tt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function $p(e,t){var r=t.defaultValue==null?"":t.defaultValue,a=t.checked!=null?t.checked:t.defaultChecked;r=vs(t.value!=null?t.value:r),e._wrapperState={initialChecked:a,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function m1(e,t){t=t.checked,t!=null&&nh(e,"checked",t,!1)}function _d(e,t){m1(e,t);var r=vs(t.value),a=t.type;if(r!=null)a==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Td(e,t.type,r):t.hasOwnProperty("defaultValue")&&Td(e,t.type,vs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Hp(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!(a!=="submit"&&a!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Td(e,t,r){(t!=="number"||s0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Io=Array.isArray;function Oi(e,t,r,a){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&a&&(e[r].defaultSelected=!0)}else{for(r=""+vs(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,a&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function jd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ne(91));return Tt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Vp(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ne(92));if(Io(r)){if(1<r.length)throw Error(Ne(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:vs(r)}}function g1(e,t){var r=vs(t.value),a=vs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),a!=null&&(e.defaultValue=""+a)}function Wp(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function v1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ad(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?v1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var gc,y1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,a,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r,a,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(gc=gc||document.createElement("div"),gc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=gc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function dl(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Vo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bk=["Webkit","ms","Moz","O"];Object.keys(Vo).forEach(function(e){bk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Vo[t]=Vo[e]})});function w1(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Vo.hasOwnProperty(e)&&Vo[e]?(""+t).trim():t+"px"}function k1(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var a=r.indexOf("--")===0,n=w1(r,t[r],a);r==="float"&&(r="cssFloat"),a?e.setProperty(r,n):e[r]=n}}var Ek=Tt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fd(e,t){if(t){if(Ek[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ne(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ne(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ne(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ne(62))}}function Pd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dd=null;function lh(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Od=null,Ri=null,Ii=null;function Gp(e){if(e=tc(e)){if(typeof Od!="function")throw Error(Ne(280));var t=e.stateNode;t&&(t=tu(t),Od(e.stateNode,e.type,t))}}function b1(e){Ri?Ii?Ii.push(e):Ii=[e]:Ri=e}function E1(){if(Ri){var e=Ri,t=Ii;if(Ii=Ri=null,Gp(e),t)for(e=0;e<t.length;e++)Gp(t[e])}}function S1(e,t){return e(t)}function N1(){}var Pu=!1;function C1(e,t,r){if(Pu)return e(t,r);Pu=!0;try{return S1(e,t,r)}finally{Pu=!1,(Ri!==null||Ii!==null)&&(N1(),E1())}}function fl(e,t){var r=e.stateNode;if(r===null)return null;var a=tu(r);if(a===null)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ne(231,t,typeof r));return r}var Rd=!1;if(An)try{var Co={};Object.defineProperty(Co,"passive",{get:function(){Rd=!0}}),window.addEventListener("test",Co,Co),window.removeEventListener("test",Co,Co)}catch{Rd=!1}function Sk(e,t,r,a,n,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Wo=!1,i0=null,o0=!1,Id=null,Nk={onError:function(e){Wo=!0,i0=e}};function Ck(e,t,r,a,n,s,o,l,c){Wo=!1,i0=null,Sk.apply(Nk,arguments)}function _k(e,t,r,a,n,s,o,l,c){if(Ck.apply(this,arguments),Wo){if(Wo){var u=i0;Wo=!1,i0=null}else throw Error(Ne(198));o0||(o0=!0,Id=u)}}function ui(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function _1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Xp(e){if(ui(e)!==e)throw Error(Ne(188))}function Tk(e){var t=e.alternate;if(!t){if(t=ui(e),t===null)throw Error(Ne(188));return t!==e?null:e}for(var r=e,a=t;;){var n=r.return;if(n===null)break;var s=n.alternate;if(s===null){if(a=n.return,a!==null){r=a;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===r)return Xp(n),e;if(s===a)return Xp(n),t;s=s.sibling}throw Error(Ne(188))}if(r.return!==a.return)r=n,a=s;else{for(var o=!1,l=n.child;l;){if(l===r){o=!0,r=n,a=s;break}if(l===a){o=!0,a=n,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,a=n;break}if(l===a){o=!0,a=s,r=n;break}l=l.sibling}if(!o)throw Error(Ne(189))}}if(r.alternate!==a)throw Error(Ne(190))}if(r.tag!==3)throw Error(Ne(188));return r.stateNode.current===r?e:t}function T1(e){return e=Tk(e),e!==null?j1(e):null}function j1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=j1(e);if(t!==null)return t;e=e.sibling}return null}var A1=na.unstable_scheduleCallback,qp=na.unstable_cancelCallback,jk=na.unstable_shouldYield,Ak=na.unstable_requestPaint,It=na.unstable_now,Fk=na.unstable_getCurrentPriorityLevel,ch=na.unstable_ImmediatePriority,F1=na.unstable_UserBlockingPriority,l0=na.unstable_NormalPriority,Pk=na.unstable_LowPriority,P1=na.unstable_IdlePriority,Y0=null,sn=null;function Dk(e){if(sn&&typeof sn.onCommitFiberRoot=="function")try{sn.onCommitFiberRoot(Y0,e,void 0,(e.current.flags&128)===128)}catch{}}var Ua=Math.clz32?Math.clz32:Ik,Ok=Math.log,Rk=Math.LN2;function Ik(e){return e>>>=0,e===0?32:31-(Ok(e)/Rk|0)|0}var vc=64,yc=4194304;function Lo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function c0(e,t){var r=e.pendingLanes;if(r===0)return 0;var a=0,n=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~n;l!==0?a=Lo(l):(s&=o,s!==0&&(a=Lo(s)))}else o=r&~n,o!==0?a=Lo(o):s!==0&&(a=Lo(s));if(a===0)return 0;if(t!==0&&t!==a&&!(t&n)&&(n=a&-a,s=t&-t,n>=s||n===16&&(s&4194240)!==0))return t;if(a&4&&(a|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=a;0<t;)r=31-Ua(t),n=1<<r,a|=e[r],t&=~n;return a}function Lk(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mk(e,t){for(var r=e.suspendedLanes,a=e.pingedLanes,n=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Ua(s),l=1<<o,c=n[o];c===-1?(!(l&r)||l&a)&&(n[o]=Lk(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function Ld(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function D1(){var e=vc;return vc<<=1,!(vc&4194240)&&(vc=64),e}function Du(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Zl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ua(t),e[t]=r}function Bk(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-Ua(r),s=1<<n;t[n]=0,a[n]=-1,e[n]=-1,r&=~s}}function uh(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var a=31-Ua(r),n=1<<a;n&t|e[a]&t&&(e[a]|=t),r&=~n}}var ut=0;function O1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var R1,dh,I1,L1,M1,Md=!1,wc=[],is=null,os=null,ls=null,hl=new Map,pl=new Map,Hn=[],Uk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qp(e,t){switch(e){case"focusin":case"focusout":is=null;break;case"dragenter":case"dragleave":os=null;break;case"mouseover":case"mouseout":ls=null;break;case"pointerover":case"pointerout":hl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":pl.delete(t.pointerId)}}function _o(e,t,r,a,n,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:a,nativeEvent:s,targetContainers:[n]},t!==null&&(t=tc(t),t!==null&&dh(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function zk(e,t,r,a,n){switch(t){case"focusin":return is=_o(is,e,t,r,a,n),!0;case"dragenter":return os=_o(os,e,t,r,a,n),!0;case"mouseover":return ls=_o(ls,e,t,r,a,n),!0;case"pointerover":var s=n.pointerId;return hl.set(s,_o(hl.get(s)||null,e,t,r,a,n)),!0;case"gotpointercapture":return s=n.pointerId,pl.set(s,_o(pl.get(s)||null,e,t,r,a,n)),!0}return!1}function B1(e){var t=Ps(e.target);if(t!==null){var r=ui(t);if(r!==null){if(t=r.tag,t===13){if(t=_1(r),t!==null){e.blockedOn=t,M1(e.priority,function(){I1(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Wc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Bd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var a=new r.constructor(r.type,r);Dd=a,r.target.dispatchEvent(a),Dd=null}else return t=tc(r),t!==null&&dh(t),e.blockedOn=r,!1;t.shift()}return!0}function Kp(e,t,r){Wc(e)&&r.delete(t)}function $k(){Md=!1,is!==null&&Wc(is)&&(is=null),os!==null&&Wc(os)&&(os=null),ls!==null&&Wc(ls)&&(ls=null),hl.forEach(Kp),pl.forEach(Kp)}function To(e,t){e.blockedOn===t&&(e.blockedOn=null,Md||(Md=!0,na.unstable_scheduleCallback(na.unstable_NormalPriority,$k)))}function xl(e){function t(n){return To(n,e)}if(0<wc.length){To(wc[0],e);for(var r=1;r<wc.length;r++){var a=wc[r];a.blockedOn===e&&(a.blockedOn=null)}}for(is!==null&&To(is,e),os!==null&&To(os,e),ls!==null&&To(ls,e),hl.forEach(t),pl.forEach(t),r=0;r<Hn.length;r++)a=Hn[r],a.blockedOn===e&&(a.blockedOn=null);for(;0<Hn.length&&(r=Hn[0],r.blockedOn===null);)B1(r),r.blockedOn===null&&Hn.shift()}var Li=Rn.ReactCurrentBatchConfig,u0=!0;function Hk(e,t,r,a){var n=ut,s=Li.transition;Li.transition=null;try{ut=1,fh(e,t,r,a)}finally{ut=n,Li.transition=s}}function Vk(e,t,r,a){var n=ut,s=Li.transition;Li.transition=null;try{ut=4,fh(e,t,r,a)}finally{ut=n,Li.transition=s}}function fh(e,t,r,a){if(u0){var n=Bd(e,t,r,a);if(n===null)Hu(e,t,a,d0,r),Qp(e,a);else if(zk(n,e,t,r,a))a.stopPropagation();else if(Qp(e,a),t&4&&-1<Uk.indexOf(e)){for(;n!==null;){var s=tc(n);if(s!==null&&R1(s),s=Bd(e,t,r,a),s===null&&Hu(e,t,a,d0,r),s===n)break;n=s}n!==null&&a.stopPropagation()}else Hu(e,t,a,null,r)}}var d0=null;function Bd(e,t,r,a){if(d0=null,e=lh(a),e=Ps(e),e!==null)if(t=ui(e),t===null)e=null;else if(r=t.tag,r===13){if(e=_1(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return d0=e,null}function U1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Fk()){case ch:return 1;case F1:return 4;case l0:case Pk:return 16;case P1:return 536870912;default:return 16}default:return 16}}var ts=null,hh=null,Gc=null;function z1(){if(Gc)return Gc;var e,t=hh,r=t.length,a,n="value"in ts?ts.value:ts.textContent,s=n.length;for(e=0;e<r&&t[e]===n[e];e++);var o=r-e;for(a=1;a<=o&&t[r-a]===n[s-a];a++);return Gc=n.slice(e,1<a?1-a:void 0)}function Xc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function kc(){return!0}function Yp(){return!1}function oa(e){function t(r,a,n,s,o){this._reactName=r,this._targetInst=n,this.type=a,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?kc:Yp,this.isPropagationStopped=Yp,this}return Tt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=kc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=kc)},persist:function(){},isPersistent:kc}),t}var xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ph=oa(xo),ec=Tt({},xo,{view:0,detail:0}),Wk=oa(ec),Ou,Ru,jo,J0=Tt({},ec,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xh,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==jo&&(jo&&e.type==="mousemove"?(Ou=e.screenX-jo.screenX,Ru=e.screenY-jo.screenY):Ru=Ou=0,jo=e),Ou)},movementY:function(e){return"movementY"in e?e.movementY:Ru}}),Jp=oa(J0),Gk=Tt({},J0,{dataTransfer:0}),Xk=oa(Gk),qk=Tt({},ec,{relatedTarget:0}),Iu=oa(qk),Qk=Tt({},xo,{animationName:0,elapsedTime:0,pseudoElement:0}),Kk=oa(Qk),Yk=Tt({},xo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jk=oa(Yk),Zk=Tt({},xo,{data:0}),Zp=oa(Zk),eb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ab(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=rb[e])?!!t[e]:!1}function xh(){return ab}var nb=Tt({},ec,{key:function(e){if(e.key){var t=eb[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Xc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?tb[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xh,charCode:function(e){return e.type==="keypress"?Xc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Xc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),sb=oa(nb),ib=Tt({},J0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ex=oa(ib),ob=Tt({},ec,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xh}),lb=oa(ob),cb=Tt({},xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),ub=oa(cb),db=Tt({},J0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),fb=oa(db),hb=[9,13,27,32],mh=An&&"CompositionEvent"in window,Go=null;An&&"documentMode"in document&&(Go=document.documentMode);var pb=An&&"TextEvent"in window&&!Go,$1=An&&(!mh||Go&&8<Go&&11>=Go),tx=String.fromCharCode(32),rx=!1;function H1(e,t){switch(e){case"keyup":return hb.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function V1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ei=!1;function xb(e,t){switch(e){case"compositionend":return V1(t);case"keypress":return t.which!==32?null:(rx=!0,tx);case"textInput":return e=t.data,e===tx&&rx?null:e;default:return null}}function mb(e,t){if(Ei)return e==="compositionend"||!mh&&H1(e,t)?(e=z1(),Gc=hh=ts=null,Ei=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return $1&&t.locale!=="ko"?null:t.data;default:return null}}var gb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ax(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!gb[e.type]:t==="textarea"}function W1(e,t,r,a){b1(a),t=f0(t,"onChange"),0<t.length&&(r=new ph("onChange","change",null,r,a),e.push({event:r,listeners:t}))}var Xo=null,ml=null;function vb(e){rv(e,0)}function Z0(e){var t=Ci(e);if(x1(t))return e}function yb(e,t){if(e==="change")return t}var G1=!1;if(An){var Lu;if(An){var Mu="oninput"in document;if(!Mu){var nx=document.createElement("div");nx.setAttribute("oninput","return;"),Mu=typeof nx.oninput=="function"}Lu=Mu}else Lu=!1;G1=Lu&&(!document.documentMode||9<document.documentMode)}function sx(){Xo&&(Xo.detachEvent("onpropertychange",X1),ml=Xo=null)}function X1(e){if(e.propertyName==="value"&&Z0(ml)){var t=[];W1(t,ml,e,lh(e)),C1(vb,t)}}function wb(e,t,r){e==="focusin"?(sx(),Xo=t,ml=r,Xo.attachEvent("onpropertychange",X1)):e==="focusout"&&sx()}function kb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Z0(ml)}function bb(e,t){if(e==="click")return Z0(t)}function Eb(e,t){if(e==="input"||e==="change")return Z0(t)}function Sb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Va=typeof Object.is=="function"?Object.is:Sb;function gl(e,t){if(Va(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var n=r[a];if(!kd.call(t,n)||!Va(e[n],t[n]))return!1}return!0}function ix(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ox(e,t){var r=ix(e);e=0;for(var a;r;){if(r.nodeType===3){if(a=e+r.textContent.length,e<=t&&a>=t)return{node:r,offset:t-e};e=a}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ix(r)}}function q1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?q1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Q1(){for(var e=window,t=s0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=s0(e.document)}return t}function gh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Nb(e){var t=Q1(),r=e.focusedElem,a=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&q1(r.ownerDocument.documentElement,r)){if(a!==null&&gh(r)){if(t=a.start,e=a.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=r.textContent.length,s=Math.min(a.start,n);a=a.end===void 0?s:Math.min(a.end,n),!e.extend&&s>a&&(n=a,a=s,s=n),n=ox(r,s);var o=ox(r,a);n&&o&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),s>a?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Cb=An&&"documentMode"in document&&11>=document.documentMode,Si=null,Ud=null,qo=null,zd=!1;function lx(e,t,r){var a=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;zd||Si==null||Si!==s0(a)||(a=Si,"selectionStart"in a&&gh(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),qo&&gl(qo,a)||(qo=a,a=f0(Ud,"onSelect"),0<a.length&&(t=new ph("onSelect","select",null,t,r),e.push({event:t,listeners:a}),t.target=Si)))}function bc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ni={animationend:bc("Animation","AnimationEnd"),animationiteration:bc("Animation","AnimationIteration"),animationstart:bc("Animation","AnimationStart"),transitionend:bc("Transition","TransitionEnd")},Bu={},K1={};An&&(K1=document.createElement("div").style,"AnimationEvent"in window||(delete Ni.animationend.animation,delete Ni.animationiteration.animation,delete Ni.animationstart.animation),"TransitionEvent"in window||delete Ni.transitionend.transition);function eu(e){if(Bu[e])return Bu[e];if(!Ni[e])return e;var t=Ni[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in K1)return Bu[e]=t[r];return e}var Y1=eu("animationend"),J1=eu("animationiteration"),Z1=eu("animationstart"),ev=eu("transitionend"),tv=new Map,cx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Es(e,t){tv.set(e,t),ci(t,[e])}for(var Uu=0;Uu<cx.length;Uu++){var zu=cx[Uu],_b=zu.toLowerCase(),Tb=zu[0].toUpperCase()+zu.slice(1);Es(_b,"on"+Tb)}Es(Y1,"onAnimationEnd");Es(J1,"onAnimationIteration");Es(Z1,"onAnimationStart");Es("dblclick","onDoubleClick");Es("focusin","onFocus");Es("focusout","onBlur");Es(ev,"onTransitionEnd");to("onMouseEnter",["mouseout","mouseover"]);to("onMouseLeave",["mouseout","mouseover"]);to("onPointerEnter",["pointerout","pointerover"]);to("onPointerLeave",["pointerout","pointerover"]);ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ci("onBeforeInput",["compositionend","keypress","textInput","paste"]);ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mo));function ux(e,t,r){var a=e.type||"unknown-event";e.currentTarget=r,_k(a,t,void 0,e),e.currentTarget=null}function rv(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var a=e[r],n=a.event;a=a.listeners;e:{var s=void 0;if(t)for(var o=a.length-1;0<=o;o--){var l=a[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&n.isPropagationStopped())break e;ux(n,l,u),s=c}else for(o=0;o<a.length;o++){if(l=a[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&n.isPropagationStopped())break e;ux(n,l,u),s=c}}}if(o0)throw e=Id,o0=!1,Id=null,e}function vt(e,t){var r=t[Gd];r===void 0&&(r=t[Gd]=new Set);var a=e+"__bubble";r.has(a)||(av(t,e,2,!1),r.add(a))}function $u(e,t,r){var a=0;t&&(a|=4),av(r,e,a,t)}var Ec="_reactListening"+Math.random().toString(36).slice(2);function vl(e){if(!e[Ec]){e[Ec]=!0,u1.forEach(function(r){r!=="selectionchange"&&(jb.has(r)||$u(r,!1,e),$u(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ec]||(t[Ec]=!0,$u("selectionchange",!1,t))}}function av(e,t,r,a){switch(U1(t)){case 1:var n=Hk;break;case 4:n=Vk;break;default:n=fh}r=n.bind(null,t,r,e),n=void 0,!Rd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),a?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function Hu(e,t,r,a,n){var s=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var o=a.tag;if(o===3||o===4){var l=a.stateNode.containerInfo;if(l===n||l.nodeType===8&&l.parentNode===n)break;if(o===4)for(o=a.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;o=o.return}for(;l!==null;){if(o=Ps(l),o===null)return;if(c=o.tag,c===5||c===6){a=s=o;continue e}l=l.parentNode}}a=a.return}C1(function(){var u=s,d=lh(r),f=[];e:{var h=tv.get(e);if(h!==void 0){var p=ph,x=e;switch(e){case"keypress":if(Xc(r)===0)break e;case"keydown":case"keyup":p=sb;break;case"focusin":x="focus",p=Iu;break;case"focusout":x="blur",p=Iu;break;case"beforeblur":case"afterblur":p=Iu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Jp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Xk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=lb;break;case Y1:case J1:case Z1:p=Kk;break;case ev:p=ub;break;case"scroll":p=Wk;break;case"wheel":p=fb;break;case"copy":case"cut":case"paste":p=Jk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=ex}var m=(t&4)!==0,w=!m&&e==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var y=u,v;y!==null;){v=y;var k=v.stateNode;if(v.tag===5&&k!==null&&(v=k,g!==null&&(k=fl(y,g),k!=null&&m.push(yl(y,k,v)))),w)break;y=y.return}0<m.length&&(h=new p(h,x,null,r,d),f.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Dd&&(x=r.relatedTarget||r.fromElement)&&(Ps(x)||x[Fn]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=u,x=x?Ps(x):null,x!==null&&(w=ui(x),x!==w||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=u),p!==x)){if(m=Jp,k="onMouseLeave",g="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=ex,k="onPointerLeave",g="onPointerEnter",y="pointer"),w=p==null?h:Ci(p),v=x==null?h:Ci(x),h=new m(k,y+"leave",p,r,d),h.target=w,h.relatedTarget=v,k=null,Ps(d)===u&&(m=new m(g,y+"enter",x,r,d),m.target=v,m.relatedTarget=w,k=m),w=k,p&&x)t:{for(m=p,g=x,y=0,v=m;v;v=gi(v))y++;for(v=0,k=g;k;k=gi(k))v++;for(;0<y-v;)m=gi(m),y--;for(;0<v-y;)g=gi(g),v--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=gi(m),g=gi(g)}m=null}else m=null;p!==null&&dx(f,h,p,m,!1),x!==null&&w!==null&&dx(f,w,x,m,!0)}}e:{if(h=u?Ci(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var _=yb;else if(ax(h))if(G1)_=Eb;else{_=kb;var F=wb}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(_=bb);if(_&&(_=_(e,u))){W1(f,_,r,d);break e}F&&F(e,h,u),e==="focusout"&&(F=h._wrapperState)&&F.controlled&&h.type==="number"&&Td(h,"number",h.value)}switch(F=u?Ci(u):window,e){case"focusin":(ax(F)||F.contentEditable==="true")&&(Si=F,Ud=u,qo=null);break;case"focusout":qo=Ud=Si=null;break;case"mousedown":zd=!0;break;case"contextmenu":case"mouseup":case"dragend":zd=!1,lx(f,r,d);break;case"selectionchange":if(Cb)break;case"keydown":case"keyup":lx(f,r,d)}var b;if(mh)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Ei?H1(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&($1&&r.locale!=="ko"&&(Ei||S!=="onCompositionStart"?S==="onCompositionEnd"&&Ei&&(b=z1()):(ts=d,hh="value"in ts?ts.value:ts.textContent,Ei=!0)),F=f0(u,S),0<F.length&&(S=new Zp(S,e,null,r,d),f.push({event:S,listeners:F}),b?S.data=b:(b=V1(r),b!==null&&(S.data=b)))),(b=pb?xb(e,r):mb(e,r))&&(u=f0(u,"onBeforeInput"),0<u.length&&(d=new Zp("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=b))}rv(f,t)})}function yl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function f0(e,t){for(var r=t+"Capture",a=[];e!==null;){var n=e,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=fl(e,r),s!=null&&a.unshift(yl(e,s,n)),s=fl(e,t),s!=null&&a.push(yl(e,s,n))),e=e.return}return a}function gi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function dx(e,t,r,a,n){for(var s=t._reactName,o=[];r!==null&&r!==a;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===a)break;l.tag===5&&u!==null&&(l=u,n?(c=fl(r,s),c!=null&&o.unshift(yl(r,c,l))):n||(c=fl(r,s),c!=null&&o.push(yl(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var Ab=/\r\n?/g,Fb=/\u0000|\uFFFD/g;function fx(e){return(typeof e=="string"?e:""+e).replace(Ab,`
`).replace(Fb,"")}function Sc(e,t,r){if(t=fx(t),fx(e)!==t&&r)throw Error(Ne(425))}function h0(){}var $d=null,Hd=null;function Vd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Wd=typeof setTimeout=="function"?setTimeout:void 0,Pb=typeof clearTimeout=="function"?clearTimeout:void 0,hx=typeof Promise=="function"?Promise:void 0,Db=typeof queueMicrotask=="function"?queueMicrotask:typeof hx<"u"?function(e){return hx.resolve(null).then(e).catch(Ob)}:Wd;function Ob(e){setTimeout(function(){throw e})}function Vu(e,t){var r=t,a=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(a===0){e.removeChild(n),xl(t);return}a--}else r!=="$"&&r!=="$?"&&r!=="$!"||a++;r=n}while(r);xl(t)}function cs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function px(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var mo=Math.random().toString(36).slice(2),nn="__reactFiber$"+mo,wl="__reactProps$"+mo,Fn="__reactContainer$"+mo,Gd="__reactEvents$"+mo,Rb="__reactListeners$"+mo,Ib="__reactHandles$"+mo;function Ps(e){var t=e[nn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Fn]||r[nn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=px(e);e!==null;){if(r=e[nn])return r;e=px(e)}return t}e=r,r=e.parentNode}return null}function tc(e){return e=e[nn]||e[Fn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ci(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ne(33))}function tu(e){return e[wl]||null}var Xd=[],_i=-1;function Ss(e){return{current:e}}function yt(e){0>_i||(e.current=Xd[_i],Xd[_i]=null,_i--)}function mt(e,t){_i++,Xd[_i]=e.current,e.current=t}var ys={},Sr=Ss(ys),Wr=Ss(!1),Zs=ys;function ro(e,t){var r=e.type.contextTypes;if(!r)return ys;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in r)n[s]=t[s];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function Gr(e){return e=e.childContextTypes,e!=null}function p0(){yt(Wr),yt(Sr)}function xx(e,t,r){if(Sr.current!==ys)throw Error(Ne(168));mt(Sr,t),mt(Wr,r)}function nv(e,t,r){var a=e.stateNode;if(t=t.childContextTypes,typeof a.getChildContext!="function")return r;a=a.getChildContext();for(var n in a)if(!(n in t))throw Error(Ne(108,wk(e)||"Unknown",n));return Tt({},r,a)}function x0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ys,Zs=Sr.current,mt(Sr,e),mt(Wr,Wr.current),!0}function mx(e,t,r){var a=e.stateNode;if(!a)throw Error(Ne(169));r?(e=nv(e,t,Zs),a.__reactInternalMemoizedMergedChildContext=e,yt(Wr),yt(Sr),mt(Sr,e)):yt(Wr),mt(Wr,r)}var kn=null,ru=!1,Wu=!1;function sv(e){kn===null?kn=[e]:kn.push(e)}function Lb(e){ru=!0,sv(e)}function Ns(){if(!Wu&&kn!==null){Wu=!0;var e=0,t=ut;try{var r=kn;for(ut=1;e<r.length;e++){var a=r[e];do a=a(!0);while(a!==null)}kn=null,ru=!1}catch(n){throw kn!==null&&(kn=kn.slice(e+1)),A1(ch,Ns),n}finally{ut=t,Wu=!1}}return null}var Ti=[],ji=0,m0=null,g0=0,ma=[],ga=0,ei=null,Sn=1,Nn="";function js(e,t){Ti[ji++]=g0,Ti[ji++]=m0,m0=e,g0=t}function iv(e,t,r){ma[ga++]=Sn,ma[ga++]=Nn,ma[ga++]=ei,ei=e;var a=Sn;e=Nn;var n=32-Ua(a)-1;a&=~(1<<n),r+=1;var s=32-Ua(t)+n;if(30<s){var o=n-n%5;s=(a&(1<<o)-1).toString(32),a>>=o,n-=o,Sn=1<<32-Ua(t)+n|r<<n|a,Nn=s+e}else Sn=1<<s|r<<n|a,Nn=e}function vh(e){e.return!==null&&(js(e,1),iv(e,1,0))}function yh(e){for(;e===m0;)m0=Ti[--ji],Ti[ji]=null,g0=Ti[--ji],Ti[ji]=null;for(;e===ei;)ei=ma[--ga],ma[ga]=null,Nn=ma[--ga],ma[ga]=null,Sn=ma[--ga],ma[ga]=null}var aa=null,ra=null,bt=!1,Ra=null;function ov(e,t){var r=va(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function gx(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,aa=e,ra=cs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,aa=e,ra=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ei!==null?{id:Sn,overflow:Nn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=va(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,aa=e,ra=null,!0):!1;default:return!1}}function qd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Qd(e){if(bt){var t=ra;if(t){var r=t;if(!gx(e,t)){if(qd(e))throw Error(Ne(418));t=cs(r.nextSibling);var a=aa;t&&gx(e,t)?ov(a,r):(e.flags=e.flags&-4097|2,bt=!1,aa=e)}}else{if(qd(e))throw Error(Ne(418));e.flags=e.flags&-4097|2,bt=!1,aa=e}}}function vx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;aa=e}function Nc(e){if(e!==aa)return!1;if(!bt)return vx(e),bt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Vd(e.type,e.memoizedProps)),t&&(t=ra)){if(qd(e))throw lv(),Error(Ne(418));for(;t;)ov(e,t),t=cs(t.nextSibling)}if(vx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ne(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ra=cs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ra=null}}else ra=aa?cs(e.stateNode.nextSibling):null;return!0}function lv(){for(var e=ra;e;)e=cs(e.nextSibling)}function ao(){ra=aa=null,bt=!1}function wh(e){Ra===null?Ra=[e]:Ra.push(e)}var Mb=Rn.ReactCurrentBatchConfig;function Ao(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ne(309));var a=r.stateNode}if(!a)throw Error(Ne(147,e));var n=a,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=n.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(Ne(284));if(!r._owner)throw Error(Ne(290,e))}return e}function Cc(e,t){throw e=Object.prototype.toString.call(t),Error(Ne(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yx(e){var t=e._init;return t(e._payload)}function cv(e){function t(g,y){if(e){var v=g.deletions;v===null?(g.deletions=[y],g.flags|=16):v.push(y)}}function r(g,y){if(!e)return null;for(;y!==null;)t(g,y),y=y.sibling;return null}function a(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function n(g,y){return g=hs(g,y),g.index=0,g.sibling=null,g}function s(g,y,v){return g.index=v,e?(v=g.alternate,v!==null?(v=v.index,v<y?(g.flags|=2,y):v):(g.flags|=2,y)):(g.flags|=1048576,y)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function l(g,y,v,k){return y===null||y.tag!==6?(y=Ju(v,g.mode,k),y.return=g,y):(y=n(y,v),y.return=g,y)}function c(g,y,v,k){var _=v.type;return _===bi?d(g,y,v.props.children,k,v.key):y!==null&&(y.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===zn&&yx(_)===y.type)?(k=n(y,v.props),k.ref=Ao(g,y,v),k.return=g,k):(k=e0(v.type,v.key,v.props,null,g.mode,k),k.ref=Ao(g,y,v),k.return=g,k)}function u(g,y,v,k){return y===null||y.tag!==4||y.stateNode.containerInfo!==v.containerInfo||y.stateNode.implementation!==v.implementation?(y=Zu(v,g.mode,k),y.return=g,y):(y=n(y,v.children||[]),y.return=g,y)}function d(g,y,v,k,_){return y===null||y.tag!==7?(y=Qs(v,g.mode,k,_),y.return=g,y):(y=n(y,v),y.return=g,y)}function f(g,y,v){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Ju(""+y,g.mode,v),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case xc:return v=e0(y.type,y.key,y.props,null,g.mode,v),v.ref=Ao(g,null,y),v.return=g,v;case ki:return y=Zu(y,g.mode,v),y.return=g,y;case zn:var k=y._init;return f(g,k(y._payload),v)}if(Io(y)||No(y))return y=Qs(y,g.mode,v,null),y.return=g,y;Cc(g,y)}return null}function h(g,y,v,k){var _=y!==null?y.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return _!==null?null:l(g,y,""+v,k);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case xc:return v.key===_?c(g,y,v,k):null;case ki:return v.key===_?u(g,y,v,k):null;case zn:return _=v._init,h(g,y,_(v._payload),k)}if(Io(v)||No(v))return _!==null?null:d(g,y,v,k,null);Cc(g,v)}return null}function p(g,y,v,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return g=g.get(v)||null,l(y,g,""+k,_);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case xc:return g=g.get(k.key===null?v:k.key)||null,c(y,g,k,_);case ki:return g=g.get(k.key===null?v:k.key)||null,u(y,g,k,_);case zn:var F=k._init;return p(g,y,v,F(k._payload),_)}if(Io(k)||No(k))return g=g.get(v)||null,d(y,g,k,_,null);Cc(y,k)}return null}function x(g,y,v,k){for(var _=null,F=null,b=y,S=y=0,C=null;b!==null&&S<v.length;S++){b.index>S?(C=b,b=null):C=b.sibling;var B=h(g,b,v[S],k);if(B===null){b===null&&(b=C);break}e&&b&&B.alternate===null&&t(g,b),y=s(B,y,S),F===null?_=B:F.sibling=B,F=B,b=C}if(S===v.length)return r(g,b),bt&&js(g,S),_;if(b===null){for(;S<v.length;S++)b=f(g,v[S],k),b!==null&&(y=s(b,y,S),F===null?_=b:F.sibling=b,F=b);return bt&&js(g,S),_}for(b=a(g,b);S<v.length;S++)C=p(b,g,S,v[S],k),C!==null&&(e&&C.alternate!==null&&b.delete(C.key===null?S:C.key),y=s(C,y,S),F===null?_=C:F.sibling=C,F=C);return e&&b.forEach(function(T){return t(g,T)}),bt&&js(g,S),_}function m(g,y,v,k){var _=No(v);if(typeof _!="function")throw Error(Ne(150));if(v=_.call(v),v==null)throw Error(Ne(151));for(var F=_=null,b=y,S=y=0,C=null,B=v.next();b!==null&&!B.done;S++,B=v.next()){b.index>S?(C=b,b=null):C=b.sibling;var T=h(g,b,B.value,k);if(T===null){b===null&&(b=C);break}e&&b&&T.alternate===null&&t(g,b),y=s(T,y,S),F===null?_=T:F.sibling=T,F=T,b=C}if(B.done)return r(g,b),bt&&js(g,S),_;if(b===null){for(;!B.done;S++,B=v.next())B=f(g,B.value,k),B!==null&&(y=s(B,y,S),F===null?_=B:F.sibling=B,F=B);return bt&&js(g,S),_}for(b=a(g,b);!B.done;S++,B=v.next())B=p(b,g,S,B.value,k),B!==null&&(e&&B.alternate!==null&&b.delete(B.key===null?S:B.key),y=s(B,y,S),F===null?_=B:F.sibling=B,F=B);return e&&b.forEach(function(U){return t(g,U)}),bt&&js(g,S),_}function w(g,y,v,k){if(typeof v=="object"&&v!==null&&v.type===bi&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case xc:e:{for(var _=v.key,F=y;F!==null;){if(F.key===_){if(_=v.type,_===bi){if(F.tag===7){r(g,F.sibling),y=n(F,v.props.children),y.return=g,g=y;break e}}else if(F.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===zn&&yx(_)===F.type){r(g,F.sibling),y=n(F,v.props),y.ref=Ao(g,F,v),y.return=g,g=y;break e}r(g,F);break}else t(g,F);F=F.sibling}v.type===bi?(y=Qs(v.props.children,g.mode,k,v.key),y.return=g,g=y):(k=e0(v.type,v.key,v.props,null,g.mode,k),k.ref=Ao(g,y,v),k.return=g,g=k)}return o(g);case ki:e:{for(F=v.key;y!==null;){if(y.key===F)if(y.tag===4&&y.stateNode.containerInfo===v.containerInfo&&y.stateNode.implementation===v.implementation){r(g,y.sibling),y=n(y,v.children||[]),y.return=g,g=y;break e}else{r(g,y);break}else t(g,y);y=y.sibling}y=Zu(v,g.mode,k),y.return=g,g=y}return o(g);case zn:return F=v._init,w(g,y,F(v._payload),k)}if(Io(v))return x(g,y,v,k);if(No(v))return m(g,y,v,k);Cc(g,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,y!==null&&y.tag===6?(r(g,y.sibling),y=n(y,v),y.return=g,g=y):(r(g,y),y=Ju(v,g.mode,k),y.return=g,g=y),o(g)):r(g,y)}return w}var no=cv(!0),uv=cv(!1),v0=Ss(null),y0=null,Ai=null,kh=null;function bh(){kh=Ai=y0=null}function Eh(e){var t=v0.current;yt(v0),e._currentValue=t}function Kd(e,t,r){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===r)break;e=e.return}}function Mi(e,t){y0=e,kh=Ai=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Vr=!0),e.firstContext=null)}function wa(e){var t=e._currentValue;if(kh!==e)if(e={context:e,memoizedValue:t,next:null},Ai===null){if(y0===null)throw Error(Ne(308));Ai=e,y0.dependencies={lanes:0,firstContext:e}}else Ai=Ai.next=e;return t}var Ds=null;function Sh(e){Ds===null?Ds=[e]:Ds.push(e)}function dv(e,t,r,a){var n=t.interleaved;return n===null?(r.next=r,Sh(t)):(r.next=n.next,n.next=r),t.interleaved=r,Pn(e,a)}function Pn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var $n=!1;function Nh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function _n(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function us(e,t,r){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,st&2){var n=a.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),a.pending=t,Pn(e,r)}return n=a.interleaved,n===null?(t.next=t,Sh(a)):(t.next=n.next,n.next=t),a.interleaved=t,Pn(e,r)}function qc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,uh(e,r)}}function wx(e,t){var r=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,r===a)){var n=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?n=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?n=s=t:s=s.next=t}else n=s=t;r={baseState:a.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:a.shared,effects:a.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function w0(e,t,r,a){var n=e.updateQueue;$n=!1;var s=n.firstBaseUpdate,o=n.lastBaseUpdate,l=n.shared.pending;if(l!==null){n.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=n.baseState;o=0,d=u=c=null,l=s;do{var h=l.lane,p=l.eventTime;if((a&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,m=l;switch(h=t,p=r,m.tag){case 1:if(x=m.payload,typeof x=="function"){f=x.call(p,f,h);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=m.payload,h=typeof x=="function"?x.call(p,f,h):x,h==null)break e;f=Tt({},f,h);break e;case 2:$n=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=n.effects,h===null?n.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=f):d=d.next=p,o|=h;if(l=l.next,l===null){if(l=n.shared.pending,l===null)break;h=l,l=h.next,h.next=null,n.lastBaseUpdate=h,n.shared.pending=null}}while(1);if(d===null&&(c=f),n.baseState=c,n.firstBaseUpdate=u,n.lastBaseUpdate=d,t=n.shared.interleaved,t!==null){n=t;do o|=n.lane,n=n.next;while(n!==t)}else s===null&&(n.shared.lanes=0);ri|=o,e.lanes=o,e.memoizedState=f}}function kx(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var a=e[t],n=a.callback;if(n!==null){if(a.callback=null,a=r,typeof n!="function")throw Error(Ne(191,n));n.call(a)}}}var rc={},on=Ss(rc),kl=Ss(rc),bl=Ss(rc);function Os(e){if(e===rc)throw Error(Ne(174));return e}function Ch(e,t){switch(mt(bl,t),mt(kl,e),mt(on,rc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ad(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ad(t,e)}yt(on),mt(on,t)}function so(){yt(on),yt(kl),yt(bl)}function hv(e){Os(bl.current);var t=Os(on.current),r=Ad(t,e.type);t!==r&&(mt(kl,e),mt(on,r))}function _h(e){kl.current===e&&(yt(on),yt(kl))}var Nt=Ss(0);function k0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Gu=[];function Th(){for(var e=0;e<Gu.length;e++)Gu[e]._workInProgressVersionPrimary=null;Gu.length=0}var Qc=Rn.ReactCurrentDispatcher,Xu=Rn.ReactCurrentBatchConfig,ti=0,Ct=null,Xt=null,tr=null,b0=!1,Qo=!1,El=0,Bb=0;function pr(){throw Error(Ne(321))}function jh(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Va(e[r],t[r]))return!1;return!0}function Ah(e,t,r,a,n,s){if(ti=s,Ct=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Qc.current=e===null||e.memoizedState===null?Hb:Vb,e=r(a,n),Qo){s=0;do{if(Qo=!1,El=0,25<=s)throw Error(Ne(301));s+=1,tr=Xt=null,t.updateQueue=null,Qc.current=Wb,e=r(a,n)}while(Qo)}if(Qc.current=E0,t=Xt!==null&&Xt.next!==null,ti=0,tr=Xt=Ct=null,b0=!1,t)throw Error(Ne(300));return e}function Fh(){var e=El!==0;return El=0,e}function en(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tr===null?Ct.memoizedState=tr=e:tr=tr.next=e,tr}function ka(){if(Xt===null){var e=Ct.alternate;e=e!==null?e.memoizedState:null}else e=Xt.next;var t=tr===null?Ct.memoizedState:tr.next;if(t!==null)tr=t,Xt=e;else{if(e===null)throw Error(Ne(310));Xt=e,e={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},tr===null?Ct.memoizedState=tr=e:tr=tr.next=e}return tr}function Sl(e,t){return typeof t=="function"?t(e):t}function qu(e){var t=ka(),r=t.queue;if(r===null)throw Error(Ne(311));r.lastRenderedReducer=e;var a=Xt,n=a.baseQueue,s=r.pending;if(s!==null){if(n!==null){var o=n.next;n.next=s.next,s.next=o}a.baseQueue=n=s,r.pending=null}if(n!==null){s=n.next,a=a.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((ti&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),a=u.hasEagerState?u.eagerState:e(a,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=a):c=c.next=f,Ct.lanes|=d,ri|=d}u=u.next}while(u!==null&&u!==s);c===null?o=a:c.next=l,Va(a,t.memoizedState)||(Vr=!0),t.memoizedState=a,t.baseState=o,t.baseQueue=c,r.lastRenderedState=a}if(e=r.interleaved,e!==null){n=e;do s=n.lane,Ct.lanes|=s,ri|=s,n=n.next;while(n!==e)}else n===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Qu(e){var t=ka(),r=t.queue;if(r===null)throw Error(Ne(311));r.lastRenderedReducer=e;var a=r.dispatch,n=r.pending,s=t.memoizedState;if(n!==null){r.pending=null;var o=n=n.next;do s=e(s,o.action),o=o.next;while(o!==n);Va(s,t.memoizedState)||(Vr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,a]}function pv(){}function xv(e,t){var r=Ct,a=ka(),n=t(),s=!Va(a.memoizedState,n);if(s&&(a.memoizedState=n,Vr=!0),a=a.queue,Ph(vv.bind(null,r,a,e),[e]),a.getSnapshot!==t||s||tr!==null&&tr.memoizedState.tag&1){if(r.flags|=2048,Nl(9,gv.bind(null,r,a,n,t),void 0,null),ar===null)throw Error(Ne(349));ti&30||mv(r,t,n)}return n}function mv(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ct.updateQueue,t===null?(t={lastEffect:null,stores:null},Ct.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function gv(e,t,r,a){t.value=r,t.getSnapshot=a,yv(t)&&wv(e)}function vv(e,t,r){return r(function(){yv(t)&&wv(e)})}function yv(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Va(e,r)}catch{return!0}}function wv(e){var t=Pn(e,1);t!==null&&za(t,e,1,-1)}function bx(e){var t=en();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sl,lastRenderedState:e},t.queue=e,e=e.dispatch=$b.bind(null,Ct,e),[t.memoizedState,e]}function Nl(e,t,r,a){return e={tag:e,create:t,destroy:r,deps:a,next:null},t=Ct.updateQueue,t===null?(t={lastEffect:null,stores:null},Ct.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(a=r.next,r.next=e,e.next=a,t.lastEffect=e)),e}function kv(){return ka().memoizedState}function Kc(e,t,r,a){var n=en();Ct.flags|=e,n.memoizedState=Nl(1|t,r,void 0,a===void 0?null:a)}function au(e,t,r,a){var n=ka();a=a===void 0?null:a;var s=void 0;if(Xt!==null){var o=Xt.memoizedState;if(s=o.destroy,a!==null&&jh(a,o.deps)){n.memoizedState=Nl(t,r,s,a);return}}Ct.flags|=e,n.memoizedState=Nl(1|t,r,s,a)}function Ex(e,t){return Kc(8390656,8,e,t)}function Ph(e,t){return au(2048,8,e,t)}function bv(e,t){return au(4,2,e,t)}function Ev(e,t){return au(4,4,e,t)}function Sv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Nv(e,t,r){return r=r!=null?r.concat([e]):null,au(4,4,Sv.bind(null,t,e),r)}function Dh(){}function Cv(e,t){var r=ka();t=t===void 0?null:t;var a=r.memoizedState;return a!==null&&t!==null&&jh(t,a[1])?a[0]:(r.memoizedState=[e,t],e)}function _v(e,t){var r=ka();t=t===void 0?null:t;var a=r.memoizedState;return a!==null&&t!==null&&jh(t,a[1])?a[0]:(e=e(),r.memoizedState=[e,t],e)}function Tv(e,t,r){return ti&21?(Va(r,t)||(r=D1(),Ct.lanes|=r,ri|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Vr=!0),e.memoizedState=r)}function Ub(e,t){var r=ut;ut=r!==0&&4>r?r:4,e(!0);var a=Xu.transition;Xu.transition={};try{e(!1),t()}finally{ut=r,Xu.transition=a}}function jv(){return ka().memoizedState}function zb(e,t,r){var a=fs(e);if(r={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null},Av(e))Fv(t,r);else if(r=dv(e,t,r,a),r!==null){var n=Rr();za(r,e,a,n),Pv(r,t,a)}}function $b(e,t,r){var a=fs(e),n={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null};if(Av(e))Fv(t,n);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(n.hasEagerState=!0,n.eagerState=l,Va(l,o)){var c=t.interleaved;c===null?(n.next=n,Sh(t)):(n.next=c.next,c.next=n),t.interleaved=n;return}}catch{}finally{}r=dv(e,t,n,a),r!==null&&(n=Rr(),za(r,e,a,n),Pv(r,t,a))}}function Av(e){var t=e.alternate;return e===Ct||t!==null&&t===Ct}function Fv(e,t){Qo=b0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Pv(e,t,r){if(r&4194240){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,uh(e,r)}}var E0={readContext:wa,useCallback:pr,useContext:pr,useEffect:pr,useImperativeHandle:pr,useInsertionEffect:pr,useLayoutEffect:pr,useMemo:pr,useReducer:pr,useRef:pr,useState:pr,useDebugValue:pr,useDeferredValue:pr,useTransition:pr,useMutableSource:pr,useSyncExternalStore:pr,useId:pr,unstable_isNewReconciler:!1},Hb={readContext:wa,useCallback:function(e,t){return en().memoizedState=[e,t===void 0?null:t],e},useContext:wa,useEffect:Ex,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Kc(4194308,4,Sv.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Kc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Kc(4,2,e,t)},useMemo:function(e,t){var r=en();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var a=en();return t=r!==void 0?r(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=zb.bind(null,Ct,e),[a.memoizedState,e]},useRef:function(e){var t=en();return e={current:e},t.memoizedState=e},useState:bx,useDebugValue:Dh,useDeferredValue:function(e){return en().memoizedState=e},useTransition:function(){var e=bx(!1),t=e[0];return e=Ub.bind(null,e[1]),en().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var a=Ct,n=en();if(bt){if(r===void 0)throw Error(Ne(407));r=r()}else{if(r=t(),ar===null)throw Error(Ne(349));ti&30||mv(a,t,r)}n.memoizedState=r;var s={value:r,getSnapshot:t};return n.queue=s,Ex(vv.bind(null,a,s,e),[e]),a.flags|=2048,Nl(9,gv.bind(null,a,s,r,t),void 0,null),r},useId:function(){var e=en(),t=ar.identifierPrefix;if(bt){var r=Nn,a=Sn;r=(a&~(1<<32-Ua(a)-1)).toString(32)+r,t=":"+t+"R"+r,r=El++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Bb++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Vb={readContext:wa,useCallback:Cv,useContext:wa,useEffect:Ph,useImperativeHandle:Nv,useInsertionEffect:bv,useLayoutEffect:Ev,useMemo:_v,useReducer:qu,useRef:kv,useState:function(){return qu(Sl)},useDebugValue:Dh,useDeferredValue:function(e){var t=ka();return Tv(t,Xt.memoizedState,e)},useTransition:function(){var e=qu(Sl)[0],t=ka().memoizedState;return[e,t]},useMutableSource:pv,useSyncExternalStore:xv,useId:jv,unstable_isNewReconciler:!1},Wb={readContext:wa,useCallback:Cv,useContext:wa,useEffect:Ph,useImperativeHandle:Nv,useInsertionEffect:bv,useLayoutEffect:Ev,useMemo:_v,useReducer:Qu,useRef:kv,useState:function(){return Qu(Sl)},useDebugValue:Dh,useDeferredValue:function(e){var t=ka();return Xt===null?t.memoizedState=e:Tv(t,Xt.memoizedState,e)},useTransition:function(){var e=Qu(Sl)[0],t=ka().memoizedState;return[e,t]},useMutableSource:pv,useSyncExternalStore:xv,useId:jv,unstable_isNewReconciler:!1};function Fa(e,t){if(e&&e.defaultProps){t=Tt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Yd(e,t,r,a){t=e.memoizedState,r=r(a,t),r=r==null?t:Tt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var nu={isMounted:function(e){return(e=e._reactInternals)?ui(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var a=Rr(),n=fs(e),s=_n(a,n);s.payload=t,r!=null&&(s.callback=r),t=us(e,s,n),t!==null&&(za(t,e,n,a),qc(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var a=Rr(),n=fs(e),s=_n(a,n);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=us(e,s,n),t!==null&&(za(t,e,n,a),qc(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Rr(),a=fs(e),n=_n(r,a);n.tag=2,t!=null&&(n.callback=t),t=us(e,n,a),t!==null&&(za(t,e,a,r),qc(t,e,a))}};function Sx(e,t,r,a,n,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,s,o):t.prototype&&t.prototype.isPureReactComponent?!gl(r,a)||!gl(n,s):!0}function Dv(e,t,r){var a=!1,n=ys,s=t.contextType;return typeof s=="object"&&s!==null?s=wa(s):(n=Gr(t)?Zs:Sr.current,a=t.contextTypes,s=(a=a!=null)?ro(e,n):ys),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=nu,e.stateNode=t,t._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=s),t}function Nx(e,t,r,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&nu.enqueueReplaceState(t,t.state,null)}function Jd(e,t,r,a){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs={},Nh(e);var s=t.contextType;typeof s=="object"&&s!==null?n.context=wa(s):(s=Gr(t)?Zs:Sr.current,n.context=ro(e,s)),n.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Yd(e,t,s,r),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&nu.enqueueReplaceState(n,n.state,null),w0(e,r,n,a),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function io(e,t){try{var r="",a=t;do r+=yk(a),a=a.return;while(a);var n=r}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:n,digest:null}}function Ku(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Zd(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Gb=typeof WeakMap=="function"?WeakMap:Map;function Ov(e,t,r){r=_n(-1,r),r.tag=3,r.payload={element:null};var a=t.value;return r.callback=function(){N0||(N0=!0,uf=a),Zd(e,t)},r}function Rv(e,t,r){r=_n(-1,r),r.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var n=t.value;r.payload=function(){return a(n)},r.callback=function(){Zd(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Zd(e,t),typeof a!="function"&&(ds===null?ds=new Set([this]):ds.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function Cx(e,t,r){var a=e.pingCache;if(a===null){a=e.pingCache=new Gb;var n=new Set;a.set(t,n)}else n=a.get(t),n===void 0&&(n=new Set,a.set(t,n));n.has(r)||(n.add(r),e=i4.bind(null,e,t,r),t.then(e,e))}function _x(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Tx(e,t,r,a,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=_n(-1,1),t.tag=2,us(r,t,1))),r.lanes|=1),e)}var Xb=Rn.ReactCurrentOwner,Vr=!1;function Fr(e,t,r,a){t.child=e===null?uv(t,null,r,a):no(t,e.child,r,a)}function jx(e,t,r,a,n){r=r.render;var s=t.ref;return Mi(t,n),a=Ah(e,t,r,a,s,n),r=Fh(),e!==null&&!Vr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Dn(e,t,n)):(bt&&r&&vh(t),t.flags|=1,Fr(e,t,a,n),t.child)}function Ax(e,t,r,a,n){if(e===null){var s=r.type;return typeof s=="function"&&!zh(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,Iv(e,t,s,a,n)):(e=e0(r.type,null,a,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&n)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:gl,r(o,a)&&e.ref===t.ref)return Dn(e,t,n)}return t.flags|=1,e=hs(s,a),e.ref=t.ref,e.return=t,t.child=e}function Iv(e,t,r,a,n){if(e!==null){var s=e.memoizedProps;if(gl(s,a)&&e.ref===t.ref)if(Vr=!1,t.pendingProps=a=s,(e.lanes&n)!==0)e.flags&131072&&(Vr=!0);else return t.lanes=e.lanes,Dn(e,t,n)}return ef(e,t,r,a,n)}function Lv(e,t,r){var a=t.pendingProps,n=a.children,s=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(Pi,Jr),Jr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,mt(Pi,Jr),Jr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=s!==null?s.baseLanes:r,mt(Pi,Jr),Jr|=a}else s!==null?(a=s.baseLanes|r,t.memoizedState=null):a=r,mt(Pi,Jr),Jr|=a;return Fr(e,t,n,r),t.child}function Mv(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ef(e,t,r,a,n){var s=Gr(r)?Zs:Sr.current;return s=ro(t,s),Mi(t,n),r=Ah(e,t,r,a,s,n),a=Fh(),e!==null&&!Vr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Dn(e,t,n)):(bt&&a&&vh(t),t.flags|=1,Fr(e,t,r,n),t.child)}function Fx(e,t,r,a,n){if(Gr(r)){var s=!0;x0(t)}else s=!1;if(Mi(t,n),t.stateNode===null)Yc(e,t),Dv(t,r,a),Jd(t,r,a,n),a=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=wa(u):(u=Gr(r)?Zs:Sr.current,u=ro(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==a||c!==u)&&Nx(t,o,a,u),$n=!1;var h=t.memoizedState;o.state=h,w0(t,a,o,n),c=t.memoizedState,l!==a||h!==c||Wr.current||$n?(typeof d=="function"&&(Yd(t,r,d,a),c=t.memoizedState),(l=$n||Sx(t,r,l,a,h,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=c),o.props=a,o.state=c,o.context=u,a=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{o=t.stateNode,fv(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Fa(t.type,l),o.props=u,f=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=wa(c):(c=Gr(r)?Zs:Sr.current,c=ro(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==c)&&Nx(t,o,a,c),$n=!1,h=t.memoizedState,o.state=h,w0(t,a,o,n);var x=t.memoizedState;l!==f||h!==x||Wr.current||$n?(typeof p=="function"&&(Yd(t,r,p,a),x=t.memoizedState),(u=$n||Sx(t,r,u,a,h,x,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(a,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(a,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=x),o.props=a,o.state=x,o.context=c,a=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),a=!1)}return tf(e,t,r,a,s,n)}function tf(e,t,r,a,n,s){Mv(e,t);var o=(t.flags&128)!==0;if(!a&&!o)return n&&mx(t,r,!1),Dn(e,t,s);a=t.stateNode,Xb.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:a.render();return t.flags|=1,e!==null&&o?(t.child=no(t,e.child,null,s),t.child=no(t,null,l,s)):Fr(e,t,l,s),t.memoizedState=a.state,n&&mx(t,r,!0),t.child}function Bv(e){var t=e.stateNode;t.pendingContext?xx(e,t.pendingContext,t.pendingContext!==t.context):t.context&&xx(e,t.context,!1),Ch(e,t.containerInfo)}function Px(e,t,r,a,n){return ao(),wh(n),t.flags|=256,Fr(e,t,r,a),t.child}var rf={dehydrated:null,treeContext:null,retryLane:0};function af(e){return{baseLanes:e,cachePool:null,transitions:null}}function Uv(e,t,r){var a=t.pendingProps,n=Nt.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(n&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),mt(Nt,n&1),e===null)return Qd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=a.children,e=a.fallback,s?(a=t.mode,s=t.child,o={mode:"hidden",children:o},!(a&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=ou(o,a,0,null),e=Qs(e,a,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=af(r),t.memoizedState=rf,e):Oh(t,o));if(n=e.memoizedState,n!==null&&(l=n.dehydrated,l!==null))return qb(e,t,o,a,l,n,r);if(s){s=a.fallback,o=t.mode,n=e.child,l=n.sibling;var c={mode:"hidden",children:a.children};return!(o&1)&&t.child!==n?(a=t.child,a.childLanes=0,a.pendingProps=c,t.deletions=null):(a=hs(n,c),a.subtreeFlags=n.subtreeFlags&14680064),l!==null?s=hs(l,s):(s=Qs(s,o,r,null),s.flags|=2),s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,o=e.child.memoizedState,o=o===null?af(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=rf,a}return s=e.child,e=s.sibling,a=hs(s,{mode:"visible",children:a.children}),!(t.mode&1)&&(a.lanes=r),a.return=t,a.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a}function Oh(e,t){return t=ou({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function _c(e,t,r,a){return a!==null&&wh(a),no(t,e.child,null,r),e=Oh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function qb(e,t,r,a,n,s,o){if(r)return t.flags&256?(t.flags&=-257,a=Ku(Error(Ne(422))),_c(e,t,o,a)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=a.fallback,n=t.mode,a=ou({mode:"visible",children:a.children},n,0,null),s=Qs(s,n,o,null),s.flags|=2,a.return=t,s.return=t,a.sibling=s,t.child=a,t.mode&1&&no(t,e.child,null,o),t.child.memoizedState=af(o),t.memoizedState=rf,s);if(!(t.mode&1))return _c(e,t,o,null);if(n.data==="$!"){if(a=n.nextSibling&&n.nextSibling.dataset,a)var l=a.dgst;return a=l,s=Error(Ne(419)),a=Ku(s,a,void 0),_c(e,t,o,a)}if(l=(o&e.childLanes)!==0,Vr||l){if(a=ar,a!==null){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(a.suspendedLanes|o)?0:n,n!==0&&n!==s.retryLane&&(s.retryLane=n,Pn(e,n),za(a,e,n,-1))}return Uh(),a=Ku(Error(Ne(421))),_c(e,t,o,a)}return n.data==="$?"?(t.flags|=128,t.child=e.child,t=o4.bind(null,e),n._reactRetry=t,null):(e=s.treeContext,ra=cs(n.nextSibling),aa=t,bt=!0,Ra=null,e!==null&&(ma[ga++]=Sn,ma[ga++]=Nn,ma[ga++]=ei,Sn=e.id,Nn=e.overflow,ei=t),t=Oh(t,a.children),t.flags|=4096,t)}function Dx(e,t,r){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),Kd(e.return,t,r)}function Yu(e,t,r,a,n){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:n}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=a,s.tail=r,s.tailMode=n)}function zv(e,t,r){var a=t.pendingProps,n=a.revealOrder,s=a.tail;if(Fr(e,t,a.children,r),a=Nt.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Dx(e,r,t);else if(e.tag===19)Dx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(mt(Nt,a),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&k0(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),Yu(t,!1,n,r,s);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&k0(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}Yu(t,!0,r,null,s);break;case"together":Yu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Yc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Dn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ri|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ne(153));if(t.child!==null){for(e=t.child,r=hs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=hs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Qb(e,t,r){switch(t.tag){case 3:Bv(t),ao();break;case 5:hv(t);break;case 1:Gr(t.type)&&x0(t);break;case 4:Ch(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,n=t.memoizedProps.value;mt(v0,a._currentValue),a._currentValue=n;break;case 13:if(a=t.memoizedState,a!==null)return a.dehydrated!==null?(mt(Nt,Nt.current&1),t.flags|=128,null):r&t.child.childLanes?Uv(e,t,r):(mt(Nt,Nt.current&1),e=Dn(e,t,r),e!==null?e.sibling:null);mt(Nt,Nt.current&1);break;case 19:if(a=(r&t.childLanes)!==0,e.flags&128){if(a)return zv(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),mt(Nt,Nt.current),a)break;return null;case 22:case 23:return t.lanes=0,Lv(e,t,r)}return Dn(e,t,r)}var $v,nf,Hv,Vv;$v=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};nf=function(){};Hv=function(e,t,r,a){var n=e.memoizedProps;if(n!==a){e=t.stateNode,Os(on.current);var s=null;switch(r){case"input":n=Cd(e,n),a=Cd(e,a),s=[];break;case"select":n=Tt({},n,{value:void 0}),a=Tt({},a,{value:void 0}),s=[];break;case"textarea":n=jd(e,n),a=jd(e,a),s=[];break;default:typeof n.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=h0)}Fd(r,a);var o;r=null;for(u in n)if(!a.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var l=n[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ul.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in a){var c=a[u];if(l=n!=null?n[u]:void 0,a.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ul.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&vt("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};Vv=function(e,t,r,a){r!==a&&(t.flags|=4)};function Fo(e,t){if(!bt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function xr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,a=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,a|=n.subtreeFlags&14680064,a|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,a|=n.subtreeFlags,a|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=a,e.childLanes=r,t}function Kb(e,t,r){var a=t.pendingProps;switch(yh(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xr(t),null;case 1:return Gr(t.type)&&p0(),xr(t),null;case 3:return a=t.stateNode,so(),yt(Wr),yt(Sr),Th(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Nc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ra!==null&&(hf(Ra),Ra=null))),nf(e,t),xr(t),null;case 5:_h(t);var n=Os(bl.current);if(r=t.type,e!==null&&t.stateNode!=null)Hv(e,t,r,a,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(t.stateNode===null)throw Error(Ne(166));return xr(t),null}if(e=Os(on.current),Nc(t)){a=t.stateNode,r=t.type;var s=t.memoizedProps;switch(a[nn]=t,a[wl]=s,e=(t.mode&1)!==0,r){case"dialog":vt("cancel",a),vt("close",a);break;case"iframe":case"object":case"embed":vt("load",a);break;case"video":case"audio":for(n=0;n<Mo.length;n++)vt(Mo[n],a);break;case"source":vt("error",a);break;case"img":case"image":case"link":vt("error",a),vt("load",a);break;case"details":vt("toggle",a);break;case"input":$p(a,s),vt("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!s.multiple},vt("invalid",a);break;case"textarea":Vp(a,s),vt("invalid",a)}Fd(r,s),n=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?a.textContent!==l&&(s.suppressHydrationWarning!==!0&&Sc(a.textContent,l,e),n=["children",l]):typeof l=="number"&&a.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Sc(a.textContent,l,e),n=["children",""+l]):ul.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&vt("scroll",a)}switch(r){case"input":mc(a),Hp(a,s,!0);break;case"textarea":mc(a),Wp(a);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(a.onclick=h0)}a=n,t.updateQueue=a,a!==null&&(t.flags|=4)}else{o=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=v1(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=o.createElement(r,{is:a.is}):(e=o.createElement(r),r==="select"&&(o=e,a.multiple?o.multiple=!0:a.size&&(o.size=a.size))):e=o.createElementNS(e,r),e[nn]=t,e[wl]=a,$v(e,t,!1,!1),t.stateNode=e;e:{switch(o=Pd(r,a),r){case"dialog":vt("cancel",e),vt("close",e),n=a;break;case"iframe":case"object":case"embed":vt("load",e),n=a;break;case"video":case"audio":for(n=0;n<Mo.length;n++)vt(Mo[n],e);n=a;break;case"source":vt("error",e),n=a;break;case"img":case"image":case"link":vt("error",e),vt("load",e),n=a;break;case"details":vt("toggle",e),n=a;break;case"input":$p(e,a),n=Cd(e,a),vt("invalid",e);break;case"option":n=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},n=Tt({},a,{value:void 0}),vt("invalid",e);break;case"textarea":Vp(e,a),n=jd(e,a),vt("invalid",e);break;default:n=a}Fd(r,n),l=n;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?k1(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&y1(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&dl(e,c):typeof c=="number"&&dl(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ul.hasOwnProperty(s)?c!=null&&s==="onScroll"&&vt("scroll",e):c!=null&&nh(e,s,c,o))}switch(r){case"input":mc(e),Hp(e,a,!1);break;case"textarea":mc(e),Wp(e);break;case"option":a.value!=null&&e.setAttribute("value",""+vs(a.value));break;case"select":e.multiple=!!a.multiple,s=a.value,s!=null?Oi(e,!!a.multiple,s,!1):a.defaultValue!=null&&Oi(e,!!a.multiple,a.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=h0)}switch(r){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return xr(t),null;case 6:if(e&&t.stateNode!=null)Vv(e,t,e.memoizedProps,a);else{if(typeof a!="string"&&t.stateNode===null)throw Error(Ne(166));if(r=Os(bl.current),Os(on.current),Nc(t)){if(a=t.stateNode,r=t.memoizedProps,a[nn]=t,(s=a.nodeValue!==r)&&(e=aa,e!==null))switch(e.tag){case 3:Sc(a.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Sc(a.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else a=(r.nodeType===9?r:r.ownerDocument).createTextNode(a),a[nn]=t,t.stateNode=a}return xr(t),null;case 13:if(yt(Nt),a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(bt&&ra!==null&&t.mode&1&&!(t.flags&128))lv(),ao(),t.flags|=98560,s=!1;else if(s=Nc(t),a!==null&&a.dehydrated!==null){if(e===null){if(!s)throw Error(Ne(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ne(317));s[nn]=t}else ao(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;xr(t),s=!1}else Ra!==null&&(hf(Ra),Ra=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(t.child.flags|=8192,t.mode&1&&(e===null||Nt.current&1?qt===0&&(qt=3):Uh())),t.updateQueue!==null&&(t.flags|=4),xr(t),null);case 4:return so(),nf(e,t),e===null&&vl(t.stateNode.containerInfo),xr(t),null;case 10:return Eh(t.type._context),xr(t),null;case 17:return Gr(t.type)&&p0(),xr(t),null;case 19:if(yt(Nt),s=t.memoizedState,s===null)return xr(t),null;if(a=(t.flags&128)!==0,o=s.rendering,o===null)if(a)Fo(s,!1);else{if(qt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=k0(e),o!==null){for(t.flags|=128,Fo(s,!1),a=o.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=r,r=t.child;r!==null;)s=r,e=a,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return mt(Nt,Nt.current&1|2),t.child}e=e.sibling}s.tail!==null&&It()>oo&&(t.flags|=128,a=!0,Fo(s,!1),t.lanes=4194304)}else{if(!a)if(e=k0(o),e!==null){if(t.flags|=128,a=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Fo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!bt)return xr(t),null}else 2*It()-s.renderingStartTime>oo&&r!==1073741824&&(t.flags|=128,a=!0,Fo(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=It(),t.sibling=null,r=Nt.current,mt(Nt,a?r&1|2:r&1),t):(xr(t),null);case 22:case 23:return Bh(),a=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(t.flags|=8192),a&&t.mode&1?Jr&1073741824&&(xr(t),t.subtreeFlags&6&&(t.flags|=8192)):xr(t),null;case 24:return null;case 25:return null}throw Error(Ne(156,t.tag))}function Yb(e,t){switch(yh(t),t.tag){case 1:return Gr(t.type)&&p0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return so(),yt(Wr),yt(Sr),Th(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return _h(t),null;case 13:if(yt(Nt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ne(340));ao()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return yt(Nt),null;case 4:return so(),null;case 10:return Eh(t.type._context),null;case 22:case 23:return Bh(),null;case 24:return null;default:return null}}var Tc=!1,vr=!1,Jb=typeof WeakSet=="function"?WeakSet:Set,Re=null;function Fi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(a){Ft(e,t,a)}else r.current=null}function sf(e,t,r){try{r()}catch(a){Ft(e,t,a)}}var Ox=!1;function Zb(e,t){if($d=u0,e=Q1(),gh(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var a=r.getSelection&&r.getSelection();if(a&&a.rangeCount!==0){r=a.anchorNode;var n=a.anchorOffset,s=a.focusNode;a=a.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var p;f!==r||n!==0&&f.nodeType!==3||(l=o+n),f!==s||a!==0&&f.nodeType!==3||(c=o+a),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++u===n&&(l=o),h===s&&++d===a&&(c=o),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Hd={focusedElem:e,selectionRange:r},u0=!1,Re=t;Re!==null;)if(t=Re,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Re=e;else for(;Re!==null;){t=Re;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var m=x.memoizedProps,w=x.memoizedState,g=t.stateNode,y=g.getSnapshotBeforeUpdate(t.elementType===t.type?m:Fa(t.type,m),w);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ne(163))}}catch(k){Ft(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,Re=e;break}Re=t.return}return x=Ox,Ox=!1,x}function Ko(e,t,r){var a=t.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var n=a=a.next;do{if((n.tag&e)===e){var s=n.destroy;n.destroy=void 0,s!==void 0&&sf(t,r,s)}n=n.next}while(n!==a)}}function su(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var a=r.create;r.destroy=a()}r=r.next}while(r!==t)}}function of(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Wv(e){var t=e.alternate;t!==null&&(e.alternate=null,Wv(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[nn],delete t[wl],delete t[Gd],delete t[Rb],delete t[Ib])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Gv(e){return e.tag===5||e.tag===3||e.tag===4}function Rx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Gv(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function lf(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=h0));else if(a!==4&&(e=e.child,e!==null))for(lf(e,t,r),e=e.sibling;e!==null;)lf(e,t,r),e=e.sibling}function cf(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(cf(e,t,r),e=e.sibling;e!==null;)cf(e,t,r),e=e.sibling}var ir=null,Oa=!1;function Mn(e,t,r){for(r=r.child;r!==null;)Xv(e,t,r),r=r.sibling}function Xv(e,t,r){if(sn&&typeof sn.onCommitFiberUnmount=="function")try{sn.onCommitFiberUnmount(Y0,r)}catch{}switch(r.tag){case 5:vr||Fi(r,t);case 6:var a=ir,n=Oa;ir=null,Mn(e,t,r),ir=a,Oa=n,ir!==null&&(Oa?(e=ir,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ir.removeChild(r.stateNode));break;case 18:ir!==null&&(Oa?(e=ir,r=r.stateNode,e.nodeType===8?Vu(e.parentNode,r):e.nodeType===1&&Vu(e,r),xl(e)):Vu(ir,r.stateNode));break;case 4:a=ir,n=Oa,ir=r.stateNode.containerInfo,Oa=!0,Mn(e,t,r),ir=a,Oa=n;break;case 0:case 11:case 14:case 15:if(!vr&&(a=r.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){n=a=a.next;do{var s=n,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&sf(r,t,o),n=n.next}while(n!==a)}Mn(e,t,r);break;case 1:if(!vr&&(Fi(r,t),a=r.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=r.memoizedProps,a.state=r.memoizedState,a.componentWillUnmount()}catch(l){Ft(r,t,l)}Mn(e,t,r);break;case 21:Mn(e,t,r);break;case 22:r.mode&1?(vr=(a=vr)||r.memoizedState!==null,Mn(e,t,r),vr=a):Mn(e,t,r);break;default:Mn(e,t,r)}}function Ix(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Jb),t.forEach(function(a){var n=l4.bind(null,e,a);r.has(a)||(r.add(a),a.then(n,n))})}}function Ta(e,t){var r=t.deletions;if(r!==null)for(var a=0;a<r.length;a++){var n=r[a];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:ir=l.stateNode,Oa=!1;break e;case 3:ir=l.stateNode.containerInfo,Oa=!0;break e;case 4:ir=l.stateNode.containerInfo,Oa=!0;break e}l=l.return}if(ir===null)throw Error(Ne(160));Xv(s,o,n),ir=null,Oa=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(u){Ft(n,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)qv(t,e),t=t.sibling}function qv(e,t){var r=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ta(t,e),Ka(e),a&4){try{Ko(3,e,e.return),su(3,e)}catch(m){Ft(e,e.return,m)}try{Ko(5,e,e.return)}catch(m){Ft(e,e.return,m)}}break;case 1:Ta(t,e),Ka(e),a&512&&r!==null&&Fi(r,r.return);break;case 5:if(Ta(t,e),Ka(e),a&512&&r!==null&&Fi(r,r.return),e.flags&32){var n=e.stateNode;try{dl(n,"")}catch(m){Ft(e,e.return,m)}}if(a&4&&(n=e.stateNode,n!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&m1(n,s),Pd(l,o);var u=Pd(l,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?k1(n,f):d==="dangerouslySetInnerHTML"?y1(n,f):d==="children"?dl(n,f):nh(n,d,f,u)}switch(l){case"input":_d(n,s);break;case"textarea":g1(n,s);break;case"select":var h=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Oi(n,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?Oi(n,!!s.multiple,s.defaultValue,!0):Oi(n,!!s.multiple,s.multiple?[]:"",!1))}n[wl]=s}catch(m){Ft(e,e.return,m)}}break;case 6:if(Ta(t,e),Ka(e),a&4){if(e.stateNode===null)throw Error(Ne(162));n=e.stateNode,s=e.memoizedProps;try{n.nodeValue=s}catch(m){Ft(e,e.return,m)}}break;case 3:if(Ta(t,e),Ka(e),a&4&&r!==null&&r.memoizedState.isDehydrated)try{xl(t.containerInfo)}catch(m){Ft(e,e.return,m)}break;case 4:Ta(t,e),Ka(e);break;case 13:Ta(t,e),Ka(e),n=e.child,n.flags&8192&&(s=n.memoizedState!==null,n.stateNode.isHidden=s,!s||n.alternate!==null&&n.alternate.memoizedState!==null||(Lh=It())),a&4&&Ix(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(vr=(u=vr)||d,Ta(t,e),vr=u):Ta(t,e),Ka(e),a&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Re=e,d=e.child;d!==null;){for(f=Re=d;Re!==null;){switch(h=Re,p=h.child,h.tag){case 0:case 11:case 14:case 15:Ko(4,h,h.return);break;case 1:Fi(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){a=h,r=h.return;try{t=a,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(m){Ft(a,r,m)}}break;case 5:Fi(h,h.return);break;case 22:if(h.memoizedState!==null){Mx(f);continue}}p!==null?(p.return=h,Re=p):Mx(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{n=f.stateNode,u?(s=n.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=w1("display",o))}catch(m){Ft(e,e.return,m)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(m){Ft(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ta(t,e),Ka(e),a&4&&Ix(e);break;case 21:break;default:Ta(t,e),Ka(e)}}function Ka(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Gv(r)){var a=r;break e}r=r.return}throw Error(Ne(160))}switch(a.tag){case 5:var n=a.stateNode;a.flags&32&&(dl(n,""),a.flags&=-33);var s=Rx(e);cf(e,s,n);break;case 3:case 4:var o=a.stateNode.containerInfo,l=Rx(e);lf(e,l,o);break;default:throw Error(Ne(161))}}catch(c){Ft(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function e4(e,t,r){Re=e,Qv(e)}function Qv(e,t,r){for(var a=(e.mode&1)!==0;Re!==null;){var n=Re,s=n.child;if(n.tag===22&&a){var o=n.memoizedState!==null||Tc;if(!o){var l=n.alternate,c=l!==null&&l.memoizedState!==null||vr;l=Tc;var u=vr;if(Tc=o,(vr=c)&&!u)for(Re=n;Re!==null;)o=Re,c=o.child,o.tag===22&&o.memoizedState!==null?Bx(n):c!==null?(c.return=o,Re=c):Bx(n);for(;s!==null;)Re=s,Qv(s),s=s.sibling;Re=n,Tc=l,vr=u}Lx(e)}else n.subtreeFlags&8772&&s!==null?(s.return=n,Re=s):Lx(e)}}function Lx(e){for(;Re!==null;){var t=Re;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:vr||su(5,t);break;case 1:var a=t.stateNode;if(t.flags&4&&!vr)if(r===null)a.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:Fa(t.type,r.memoizedProps);a.componentDidUpdate(n,r.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&kx(t,s,a);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}kx(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&xl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ne(163))}vr||t.flags&512&&of(t)}catch(h){Ft(t,t.return,h)}}if(t===e){Re=null;break}if(r=t.sibling,r!==null){r.return=t.return,Re=r;break}Re=t.return}}function Mx(e){for(;Re!==null;){var t=Re;if(t===e){Re=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Re=r;break}Re=t.return}}function Bx(e){for(;Re!==null;){var t=Re;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{su(4,t)}catch(c){Ft(t,r,c)}break;case 1:var a=t.stateNode;if(typeof a.componentDidMount=="function"){var n=t.return;try{a.componentDidMount()}catch(c){Ft(t,n,c)}}var s=t.return;try{of(t)}catch(c){Ft(t,s,c)}break;case 5:var o=t.return;try{of(t)}catch(c){Ft(t,o,c)}}}catch(c){Ft(t,t.return,c)}if(t===e){Re=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Re=l;break}Re=t.return}}var t4=Math.ceil,S0=Rn.ReactCurrentDispatcher,Rh=Rn.ReactCurrentOwner,ya=Rn.ReactCurrentBatchConfig,st=0,ar=null,Ht=null,cr=0,Jr=0,Pi=Ss(0),qt=0,Cl=null,ri=0,iu=0,Ih=0,Yo=null,Hr=null,Lh=0,oo=1/0,wn=null,N0=!1,uf=null,ds=null,jc=!1,rs=null,C0=0,Jo=0,df=null,Jc=-1,Zc=0;function Rr(){return st&6?It():Jc!==-1?Jc:Jc=It()}function fs(e){return e.mode&1?st&2&&cr!==0?cr&-cr:Mb.transition!==null?(Zc===0&&(Zc=D1()),Zc):(e=ut,e!==0||(e=window.event,e=e===void 0?16:U1(e.type)),e):1}function za(e,t,r,a){if(50<Jo)throw Jo=0,df=null,Error(Ne(185));Zl(e,r,a),(!(st&2)||e!==ar)&&(e===ar&&(!(st&2)&&(iu|=r),qt===4&&Vn(e,cr)),Xr(e,a),r===1&&st===0&&!(t.mode&1)&&(oo=It()+500,ru&&Ns()))}function Xr(e,t){var r=e.callbackNode;Mk(e,t);var a=c0(e,e===ar?cr:0);if(a===0)r!==null&&qp(r),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(r!=null&&qp(r),t===1)e.tag===0?Lb(Ux.bind(null,e)):sv(Ux.bind(null,e)),Db(function(){!(st&6)&&Ns()}),r=null;else{switch(O1(a)){case 1:r=ch;break;case 4:r=F1;break;case 16:r=l0;break;case 536870912:r=P1;break;default:r=l0}r=ay(r,Kv.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Kv(e,t){if(Jc=-1,Zc=0,st&6)throw Error(Ne(327));var r=e.callbackNode;if(Bi()&&e.callbackNode!==r)return null;var a=c0(e,e===ar?cr:0);if(a===0)return null;if(a&30||a&e.expiredLanes||t)t=_0(e,a);else{t=a;var n=st;st|=2;var s=Jv();(ar!==e||cr!==t)&&(wn=null,oo=It()+500,qs(e,t));do try{n4();break}catch(l){Yv(e,l)}while(1);bh(),S0.current=s,st=n,Ht!==null?t=0:(ar=null,cr=0,t=qt)}if(t!==0){if(t===2&&(n=Ld(e),n!==0&&(a=n,t=ff(e,n))),t===1)throw r=Cl,qs(e,0),Vn(e,a),Xr(e,It()),r;if(t===6)Vn(e,a);else{if(n=e.current.alternate,!(a&30)&&!r4(n)&&(t=_0(e,a),t===2&&(s=Ld(e),s!==0&&(a=s,t=ff(e,s))),t===1))throw r=Cl,qs(e,0),Vn(e,a),Xr(e,It()),r;switch(e.finishedWork=n,e.finishedLanes=a,t){case 0:case 1:throw Error(Ne(345));case 2:As(e,Hr,wn);break;case 3:if(Vn(e,a),(a&130023424)===a&&(t=Lh+500-It(),10<t)){if(c0(e,0)!==0)break;if(n=e.suspendedLanes,(n&a)!==a){Rr(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=Wd(As.bind(null,e,Hr,wn),t);break}As(e,Hr,wn);break;case 4:if(Vn(e,a),(a&4194240)===a)break;for(t=e.eventTimes,n=-1;0<a;){var o=31-Ua(a);s=1<<o,o=t[o],o>n&&(n=o),a&=~s}if(a=n,a=It()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*t4(a/1960))-a,10<a){e.timeoutHandle=Wd(As.bind(null,e,Hr,wn),a);break}As(e,Hr,wn);break;case 5:As(e,Hr,wn);break;default:throw Error(Ne(329))}}}return Xr(e,It()),e.callbackNode===r?Kv.bind(null,e):null}function ff(e,t){var r=Yo;return e.current.memoizedState.isDehydrated&&(qs(e,t).flags|=256),e=_0(e,t),e!==2&&(t=Hr,Hr=r,t!==null&&hf(t)),e}function hf(e){Hr===null?Hr=e:Hr.push.apply(Hr,e)}function r4(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var a=0;a<r.length;a++){var n=r[a],s=n.getSnapshot;n=n.value;try{if(!Va(s(),n))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Vn(e,t){for(t&=~Ih,t&=~iu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ua(t),a=1<<r;e[r]=-1,t&=~a}}function Ux(e){if(st&6)throw Error(Ne(327));Bi();var t=c0(e,0);if(!(t&1))return Xr(e,It()),null;var r=_0(e,t);if(e.tag!==0&&r===2){var a=Ld(e);a!==0&&(t=a,r=ff(e,a))}if(r===1)throw r=Cl,qs(e,0),Vn(e,t),Xr(e,It()),r;if(r===6)throw Error(Ne(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,As(e,Hr,wn),Xr(e,It()),null}function Mh(e,t){var r=st;st|=1;try{return e(t)}finally{st=r,st===0&&(oo=It()+500,ru&&Ns())}}function ai(e){rs!==null&&rs.tag===0&&!(st&6)&&Bi();var t=st;st|=1;var r=ya.transition,a=ut;try{if(ya.transition=null,ut=1,e)return e()}finally{ut=a,ya.transition=r,st=t,!(st&6)&&Ns()}}function Bh(){Jr=Pi.current,yt(Pi)}function qs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Pb(r)),Ht!==null)for(r=Ht.return;r!==null;){var a=r;switch(yh(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&p0();break;case 3:so(),yt(Wr),yt(Sr),Th();break;case 5:_h(a);break;case 4:so();break;case 13:yt(Nt);break;case 19:yt(Nt);break;case 10:Eh(a.type._context);break;case 22:case 23:Bh()}r=r.return}if(ar=e,Ht=e=hs(e.current,null),cr=Jr=t,qt=0,Cl=null,Ih=iu=ri=0,Hr=Yo=null,Ds!==null){for(t=0;t<Ds.length;t++)if(r=Ds[t],a=r.interleaved,a!==null){r.interleaved=null;var n=a.next,s=r.pending;if(s!==null){var o=s.next;s.next=n,a.next=o}r.pending=a}Ds=null}return e}function Yv(e,t){do{var r=Ht;try{if(bh(),Qc.current=E0,b0){for(var a=Ct.memoizedState;a!==null;){var n=a.queue;n!==null&&(n.pending=null),a=a.next}b0=!1}if(ti=0,tr=Xt=Ct=null,Qo=!1,El=0,Rh.current=null,r===null||r.return===null){qt=1,Cl=t,Ht=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=cr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=_x(o);if(p!==null){p.flags&=-257,Tx(p,o,l,s,t),p.mode&1&&Cx(s,u,t),t=p,c=u;var x=t.updateQueue;if(x===null){var m=new Set;m.add(c),t.updateQueue=m}else x.add(c);break e}else{if(!(t&1)){Cx(s,u,t),Uh();break e}c=Error(Ne(426))}}else if(bt&&l.mode&1){var w=_x(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Tx(w,o,l,s,t),wh(io(c,l));break e}}s=c=io(c,l),qt!==4&&(qt=2),Yo===null?Yo=[s]:Yo.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var g=Ov(s,c,t);wx(s,g);break e;case 1:l=c;var y=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ds===null||!ds.has(v)))){s.flags|=65536,t&=-t,s.lanes|=t;var k=Rv(s,l,t);wx(s,k);break e}}s=s.return}while(s!==null)}ey(r)}catch(_){t=_,Ht===r&&r!==null&&(Ht=r=r.return);continue}break}while(1)}function Jv(){var e=S0.current;return S0.current=E0,e===null?E0:e}function Uh(){(qt===0||qt===3||qt===2)&&(qt=4),ar===null||!(ri&268435455)&&!(iu&268435455)||Vn(ar,cr)}function _0(e,t){var r=st;st|=2;var a=Jv();(ar!==e||cr!==t)&&(wn=null,qs(e,t));do try{a4();break}catch(n){Yv(e,n)}while(1);if(bh(),st=r,S0.current=a,Ht!==null)throw Error(Ne(261));return ar=null,cr=0,qt}function a4(){for(;Ht!==null;)Zv(Ht)}function n4(){for(;Ht!==null&&!jk();)Zv(Ht)}function Zv(e){var t=ry(e.alternate,e,Jr);e.memoizedProps=e.pendingProps,t===null?ey(e):Ht=t,Rh.current=null}function ey(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Yb(r,t),r!==null){r.flags&=32767,Ht=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{qt=6,Ht=null;return}}else if(r=Kb(r,t,Jr),r!==null){Ht=r;return}if(t=t.sibling,t!==null){Ht=t;return}Ht=t=e}while(t!==null);qt===0&&(qt=5)}function As(e,t,r){var a=ut,n=ya.transition;try{ya.transition=null,ut=1,s4(e,t,r,a)}finally{ya.transition=n,ut=a}return null}function s4(e,t,r,a){do Bi();while(rs!==null);if(st&6)throw Error(Ne(327));r=e.finishedWork;var n=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ne(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(Bk(e,s),e===ar&&(Ht=ar=null,cr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||jc||(jc=!0,ay(l0,function(){return Bi(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ya.transition,ya.transition=null;var o=ut;ut=1;var l=st;st|=4,Rh.current=null,Zb(e,r),qv(r,e),Nb(Hd),u0=!!$d,Hd=$d=null,e.current=r,e4(r),Ak(),st=l,ut=o,ya.transition=s}else e.current=r;if(jc&&(jc=!1,rs=e,C0=n),s=e.pendingLanes,s===0&&(ds=null),Dk(r.stateNode),Xr(e,It()),t!==null)for(a=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],a(n.value,{componentStack:n.stack,digest:n.digest});if(N0)throw N0=!1,e=uf,uf=null,e;return C0&1&&e.tag!==0&&Bi(),s=e.pendingLanes,s&1?e===df?Jo++:(Jo=0,df=e):Jo=0,Ns(),null}function Bi(){if(rs!==null){var e=O1(C0),t=ya.transition,r=ut;try{if(ya.transition=null,ut=16>e?16:e,rs===null)var a=!1;else{if(e=rs,rs=null,C0=0,st&6)throw Error(Ne(331));var n=st;for(st|=4,Re=e.current;Re!==null;){var s=Re,o=s.child;if(Re.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Re=u;Re!==null;){var d=Re;switch(d.tag){case 0:case 11:case 15:Ko(8,d,s)}var f=d.child;if(f!==null)f.return=d,Re=f;else for(;Re!==null;){d=Re;var h=d.sibling,p=d.return;if(Wv(d),d===u){Re=null;break}if(h!==null){h.return=p,Re=h;break}Re=p}}}var x=s.alternate;if(x!==null){var m=x.child;if(m!==null){x.child=null;do{var w=m.sibling;m.sibling=null,m=w}while(m!==null)}}Re=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Re=o;else e:for(;Re!==null;){if(s=Re,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ko(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,Re=g;break e}Re=s.return}}var y=e.current;for(Re=y;Re!==null;){o=Re;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,Re=v;else e:for(o=y;Re!==null;){if(l=Re,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:su(9,l)}}catch(_){Ft(l,l.return,_)}if(l===o){Re=null;break e}var k=l.sibling;if(k!==null){k.return=l.return,Re=k;break e}Re=l.return}}if(st=n,Ns(),sn&&typeof sn.onPostCommitFiberRoot=="function")try{sn.onPostCommitFiberRoot(Y0,e)}catch{}a=!0}return a}finally{ut=r,ya.transition=t}}return!1}function zx(e,t,r){t=io(r,t),t=Ov(e,t,1),e=us(e,t,1),t=Rr(),e!==null&&(Zl(e,1,t),Xr(e,t))}function Ft(e,t,r){if(e.tag===3)zx(e,e,r);else for(;t!==null;){if(t.tag===3){zx(t,e,r);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(ds===null||!ds.has(a))){e=io(r,e),e=Rv(t,e,1),t=us(t,e,1),e=Rr(),t!==null&&(Zl(t,1,e),Xr(t,e));break}}t=t.return}}function i4(e,t,r){var a=e.pingCache;a!==null&&a.delete(t),t=Rr(),e.pingedLanes|=e.suspendedLanes&r,ar===e&&(cr&r)===r&&(qt===4||qt===3&&(cr&130023424)===cr&&500>It()-Lh?qs(e,0):Ih|=r),Xr(e,t)}function ty(e,t){t===0&&(e.mode&1?(t=yc,yc<<=1,!(yc&130023424)&&(yc=4194304)):t=1);var r=Rr();e=Pn(e,t),e!==null&&(Zl(e,t,r),Xr(e,r))}function o4(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),ty(e,r)}function l4(e,t){var r=0;switch(e.tag){case 13:var a=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(Ne(314))}a!==null&&a.delete(t),ty(e,r)}var ry;ry=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wr.current)Vr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Vr=!1,Qb(e,t,r);Vr=!!(e.flags&131072)}else Vr=!1,bt&&t.flags&1048576&&iv(t,g0,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Yc(e,t),e=t.pendingProps;var n=ro(t,Sr.current);Mi(t,r),n=Ah(null,t,a,e,n,r);var s=Fh();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Gr(a)?(s=!0,x0(t)):s=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,Nh(t),n.updater=nu,t.stateNode=n,n._reactInternals=t,Jd(t,a,e,r),t=tf(null,t,a,!0,s,r)):(t.tag=0,bt&&s&&vh(t),Fr(null,t,n,r),t=t.child),t;case 16:a=t.elementType;e:{switch(Yc(e,t),e=t.pendingProps,n=a._init,a=n(a._payload),t.type=a,n=t.tag=u4(a),e=Fa(a,e),n){case 0:t=ef(null,t,a,e,r);break e;case 1:t=Fx(null,t,a,e,r);break e;case 11:t=jx(null,t,a,e,r);break e;case 14:t=Ax(null,t,a,Fa(a.type,e),r);break e}throw Error(Ne(306,a,""))}return t;case 0:return a=t.type,n=t.pendingProps,n=t.elementType===a?n:Fa(a,n),ef(e,t,a,n,r);case 1:return a=t.type,n=t.pendingProps,n=t.elementType===a?n:Fa(a,n),Fx(e,t,a,n,r);case 3:e:{if(Bv(t),e===null)throw Error(Ne(387));a=t.pendingProps,s=t.memoizedState,n=s.element,fv(e,t),w0(t,a,null,r);var o=t.memoizedState;if(a=o.element,s.isDehydrated)if(s={element:a,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){n=io(Error(Ne(423)),t),t=Px(e,t,a,r,n);break e}else if(a!==n){n=io(Error(Ne(424)),t),t=Px(e,t,a,r,n);break e}else for(ra=cs(t.stateNode.containerInfo.firstChild),aa=t,bt=!0,Ra=null,r=uv(t,null,a,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ao(),a===n){t=Dn(e,t,r);break e}Fr(e,t,a,r)}t=t.child}return t;case 5:return hv(t),e===null&&Qd(t),a=t.type,n=t.pendingProps,s=e!==null?e.memoizedProps:null,o=n.children,Vd(a,n)?o=null:s!==null&&Vd(a,s)&&(t.flags|=32),Mv(e,t),Fr(e,t,o,r),t.child;case 6:return e===null&&Qd(t),null;case 13:return Uv(e,t,r);case 4:return Ch(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=no(t,null,a,r):Fr(e,t,a,r),t.child;case 11:return a=t.type,n=t.pendingProps,n=t.elementType===a?n:Fa(a,n),jx(e,t,a,n,r);case 7:return Fr(e,t,t.pendingProps,r),t.child;case 8:return Fr(e,t,t.pendingProps.children,r),t.child;case 12:return Fr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(a=t.type._context,n=t.pendingProps,s=t.memoizedProps,o=n.value,mt(v0,a._currentValue),a._currentValue=o,s!==null)if(Va(s.value,o)){if(s.children===n.children&&!Wr.current){t=Dn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===a){if(s.tag===1){c=_n(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Kd(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Ne(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Kd(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Fr(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,a=t.pendingProps.children,Mi(t,r),n=wa(n),a=a(n),t.flags|=1,Fr(e,t,a,r),t.child;case 14:return a=t.type,n=Fa(a,t.pendingProps),n=Fa(a.type,n),Ax(e,t,a,n,r);case 15:return Iv(e,t,t.type,t.pendingProps,r);case 17:return a=t.type,n=t.pendingProps,n=t.elementType===a?n:Fa(a,n),Yc(e,t),t.tag=1,Gr(a)?(e=!0,x0(t)):e=!1,Mi(t,r),Dv(t,a,n),Jd(t,a,n,r),tf(null,t,a,!0,e,r);case 19:return zv(e,t,r);case 22:return Lv(e,t,r)}throw Error(Ne(156,t.tag))};function ay(e,t){return A1(e,t)}function c4(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function va(e,t,r,a){return new c4(e,t,r,a)}function zh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function u4(e){if(typeof e=="function")return zh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ih)return 11;if(e===oh)return 14}return 2}function hs(e,t){var r=e.alternate;return r===null?(r=va(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function e0(e,t,r,a,n,s){var o=2;if(a=e,typeof e=="function")zh(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case bi:return Qs(r.children,n,s,t);case sh:o=8,n|=8;break;case bd:return e=va(12,r,t,n|2),e.elementType=bd,e.lanes=s,e;case Ed:return e=va(13,r,t,n),e.elementType=Ed,e.lanes=s,e;case Sd:return e=va(19,r,t,n),e.elementType=Sd,e.lanes=s,e;case h1:return ou(r,n,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case d1:o=10;break e;case f1:o=9;break e;case ih:o=11;break e;case oh:o=14;break e;case zn:o=16,a=null;break e}throw Error(Ne(130,e==null?e:typeof e,""))}return t=va(o,r,t,n),t.elementType=e,t.type=a,t.lanes=s,t}function Qs(e,t,r,a){return e=va(7,e,a,t),e.lanes=r,e}function ou(e,t,r,a){return e=va(22,e,a,t),e.elementType=h1,e.lanes=r,e.stateNode={isHidden:!1},e}function Ju(e,t,r){return e=va(6,e,null,t),e.lanes=r,e}function Zu(e,t,r){return t=va(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function d4(e,t,r,a,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Du(0),this.expirationTimes=Du(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Du(0),this.identifierPrefix=a,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function $h(e,t,r,a,n,s,o,l,c){return e=new d4(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=va(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:a,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nh(s),e}function f4(e,t,r){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ki,key:a==null?null:""+a,children:e,containerInfo:t,implementation:r}}function ny(e){if(!e)return ys;e=e._reactInternals;e:{if(ui(e)!==e||e.tag!==1)throw Error(Ne(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Gr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ne(171))}if(e.tag===1){var r=e.type;if(Gr(r))return nv(e,r,t)}return t}function sy(e,t,r,a,n,s,o,l,c){return e=$h(r,a,!0,e,n,s,o,l,c),e.context=ny(null),r=e.current,a=Rr(),n=fs(r),s=_n(a,n),s.callback=t??null,us(r,s,n),e.current.lanes=n,Zl(e,n,a),Xr(e,a),e}function lu(e,t,r,a){var n=t.current,s=Rr(),o=fs(n);return r=ny(r),t.context===null?t.context=r:t.pendingContext=r,t=_n(s,o),t.payload={element:e},a=a===void 0?null:a,a!==null&&(t.callback=a),e=us(n,t,o),e!==null&&(za(e,n,o,s),qc(e,n,o)),o}function T0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function $x(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Hh(e,t){$x(e,t),(e=e.alternate)&&$x(e,t)}function h4(){return null}var iy=typeof reportError=="function"?reportError:function(e){console.error(e)};function Vh(e){this._internalRoot=e}cu.prototype.render=Vh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ne(409));lu(e,t,null,null)};cu.prototype.unmount=Vh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ai(function(){lu(null,e,null,null)}),t[Fn]=null}};function cu(e){this._internalRoot=e}cu.prototype.unstable_scheduleHydration=function(e){if(e){var t=L1();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Hn.length&&t!==0&&t<Hn[r].priority;r++);Hn.splice(r,0,e),r===0&&B1(e)}};function Wh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function uu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Hx(){}function p4(e,t,r,a,n){if(n){if(typeof a=="function"){var s=a;a=function(){var u=T0(o);s.call(u)}}var o=sy(t,a,e,0,null,!1,!1,"",Hx);return e._reactRootContainer=o,e[Fn]=o.current,vl(e.nodeType===8?e.parentNode:e),ai(),o}for(;n=e.lastChild;)e.removeChild(n);if(typeof a=="function"){var l=a;a=function(){var u=T0(c);l.call(u)}}var c=$h(e,0,!1,null,null,!1,!1,"",Hx);return e._reactRootContainer=c,e[Fn]=c.current,vl(e.nodeType===8?e.parentNode:e),ai(function(){lu(t,c,r,a)}),c}function du(e,t,r,a,n){var s=r._reactRootContainer;if(s){var o=s;if(typeof n=="function"){var l=n;n=function(){var c=T0(o);l.call(c)}}lu(t,o,e,n)}else o=p4(r,t,e,n,a);return T0(o)}R1=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Lo(t.pendingLanes);r!==0&&(uh(t,r|1),Xr(t,It()),!(st&6)&&(oo=It()+500,Ns()))}break;case 13:ai(function(){var a=Pn(e,1);if(a!==null){var n=Rr();za(a,e,1,n)}}),Hh(e,1)}};dh=function(e){if(e.tag===13){var t=Pn(e,134217728);if(t!==null){var r=Rr();za(t,e,134217728,r)}Hh(e,134217728)}};I1=function(e){if(e.tag===13){var t=fs(e),r=Pn(e,t);if(r!==null){var a=Rr();za(r,e,t,a)}Hh(e,t)}};L1=function(){return ut};M1=function(e,t){var r=ut;try{return ut=e,t()}finally{ut=r}};Od=function(e,t,r){switch(t){case"input":if(_d(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var n=tu(a);if(!n)throw Error(Ne(90));x1(a),_d(a,n)}}}break;case"textarea":g1(e,r);break;case"select":t=r.value,t!=null&&Oi(e,!!r.multiple,t,!1)}};S1=Mh;N1=ai;var x4={usingClientEntryPoint:!1,Events:[tc,Ci,tu,b1,E1,Mh]},Po={findFiberByHostInstance:Ps,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},m4={bundleType:Po.bundleType,version:Po.version,rendererPackageName:Po.rendererPackageName,rendererConfig:Po.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Rn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=T1(e),e===null?null:e.stateNode},findFiberByHostInstance:Po.findFiberByHostInstance||h4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ac=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ac.isDisabled&&Ac.supportsFiber)try{Y0=Ac.inject(m4),sn=Ac}catch{}}ia.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x4;ia.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wh(t))throw Error(Ne(200));return f4(e,t,null,r)};ia.createRoot=function(e,t){if(!Wh(e))throw Error(Ne(299));var r=!1,a="",n=iy;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=$h(e,1,!1,null,null,r,!1,a,n),e[Fn]=t.current,vl(e.nodeType===8?e.parentNode:e),new Vh(t)};ia.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ne(188)):(e=Object.keys(e).join(","),Error(Ne(268,e)));return e=T1(t),e=e===null?null:e.stateNode,e};ia.flushSync=function(e){return ai(e)};ia.hydrate=function(e,t,r){if(!uu(t))throw Error(Ne(200));return du(null,e,t,!0,r)};ia.hydrateRoot=function(e,t,r){if(!Wh(e))throw Error(Ne(405));var a=r!=null&&r.hydratedSources||null,n=!1,s="",o=iy;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=sy(t,null,e,1,r??null,n,!1,s,o),e[Fn]=t.current,vl(e),a)for(e=0;e<a.length;e++)r=a[e],n=r._getVersion,n=n(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new cu(t)};ia.render=function(e,t,r){if(!uu(t))throw Error(Ne(200));return du(null,e,t,!1,r)};ia.unmountComponentAtNode=function(e){if(!uu(e))throw Error(Ne(40));return e._reactRootContainer?(ai(function(){du(null,null,e,!1,function(){e._reactRootContainer=null,e[Fn]=null})}),!0):!1};ia.unstable_batchedUpdates=Mh;ia.unstable_renderSubtreeIntoContainer=function(e,t,r,a){if(!uu(r))throw Error(Ne(200));if(e==null||e._reactInternals===void 0)throw Error(Ne(38));return du(e,t,r,!1,a)};ia.version="18.3.1-next-f1338f8080-20240426";function oy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(oy)}catch(e){console.error(e)}}oy(),o1.exports=ia;var g4=o1.exports,Vx=g4;wd.createRoot=Vx.createRoot,wd.hydrateRoot=Vx.hydrateRoot;var ac=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},v4={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Xn,Yf,Bg,y4=(Bg=class{constructor(){Le(this,Xn,v4);Le(this,Yf,!1)}setTimeoutProvider(e){Oe(this,Xn,e)}setTimeout(e,t){return G(this,Xn).setTimeout(e,t)}clearTimeout(e){G(this,Xn).clearTimeout(e)}setInterval(e,t){return G(this,Xn).setInterval(e,t)}clearInterval(e){G(this,Xn).clearInterval(e)}},Xn=new WeakMap,Yf=new WeakMap,Bg),Rs=new y4;function w4(e){setTimeout(e,0)}var ni=typeof window>"u"||"Deno"in globalThis;function $r(){}function k4(e,t){return typeof e=="function"?e(t):e}function pf(e){return typeof e=="number"&&e>=0&&e!==1/0}function ly(e,t){return Math.max(e+(t||0)-Date.now(),0)}function ps(e,t){return typeof e=="function"?e(t):e}function xa(e,t){return typeof e=="function"?e(t):e}function Wx(e,t){const{type:r="all",exact:a,fetchStatus:n,predicate:s,queryKey:o,stale:l}=e;if(o){if(a){if(t.queryHash!==Gh(o,t.options))return!1}else if(!Tl(t.queryKey,o))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||n&&n!==t.state.fetchStatus||s&&!s(t))}function Gx(e,t){const{exact:r,status:a,predicate:n,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(r){if(_l(t.options.mutationKey)!==_l(s))return!1}else if(!Tl(t.options.mutationKey,s))return!1}return!(a&&t.state.status!==a||n&&!n(t))}function Gh(e,t){return((t==null?void 0:t.queryKeyHashFn)||_l)(e)}function _l(e){return JSON.stringify(e,(t,r)=>mf(r)?Object.keys(r).sort().reduce((a,n)=>(a[n]=r[n],a),{}):r)}function Tl(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Tl(e[r],t[r])):!1}var b4=Object.prototype.hasOwnProperty;function cy(e,t){if(e===t)return e;const r=Xx(e)&&Xx(t);if(!r&&!(mf(e)&&mf(t)))return t;const n=(r?e:Object.keys(e)).length,s=r?t:Object.keys(t),o=s.length,l=r?new Array(o):{};let c=0;for(let u=0;u<o;u++){const d=r?u:s[u],f=e[d],h=t[d];if(f===h){l[d]=f,(r?u<n:b4.call(e,d))&&c++;continue}if(f===null||h===null||typeof f!="object"||typeof h!="object"){l[d]=h;continue}const p=cy(f,h);l[d]=p,p===f&&c++}return n===o&&c===n?e:l}function xf(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function Xx(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function mf(e){if(!qx(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!qx(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function qx(e){return Object.prototype.toString.call(e)==="[object Object]"}function E4(e){return new Promise(t=>{Rs.setTimeout(t,e)})}function gf(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?cy(e,t):t}function S4(e,t,r=0){const a=[...e,t];return r&&a.length>r?a.slice(1):a}function N4(e,t,r=0){const a=[t,...e];return r&&a.length>r?a.slice(0,-1):a}var Xh=Symbol();function uy(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Xh?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function C4(e,t){return typeof e=="function"?e(...t):!!e}var Ms,qn,Hi,Ug,_4=(Ug=class extends ac{constructor(){super();Le(this,Ms,void 0);Le(this,qn,void 0);Le(this,Hi,void 0);Oe(this,Hi,t=>{if(!ni&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){G(this,qn)||this.setEventListener(G(this,Hi))}onUnsubscribe(){var t;this.hasListeners()||((t=G(this,qn))==null||t.call(this),Oe(this,qn,void 0))}setEventListener(t){var r;Oe(this,Hi,t),(r=G(this,qn))==null||r.call(this),Oe(this,qn,t(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(t){G(this,Ms)!==t&&(Oe(this,Ms,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof G(this,Ms)=="boolean"?G(this,Ms):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Ms=new WeakMap,qn=new WeakMap,Hi=new WeakMap,Ug),qh=new _4;function vf(){let e,t;const r=new Promise((n,s)=>{e=n,t=s});r.status="pending",r.catch(()=>{});function a(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{a({status:"fulfilled",value:n}),e(n)},r.reject=n=>{a({status:"rejected",reason:n}),t(n)},r}var T4=w4;function j4(){let e=[],t=0,r=l=>{l()},a=l=>{l()},n=T4;const s=l=>{t?e.push(l):n(()=>{r(l)})},o=()=>{const l=e;e=[],l.length&&n(()=>{a(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{s(()=>{l(...c)})},schedule:s,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{a=l},setScheduler:l=>{n=l}}}var lr=j4(),Vi,Qn,Wi,zg,A4=(zg=class extends ac{constructor(){super();Le(this,Vi,!0);Le(this,Qn,void 0);Le(this,Wi,void 0);Oe(this,Wi,t=>{if(!ni&&window.addEventListener){const r=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",a)}}})}onSubscribe(){G(this,Qn)||this.setEventListener(G(this,Wi))}onUnsubscribe(){var t;this.hasListeners()||((t=G(this,Qn))==null||t.call(this),Oe(this,Qn,void 0))}setEventListener(t){var r;Oe(this,Wi,t),(r=G(this,Qn))==null||r.call(this),Oe(this,Qn,t(this.setOnline.bind(this)))}setOnline(t){G(this,Vi)!==t&&(Oe(this,Vi,t),this.listeners.forEach(a=>{a(t)}))}isOnline(){return G(this,Vi)}},Vi=new WeakMap,Qn=new WeakMap,Wi=new WeakMap,zg),j0=new A4;function F4(e){return Math.min(1e3*2**e,3e4)}function dy(e){return(e??"online")==="online"?j0.isOnline():!0}var yf=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function fy(e){let t=!1,r=0,a;const n=vf(),s=()=>n.status!=="pending",o=m=>{var w;if(!s()){const g=new yf(m);h(g),(w=e.onCancel)==null||w.call(e,g)}},l=()=>{t=!0},c=()=>{t=!1},u=()=>qh.isFocused()&&(e.networkMode==="always"||j0.isOnline())&&e.canRun(),d=()=>dy(e.networkMode)&&e.canRun(),f=m=>{s()||(a==null||a(),n.resolve(m))},h=m=>{s()||(a==null||a(),n.reject(m))},p=()=>new Promise(m=>{var w;a=g=>{(s()||u())&&m(g)},(w=e.onPause)==null||w.call(e)}).then(()=>{var m;a=void 0,s()||(m=e.onContinue)==null||m.call(e)}),x=()=>{if(s())return;let m;const w=r===0?e.initialPromise:void 0;try{m=w??e.fn()}catch(g){m=Promise.reject(g)}Promise.resolve(m).then(f).catch(g=>{var F;if(s())return;const y=e.retry??(ni?0:3),v=e.retryDelay??F4,k=typeof v=="function"?v(r,g):v,_=y===!0||typeof y=="number"&&r<y||typeof y=="function"&&y(r,g);if(t||!_){h(g);return}r++,(F=e.onFail)==null||F.call(e,r,g),E4(k).then(()=>u()?void 0:p()).then(()=>{t?h(g):x()})})};return{promise:n,status:()=>n.status,cancel:o,continue:()=>(a==null||a(),n),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?x():p().then(x),n)}}var Bs,$g,hy=($g=class{constructor(){Le(this,Bs,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),pf(this.gcTime)&&Oe(this,Bs,Rs.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(ni?1/0:5*60*1e3))}clearGcTimeout(){G(this,Bs)&&(Rs.clearTimeout(G(this,Bs)),Oe(this,Bs,void 0))}},Bs=new WeakMap,$g),Us,Gi,pa,zs,Zt,Ul,$s,Pa,yn,Hg,P4=(Hg=class extends hy{constructor(t){super();Le(this,Pa);Le(this,Us,void 0);Le(this,Gi,void 0);Le(this,pa,void 0);Le(this,zs,void 0);Le(this,Zt,void 0);Le(this,Ul,void 0);Le(this,$s,void 0);Oe(this,$s,!1),Oe(this,Ul,t.defaultOptions),this.setOptions(t.options),this.observers=[],Oe(this,zs,t.client),Oe(this,pa,G(this,zs).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Oe(this,Us,Kx(this.options)),this.state=t.state??G(this,Us),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=G(this,Zt))==null?void 0:t.promise}setOptions(t){if(this.options={...G(this,Ul),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=Kx(this.options);r.data!==void 0&&(this.setState(Qx(r.data,r.dataUpdatedAt)),Oe(this,Us,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&G(this,pa).remove(this)}setData(t,r){const a=gf(this.state.data,t,this.options);return et(this,Pa,yn).call(this,{data:a,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),a}setState(t,r){et(this,Pa,yn).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var a,n;const r=(a=G(this,Zt))==null?void 0:a.promise;return(n=G(this,Zt))==null||n.cancel(t),r?r.then($r).catch($r):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(G(this,Us))}isActive(){return this.observers.some(t=>xa(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Xh||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ps(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!ly(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(a=>a.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=G(this,Zt))==null||r.continue()}onOnline(){var r;const t=this.observers.find(a=>a.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=G(this,Zt))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),G(this,pa).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(G(this,Zt)&&(G(this,$s)?G(this,Zt).cancel({revert:!0}):G(this,Zt).cancelRetry()),this.scheduleGc()),G(this,pa).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||et(this,Pa,yn).call(this,{type:"invalidate"})}async fetch(t,r){var c,u,d,f,h,p,x,m,w,g,y,v;if(this.state.fetchStatus!=="idle"&&((c=G(this,Zt))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(G(this,Zt))return G(this,Zt).continueRetry(),G(this,Zt).promise}if(t&&this.setOptions(t),!this.options.queryFn){const k=this.observers.find(_=>_.options.queryFn);k&&this.setOptions(k.options)}const a=new AbortController,n=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(Oe(this,$s,!0),a.signal)})},s=()=>{const k=uy(this.options,r),F=(()=>{const b={client:G(this,zs),queryKey:this.queryKey,meta:this.meta};return n(b),b})();return Oe(this,$s,!1),this.options.persister?this.options.persister(k,F,this):k(F)},l=(()=>{const k={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:G(this,zs),state:this.state,fetchFn:s};return n(k),k})();(u=this.options.behavior)==null||u.onFetch(l,this),Oe(this,Gi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=l.fetchOptions)==null?void 0:d.meta))&&et(this,Pa,yn).call(this,{type:"fetch",meta:(f=l.fetchOptions)==null?void 0:f.meta}),Oe(this,Zt,fy({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,onCancel:k=>{k instanceof yf&&k.revert&&this.setState({...G(this,Gi),fetchStatus:"idle"}),a.abort()},onFail:(k,_)=>{et(this,Pa,yn).call(this,{type:"failed",failureCount:k,error:_})},onPause:()=>{et(this,Pa,yn).call(this,{type:"pause"})},onContinue:()=>{et(this,Pa,yn).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const k=await G(this,Zt).start();if(k===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(k),(p=(h=G(this,pa).config).onSuccess)==null||p.call(h,k,this),(m=(x=G(this,pa).config).onSettled)==null||m.call(x,k,this.state.error,this),k}catch(k){if(k instanceof yf){if(k.silent)return G(this,Zt).promise;if(k.revert){if(this.state.data===void 0)throw k;return this.state.data}}throw et(this,Pa,yn).call(this,{type:"error",error:k}),(g=(w=G(this,pa).config).onError)==null||g.call(w,k,this),(v=(y=G(this,pa).config).onSettled)==null||v.call(y,this.state.data,k,this),k}finally{this.scheduleGc()}}},Us=new WeakMap,Gi=new WeakMap,pa=new WeakMap,zs=new WeakMap,Zt=new WeakMap,Ul=new WeakMap,$s=new WeakMap,Pa=new WeakSet,yn=function(t){const r=a=>{switch(t.type){case"failed":return{...a,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...py(a.data,this.options),fetchMeta:t.meta??null};case"success":const n={...a,...Qx(t.data,t.dataUpdatedAt),dataUpdateCount:a.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Oe(this,Gi,t.manual?n:void 0),n;case"error":const s=t.error;return{...a,error:s,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...t.state}}};this.state=r(this.state),lr.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),G(this,pa).notify({query:this,type:"updated",action:t})})},Hg);function py(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:dy(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Qx(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Kx(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,a=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Ur,tt,zl,jr,Hs,Xi,bn,Kn,$l,qi,Qi,Vs,Ws,Yn,Ki,Gs,Bo,Hl,wf,Vl,kf,Wl,bf,Gl,Ef,Xl,Sf,ql,Nf,Ql,Cf,Q0,xy,Vg,D4=(Vg=class extends ac{constructor(t,r){super();Le(this,Gs);Le(this,Hl);Le(this,Vl);Le(this,Wl);Le(this,Gl);Le(this,Xl);Le(this,ql);Le(this,Ql);Le(this,Q0);Le(this,Ur,void 0);Le(this,tt,void 0);Le(this,zl,void 0);Le(this,jr,void 0);Le(this,Hs,void 0);Le(this,Xi,void 0);Le(this,bn,void 0);Le(this,Kn,void 0);Le(this,$l,void 0);Le(this,qi,void 0);Le(this,Qi,void 0);Le(this,Vs,void 0);Le(this,Ws,void 0);Le(this,Yn,void 0);Le(this,Ki,new Set);this.options=r,Oe(this,Ur,t),Oe(this,Kn,null),Oe(this,bn,vf()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(G(this,tt).addObserver(this),Yx(G(this,tt),this.options)?et(this,Gs,Bo).call(this):this.updateResult(),et(this,Gl,Ef).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return _f(G(this,tt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return _f(G(this,tt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,et(this,Xl,Sf).call(this),et(this,ql,Nf).call(this),G(this,tt).removeObserver(this)}setOptions(t){const r=this.options,a=G(this,tt);if(this.options=G(this,Ur).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof xa(this.options.enabled,G(this,tt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");et(this,Ql,Cf).call(this),G(this,tt).setOptions(this.options),r._defaulted&&!xf(this.options,r)&&G(this,Ur).getQueryCache().notify({type:"observerOptionsUpdated",query:G(this,tt),observer:this});const n=this.hasListeners();n&&Jx(G(this,tt),a,this.options,r)&&et(this,Gs,Bo).call(this),this.updateResult(),n&&(G(this,tt)!==a||xa(this.options.enabled,G(this,tt))!==xa(r.enabled,G(this,tt))||ps(this.options.staleTime,G(this,tt))!==ps(r.staleTime,G(this,tt)))&&et(this,Hl,wf).call(this);const s=et(this,Vl,kf).call(this);n&&(G(this,tt)!==a||xa(this.options.enabled,G(this,tt))!==xa(r.enabled,G(this,tt))||s!==G(this,Yn))&&et(this,Wl,bf).call(this,s)}getOptimisticResult(t){const r=G(this,Ur).getQueryCache().build(G(this,Ur),t),a=this.createResult(r,t);return R4(this,a)&&(Oe(this,jr,a),Oe(this,Xi,this.options),Oe(this,Hs,G(this,tt).state)),a}getCurrentResult(){return G(this,jr)}trackResult(t,r){return new Proxy(t,{get:(a,n)=>(this.trackProp(n),r==null||r(n),n==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&G(this,bn).status==="pending"&&G(this,bn).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(a,n))})}trackProp(t){G(this,Ki).add(t)}getCurrentQuery(){return G(this,tt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=G(this,Ur).defaultQueryOptions(t),a=G(this,Ur).getQueryCache().build(G(this,Ur),r);return a.fetch().then(()=>this.createResult(a,r))}fetch(t){return et(this,Gs,Bo).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),G(this,jr)))}createResult(t,r){var C;const a=G(this,tt),n=this.options,s=G(this,jr),o=G(this,Hs),l=G(this,Xi),u=t!==a?t.state:G(this,zl),{state:d}=t;let f={...d},h=!1,p;if(r._optimisticResults){const B=this.hasListeners(),T=!B&&Yx(t,r),U=B&&Jx(t,a,r,n);(T||U)&&(f={...f,...py(d.data,t.options)}),r._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:x,errorUpdatedAt:m,status:w}=f;p=f.data;let g=!1;if(r.placeholderData!==void 0&&p===void 0&&w==="pending"){let B;s!=null&&s.isPlaceholderData&&r.placeholderData===(l==null?void 0:l.placeholderData)?(B=s.data,g=!0):B=typeof r.placeholderData=="function"?r.placeholderData((C=G(this,Qi))==null?void 0:C.state.data,G(this,Qi)):r.placeholderData,B!==void 0&&(w="success",p=gf(s==null?void 0:s.data,B,r),h=!0)}if(r.select&&p!==void 0&&!g)if(s&&p===(o==null?void 0:o.data)&&r.select===G(this,$l))p=G(this,qi);else try{Oe(this,$l,r.select),p=r.select(p),p=gf(s==null?void 0:s.data,p,r),Oe(this,qi,p),Oe(this,Kn,null)}catch(B){Oe(this,Kn,B)}G(this,Kn)&&(x=G(this,Kn),p=G(this,qi),m=Date.now(),w="error");const y=f.fetchStatus==="fetching",v=w==="pending",k=w==="error",_=v&&y,F=p!==void 0,S={status:w,fetchStatus:f.fetchStatus,isPending:v,isSuccess:w==="success",isError:k,isInitialLoading:_,isLoading:_,data:p,dataUpdatedAt:f.dataUpdatedAt,error:x,errorUpdatedAt:m,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>u.dataUpdateCount||f.errorUpdateCount>u.errorUpdateCount,isFetching:y,isRefetching:y&&!v,isLoadingError:k&&!F,isPaused:f.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:k&&F,isStale:Qh(t,r),refetch:this.refetch,promise:G(this,bn),isEnabled:xa(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const B=K=>{S.status==="error"?K.reject(S.error):S.data!==void 0&&K.resolve(S.data)},T=()=>{const K=Oe(this,bn,S.promise=vf());B(K)},U=G(this,bn);switch(U.status){case"pending":t.queryHash===a.queryHash&&B(U);break;case"fulfilled":(S.status==="error"||S.data!==U.value)&&T();break;case"rejected":(S.status!=="error"||S.error!==U.reason)&&T();break}}return S}updateResult(){const t=G(this,jr),r=this.createResult(G(this,tt),this.options);if(Oe(this,Hs,G(this,tt).state),Oe(this,Xi,this.options),G(this,Hs).data!==void 0&&Oe(this,Qi,G(this,tt)),xf(r,t))return;Oe(this,jr,r);const a=()=>{if(!t)return!0;const{notifyOnChangeProps:n}=this.options,s=typeof n=="function"?n():n;if(s==="all"||!s&&!G(this,Ki).size)return!0;const o=new Set(s??G(this,Ki));return this.options.throwOnError&&o.add("error"),Object.keys(G(this,jr)).some(l=>{const c=l;return G(this,jr)[c]!==t[c]&&o.has(c)})};et(this,Q0,xy).call(this,{listeners:a()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&et(this,Gl,Ef).call(this)}},Ur=new WeakMap,tt=new WeakMap,zl=new WeakMap,jr=new WeakMap,Hs=new WeakMap,Xi=new WeakMap,bn=new WeakMap,Kn=new WeakMap,$l=new WeakMap,qi=new WeakMap,Qi=new WeakMap,Vs=new WeakMap,Ws=new WeakMap,Yn=new WeakMap,Ki=new WeakMap,Gs=new WeakSet,Bo=function(t){et(this,Ql,Cf).call(this);let r=G(this,tt).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch($r)),r},Hl=new WeakSet,wf=function(){et(this,Xl,Sf).call(this);const t=ps(this.options.staleTime,G(this,tt));if(ni||G(this,jr).isStale||!pf(t))return;const a=ly(G(this,jr).dataUpdatedAt,t)+1;Oe(this,Vs,Rs.setTimeout(()=>{G(this,jr).isStale||this.updateResult()},a))},Vl=new WeakSet,kf=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(G(this,tt)):this.options.refetchInterval)??!1},Wl=new WeakSet,bf=function(t){et(this,ql,Nf).call(this),Oe(this,Yn,t),!(ni||xa(this.options.enabled,G(this,tt))===!1||!pf(G(this,Yn))||G(this,Yn)===0)&&Oe(this,Ws,Rs.setInterval(()=>{(this.options.refetchIntervalInBackground||qh.isFocused())&&et(this,Gs,Bo).call(this)},G(this,Yn)))},Gl=new WeakSet,Ef=function(){et(this,Hl,wf).call(this),et(this,Wl,bf).call(this,et(this,Vl,kf).call(this))},Xl=new WeakSet,Sf=function(){G(this,Vs)&&(Rs.clearTimeout(G(this,Vs)),Oe(this,Vs,void 0))},ql=new WeakSet,Nf=function(){G(this,Ws)&&(Rs.clearInterval(G(this,Ws)),Oe(this,Ws,void 0))},Ql=new WeakSet,Cf=function(){const t=G(this,Ur).getQueryCache().build(G(this,Ur),this.options);if(t===G(this,tt))return;const r=G(this,tt);Oe(this,tt,t),Oe(this,zl,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},Q0=new WeakSet,xy=function(t){lr.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(G(this,jr))}),G(this,Ur).getQueryCache().notify({query:G(this,tt),type:"observerResultsUpdated"})})},Vg);function O4(e,t){return xa(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Yx(e,t){return O4(e,t)||e.state.data!==void 0&&_f(e,t,t.refetchOnMount)}function _f(e,t,r){if(xa(t.enabled,e)!==!1&&ps(t.staleTime,e)!=="static"){const a=typeof r=="function"?r(e):r;return a==="always"||a!==!1&&Qh(e,t)}return!1}function Jx(e,t,r,a){return(e!==t||xa(a.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&Qh(e,r)}function Qh(e,t){return xa(t.enabled,e)!==!1&&e.isStaleByTime(ps(t.staleTime,e))}function R4(e,t){return!xf(e.getCurrentResult(),t)}function Zx(e){return{onFetch:(t,r)=>{var d,f,h,p,x;const a=t.options,n=(h=(f=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:f.fetchMore)==null?void 0:h.direction,s=((p=t.state.data)==null?void 0:p.pages)||[],o=((x=t.state.data)==null?void 0:x.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let m=!1;const w=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(t.signal.aborted?m=!0:t.signal.addEventListener("abort",()=>{m=!0}),t.signal)})},g=uy(t.options,t.fetchOptions),y=async(v,k,_)=>{if(m)return Promise.reject();if(k==null&&v.pages.length)return Promise.resolve(v);const b=(()=>{const T={client:t.client,queryKey:t.queryKey,pageParam:k,direction:_?"backward":"forward",meta:t.options.meta};return w(T),T})(),S=await g(b),{maxPages:C}=t.options,B=_?N4:S4;return{pages:B(v.pages,S,C),pageParams:B(v.pageParams,k,C)}};if(n&&s.length){const v=n==="backward",k=v?I4:em,_={pages:s,pageParams:o},F=k(a,_);l=await y(_,F,v)}else{const v=e??s.length;do{const k=c===0?o[0]??a.initialPageParam:em(a,l);if(c>0&&k==null)break;l=await y(l,k),c++}while(c<v)}return l};t.options.persister?t.fetchFn=()=>{var m,w;return(w=(m=t.options).persister)==null?void 0:w.call(m,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function em(e,{pages:t,pageParams:r}){const a=t.length-1;return t.length>0?e.getNextPageParam(t[a],t,r[a],r):void 0}function I4(e,{pages:t,pageParams:r}){var a;return t.length>0?(a=e.getPreviousPageParam)==null?void 0:a.call(e,t[0],t,r[0],r):void 0}var Kl,tn,Ar,Xs,rn,Un,Wg,L4=(Wg=class extends hy{constructor(t){super();Le(this,rn);Le(this,Kl,void 0);Le(this,tn,void 0);Le(this,Ar,void 0);Le(this,Xs,void 0);Oe(this,Kl,t.client),this.mutationId=t.mutationId,Oe(this,Ar,t.mutationCache),Oe(this,tn,[]),this.state=t.state||M4(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){G(this,tn).includes(t)||(G(this,tn).push(t),this.clearGcTimeout(),G(this,Ar).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Oe(this,tn,G(this,tn).filter(r=>r!==t)),this.scheduleGc(),G(this,Ar).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){G(this,tn).length||(this.state.status==="pending"?this.scheduleGc():G(this,Ar).remove(this))}continue(){var t;return((t=G(this,Xs))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,c,u,d,f,h,p,x,m,w,g,y,v,k,_,F,b,S,C;const r=()=>{et(this,rn,Un).call(this,{type:"continue"})},a={client:G(this,Kl),meta:this.options.meta,mutationKey:this.options.mutationKey};Oe(this,Xs,fy({fn:()=>this.options.mutationFn?this.options.mutationFn(t,a):Promise.reject(new Error("No mutationFn found")),onFail:(B,T)=>{et(this,rn,Un).call(this,{type:"failed",failureCount:B,error:T})},onPause:()=>{et(this,rn,Un).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>G(this,Ar).canRun(this)}));const n=this.state.status==="pending",s=!G(this,Xs).canStart();try{if(n)r();else{et(this,rn,Un).call(this,{type:"pending",variables:t,isPaused:s}),await((l=(o=G(this,Ar).config).onMutate)==null?void 0:l.call(o,t,this,a));const T=await((u=(c=this.options).onMutate)==null?void 0:u.call(c,t,a));T!==this.state.context&&et(this,rn,Un).call(this,{type:"pending",context:T,variables:t,isPaused:s})}const B=await G(this,Xs).start();return await((f=(d=G(this,Ar).config).onSuccess)==null?void 0:f.call(d,B,t,this.state.context,this,a)),await((p=(h=this.options).onSuccess)==null?void 0:p.call(h,B,t,this.state.context,a)),await((m=(x=G(this,Ar).config).onSettled)==null?void 0:m.call(x,B,null,this.state.variables,this.state.context,this,a)),await((g=(w=this.options).onSettled)==null?void 0:g.call(w,B,null,t,this.state.context,a)),et(this,rn,Un).call(this,{type:"success",data:B}),B}catch(B){try{throw await((v=(y=G(this,Ar).config).onError)==null?void 0:v.call(y,B,t,this.state.context,this,a)),await((_=(k=this.options).onError)==null?void 0:_.call(k,B,t,this.state.context,a)),await((b=(F=G(this,Ar).config).onSettled)==null?void 0:b.call(F,void 0,B,this.state.variables,this.state.context,this,a)),await((C=(S=this.options).onSettled)==null?void 0:C.call(S,void 0,B,t,this.state.context,a)),B}finally{et(this,rn,Un).call(this,{type:"error",error:B})}}finally{G(this,Ar).runNext(this)}}},Kl=new WeakMap,tn=new WeakMap,Ar=new WeakMap,Xs=new WeakMap,rn=new WeakSet,Un=function(t){const r=a=>{switch(t.type){case"failed":return{...a,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...a,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:t.error,failureCount:a.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),lr.batch(()=>{G(this,tn).forEach(a=>{a.onMutationUpdate(t)}),G(this,Ar).notify({mutation:this,type:"updated",action:t})})},Wg);function M4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var En,Da,Yl,Gg,B4=(Gg=class extends ac{constructor(t={}){super();Le(this,En,void 0);Le(this,Da,void 0);Le(this,Yl,void 0);this.config=t,Oe(this,En,new Set),Oe(this,Da,new Map),Oe(this,Yl,0)}build(t,r,a){const n=new L4({client:t,mutationCache:this,mutationId:++hc(this,Yl)._,options:t.defaultMutationOptions(r),state:a});return this.add(n),n}add(t){G(this,En).add(t);const r=Fc(t);if(typeof r=="string"){const a=G(this,Da).get(r);a?a.push(t):G(this,Da).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(G(this,En).delete(t)){const r=Fc(t);if(typeof r=="string"){const a=G(this,Da).get(r);if(a)if(a.length>1){const n=a.indexOf(t);n!==-1&&a.splice(n,1)}else a[0]===t&&G(this,Da).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Fc(t);if(typeof r=="string"){const a=G(this,Da).get(r),n=a==null?void 0:a.find(s=>s.state.status==="pending");return!n||n===t}else return!0}runNext(t){var a;const r=Fc(t);if(typeof r=="string"){const n=(a=G(this,Da).get(r))==null?void 0:a.find(s=>s!==t&&s.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){lr.batch(()=>{G(this,En).forEach(t=>{this.notify({type:"removed",mutation:t})}),G(this,En).clear(),G(this,Da).clear()})}getAll(){return Array.from(G(this,En))}find(t){const r={exact:!0,...t};return this.getAll().find(a=>Gx(r,a))}findAll(t={}){return this.getAll().filter(r=>Gx(t,r))}notify(t){lr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return lr.batch(()=>Promise.all(t.map(r=>r.continue().catch($r))))}},En=new WeakMap,Da=new WeakMap,Yl=new WeakMap,Gg);function Fc(e){var t;return(t=e.options.scope)==null?void 0:t.id}var an,Xg,U4=(Xg=class extends ac{constructor(t={}){super();Le(this,an,void 0);this.config=t,Oe(this,an,new Map)}build(t,r,a){const n=r.queryKey,s=r.queryHash??Gh(n,r);let o=this.get(s);return o||(o=new P4({client:t,queryKey:n,queryHash:s,options:t.defaultQueryOptions(r),state:a,defaultOptions:t.getQueryDefaults(n)}),this.add(o)),o}add(t){G(this,an).has(t.queryHash)||(G(this,an).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=G(this,an).get(t.queryHash);r&&(t.destroy(),r===t&&G(this,an).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){lr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return G(this,an).get(t)}getAll(){return[...G(this,an).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(a=>Wx(r,a))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(a=>Wx(t,a)):r}notify(t){lr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){lr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){lr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},an=new WeakMap,Xg),At,Jn,Zn,Yi,Ji,es,Zi,eo,qg,z4=(qg=class{constructor(e={}){Le(this,At,void 0);Le(this,Jn,void 0);Le(this,Zn,void 0);Le(this,Yi,void 0);Le(this,Ji,void 0);Le(this,es,void 0);Le(this,Zi,void 0);Le(this,eo,void 0);Oe(this,At,e.queryCache||new U4),Oe(this,Jn,e.mutationCache||new B4),Oe(this,Zn,e.defaultOptions||{}),Oe(this,Yi,new Map),Oe(this,Ji,new Map),Oe(this,es,0)}mount(){hc(this,es)._++,G(this,es)===1&&(Oe(this,Zi,qh.subscribe(async e=>{e&&(await this.resumePausedMutations(),G(this,At).onFocus())})),Oe(this,eo,j0.subscribe(async e=>{e&&(await this.resumePausedMutations(),G(this,At).onOnline())})))}unmount(){var e,t;hc(this,es)._--,G(this,es)===0&&((e=G(this,Zi))==null||e.call(this),Oe(this,Zi,void 0),(t=G(this,eo))==null||t.call(this),Oe(this,eo,void 0))}isFetching(e){return G(this,At).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return G(this,Jn).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=G(this,At).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=G(this,At).build(this,t),a=r.state.data;return a===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(ps(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(a))}getQueriesData(e){return G(this,At).findAll(e).map(({queryKey:t,state:r})=>{const a=r.data;return[t,a]})}setQueryData(e,t,r){const a=this.defaultQueryOptions({queryKey:e}),n=G(this,At).get(a.queryHash),s=n==null?void 0:n.state.data,o=k4(t,s);if(o!==void 0)return G(this,At).build(this,a).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return lr.batch(()=>G(this,At).findAll(e).map(({queryKey:a})=>[a,this.setQueryData(a,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=G(this,At).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=G(this,At);lr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=G(this,At);return lr.batch(()=>(r.findAll(e).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},a=lr.batch(()=>G(this,At).findAll(e).map(n=>n.cancel(r)));return Promise.all(a).then($r).catch($r)}invalidateQueries(e,t={}){return lr.batch(()=>(G(this,At).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},a=lr.batch(()=>G(this,At).findAll(e).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let s=n.fetch(void 0,r);return r.throwOnError||(s=s.catch($r)),n.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(a).then($r)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=G(this,At).build(this,t);return r.isStaleByTime(ps(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then($r).catch($r)}fetchInfiniteQuery(e){return e.behavior=Zx(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then($r).catch($r)}ensureInfiniteQueryData(e){return e.behavior=Zx(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return j0.isOnline()?G(this,Jn).resumePausedMutations():Promise.resolve()}getQueryCache(){return G(this,At)}getMutationCache(){return G(this,Jn)}getDefaultOptions(){return G(this,Zn)}setDefaultOptions(e){Oe(this,Zn,e)}setQueryDefaults(e,t){G(this,Yi).set(_l(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...G(this,Yi).values()],r={};return t.forEach(a=>{Tl(e,a.queryKey)&&Object.assign(r,a.defaultOptions)}),r}setMutationDefaults(e,t){G(this,Ji).set(_l(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...G(this,Ji).values()],r={};return t.forEach(a=>{Tl(e,a.mutationKey)&&Object.assign(r,a.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...G(this,Zn).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Gh(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Xh&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...G(this,Zn).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){G(this,At).clear(),G(this,Jn).clear()}},At=new WeakMap,Jn=new WeakMap,Zn=new WeakMap,Yi=new WeakMap,Ji=new WeakMap,es=new WeakMap,Zi=new WeakMap,eo=new WeakMap,qg),my=D.createContext(void 0),$4=e=>{const t=D.useContext(my);if(e)return e;if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},H4=({client:e,children:t})=>(D.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),i.jsx(my.Provider,{value:e,children:t})),gy=D.createContext(!1),V4=()=>D.useContext(gy);gy.Provider;function W4(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var G4=D.createContext(W4()),X4=()=>D.useContext(G4),q4=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Q4=e=>{D.useEffect(()=>{e.clearReset()},[e])},K4=({result:e,errorResetBoundary:t,throwOnError:r,query:a,suspense:n})=>e.isError&&!t.isReset()&&!e.isFetching&&a&&(n&&e.data===void 0||C4(r,[e.error,a])),Y4=e=>{if(e.suspense){const r=n=>n==="static"?n:Math.max(n??1e3,1e3),a=e.staleTime;e.staleTime=typeof a=="function"?(...n)=>r(a(...n)):r(a),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},J4=(e,t)=>e.isLoading&&e.isFetching&&!t,Z4=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,tm=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function eE(e,t,r){var f,h,p,x,m;const a=V4(),n=X4(),s=$4(r),o=s.defaultQueryOptions(e);(h=(f=s.getDefaultOptions().queries)==null?void 0:f._experimental_beforeQuery)==null||h.call(f,o),o._optimisticResults=a?"isRestoring":"optimistic",Y4(o),q4(o,n),Q4(n);const l=!s.getQueryCache().get(o.queryHash),[c]=D.useState(()=>new t(s,o)),u=c.getOptimisticResult(o),d=!a&&e.subscribed!==!1;if(D.useSyncExternalStore(D.useCallback(w=>{const g=d?c.subscribe(lr.batchCalls(w)):$r;return c.updateResult(),g},[c,d]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),D.useEffect(()=>{c.setOptions(o)},[o,c]),Z4(o,u))throw tm(o,c,n);if(K4({result:u,errorResetBoundary:n,throwOnError:o.throwOnError,query:s.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if((x=(p=s.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||x.call(p,o,u),o.experimental_prefetchInRender&&!ni&&J4(u,a)){const w=l?tm(o,c,n):(m=s.getQueryCache().get(o.queryHash))==null?void 0:m.promise;w==null||w.catch($r).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?u:c.trackResult(u)}function tE(e,t){return eE(e,D4,t)}/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function jl(){return jl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},jl.apply(this,arguments)}var as;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(as||(as={}));const rm="popstate";function rE(e){e===void 0&&(e={});function t(a,n){let{pathname:s,search:o,hash:l}=a.location;return Tf("",{pathname:s,search:o,hash:l},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(a,n){return typeof n=="string"?n:A0(n)}return nE(t,r,null,e)}function _t(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Kh(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function aE(){return Math.random().toString(36).substr(2,8)}function am(e,t){return{usr:e.state,key:e.key,idx:t}}function Tf(e,t,r,a){return r===void 0&&(r=null),jl({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?go(t):t,{state:r,key:t&&t.key||a||aE()})}function A0(e){let{pathname:t="/",search:r="",hash:a=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function go(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}function nE(e,t,r,a){a===void 0&&(a={});let{window:n=document.defaultView,v5Compat:s=!1}=a,o=n.history,l=as.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(jl({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function f(){l=as.Pop;let w=d(),g=w==null?null:w-u;u=w,c&&c({action:l,location:m.location,delta:g})}function h(w,g){l=as.Push;let y=Tf(m.location,w,g);r&&r(y,w),u=d()+1;let v=am(y,u),k=m.createHref(y);try{o.pushState(v,"",k)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;n.location.assign(k)}s&&c&&c({action:l,location:m.location,delta:1})}function p(w,g){l=as.Replace;let y=Tf(m.location,w,g);r&&r(y,w),u=d();let v=am(y,u),k=m.createHref(y);o.replaceState(v,"",k),s&&c&&c({action:l,location:m.location,delta:0})}function x(w){let g=n.location.origin!=="null"?n.location.origin:n.location.href,y=typeof w=="string"?w:A0(w);return y=y.replace(/ $/,"%20"),_t(g,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,g)}let m={get action(){return l},get location(){return e(n,o)},listen(w){if(c)throw new Error("A history only accepts one active listener");return n.addEventListener(rm,f),c=w,()=>{n.removeEventListener(rm,f),c=null}},createHref(w){return t(n,w)},createURL:x,encodeLocation(w){let g=x(w);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:h,replace:p,go(w){return o.go(w)}};return m}var nm;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(nm||(nm={}));function sE(e,t,r){return r===void 0&&(r="/"),iE(e,t,r,!1)}function iE(e,t,r,a){let n=typeof t=="string"?go(t):t,s=lo(n.pathname||"/",r);if(s==null)return null;let o=vy(e);oE(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=vE(s);l=mE(o[c],u,a)}return l}function vy(e,t,r,a){t===void 0&&(t=[]),r===void 0&&(r=[]),a===void 0&&(a="");let n=(s,o,l)=>{let c={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(_t(c.relativePath.startsWith(a),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(a.length));let u=xs([a,c.relativePath]),d=r.concat(c);s.children&&s.children.length>0&&(_t(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),vy(s.children,t,d,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:pE(u,s.index),routesMeta:d})};return e.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))n(s,o);else for(let c of yy(s.path))n(s,o,c)}),t}function yy(e){let t=e.split("/");if(t.length===0)return[];let[r,...a]=t,n=r.endsWith("?"),s=r.replace(/\?$/,"");if(a.length===0)return n?[s,""]:[s];let o=yy(a.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),n&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function oE(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:xE(t.routesMeta.map(a=>a.childrenIndex),r.routesMeta.map(a=>a.childrenIndex)))}const lE=/^:[\w-]+$/,cE=3,uE=2,dE=1,fE=10,hE=-2,sm=e=>e==="*";function pE(e,t){let r=e.split("/"),a=r.length;return r.some(sm)&&(a+=hE),t&&(a+=uE),r.filter(n=>!sm(n)).reduce((n,s)=>n+(lE.test(s)?cE:s===""?dE:fE),a)}function xE(e,t){return e.length===t.length&&e.slice(0,-1).every((a,n)=>a===t[n])?e[e.length-1]-t[t.length-1]:0}function mE(e,t,r){r===void 0&&(r=!1);let{routesMeta:a}=e,n={},s="/",o=[];for(let l=0;l<a.length;++l){let c=a[l],u=l===a.length-1,d=s==="/"?t:t.slice(s.length)||"/",f=F0({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f&&u&&r&&!a[a.length-1].route.index&&(f=F0({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!f)return null;Object.assign(n,f.params),o.push({params:n,pathname:xs([s,f.pathname]),pathnameBase:EE(xs([s,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(s=xs([s,f.pathnameBase]))}return o}function F0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,a]=gE(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let s=n[0],o=s.replace(/(.)\/+$/,"$1"),l=n.slice(1);return{params:a.reduce((u,d,f)=>{let{paramName:h,isOptional:p}=d;if(h==="*"){let m=l[f]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const x=l[f];return p&&!x?u[h]=void 0:u[h]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:e}}function gE(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Kh(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let a=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(a.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),a]}function vE(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Kh(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function lo(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,a=e.charAt(r);return a&&a!=="/"?null:e.slice(r)||"/"}const yE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wE=e=>yE.test(e);function kE(e,t){t===void 0&&(t="/");let{pathname:r,search:a="",hash:n=""}=typeof e=="string"?go(e):e,s;if(r)if(wE(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),Kh(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=im(r.substring(1),"/"):s=im(r,t)}else s=t;return{pathname:s,search:SE(a),hash:NE(n)}}function im(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function ed(e,t,r,a){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function bE(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Yh(e,t){let r=bE(e);return t?r.map((a,n)=>n===r.length-1?a.pathname:a.pathnameBase):r.map(a=>a.pathnameBase)}function Jh(e,t,r,a){a===void 0&&(a=!1);let n;typeof e=="string"?n=go(e):(n=jl({},e),_t(!n.pathname||!n.pathname.includes("?"),ed("?","pathname","search",n)),_t(!n.pathname||!n.pathname.includes("#"),ed("#","pathname","hash",n)),_t(!n.search||!n.search.includes("#"),ed("#","search","hash",n)));let s=e===""||n.pathname==="",o=s?"/":n.pathname,l;if(o==null)l=r;else{let f=t.length-1;if(!a&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),f-=1;n.pathname=h.join("/")}l=f>=0?t[f]:"/"}let c=kE(n,l),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const xs=e=>e.join("/").replace(/\/\/+/g,"/"),EE=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),SE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,NE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function CE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const wy=["post","put","patch","delete"];new Set(wy);const _E=["get",...wy];new Set(_E);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Al(){return Al=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Al.apply(this,arguments)}const fu=D.createContext(null),ky=D.createContext(null),In=D.createContext(null),hu=D.createContext(null),cn=D.createContext({outlet:null,matches:[],isDataRoute:!1}),by=D.createContext(null);function TE(e,t){let{relative:r}=t===void 0?{}:t;vo()||_t(!1);let{basename:a,navigator:n}=D.useContext(In),{hash:s,pathname:o,search:l}=pu(e,{relative:r}),c=o;return a!=="/"&&(c=o==="/"?a:xs([a,o])),n.createHref({pathname:c,search:l,hash:s})}function vo(){return D.useContext(hu)!=null}function Cs(){return vo()||_t(!1),D.useContext(hu).location}function Ey(e){D.useContext(In).static||D.useLayoutEffect(e)}function _s(){let{isDataRoute:e}=D.useContext(cn);return e?VE():jE()}function jE(){vo()||_t(!1);let e=D.useContext(fu),{basename:t,future:r,navigator:a}=D.useContext(In),{matches:n}=D.useContext(cn),{pathname:s}=Cs(),o=JSON.stringify(Yh(n,r.v7_relativeSplatPath)),l=D.useRef(!1);return Ey(()=>{l.current=!0}),D.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){a.go(u);return}let f=Jh(u,JSON.parse(o),s,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:xs([t,f.pathname])),(d.replace?a.replace:a.push)(f,d.state,d)},[t,a,o,s,e])}const AE=D.createContext(null);function FE(e){let t=D.useContext(cn).outlet;return t&&D.createElement(AE.Provider,{value:e},t)}function PE(){let{matches:e}=D.useContext(cn),t=e[e.length-1];return t?t.params:{}}function pu(e,t){let{relative:r}=t===void 0?{}:t,{future:a}=D.useContext(In),{matches:n}=D.useContext(cn),{pathname:s}=Cs(),o=JSON.stringify(Yh(n,a.v7_relativeSplatPath));return D.useMemo(()=>Jh(e,JSON.parse(o),s,r==="path"),[e,o,s,r])}function DE(e,t){return OE(e,t)}function OE(e,t,r,a){vo()||_t(!1);let{navigator:n}=D.useContext(In),{matches:s}=D.useContext(cn),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=Cs(),d;if(t){var f;let w=typeof t=="string"?go(t):t;c==="/"||(f=w.pathname)!=null&&f.startsWith(c)||_t(!1),d=w}else d=u;let h=d.pathname||"/",p=h;if(c!=="/"){let w=c.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(w.length).join("/")}let x=sE(e,{pathname:p}),m=BE(x&&x.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:xs([c,n.encodeLocation?n.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:xs([c,n.encodeLocation?n.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),s,r,a);return t&&m?D.createElement(hu.Provider,{value:{location:Al({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:as.Pop}},m):m}function RE(){let e=HE(),t=CE(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return D.createElement(D.Fragment,null,D.createElement("h2",null,"Unexpected Application Error!"),D.createElement("h3",{style:{fontStyle:"italic"}},t),r?D.createElement("pre",{style:n},r):null,s)}const IE=D.createElement(RE,null);class LE extends D.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?D.createElement(cn.Provider,{value:this.props.routeContext},D.createElement(by.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ME(e){let{routeContext:t,match:r,children:a}=e,n=D.useContext(fu);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),D.createElement(cn.Provider,{value:t},a)}function BE(e,t,r,a){var n;if(t===void 0&&(t=[]),r===void 0&&(r=null),a===void 0&&(a=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=a)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(n=r)==null?void 0:n.errors;if(l!=null){let d=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);d>=0||_t(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(r&&a&&a.v7_partialHydration)for(let d=0;d<o.length;d++){let f=o[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:p}=r,x=f.route.loader&&h[f.route.id]===void 0&&(!p||p[f.route.id]===void 0);if(f.route.lazy||x){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,f,h)=>{let p,x=!1,m=null,w=null;r&&(p=l&&f.route.id?l[f.route.id]:void 0,m=f.route.errorElement||IE,c&&(u<0&&h===0?(WE("route-fallback",!1),x=!0,w=null):u===h&&(x=!0,w=f.route.hydrateFallbackElement||null)));let g=t.concat(o.slice(0,h+1)),y=()=>{let v;return p?v=m:x?v=w:f.route.Component?v=D.createElement(f.route.Component,null):f.route.element?v=f.route.element:v=d,D.createElement(ME,{match:f,routeContext:{outlet:d,matches:g,isDataRoute:r!=null},children:v})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?D.createElement(LE,{location:r.location,revalidation:r.revalidation,component:m,error:p,children:y(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):y()},null)}var Sy=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Sy||{}),P0=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(P0||{});function UE(e){let t=D.useContext(fu);return t||_t(!1),t}function zE(e){let t=D.useContext(ky);return t||_t(!1),t}function $E(e){let t=D.useContext(cn);return t||_t(!1),t}function Ny(e){let t=$E(),r=t.matches[t.matches.length-1];return r.route.id||_t(!1),r.route.id}function HE(){var e;let t=D.useContext(by),r=zE(P0.UseRouteError),a=Ny(P0.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[a]}function VE(){let{router:e}=UE(Sy.UseNavigateStable),t=Ny(P0.UseNavigateStable),r=D.useRef(!1);return Ey(()=>{r.current=!0}),D.useCallback(function(n,s){s===void 0&&(s={}),r.current&&(typeof n=="number"?e.navigate(n):e.navigate(n,Al({fromRouteId:t},s)))},[e,t])}const om={};function WE(e,t,r){!t&&!om[e]&&(om[e]=!0)}function GE(e,t){e==null||e.v7_startTransition,(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function Cy(e){let{to:t,replace:r,state:a,relative:n}=e;vo()||_t(!1);let{future:s,static:o}=D.useContext(In),{matches:l}=D.useContext(cn),{pathname:c}=Cs(),u=_s(),d=Jh(t,Yh(l,s.v7_relativeSplatPath),c,n==="path"),f=JSON.stringify(d);return D.useEffect(()=>u(JSON.parse(f),{replace:r,state:a,relative:n}),[u,f,n,r,a]),null}function XE(e){return FE(e.context)}function Be(e){_t(!1)}function qE(e){let{basename:t="/",children:r=null,location:a,navigationType:n=as.Pop,navigator:s,static:o=!1,future:l}=e;vo()&&_t(!1);let c=t.replace(/^\/*/,"/"),u=D.useMemo(()=>({basename:c,navigator:s,static:o,future:Al({v7_relativeSplatPath:!1},l)}),[c,l,s,o]);typeof a=="string"&&(a=go(a));let{pathname:d="/",search:f="",hash:h="",state:p=null,key:x="default"}=a,m=D.useMemo(()=>{let w=lo(d,c);return w==null?null:{location:{pathname:w,search:f,hash:h,state:p,key:x},navigationType:n}},[c,d,f,h,p,x,n]);return m==null?null:D.createElement(In.Provider,{value:u},D.createElement(hu.Provider,{children:r,value:m}))}function QE(e){let{children:t,location:r}=e;return DE(jf(t),r)}new Promise(()=>{});function jf(e,t){t===void 0&&(t=[]);let r=[];return D.Children.forEach(e,(a,n)=>{if(!D.isValidElement(a))return;let s=[...t,n];if(a.type===D.Fragment){r.push.apply(r,jf(a.props.children,s));return}a.type!==Be&&_t(!1),!a.props.index||!a.props.children||_t(!1);let o={id:a.props.id||s.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(o.children=jf(a.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function D0(){return D0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},D0.apply(this,arguments)}function _y(e,t){if(e==null)return{};var r={},a=Object.keys(e),n,s;for(s=0;s<a.length;s++)n=a[s],!(t.indexOf(n)>=0)&&(r[n]=e[n]);return r}function KE(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function YE(e,t){return e.button===0&&(!t||t==="_self")&&!KE(e)}const JE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],ZE=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],eS="6";try{window.__reactRouterVersion=eS}catch{}const tS=D.createContext({isTransitioning:!1}),rS="startTransition",lm=ik[rS];function aS(e){let{basename:t,children:r,future:a,window:n}=e,s=D.useRef();s.current==null&&(s.current=rE({window:n,v5Compat:!0}));let o=s.current,[l,c]=D.useState({action:o.action,location:o.location}),{v7_startTransition:u}=a||{},d=D.useCallback(f=>{u&&lm?lm(()=>c(f)):c(f)},[c,u]);return D.useLayoutEffect(()=>o.listen(d),[o,d]),D.useEffect(()=>GE(a),[a]),D.createElement(qE,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:a})}const nS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",sS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ty=D.forwardRef(function(t,r){let{onClick:a,relative:n,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f}=t,h=_y(t,JE),{basename:p}=D.useContext(In),x,m=!1;if(typeof u=="string"&&sS.test(u)&&(x=u,nS))try{let v=new URL(window.location.href),k=u.startsWith("//")?new URL(v.protocol+u):new URL(u),_=lo(k.pathname,p);k.origin===v.origin&&_!=null?u=_+k.search+k.hash:m=!0}catch{}let w=TE(u,{relative:n}),g=oS(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:n,viewTransition:f});function y(v){a&&a(v),v.defaultPrevented||g(v)}return D.createElement("a",D0({},h,{href:x||w,onClick:m||s?a:y,ref:r,target:c}))}),cm=D.forwardRef(function(t,r){let{"aria-current":a="page",caseSensitive:n=!1,className:s="",end:o=!1,style:l,to:c,viewTransition:u,children:d}=t,f=_y(t,ZE),h=pu(c,{relative:f.relative}),p=Cs(),x=D.useContext(ky),{navigator:m,basename:w}=D.useContext(In),g=x!=null&&lS(h)&&u===!0,y=m.encodeLocation?m.encodeLocation(h).pathname:h.pathname,v=p.pathname,k=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;n||(v=v.toLowerCase(),k=k?k.toLowerCase():null,y=y.toLowerCase()),k&&w&&(k=lo(k,w)||k);const _=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let F=v===y||!o&&v.startsWith(y)&&v.charAt(_)==="/",b=k!=null&&(k===y||!o&&k.startsWith(y)&&k.charAt(y.length)==="/"),S={isActive:F,isPending:b,isTransitioning:g},C=F?a:void 0,B;typeof s=="function"?B=s(S):B=[s,F?"active":null,b?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let T=typeof l=="function"?l(S):l;return D.createElement(Ty,D0({},f,{"aria-current":C,className:B,ref:r,style:T,to:c,viewTransition:u}),typeof d=="function"?d(S):d)});var Af;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Af||(Af={}));var um;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(um||(um={}));function iS(e){let t=D.useContext(fu);return t||_t(!1),t}function oS(e,t){let{target:r,replace:a,state:n,preventScrollReset:s,relative:o,viewTransition:l}=t===void 0?{}:t,c=_s(),u=Cs(),d=pu(e,{relative:o});return D.useCallback(f=>{if(YE(f,r)){f.preventDefault();let h=a!==void 0?a:A0(u)===A0(d);c(e,{replace:h,state:n,preventScrollReset:s,relative:o,viewTransition:l})}},[u,c,d,a,n,r,e,s,o,l])}function lS(e,t){t===void 0&&(t={});let r=D.useContext(tS);r==null&&_t(!1);let{basename:a}=iS(Af.useViewTransitionState),n=pu(e,{relative:t.relative});if(!r.isTransitioning)return!1;let s=lo(r.currentLocation.pathname,a)||r.currentLocation.pathname,o=lo(r.nextLocation.pathname,a)||r.nextLocation.pathname;return F0(n.pathname,o)!=null||F0(n.pathname,s)!=null}const cS={common:{welcome:"Bienvenido",logout:"Cerrar Sesin",login:"Iniciar Sesin",loading:"Cargando...",error:"Error",success:"xito",cancel:"Cancelar",save:"Guardar",delete:"Eliminar",edit:"Editar",back:"Volver",next:"Siguiente",previous:"Anterior",search:"Buscar",filter:"Filtrar",close:"Cerrar"},login:{title:"Iniciar Sesin",subtitle:"Accede a tu cuenta de Auriga",button:"Iniciar Sesin con Authentik",checking:"Verificando sesin...",redirecting:"Redirigiendo...",tryAnotherUser:"Puedes intentar iniciar sesin con otro usuario haciendo clic en el botn de abajo.",tryAgain:"Intentar con Otro Usuario"},dashboard:{title:"Dashboard",welcome:"Bienvenido",userInfo:"Informacin del Usuario",email:"Email",id:"ID",apiInfo:"Informacin de la API",noUserData:"No hay informacin de usuario disponible.",sections:"Secciones Disponibles",qualityDashboard:"Dashboard de Calidad",maintenanceDashboard:"Dashboard de Mantenimiento",adminDashboard:"Dashboard de Administracin",noAccess:"No tienes acceso a secciones especializadas. Contacta al administrador para obtener permisos.",permissions:"Informacin de Permisos",factories:"Fbricas",roles:"Roles",departments:"Departamentos",groups:"Grupos",none:"Ninguno",noneFound:"Ninguna",categories:{general:"General",productive:"Gestin Productiva",people:"Gestin de Personas",quality:"Gestin de Calidad",processes:"Gestin de Procesos",assets:"Gestin de Activos",safety:"Seguridad y Salud",configuration:"Configuracin",administration:"Administracin",mobile:"Mvil"}},quality:{title:"Dashboard de Calidad",permissions:"Informacin de Permisos",accessChecks:"Verificaciones de Acceso",factoryAccess:"Acceso a",roleIn:"Rol",features:"Funcionalidades de Calidad",inspections:"Gestin de inspecciones",qualityControl:"Control de calidad",nonConformities:"Reportes de no conformidades",trends:"Anlisis de tendencias"},maintenance:{title:"Dashboard de Mantenimiento",permissions:"Informacin de Permisos",accessChecks:"Verificaciones de Acceso",factoryAccess:"Acceso a",roleIn:"Rol",features:"Funcionalidades de Mantenimiento",planning:"Planificacin de mantenimiento",workOrders:"rdenes de trabajo",equipment:"Gestin de equipos",history:"Historial de mantenimientos"},admin:{title:"Dashboard de Administracin",permissions:"Informacin de Permisos",accessChecks:"Verificaciones de Acceso",group:"Grupo",features:"Funcionalidades de Administracin",users:"Gestin de usuarios",system:"Configuracin del sistema",reports:"Reportes administrativos",audit:"Auditora y logs"},errors:{notAuthenticated:"No autenticado",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a esta seccin.",requirements:"Requisitos",factory:"Fbrica",department:"Departamento",role:"Rol",group:"Grupo",backToDashboard:"Volver al Dashboard",authenticationError:"Error de Autenticacin",codeExpired:"El cdigo de autorizacin ha expirado. Por favor, intenta iniciar sesin nuevamente.",accountDisabled:"Tu cuenta ha sido deshabilitada. Por favor, contacta a tu administrador."},produccion:{ordenesFabricacion:{title:"rdenes de Fabricacin",description:"Gestin de rdenes de fabricacin"},programacion:{title:"Programacin",description:"Programacin de produccin"},oeeMetricas:{title:"Mtricas OEE",description:"Mtricas OEE (Overall Equipment Effectiveness)"},materialesConsumos:{title:"Materiales y Consumos",description:"Control de materiales y consumos"},lotesTrazabilidad:{title:"Lotes y Trazabilidad",description:"Trazabilidad de lotes"}},personas:{turnos:{title:"Turnos",description:"Gestin de turnos de trabajo"},empleados:{title:"Empleados",description:"Gestin de empleados"},turnosAsignados:{title:"Turnos Asignados",description:"Asignacin de turnos a empleados"},horariosTrabajo:{title:"Horarios de Trabajo",description:"Horarios de trabajo diarios"},asistencia:{title:"Asistencia",description:"Control de asistencia"},asignaciones:{title:"Asignaciones",description:"Asignaciones de personal"},salidasEspeciales:{title:"Salidas Especiales",description:"Gestin de salidas especiales"},evaluaciones:{title:"Evaluaciones",description:"Evaluaciones de personal"}},calidad:{planesInspeccion:{title:"Planes de Inspeccin",description:"Planes de inspeccin y ensayos (ITP)"},autocontrolCalidad:{title:"Autocontrol de Calidad",description:"Autocontrol de calidad por plan"},registrosAutocontrol:{title:"Registros de Autocontrol",description:"Registros de autocontrol"},caracteristicasCalidad:{title:"Caractersticas de Calidad",description:"Caractersticas de calidad"},defectos:{title:"Defectos",description:"Gestin de defectos"},controlEstadistico:{title:"Control Estadstico",description:"Control estadstico de procesos"},accionesCorrectivas:{title:"Acciones Correctivas",description:"Acciones correctivas"},certificados:{title:"Certificados",description:"Gestin de certificados"}},procesos:{datosMaestros:{title:"Datos Maestros de Procesos",description:"Datos maestros de procesos"},parametros:{title:"Parmetros de Procesos",description:"Parmetros de procesos"},bomRutas:{title:"BOM y Rutas",description:"BOM (Bill of Materials) y rutas"},instrucciones:{title:"Instrucciones de Trabajo",description:"Instrucciones de trabajo (WI, SOP, ITP)"},control:{title:"Control de Proceso",description:"Control de procesos"},automaticos:{title:"Procesos Automticos",description:"Procesos automticos y sincronizaciones"}},activos:{jerarquia:{title:"Jerarqua de Activos",description:"Jerarqua de activos"},lineas:{title:"Lneas",description:"Gestin de lneas de produccin"},lineAssets:{title:"Activos de Lnea",description:"Activos de una lnea especfica"},estados:{title:"Estados de Disponibilidad",description:"Estados de disponibilidad"},especificaciones:{title:"Especificaciones Tcnicas",description:"Especificaciones tcnicas"}},seguridad:{riesgos:{title:"Riesgos",description:"Gestin de riesgos"},inspecciones:{title:"Inspecciones de Seguridad",description:"Inspecciones de seguridad"},accidentes:{title:"Accidentes",description:"Registro de accidentes"},capacitaciones:{title:"Capacitaciones",description:"Gestin de capacitaciones"},epp:{title:"EPP",description:"Equipos de proteccin personal"},saludOcupacional:{title:"Salud Ocupacional",description:"Salud ocupacional"}},configuracion:{empresa:{title:"Configuracin de Empresa",description:"Configuracin de empresa"},plantas:{title:"Configuracin de Plantas",description:"Configuracin de plantas"},calendario:{title:"Configuracin de Calendario",description:"Configuracin de calendario"},turnos:{title:"Configuracin de Turnos",description:"Configuracin de turnos"},zonasHorarias:{title:"Configuracin de Zonas Horarias",description:"Configuracin de zonas horarias"},unidades:{title:"Configuracin de Unidades",description:"Configuracin de unidades"},monedas:{title:"Configuracin de Monedas",description:"Configuracin de monedas"}},administracion:{seguridad:{title:"Seguridad",description:"Configuracin de seguridad"},usuarios:{title:"Usuarios",description:"Gestin de usuarios"},roles:{title:"Roles",description:"Gestin de roles"},rolesPermisos:{title:"Roles y Permisos",description:"Permisos por rol"}},mobile:{scanQR:{title:"Escanear QR",description:"Escaneo de cdigos QR"}},navigation:{general:"General",productive:"Gestin Productiva",people:"Gestin de Personas",quality:"Gestin de Calidad",processes:"Gestin de Procesos",assets:"Gestin de Activos",safety:"Seguridad y Salud",configuration:"Configuracin",administration:"Administracin",mobile:"Mvil",orders:"rdenes de Fabricacin",scheduling:"Programacin",oee:"Mtricas OEE",materials:"Materiales y Consumos",traceability:"Lotes y Trazabilidad",shifts:"Turnos",employees:"Empleados",assignedShifts:"Turnos Asignados",workSchedules:"Horarios de Trabajo",attendance:"Asistencia",assignments:"Asignaciones",personalAssignment:"Asignacin de Personal",specialExits:"Salidas Especiales",evaluations:"Evaluaciones",inspectionPlans:"Planes de Inspeccin",selfControl:"Registros de Autocontrol",qualityCharacteristics:"Caractersticas de Calidad",defects:"Defectos",statisticalControl:"Control Estadstico",correctiveActions:"Acciones Correctivas",certificates:"Certificados",masterData:"Datos Maestros",processParameters:"Parmetros de Procesos",bomRoutes:"BOM y Rutas",workInstructions:"Instrucciones de Trabajo",processControl:"Control de Proceso",automaticProcesses:"Procesos Automticos",assetHierarchy:"Jerarqua de Activos",lines:"Lneas",availabilityStates:"Estados de Disponibilidad",technicalSpecs:"Especificaciones Tcnicas",risks:"Riesgos",safetyInspections:"Inspecciones de Seguridad",accidents:"Accidentes",trainings:"Capacitaciones",ppe:"EPP",occupationalHealth:"Salud Ocupacional",companyConfig:"Configuracin de Empresa",plantsConfig:"Configuracin de Plantas",calendarConfig:"Configuracin de Calendario",shiftsConfig:"Configuracin de Turnos",timezonesConfig:"Zonas Horarias",unitsConfig:"Unidades",currenciesConfig:"Monedas",security:"Seguridad",users:"Usuarios",roles:"Roles",rolesPermissions:"Roles y Permisos",scanQR:"Escanear QR"}},uS={common:{welcome:"Welcome",logout:"Log Out",login:"Log In",loading:"Loading...",error:"Error",success:"Success",cancel:"Cancel",save:"Save",delete:"Delete",edit:"Edit",back:"Back",next:"Next",previous:"Previous",search:"Search",filter:"Filter",close:"Close"},login:{title:"Log In",subtitle:"Access your Auriga account",button:"Log In with Authentik",checking:"Checking session...",redirecting:"Redirecting..."},dashboard:{title:"Dashboard",welcome:"Welcome",userInfo:"User Information",email:"Email",id:"ID",apiInfo:"API Information",noUserData:"No user information available.",sections:"Available Sections",qualityDashboard:"Quality Dashboard",maintenanceDashboard:"Maintenance Dashboard",adminDashboard:"Administration Dashboard",noAccess:"You don't have access to specialized sections. Contact the administrator to obtain permissions.",permissions:"Permissions Information",factories:"Factories",roles:"Roles",departments:"Departments",groups:"Groups",none:"None",noneFound:"None"},quality:{title:"Quality Dashboard",permissions:"Permissions Information",accessChecks:"Access Checks",factoryAccess:"Access to",roleIn:"Role",features:"Quality Features",inspections:"Inspection management",qualityControl:"Quality control",nonConformities:"Non-conformity reports",trends:"Trend analysis"},maintenance:{title:"Maintenance Dashboard",permissions:"Permissions Information",accessChecks:"Access Checks",factoryAccess:"Access to",roleIn:"Role",features:"Maintenance Features",planning:"Maintenance planning",workOrders:"Work orders",equipment:"Equipment management",history:"Maintenance history"},admin:{title:"Administration Dashboard",permissions:"Permissions Information",accessChecks:"Access Checks",group:"Group",features:"Administration Features",users:"User management",system:"System configuration",reports:"Administrative reports",audit:"Audit and logs"},errors:{notAuthenticated:"Not authenticated",accessDenied:"Access Denied",noPermission:"You don't have permission to access this section.",requirements:"Requirements",factory:"Factory",department:"Department",role:"Role",group:"Group",backToDashboard:"Back to Dashboard"}},dS={common:{welcome:"Willkommen",logout:"Abmelden",login:"Anmelden",loading:"Laden...",error:"Fehler",success:"Erfolg",cancel:"Abbrechen",save:"Speichern",delete:"Lschen",edit:"Bearbeiten",back:"Zurck",next:"Weiter",previous:"Vorherige",search:"Suchen",filter:"Filtern",close:"Schlieen"},login:{title:"Anmelden",subtitle:"Zugriff auf Ihr Auriga-Konto",button:"Mit Authentik anmelden",checking:"Sitzung wird berprft...",redirecting:"Weiterleitung..."},dashboard:{title:"Dashboard",welcome:"Willkommen",userInfo:"Benutzerinformationen",email:"E-Mail",id:"ID",apiInfo:"API-Informationen",noUserData:"Keine Benutzerinformationen verfgbar.",sections:"Verfgbare Bereiche",qualityDashboard:"Qualitts-Dashboard",maintenanceDashboard:"Wartungs-Dashboard",adminDashboard:"Administrations-Dashboard",noAccess:"Sie haben keinen Zugriff auf spezialisierte Bereiche. Wenden Sie sich an den Administrator, um Berechtigungen zu erhalten.",permissions:"Berechtigungsinformationen",factories:"Fabriken",roles:"Rollen",departments:"Abteilungen",groups:"Gruppen",none:"Keine",noneFound:"Keine"},quality:{title:"Qualitts-Dashboard",permissions:"Berechtigungsinformationen",accessChecks:"Zugriffsprfungen",factoryAccess:"Zugriff auf",roleIn:"Rolle",features:"Qualittsfunktionen",inspections:"Inspektionsverwaltung",qualityControl:"Qualittskontrolle",nonConformities:"Berichte ber Abweichungen",trends:"Trendanalyse"},maintenance:{title:"Wartungs-Dashboard",permissions:"Berechtigungsinformationen",accessChecks:"Zugriffsprfungen",factoryAccess:"Zugriff auf",roleIn:"Rolle",features:"Wartungsfunktionen",planning:"Wartungsplanung",workOrders:"Arbeitsauftrge",equipment:"Gerteverwaltung",history:"Wartungsverlauf"},admin:{title:"Administrations-Dashboard",permissions:"Berechtigungsinformationen",accessChecks:"Zugriffsprfungen",group:"Gruppe",features:"Verwaltungsfunktionen",users:"Benutzerverwaltung",system:"Systemkonfiguration",reports:"Verwaltungsberichte",audit:"Prfung und Protokolle"},errors:{notAuthenticated:"Nicht authentifiziert",accessDenied:"Zugriff verweigert",noPermission:"Sie haben keine Berechtigung, auf diesen Bereich zuzugreifen.",requirements:"Anforderungen",factory:"Fabrik",department:"Abteilung",role:"Rolle",group:"Gruppe",backToDashboard:"Zurck zum Dashboard"}},fS={common:{welcome:"Bienvenue",logout:"Dconnexion",login:"Connexion",loading:"Chargement...",error:"Erreur",success:"Succs",cancel:"Annuler",save:"Enregistrer",delete:"Supprimer",edit:"Modifier",back:"Retour",next:"Suivant",previous:"Prcdent",search:"Rechercher",filter:"Filtrer",close:"Fermer"},login:{title:"Connexion",subtitle:"Accdez  votre compte Auriga",button:"Se connecter avec Authentik",checking:"Vrification de la session...",redirecting:"Redirection..."},dashboard:{title:"Tableau de bord",welcome:"Bienvenue",userInfo:"Informations utilisateur",email:"E-mail",id:"ID",apiInfo:"Informations API",noUserData:"Aucune information utilisateur disponible.",sections:"Sections disponibles",qualityDashboard:"Tableau de bord Qualit",maintenanceDashboard:"Tableau de bord Maintenance",adminDashboard:"Tableau de bord Administration",noAccess:"Vous n'avez pas accs aux sections spcialises. Contactez l'administrateur pour obtenir des permissions.",permissions:"Informations sur les permissions",factories:"Usines",roles:"Rles",departments:"Dpartements",groups:"Groupes",none:"Aucun",noneFound:"Aucun"},quality:{title:"Tableau de bord Qualit",permissions:"Informations sur les permissions",accessChecks:"Vrifications d'accs",factoryAccess:"Accs ",roleIn:"Rle",features:"Fonctionnalits Qualit",inspections:"Gestion des inspections",qualityControl:"Contrle qualit",nonConformities:"Rapports de non-conformit",trends:"Analyse des tendances"},maintenance:{title:"Tableau de bord Maintenance",permissions:"Informations sur les permissions",accessChecks:"Vrifications d'accs",factoryAccess:"Accs ",roleIn:"Rle",features:"Fonctionnalits Maintenance",planning:"Planification de la maintenance",workOrders:"Ordres de travail",equipment:"Gestion des quipements",history:"Historique de maintenance"},admin:{title:"Tableau de bord Administration",permissions:"Informations sur les permissions",accessChecks:"Vrifications d'accs",group:"Groupe",features:"Fonctionnalits Administration",users:"Gestion des utilisateurs",system:"Configuration du systme",reports:"Rapports administratifs",audit:"Audit et journaux"},errors:{notAuthenticated:"Non authentifi",accessDenied:"Accs refus",noPermission:"Vous n'avez pas la permission d'accder  cette section.",requirements:"Exigences",factory:"Usine",department:"Dpartement",role:"Rle",group:"Groupe",backToDashboard:"Retour au tableau de bord"}},hS={common:{welcome:"Benvenuto",logout:"Esci",login:"Accedi",loading:"Caricamento...",error:"Errore",success:"Successo",cancel:"Annulla",save:"Salva",delete:"Elimina",edit:"Modifica",back:"Indietro",next:"Avanti",previous:"Precedente",search:"Cerca",filter:"Filtra",close:"Chiudi"},login:{title:"Accedi",subtitle:"Accedi al tuo account Auriga",button:"Accedi con Authentik",checking:"Verifica sessione...",redirecting:"Reindirizzamento..."},dashboard:{title:"Dashboard",welcome:"Benvenuto",userInfo:"Informazioni utente",email:"Email",id:"ID",apiInfo:"Informazioni API",noUserData:"Nessuna informazione utente disponibile.",sections:"Sezioni disponibili",qualityDashboard:"Dashboard Qualit",maintenanceDashboard:"Dashboard Manutenzione",adminDashboard:"Dashboard Amministrazione",noAccess:"Non hai accesso alle sezioni specializzate. Contatta l'amministratore per ottenere i permessi.",permissions:"Informazioni sui permessi",factories:"Fabbriche",roles:"Ruoli",departments:"Dipartimenti",groups:"Gruppi",none:"Nessuno",noneFound:"Nessuno"},quality:{title:"Dashboard Qualit",permissions:"Informazioni sui permessi",accessChecks:"Controlli di accesso",factoryAccess:"Accesso a",roleIn:"Ruolo",features:"Funzionalit Qualit",inspections:"Gestione ispezioni",qualityControl:"Controllo qualit",nonConformities:"Report di non conformit",trends:"Analisi delle tendenze"},maintenance:{title:"Dashboard Manutenzione",permissions:"Informazioni sui permessi",accessChecks:"Controlli di accesso",factoryAccess:"Accesso a",roleIn:"Ruolo",features:"Funzionalit Manutenzione",planning:"Pianificazione manutenzione",workOrders:"Ordini di lavoro",equipment:"Gestione attrezzature",history:"Storico manutenzioni"},admin:{title:"Dashboard Amministrazione",permissions:"Informazioni sui permessi",accessChecks:"Controlli di accesso",group:"Gruppo",features:"Funzionalit Amministrazione",users:"Gestione utenti",system:"Configurazione sistema",reports:"Report amministrativi",audit:"Audit e log"},errors:{notAuthenticated:"Non autenticato",accessDenied:"Accesso negato",noPermission:"Non hai il permesso di accedere a questa sezione.",requirements:"Requisiti",factory:"Fabbrica",department:"Dipartimento",role:"Ruolo",group:"Gruppo",backToDashboard:"Torna al Dashboard"}},pS={common:{welcome:" ",logout:"",login:"",loading:"...",error:"",success:"",cancel:"",save:"",delete:"",edit:"",back:"",next:"",previous:"",search:"",filter:"",close:""},login:{title:"",subtitle:"     Auriga",button:"  Authentik",checking:" ...",redirecting:"..."},dashboard:{title:" ",welcome:" ",userInfo:"  ",email:" ",id:"ID",apiInfo:" API",noUserData:"   .",sections:" ",qualityDashboard:" ",maintenanceDashboard:" ",adminDashboard:" ",noAccess:"      .      .",permissions:"  ",factories:"",roles:"",departments:"",groups:"",none:"",noneFound:""},quality:{title:" ",permissions:"  ",accessChecks:" ",factoryAccess:" ",roleIn:"",features:" ",inspections:" ",qualityControl:" ",nonConformities:"  ",trends:" "},maintenance:{title:" ",permissions:"  ",accessChecks:" ",factoryAccess:" ",roleIn:"",features:" ",planning:" ",workOrders:" ",equipment:" ",history:" "},admin:{title:" ",permissions:"  ",accessChecks:" ",group:"",features:" ",users:" ",system:" ",reports:" ",audit:"  "},errors:{notAuthenticated:" ",accessDenied:" ",noPermission:"        .",requirements:"",factory:"",department:"",role:"",group:"",backToDashboard:"   "}},Do={es:cS,en:uS,de:dS,fr:fS,it:hS,ru:pS},jy=D.createContext(),He=()=>{const e=D.useContext(jy);if(!e)throw new Error("useLanguage must be used within a LanguageProvider");return e},xS=({children:e})=>{const[t,r]=D.useState(()=>{const c=localStorage.getItem("app_language");return c&&Do[c]?c:"es"}),[a,n]=D.useState(()=>Do[t]);D.useEffect(()=>{n(Do[t]),localStorage.setItem("app_language",t)},[t]);const l={language:t,t:a,changeLanguage:c=>{Do[c]?r(c):console.warn(`Language ${c} not supported. Available: ${Object.keys(Do).join(", ")}`)},getAvailableLanguages:()=>[{code:"es",name:"Espaol",flag:""},{code:"en",name:"English",flag:""},{code:"de",name:"Deutsch",flag:""},{code:"fr",name:"Franais",flag:""},{code:"it",name:"Italiano",flag:""},{code:"ru",name:"",flag:""}]};return i.jsx(jy.Provider,{value:l,children:e})},mS=()=>{const e=["auth_token","user_data","session_active"],t=window.location.hostname,r=t.split("."),a=[t,t.split(":")[0],`.${t.split(":")[0]}`,...r.length>1?[r.slice(-2).join("."),`.${r.slice(-2).join(".")}`]:[]],n=["/","/auth","/dashboard","/login"];e.forEach(o=>{a.forEach(l=>{n.forEach(c=>{document.cookie=`${o}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${c}; domain=${l};`,document.cookie=`${o}=; max-age=0; path=${c}; domain=${l};`,document.cookie=`${o}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${c};`,document.cookie=`${o}=; max-age=0; path=${c};`})}),document.cookie=`${o}=; expires=Thu, 01 Jan 1970 00:00:00 UTC;`,document.cookie=`${o}=; max-age=0;`}),document.cookie.split(";").forEach(o=>{const l=o.indexOf("="),c=l>-1?o.substr(0,l).trim():o.trim();c&&(c.includes("auth")||c.includes("session")||c.includes("token"))&&a.forEach(u=>{n.forEach(d=>{document.cookie=`${c}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${d}; domain=${u};`,document.cookie=`${c}=; max-age=0; path=${d}; domain=${u};`})})}),console.log(" [clearAllAuthCookies] Todas las cookies de autenticacin limpiadas")},gS=()=>{try{localStorage.clear(),Object.keys(localStorage).forEach(r=>{(r.includes("auth")||r.includes("session")||r.includes("token")||r.includes("user"))&&localStorage.removeItem(r)}),sessionStorage.clear(),Object.keys(sessionStorage).forEach(r=>{(r.includes("auth")||r.includes("session")||r.includes("token")||r.includes("user"))&&sessionStorage.removeItem(r)}),console.log(" [clearAllStorage] localStorage y sessionStorage limpiados")}catch(e){console.warn(" [clearAllStorage] Error al limpiar storage:",e)}},vS=async()=>{try{if("caches"in window){const e=await caches.keys();await Promise.all(e.map(t=>(console.log(` [clearAllCache] Eliminando cache: ${t}`),caches.delete(t)))),console.log(" [clearAllCache] Todos los caches eliminados")}if("serviceWorker"in navigator){const e=await navigator.serviceWorker.getRegistrations();await Promise.all(e.map(t=>(console.log(" [clearAllCache] Desregistrando service worker"),t.unregister())))}window.location.reload}catch(e){console.warn(" [clearAllCache] Error al limpiar cache:",e)}},Zo=async()=>{console.log(" [clearEverything] Iniciando limpieza completa..."),mS(),gS(),await vS(),await new Promise(t=>setTimeout(t,100)),console.log(" [clearEverything] Limpieza completa finalizada");const e=document.cookie;e?console.warn(" [clearEverything] An quedan cookies:",e):console.log(" [clearEverything] Todas las cookies eliminadas")},yS=e=>{const r=`; ${document.cookie}`.split(`; ${e}=`);return r.length===2?r.pop().split(";").shift():null},wS=()=>{try{const e=yS("user_data");if(e){const t=atob(e);return JSON.parse(t)}}catch(e){console.error("Error reading user session:",e)}return null},kS=()=>wS()||null,Zh=async()=>{try{console.log(" [checkServerAuth] Iniciando verificacin de autenticacin...");const e="/api/auth/check";console.log(" [checkServerAuth] URL:",e),console.log(" [checkServerAuth] Credentials disponibles:",document.cookie);const t=await fetch(e,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}).catch(a=>{throw console.error(" [checkServerAuth] Error de red:",a),a});if(console.log(" [checkServerAuth] Status:",t.status),console.log(" [checkServerAuth] OK:",t.ok),console.log(" [checkServerAuth] Status text:",t.statusText),!t.ok){let a="";try{a=await t.text(),console.error(" [checkServerAuth] Error HTTP:",t.status,a)}catch(n){console.error(" [checkServerAuth] No se pudo leer el texto de error:",n)}return{authenticated:!1,message:`HTTP ${t.status}`}}const r=await t.json();return console.log(" [checkServerAuth] Datos recibidos:",r),r}catch(e){console.error(" [checkServerAuth] Error completo:",e),console.error(" [checkServerAuth] Tipo de error:",e.name),console.error(" [checkServerAuth] Mensaje:",e.message),console.error(" [checkServerAuth] Causa:",e.cause),e.stack&&console.error(" [checkServerAuth] Stack:",e.stack);const t={name:e.name,message:e.message,cause:e.cause,stack:e.stack};return console.error(" [checkServerAuth] Informacin completa del error:",JSON.stringify(t,null,2)),{authenticated:!1,error:e.message||"Error desconocido",errorDetails:t}}},ep=async()=>{try{const e=await fetch("/auth/logout",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}}).catch(t=>(console.warn("Logout server call failed, continuing with local cleanup:",t),null));if(await Zo(),e&&e.ok)try{const t=await e.json();if(t.logout_url&&t.redirect){console.log("Redirecting to Authentik logout:",t.logout_url),window.location.href=t.logout_url;return}}catch(t){console.warn("Failed to parse logout response, redirecting to login:",t)}typeof window<"u"&&(window.location.href="/login")}catch(e){console.error("Logout error:",e),await Zo(),typeof window<"u"&&(window.location.href="/login")}},bS=async(e,t={})=>{const r={credentials:"include",headers:{"Content-Type":"application/json",...t.headers}};try{const a=await fetch(`/api${e}`,{...r,...t});if(a.status===401)return window.location.href="/login",null;if(a.status===403)throw new Error("No tienes permisos para acceder a este recurso");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){throw console.error("API request failed:",a),a}},ES=()=>bS("/users/me"),Ve=({children:e})=>{const[t,r]=D.useState(null);return D.useEffect(()=>{(async()=>{try{console.log(" [ProtectedRoute] Verificando autenticacin...");const n=await Zh();console.log(" [ProtectedRoute] Respuesta de autenticacin:",n),r(n.authenticated),n.authenticated?console.log(" [ProtectedRoute] Usuario autenticado"):(console.warn(" [ProtectedRoute] No autenticado, redirigiendo a /login"),window.location.href="/login")}catch(n){console.error(" [ProtectedRoute] Error verificando autenticacin:",n),console.error(" [ProtectedRoute] Tipo de error:",(n==null?void 0:n.name)||"Unknown"),console.error(" [ProtectedRoute] Mensaje:",(n==null?void 0:n.message)||"Error sin mensaje"),console.error(" [ProtectedRoute] Stack:",(n==null?void 0:n.stack)||"Sin stack");const s={name:(n==null?void 0:n.name)||"Unknown",message:(n==null?void 0:n.message)||"Error desconocido",stack:(n==null?void 0:n.stack)||"Sin stack trace",fullError:n};console.error(" [ProtectedRoute] Informacin completa del error:",JSON.stringify(s,null,2)),r(!1),setTimeout(()=>{window.location.href="/login"},100)}})()},[]),t===null?i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{border:"4px solid #f3f3f3",borderTop:"4px solid #007bff",borderRadius:"50%",width:"40px",height:"40px",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),i.jsx("p",{children:"Verificando autenticacin..."})]})}):t?e:null},SS=async()=>{try{const e=await fetch("/api/auth/permissions",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){return console.error("Error fetching user permissions:",e),null}},NS=(e,{factory:t,department:r,role:a,group:n})=>{var o;if(!e||!e.organization)return!1;const{organization:s}=e;if(n&&!(((o=e.user)==null?void 0:o.groups)||[]).includes(n)||t&&!(s.factories||{})[t])return!1;if(a){const l=s.roles_detail||[];let c=!1;if(t&&r?c=l.some(u=>u.factory===t&&u.department===r&&u.role===a):t?c=l.some(u=>u.factory===t&&u.role===a):c=l.some(u=>u.role===a),!c)return!1}return!0},CS=(e,t)=>!e||!e.organization?!1:(e.organization.factory_names||[]).includes(t),_S=(e,t,r=null,a=null)=>{if(!e||!e.organization)return!1;const n=e.organization.roles_detail||[];return r&&a?n.some(s=>s.factory===r&&s.department===a&&s.role===t):r?n.some(s=>s.factory===r&&s.role===t):n.some(s=>s.role===t)},TS=(e,t)=>!e||!e.user?!1:(e.user.groups||[]).includes(t),yo=()=>{const[e,t]=D.useState({data:null,isLoading:!0,error:null});D.useEffect(()=>{(async()=>{try{if(!(await Zh()).authenticated){t({data:null,isLoading:!1,error:"Not authenticated"});return}const c=await SS();t({data:c,isLoading:!1,error:null})}catch(l){console.error("Error loading permissions:",l),t({data:null,isLoading:!1,error:l.message})}})()},[]);const r=o=>e.data?NS(e.data,o):!1,a=o=>e.data?CS(e.data,o):!1,n=(o,l=null,c=null)=>e.data?_S(e.data,o,l,c):!1,s=o=>e.data?TS(e.data,o):!1;return{permissions:e.data,isLoading:e.isLoading,error:e.error,checkPermission:r,checkFactoryAccess:a,checkRole:n,checkGroup:s}},Jt=({children:e,factory:t,department:r,role:a,group:n,redirectTo:s="/dashboard",fallback:o=null})=>{const{permissions:l,isLoading:c,checkPermission:u}=yo();return c?o||i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{border:"4px solid #f3f3f3",borderTop:"4px solid #007bff",borderRadius:"50%",width:"40px",height:"40px",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),i.jsx("p",{children:"Verificando permisos..."})]})}):l?u({factory:t,department:r,role:a,group:n})?e:o||i.jsxs("div",{style:{padding:"20px",textAlign:"center",background:"#fff3cd",color:"#856404",borderRadius:"5px",margin:"20px"},children:[i.jsx("h2",{children:"Acceso Denegado"}),i.jsx("p",{children:"No tienes permisos para acceder a esta seccin."}),i.jsxs("p",{style:{fontSize:"12px",marginTop:"10px"},children:["Requisitos:",t&&i.jsxs("span",{children:[" Fbrica: ",t]}),r&&i.jsxs("span",{children:[" | Departamento: ",r]}),a&&i.jsxs("span",{children:[" | Rol: ",a]}),n&&i.jsxs("span",{children:[" | Grupo: ",n]})]}),i.jsx("button",{onClick:()=>window.location.href=s,style:{marginTop:"20px",padding:"10px 20px",background:"#007bff",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Volver al Dashboard"})]}):i.jsx(Cy,{to:s,replace:!0})};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jS=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),AS=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,a)=>a?a.toUpperCase():r.toLowerCase()),dm=e=>{const t=AS(e);return t.charAt(0).toUpperCase()+t.slice(1)},Ay=(...e)=>e.filter((t,r,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===r).join(" ").trim(),FS=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var PS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DS=D.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:s,iconNode:o,...l},c)=>D.createElement("svg",{ref:c,...PS,width:t,height:t,stroke:e,strokeWidth:a?Number(r)*24/Number(t):r,className:Ay("lucide",n),...!s&&!FS(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,d])=>D.createElement(u,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=(e,t)=>{const r=D.forwardRef(({className:a,...n},s)=>D.createElement(DS,{ref:s,iconNode:t,className:Ay(`lucide-${jS(dm(e))}`,`lucide-${e}`,a),...n}));return r.displayName=dm(e),r};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OS=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],td=Ie("activity",OS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RS=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],fm=Ie("award",RS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IS=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],LS=Ie("book-open",IS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MS=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],BS=Ie("building-2",MS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const US=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],zS=Ie("calculator",US);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $S=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],HS=Ie("calendar-days",$S);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VS=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],O0=Ie("calendar",VS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],GS=Ie("chart-column",WS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Fl=Ie("chevron-down",XS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qS=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],QS=Ie("chevron-left",qS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ba=Ie("chevron-right",KS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],La=Ie("circle-alert",YS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JS=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ZS=Ie("circle-check-big",JS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ws=Ie("circle-check",eN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tN=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],hm=Ie("circle-play",tN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],aN=Ie("circle-x",rN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nN=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],sN=Ie("clipboard-list",nN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iN=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ms=Ie("clock",iN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oN=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],lN=Ie("database",oN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cN=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],uN=Ie("dollar-sign",cN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dN=[["path",{d:"M11 20H2",key:"nlcfvz"}],["path",{d:"M11 4.562v16.157a1 1 0 0 0 1.242.97L19 20V5.562a2 2 0 0 0-1.515-1.94l-4-1A2 2 0 0 0 11 4.561z",key:"au4z13"}],["path",{d:"M11 4H8a2 2 0 0 0-2 2v14",key:"74r1mk"}],["path",{d:"M14 12h.01",key:"1jfl7z"}],["path",{d:"M22 20h-3",key:"vhrsz"}]],fN=Ie("door-open",dN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hN=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],pm=Ie("external-link",hN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pN=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M3 19a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8.5a.5.5 0 0 0-.769-.422l-4.462 2.844A.5.5 0 0 1 15 10.5v-2a.5.5 0 0 0-.769-.422L9.77 10.922A.5.5 0 0 1 9 10.5V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2z",key:"1iv0i2"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],br=Ie("factory",pN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xN=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],xm=Ie("file-spreadsheet",xN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mN=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ff=Ie("file-text",mN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gN=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Pf=Ie("funnel",gN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],yN=Ie("gauge",vN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],R0=Ie("git-branch",wN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],bN=Ie("globe",kN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],SN=Ie("graduation-cap",EN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=[["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["rect",{x:"2",y:"15",width:"20",height:"4",rx:"1",key:"g3x8cw"}]],CN=Ie("hard-hat",NN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _N=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],TN=Ie("heart",_N);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jN=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Fy=Ie("house",jN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Df=Ie("info",AN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FN=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],PN=Ie("layout-dashboard",FN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DN=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ft=Ie("loader-circle",DN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ON=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],RN=Ie("log-out",ON);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IN=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],LN=Ie("map-pin",IN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MN=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],BN=Ie("monitor",MN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UN=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z",key:"1fd625"}]],zN=Ie("octagon-alert",UN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $N=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],rr=Ie("package",$N);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HN=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],VN=Ie("plus",HN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WN=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Zr=Ie("refresh-cw",WN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GN=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],XN=Ie("ruler",GN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qN=[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],QN=Ie("scroll-text",qN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Py=Ie("search",KN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],JN=Ie("settings",YN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],eC=Ie("shield-alert",ZN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tC=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],rC=Ie("shield",tC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aC=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],nC=Ie("sliders-vertical",aC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sC=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],iC=Ie("square-check-big",sC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oC=[["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M21 19a2 2 0 0 1-2 2",key:"1j7049"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M9 3h1",key:"1yesri"}],["path",{d:"M9 21h1",key:"15o7lz"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M21 9v1",key:"mxsmne"}],["path",{d:"M3 14v1",key:"vnatye"}],["path",{d:"M21 14v1",key:"169vum"}]],Dy=Ie("square-dashed",oC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lC=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],rd=Ie("square-pen",lC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cC=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],mm=Ie("square",cC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],dC=Ie("trash-2",uC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fC=[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]],hC=Ie("tree-pine",fC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pC=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Oy=Ie("trending-up",pC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xC=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ad=Ie("triangle-alert",xC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mC=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],nd=Ie("upload",mC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gC=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],vC=Ie("user-check",gC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yC=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],wC=Ie("user-plus",yC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kC=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],bC=Ie("user",kC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EC=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],el=Ie("users",EC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SC=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],Of=Ie("wrench",SC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NC=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],co=Ie("x",NC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CC=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Rf=Ie("zap",CC);function Ry(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=Ry(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function _C(){for(var e,t,r=0,a="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=Ry(e))&&(a&&(a+=" "),a+=t);return a}function Ks(...e){return _C(e)}function TC({onLogout:e,userName:t,factories:r,selectedFactory:a,onFactoryChange:n,factoryCode:s,navigate:o}){const[l,c]=D.useState(!1),[u,d]=D.useState(!1),f=()=>{c(!l)},h=()=>{d(!u)},p=["FPC","FPL","FSP","CXM","CXF","CXE","CXD","CXC","CXB","EXT","MNT","RTP","ITC"],x=g=>{let y=g;if(!g&&r&&r.includes("CX"))y="CX";else if(!g){for(const v of p)if(r&&r.includes(v)){y=v;break}!y&&r&&r.length>0&&(y=r[0])}n&&y&&n(y),y?localStorage.setItem("selectedFactory",y):localStorage.removeItem("selectedFactory"),window.dispatchEvent(new CustomEvent("factoryChanged",{detail:{factory:y}})),d(!1)},m=g=>({CXB:"",CXC:"",CXD:"",CXE:"",CXF:"",CXM:"",EXT:"",FSP:"",FPC:"",FPL:"",MNT:"",RTP:"",ITC:""})[g]||"",w=async()=>{c(!1),e&&await e()};return i.jsx("header",{className:"sticky top-0 z-40 h-16 bg-gray-800 border-b border-gray-700 shadow-sm",children:i.jsxs("div",{className:"flex items-center justify-between h-full px-4 sm:px-6 lg:px-8",children:[i.jsxs("div",{className:"flex items-center gap-6",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 100 100",fill:"none",className:"flex-shrink-0",children:[i.jsx("rect",{width:"100",height:"100",rx:"15",fill:"#2563eb"}),i.jsx("path",{d:"M30 70L50 30L70 70H30Z",fill:"white",stroke:"white",strokeWidth:"4"}),i.jsx("circle",{cx:"50",cy:"50",r:"8",fill:"white"})]}),i.jsx("span",{className:"text-xl font-bold text-white",children:"Auriga"})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:h,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-700 hover:bg-gray-600 transition-colors",children:[i.jsx(br,{size:18,className:"text-blue-400"}),i.jsx("span",{className:"text-sm font-medium text-white",children:a?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"mr-1",children:m(a)}),a]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"mr-1",children:""}),"Todas"]})}),i.jsx(Fl,{size:16,className:`text-gray-400 transition-transform ${u?"rotate-180":""}`})]}),u&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>d(!1)}),i.jsxs("div",{className:"absolute left-0 mt-2 w-72 bg-gray-800 rounded-lg shadow-xl border border-gray-700 z-50 max-h-96 overflow-y-auto",children:[i.jsx("div",{className:"p-3 border-b border-gray-700",children:i.jsx("p",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Seleccionar Fbrica"})}),r&&r.includes("CX")&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"p-2",children:i.jsxs("button",{onClick:()=>x(null),className:Ks("w-full flex items-center gap-3 px-3 py-2 rounded-md transition-all text-sm",a?"text-gray-300 hover:bg-gray-700 hover:text-white":"bg-blue-600 text-white"),children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"font-medium",children:"Todas las Fbricas"})]})}),i.jsx("div",{className:"h-px bg-gray-700 mx-2"})]}),i.jsx("div",{className:"p-2 space-y-1",children:r&&r.length>0?(()=>[...r].sort((y,v)=>{const k=p.indexOf(y),_=p.indexOf(v);return k!==-1&&_!==-1?k-_:k!==-1?-1:_!==-1?1:y.localeCompare(v)}).map(y=>i.jsxs("button",{onClick:()=>x(y),className:Ks("w-full flex items-center gap-3 px-3 py-2 rounded-md transition-all text-sm",a===y?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"),children:[i.jsx("span",{className:"text-lg",children:m(y)}),i.jsx("span",{children:y})]},y)))():i.jsx("div",{className:"px-3 py-4 text-xs text-gray-500 text-center",children:"Cargando fbricas..."})})]})]})]})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:f,className:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-semibold text-sm",children:(t==null?void 0:t.charAt(0).toUpperCase())||"U"}),i.jsx("span",{className:"text-sm font-medium text-gray-100 hidden sm:block",children:t}),i.jsx(Fl,{size:16,className:`text-gray-400 transition-transform ${l?"rotate-180":""}`})]}),l&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>c(!1)}),i.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-gray-800 rounded-lg shadow-xl border border-gray-700 z-50",children:[i.jsxs("div",{className:"p-4 border-b border-gray-700",children:[i.jsx("p",{className:"text-sm font-semibold text-white",children:t}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Usuario del Sistema"})]}),i.jsx("div",{className:"p-2",children:i.jsxs("button",{onClick:w,className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white rounded-md transition-colors",children:[i.jsx(RN,{size:18}),"Cerrar Sesin"]})})]})]})]})]})})}function jC({selectedFactory:e,factoryCode:t,isVisible:r=!0}){const[a,n]=D.useState({}),s=l=>{n(c=>({...c,[l]:!c[l]}))},o=[{name:"Dashboard",path:"/dashboard",icon:PN},{name:"Production Management",icon:rr,submenu:[{name:"Manufacturing Orders",path:"/ordenes-fabricacion",icon:rr},{name:"Scheduling",path:"/programacion",icon:O0},{name:"OEE and Metrics",path:"/oee-metricas",icon:GS},{name:"Materials and Consumables",path:"/materiales-consumos",icon:Dy},{name:"Batches and Traceability",path:"/lotes-trazabilidad",icon:Py}]},{name:"Asset Management",icon:br,submenu:[{name:"Hierarchy of Assets",path:"/jerarquia-activos",icon:hC},{name:"Production Lines",path:"/lineas",icon:br},{name:"Status and Availability",path:"/estados-disponibilidad",icon:Rf},{name:"Technical Specifications",path:"/especificaciones-tecnicas",icon:Ff}]},{name:"People Management",icon:el,submenu:[{name:"Shifts",path:"/turnos",icon:ms},{name:"Employees",path:"/empleados",icon:vC},{name:"Assigned Shifts",path:"/turnos-asignados",icon:HS},{name:"Work Schedules",path:"/horarios-trabajo",icon:ms},{name:"Attendance",path:"/asistencia",icon:sN},{name:"Assignments",path:"/asignaciones",icon:wC},{name:"Special Outings",path:"/salidas-especiales",icon:fN},{name:"Evaluations",path:"/evaluaciones",icon:iC}]},{name:"Process Management",icon:R0,submenu:[{name:"Process Master Data",path:"/datos-maestros-procesos",icon:lN},{name:"Process Parameters",path:"/parametros-procesos",icon:nC},{name:"BOM and Routes",path:"/bom-rutas",icon:R0},{name:"Work Instructions",path:"/instrucciones-trabajo",icon:LS},{name:"Process Control",path:"/control-proceso",icon:yN}]},{name:"Quality Management",icon:fm,submenu:[{name:"Inspection Plans",path:"/planes-inspeccion",icon:ws},{name:"Quality Characteristics",path:"/caracteristicas-calidad",icon:ws},{name:"Defects and Nonconformities",path:"/defectos",icon:ad},{name:"Statistical Process Control",path:"/control-estadistico",icon:Oy},{name:"Corrective Actions",path:"/acciones-correctivas",icon:ad},{name:"Certificates and Compliance",path:"/certificados",icon:fm}]},{name:"Prevention and Safety",icon:eC,submenu:[{name:"Risks and Hazards",path:"/riesgos",icon:ad},{name:"Safety Inspections",path:"/inspecciones-seguridad",icon:QN},{name:"Accidents and Incidents",path:"/accidentes",icon:zN},{name:"Training",path:"/capacitaciones",icon:SN},{name:"Personal Protective Equipment (PPE)",path:"/epp",icon:CN},{name:"Occupational Health",path:"/salud-ocupacional",icon:TN}]},{name:"General Configuration",icon:JN,submenu:[{name:"Company Information",path:"/config-empresa",icon:BS},{name:"Plants and Locations",path:"/config-plantas",icon:LN},{name:"Work Calendar",path:"/config-calendario",icon:O0},{name:"Shift Definition",path:"/config-turnos",icon:ms},{name:"Time Zones",path:"/config-zonas-horarias",icon:bN},{name:"Units of Measurement",path:"/config-unidades",icon:XN},{name:"Currencies",path:"/config-monedas",icon:uN},{name:"Automated Processes",path:"/procesos-automaticos",icon:Zr}]},{name:"System",icon:rC,submenu:[{name:"Monitor",path:"/seguridad",icon:BN},{name:"Users",path:"/usuarios",icon:bC}]}];return i.jsx("aside",{className:"w-64 bg-gray-800 border-r border-gray-700 flex flex-col h-full",children:i.jsx("nav",{className:"flex-1 px-3 py-4 space-y-1 overflow-y-auto",children:o.map(l=>{const c=l.icon,u=a[l.name];return l.submenu?i.jsxs("div",{children:[i.jsxs("button",{onClick:()=>s(l.name),className:Ks("w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all text-sm font-medium","text-gray-300 hover:bg-gray-700 hover:text-white"),children:[i.jsx(c,{size:18}),i.jsx("span",{className:"flex-1 text-left",children:l.name}),u?i.jsx(Fl,{size:16,className:"text-gray-400"}):i.jsx(ba,{size:16,className:"text-gray-400"})]}),u&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:l.submenu.map(d=>{const f=d.icon;return i.jsxs(cm,{to:d.path,className:({isActive:h})=>Ks("flex items-center gap-3 px-3 py-2 rounded-lg transition-all text-xs font-medium",h?"bg-blue-600 text-white":"text-gray-400 hover:bg-gray-700 hover:text-white"),children:[i.jsx(f,{size:16}),i.jsx("span",{className:"truncate",children:d.name})]},d.path)})})]},l.name):i.jsx(cm,{to:l.path,className:({isActive:d})=>Ks("flex items-center gap-3 px-3 py-2 rounded-lg transition-all text-sm font-medium",d?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"),children:({isActive:d})=>i.jsxs(i.Fragment,{children:[i.jsx(c,{size:18}),i.jsx("span",{children:l.name}),d&&i.jsx(ba,{size:16,className:"ml-auto"})]})},l.path)})})})}function AC({children:e,onLogout:t,userName:r,factories:a,selectedFactory:n,onFactoryChange:s,factoryCode:o,navigate:l}){const[c,u]=D.useState(()=>{const f=localStorage.getItem("sidebarVisible");return f!==null?f==="true":!0});D.useEffect(()=>{localStorage.setItem("sidebarVisible",c.toString())},[c]);const d=D.useCallback(()=>{u(f=>!f)},[]);return D.useEffect(()=>{const f=h=>{(h.ctrlKey||h.metaKey)&&h.key==="b"&&(h.preventDefault(),d())};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[d]),i.jsxs("div",{className:"min-h-screen bg-gray-900 flex flex-col",children:[i.jsx(TC,{onLogout:t,userName:r,factories:a,selectedFactory:n,onFactoryChange:s,factoryCode:o,navigate:l}),i.jsxs("div",{className:"flex-1 flex relative",children:[i.jsx("button",{onClick:d,className:`absolute top-4 z-50 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-r-lg p-2.5 shadow-lg transition-all duration-300 hover:scale-105 ${c?"left-64":"left-0"}`,title:c?"Ocultar men (Ctrl+B)":"Mostrar men (Ctrl+B)","aria-label":c?"Ocultar men":"Mostrar men",children:c?i.jsx(QS,{size:18,className:"text-gray-300"}):i.jsx(ba,{size:18,className:"text-gray-300"})}),i.jsx("div",{className:`transition-all duration-300 ease-in-out flex-shrink-0 ${c?"w-64":"w-0"} overflow-hidden`,children:i.jsx(jC,{selectedFactory:n,factoryCode:o,isVisible:c})}),i.jsx("main",{className:"flex-1 overflow-auto",children:e})]})]})}const xu=()=>{const[e,t]=D.useState({isAuthenticated:!1,user:null,serverAuth:null,apiUserData:null,isLoading:!0,error:null});return D.useEffect(()=>{(async()=>{try{const a=await Zh();if(a.authenticated){const n=await ES();t({isAuthenticated:!0,user:a.user||kS(),serverAuth:a,apiUserData:n,isLoading:!1,error:null})}else t({isAuthenticated:!1,user:null,serverAuth:a,apiUserData:null,isLoading:!1,error:a.message||"Not authenticated"})}catch(a){console.error("Auth check error:",a),t({isAuthenticated:!1,user:null,serverAuth:null,apiUserData:null,isLoading:!1,error:a.message})}})()},[]),e},FC=(e,t="cx-auriga")=>new Promise((r,a)=>{try{const s=`${e.endsWith("/")?e.slice(0,-1):e}/application/o/${t}/end-session/`;console.log(" [forceAuthentikLogout] Forzando logout de Authentik:",s);const o=document.createElement("iframe");o.style.display="none",o.style.width="0",o.style.height="0",o.style.border="none",o.style.position="absolute",o.style.top="-9999px",o.src=s,o.onload=()=>{console.log(" [forceAuthentikLogout] Iframe de logout cargado"),setTimeout(()=>{document.body.removeChild(o),console.log(" [forceAuthentikLogout] Logout de Authentik forzado"),r()},500)},o.onerror=l=>{console.warn(" [forceAuthentikLogout] Error al cargar iframe de logout:",l),document.body.removeChild(o),r()},document.body.appendChild(o),setTimeout(()=>{document.body.contains(o)&&document.body.removeChild(o),console.log(" [forceAuthentikLogout] Timeout alcanzado, continuando"),r()},2e3)}catch(n){console.error(" [forceAuthentikLogout] Error:",n),a(n)}}),PC=()=>{var n,s,o,l,c,u;const{t:e}=He(),[t,r]=D.useState(null);D.useEffect(()=>{var x,m;const d=new URLSearchParams(window.location.search),f=d.get("error"),h=d.get("message"),p=d.get("_logout_complete")==="1";if(f==="account_disabled")console.log(" [Login] Error de cuenta deshabilitada detectado"),console.log(p?" [Login] Logout de Authentik completado, limpiando todo...":" [Login] Limpiando todo..."),Zo().then(()=>{console.log(" [Login] Limpieza completa finalizada"),p&&console.log(" [Login] Sesin de Authentik cerrada y limpieza completada")}).catch(w=>{console.error(" [Login] Error en limpieza:",w)}),r(h?decodeURIComponent(h):((x=e.errors)==null?void 0:x.accountDisabled)||"Tu cuenta ha sido deshabilitada. Por favor, contacta a tu administrador.");else if(f==="code_expired")Zo().catch(w=>{console.error(" [Login] Error en limpieza:",w)}),r(((m=e.errors)==null?void 0:m.codeExpired)||"El cdigo de autorizacin ha expirado. Por favor, intenta iniciar sesin nuevamente.");else if(h)try{r(decodeURIComponent(h))}catch{r(h)}else document.cookie.includes("session_active=true")&&(window.location.href="/dashboard");(f||h)&&window.history.replaceState({},document.title,window.location.pathname)},[e]);const a=async()=>{var w;typeof console<"u"&&typeof console.log=="function"&&console.log(" [Login] Botn de login presionado");const d=!!t,h=new URLSearchParams(window.location.search).get("_cleared")==="1",p=d||h;if(d){console.log(" [Login] Limpiando todo antes de nuevo intento de login..."),console.log(" [Login] Estado ANTES de limpieza - Cookies:",document.cookie);try{await Zo(),console.log(" [Login] Limpieza completa antes de redirigir"),console.log(" [Login] Estado DESPUS de limpieza - Cookies:",document.cookie);const g="http://18.232.248.24:38006";console.log(" [Login] Forzando logout de Authentik desde frontend...");try{await FC(g,"cx-auriga"),console.log(" [Login] Logout de Authentik forzado desde frontend")}catch(y){console.warn(" [Login] Error al forzar logout de Authentik:",y)}await new Promise(y=>setTimeout(y,500))}catch(g){console.error(" [Login] Error en limpieza:",g)}}r(null);const x=window.location.hostname;let m=x==="18.213.58.26"?"http://18.213.58.26:8081/auth/login":"http://localhost:8081/auth/login";p&&(m+="?force_new_login=true",console.log(" [Login] Agregando force_new_login=true para forzar nuevo login")),typeof console<"u"&&typeof console.log=="function"&&(console.log(" [Login] Redirigiendo a:",m),console.log(" [Login] Hostname detectado:",x),console.log(" [Login] force_new_login:",p),console.log(" [Login] Estado final - Cookies:",document.cookie),console.log(" [Login] Estado final - localStorage:",Object.keys(localStorage).length,"items"),console.log(" [Login] Estado final - sessionStorage:",Object.keys(sessionStorage).length,"items"));try{const g=`${m}${m.includes("?")?"&":"?"}_t=${Date.now()}&_nocache=1`;window.location.replace(g),typeof console<"u"&&typeof console.log=="function"&&console.log(" [Login] Redireccin iniciada")}catch(g){typeof console<"u"&&typeof console.error=="function"&&console.error(" [Login] Error al redirigir:",g),alert(((w=e.errors)==null?void 0:w.accessDenied)||"Error al redirigir. Por favor, intntalo de nuevo.")}};return i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:i.jsxs("div",{style:{background:"white",borderRadius:"10px",padding:"40px",boxShadow:"0 10px 40px rgba(0,0,0,0.2)",maxWidth:"450px",width:"100%",textAlign:"center"},children:[i.jsx("h1",{style:{marginBottom:"10px",color:"#333",fontSize:"28px",fontWeight:"bold"},children:((n=e.login)==null?void 0:n.title)||"Iniciar Sesin"}),i.jsx("p",{style:{marginBottom:"30px",color:"#666",fontSize:"16px"},children:((s=e.login)==null?void 0:s.subtitle)||"Accede a tu cuenta"}),t&&i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",padding:"15px",marginBottom:"20px",backgroundColor:"#fff3cd",border:"1px solid #ffc107",borderRadius:"8px",color:"#856404",textAlign:"left"},children:[i.jsx("div",{style:{fontSize:"24px",marginRight:"12px",flexShrink:0},children:""}),i.jsxs("div",{style:{flex:1},children:[i.jsx("strong",{style:{display:"block",marginBottom:"5px",fontSize:"14px"},children:((o=e.errors)==null?void 0:o.authenticationError)||"Error de Autenticacin"}),i.jsx("p",{style:{margin:0,fontSize:"13px",lineHeight:"1.4",marginBottom:"10px"},children:t}),i.jsx("p",{style:{margin:0,fontSize:"12px",fontStyle:"italic",color:"#856404"},children:((l=e.login)==null?void 0:l.tryAnotherUser)||"Puedes intentar iniciar sesin con otro usuario haciendo clic en el botn de abajo."})]})]}),i.jsx("button",{onClick:a,style:{width:"100%",padding:"15px",background:t?"#28a745":"#667eea",color:"white",border:"none",borderRadius:"5px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",transition:"background 0.3s",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",marginBottom:"10px"},onMouseOver:d=>d.target.style.background=t?"#218838":"#5568d3",onMouseOut:d=>d.target.style.background=t?"#28a745":"#667eea",children:t?((c=e.login)==null?void 0:c.tryAgain)||"Intentar con Otro Usuario":((u=e.login)==null?void 0:u.button)||"Iniciar Sesin con Authentik"})]})})},vi={}.VITE_API_URL||"/api",Pc=()=>{const e=document.cookie.split(";");for(let t of e){const[r,a]=t.trim().split("=");if(r==="auth_token"&&a)return a}return null},Ye={async get(e,t={}){try{const r=Pc(),a={...t.headers};r&&(a.Authorization=`Bearer ${r}`);const n=await fetch(`${vi}${e}`,{...t,method:"GET",headers:a,credentials:"include"});if(n.status===401){if(window._redirectingToLogin)throw new Error("Unauthorized - Sesin expirada");window._redirectingToLogin=!0;try{if(!(await fetch(`${vi}/api/auth/check`,{credentials:"include"})).ok)throw console.warn(" Sesin expirada, redirigiendo a login..."),setTimeout(()=>{window.location.href="/login"},500),new Error("Unauthorized - Sesin expirada")}catch{throw console.warn(" Error verificando autenticacin, redirigiendo a login..."),setTimeout(()=>{window.location.href="/login"},500),new Error("Unauthorized - Sesin expirada")}throw console.warn(" Sesin vlida pero recibiendo 401 - puede ser un problema de permisos"),new Error(`HTTP error! status: ${n.status}`)}if(!n.ok){let o=`HTTP error! status: ${n.status}`,l=null;try{const u=await n.text();if(u)try{l=JSON.parse(u),l.message?o=l.message:l.error&&(o=l.error)}catch{o=u||o}}catch{}const c=new Error(o);throw c.status=n.status,c.response={status:n.status,data:l},c}return await n.json()}catch(r){throw e.includes("/sap/orderConsump/add")?console.warn(` El backend no pudo procesar ${e} (esto es esperado por ahora):`,r.message):console.error(`Error en GET ${e}:`,r),r}},async post(e,t,r={}){try{const a=Pc(),n={"Content-Type":"application/json",...r.headers};a&&(n.Authorization=`Bearer ${a}`);const s=await fetch(`${vi}${e}`,{...r,method:"POST",headers:n,credentials:"include",body:JSON.stringify(t)});if(s.status===401){if(window._redirectingToLogin)throw new Error("Unauthorized - Sesin expirada");window._redirectingToLogin=!0;try{if(!(await fetch(`${vi}/api/auth/check`,{credentials:"include"})).ok)throw console.warn(" Sesin expirada, redirigiendo a login..."),setTimeout(()=>{window.location.href="/login"},500),new Error("Unauthorized - Sesin expirada")}catch{throw console.warn(" Error verificando autenticacin, redirigiendo a login..."),setTimeout(()=>{window.location.href="/login"},500),new Error("Unauthorized - Sesin expirada")}throw new Error(`HTTP error! status: ${s.status}`)}if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(a){throw console.error(`Error en POST ${e}:`,a),a}},async put(e,t,r={}){try{const a=Pc(),n={"Content-Type":"application/json",...r.headers};a&&(n.Authorization=`Bearer ${a}`);const s=await fetch(`${vi}${e}`,{...r,method:"PUT",headers:n,credentials:"include",body:JSON.stringify(t)});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(a){throw console.error(`Error en PUT ${e}:`,a),a}},async delete(e,t={}){try{const r=Pc(),a={...t.headers};r&&(a.Authorization=`Bearer ${r}`);const n=await fetch(`${vi}${e}`,{...t,method:"DELETE",headers:a,credentials:"include"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return await n.json()}catch(r){throw console.error(`Error en DELETE ${e}:`,r),r}}};class DC{async getProductionLinesStats(t=null){try{let a=await Ye.get("/asset/list")||[];t&&(a=a.filter(s=>{var o,l;return((o=s.location)==null?void 0:o.includes(t))||((l=s.hierarchical_level)==null?void 0:l[0])===t||s.factory===t}));const n=a.filter(s=>{var o;return s.hierarchical_level&&s.hierarchical_level.length>=2&&((o=s.hierarchical_level[1])==null?void 0:o.startsWith("L"))});return{total:n.length,operativas:0,mantenimiento:0,indisponibles:0,lines:n}}catch(r){return console.error("Error getting production lines stats:",r),{total:0,operativas:0,mantenimiento:0,indisponibles:0,lines:[]}}}async getEmployeesStats(t=null){try{return{total:0,porTurno:{manana:0,tarde:0,noche:0}}}catch(r){return console.error("Error getting employees stats:",r),{total:0,porTurno:{manana:0,tarde:0,noche:0}}}}async getAssets(t=null){try{let r=await Ye.get("/asset/list")||[];return t&&(r=r.filter(a=>{var n,s;return((n=a.location)==null?void 0:n.includes(t))||((s=a.hierarchical_level)==null?void 0:s[0])===t||a.factory===t})),r}catch(r){return console.error("Error getting assets:",r),[]}}async getGeneralStats(t=null){try{const[r,a]=await Promise.all([this.getProductionLinesStats(t),this.getEmployeesStats(t)]);return{productionLines:r,employees:a}}catch(r){return console.error("Error getting general stats:",r),{productionLines:{total:0,operativas:0,mantenimiento:0,indisponibles:0},employees:{total:0,porTurno:{manana:0,tarde:0,noche:0}}}}}}const OC=new DC,RC=()=>{var w,g,y,v,k,_,F,b,S,C,B,T,U,K,de,oe,ge,Z,se,z,xe,be,O,J,W,V,le,we,R,X,q,ce,P,Se,Ce,Te,fe,ve,ze,Ze,dt,Wt,_r,Yt,Et,sr;const e=xu(),{isLoading:t,error:r}=e,{permissions:a,checkPermission:n,checkFactoryAccess:s,checkRole:o,checkGroup:l}=yo(),{t:c}=He(),u=D.useMemo(()=>{const Pe=localStorage.getItem("selectedFactory");return Pe&&Pe!=="CX"?Pe:null},[]),[d,f]=D.useState(null),[h,p]=D.useState(!0);D.useEffect(()=>{(async()=>{try{p(!0);const jt=await OC.getGeneralStats(u);f(jt)}catch(jt){console.error("Error loading stats:",jt)}finally{p(!1)}})()},[u]);const x=D.useMemo(()=>{var jt,ot,wt,Ge,ct,Lt,ht,Tr,Na,la,fn,Qr,Ga,Kr,Ca,pt,Mt,Xa,qa,Qa,hr,Yr,hn,pn,xn,_a,ca,mn,gn,E,I,j,A,L,M,re,ue,te,ae,ne,ye,_e,Fe,Ee,je,Ue,N;if(!a)return{};const Pe={general:[],productive:[],people:[],quality:[],processes:[],assets:[],safety:[],configuration:[],administration:[],mobile:[]};return Pe.general.push({path:"/dashboard",label:((jt=c.dashboard)==null?void 0:jt.title)||"Dashboard",icon:"",available:!0}),Pe.general.push({path:"/profile",label:((ot=c.common)==null?void 0:ot.profile)||"Perfil",icon:"",available:!0}),(o("Manager")||o("Supervisor")||o("Planner"))&&(Pe.productive.push({path:"/ordenes-fabricacion",label:((wt=c.navigation)==null?void 0:wt.orders)||"rdenes de Fabricacin",icon:"",available:!0}),Pe.productive.push({path:"/programacion",label:((Ge=c.navigation)==null?void 0:Ge.scheduling)||"Programacin",icon:"",available:!0}),Pe.productive.push({path:"/oee-metricas",label:((ct=c.navigation)==null?void 0:ct.oee)||"Mtricas OEE",icon:"",available:!0}),Pe.productive.push({path:"/materiales-consumos",label:((Lt=c.navigation)==null?void 0:Lt.materials)||"Materiales y Consumos",icon:"",available:!0}),Pe.productive.push({path:"/lotes-trazabilidad",label:((ht=c.navigation)==null?void 0:ht.traceability)||"Lotes y Trazabilidad",icon:"",available:!0})),(o("Manager")||o("Supervisor"))&&(Pe.people.push({path:"/turnos",label:((Tr=c.navigation)==null?void 0:Tr.shifts)||"Turnos",icon:"",available:!0}),Pe.people.push({path:"/empleados",label:((Na=c.navigation)==null?void 0:Na.employees)||"Empleados",icon:"",available:!0}),Pe.people.push({path:"/turnos-asignados",label:((la=c.navigation)==null?void 0:la.assignedShifts)||"Turnos Asignados",icon:"",available:!0}),Pe.people.push({path:"/horarios-trabajo",label:((fn=c.navigation)==null?void 0:fn.workSchedules)||"Horarios de Trabajo",icon:"",available:!0}),Pe.people.push({path:"/asistencia",label:((Qr=c.navigation)==null?void 0:Qr.attendance)||"Asistencia",icon:"",available:!0}),Pe.people.push({path:"/asignaciones",label:((Ga=c.navigation)==null?void 0:Ga.assignments)||"Asignaciones",icon:"",available:!0})),(n({department:"Quality",role:"Supervisor"})||n({department:"Quality",role:"Manager"})||n({department:"Quality",role:"Admin"}))&&(Pe.quality.push({path:"/planes-inspeccion",label:((Kr=c.navigation)==null?void 0:Kr.inspectionPlans)||"Planes de Inspeccin",icon:"",available:!0}),Pe.quality.push({path:"/registros-autocontrol",label:((Ca=c.navigation)==null?void 0:Ca.selfControl)||"Registros de Autocontrol",icon:"",available:!0}),Pe.quality.push({path:"/caracteristicas-calidad",label:((pt=c.navigation)==null?void 0:pt.qualityCharacteristics)||"Caractersticas de Calidad",icon:"",available:!0}),Pe.quality.push({path:"/defectos",label:((Mt=c.navigation)==null?void 0:Mt.defects)||"Defectos",icon:"",available:!0}),Pe.quality.push({path:"/control-estadistico",label:((Xa=c.navigation)==null?void 0:Xa.statisticalControl)||"Control Estadstico",icon:"",available:!0}),Pe.quality.push({path:"/acciones-correctivas",label:((qa=c.navigation)==null?void 0:qa.correctiveActions)||"Acciones Correctivas",icon:"",available:!0}),Pe.quality.push({path:"/certificados",label:((Qa=c.navigation)==null?void 0:Qa.certificates)||"Certificados",icon:"",available:!0})),(o("Manager")||o("Supervisor")||o("Planner"))&&(Pe.processes.push({path:"/datos-maestros-procesos",label:((hr=c.navigation)==null?void 0:hr.masterData)||"Datos Maestros de Procesos",icon:"",available:!0}),Pe.processes.push({path:"/parametros-procesos",label:((Yr=c.navigation)==null?void 0:Yr.processParameters)||"Parmetros de Procesos",icon:"",available:!0}),Pe.processes.push({path:"/bom-rutas",label:((hn=c.navigation)==null?void 0:hn.bomRoutes)||"BOM y Rutas",icon:"",available:!0}),Pe.processes.push({path:"/instrucciones-trabajo",label:((pn=c.navigation)==null?void 0:pn.workInstructions)||"Instrucciones de Trabajo",icon:"",available:!0}),Pe.processes.push({path:"/control-proceso",label:((xn=c.navigation)==null?void 0:xn.processControl)||"Control de Proceso",icon:"",available:!0}),Pe.processes.push({path:"/procesos-automaticos",label:((_a=c.navigation)==null?void 0:_a.automaticProcesses)||"Procesos Automticos",icon:"",available:!0})),(o("Manager")||o("Supervisor")||n({department:"Maintenance"}))&&(Pe.assets.push({path:"/jerarquia-activos",label:((ca=c.navigation)==null?void 0:ca.assetHierarchy)||"Jerarqua de Activos",icon:"",available:!0}),Pe.assets.push({path:"/lineas",label:((mn=c.navigation)==null?void 0:mn.lines)||"Lneas",icon:"",available:!0}),Pe.assets.push({path:"/estados-disponibilidad",label:((gn=c.navigation)==null?void 0:gn.availabilityStates)||"Estados de Disponibilidad",icon:"",available:!0}),Pe.assets.push({path:"/especificaciones-tecnicas",label:((E=c.navigation)==null?void 0:E.technicalSpecs)||"Especificaciones Tcnicas",icon:"",available:!0})),(o("Manager")||o("Supervisor"))&&(Pe.safety.push({path:"/riesgos",label:((I=c.navigation)==null?void 0:I.risks)||"Riesgos",icon:"",available:!0}),Pe.safety.push({path:"/inspecciones-seguridad",label:((j=c.navigation)==null?void 0:j.safetyInspections)||"Inspecciones de Seguridad",icon:"",available:!0}),Pe.safety.push({path:"/accidentes",label:((A=c.navigation)==null?void 0:A.accidents)||"Accidentes",icon:"",available:!0}),Pe.safety.push({path:"/capacitaciones",label:((L=c.navigation)==null?void 0:L.trainings)||"Capacitaciones",icon:"",available:!0}),Pe.safety.push({path:"/epp",label:((M=c.navigation)==null?void 0:M.ppe)||"EPP",icon:"",available:!0}),Pe.safety.push({path:"/salud-ocupacional",label:((re=c.navigation)==null?void 0:re.occupationalHealth)||"Salud Ocupacional",icon:"",available:!0})),l("GrAuriga")&&(Pe.configuration.push({path:"/config-empresa",label:((ue=c.navigation)==null?void 0:ue.companyConfig)||"Configuracin de Empresa",icon:"",available:!0}),Pe.configuration.push({path:"/config-plantas",label:((te=c.navigation)==null?void 0:te.plantsConfig)||"Configuracin de Plantas",icon:"",available:!0}),Pe.configuration.push({path:"/config-calendario",label:((ae=c.navigation)==null?void 0:ae.calendarConfig)||"Configuracin de Calendario",icon:"",available:!0}),Pe.configuration.push({path:"/config-turnos",label:((ne=c.navigation)==null?void 0:ne.shiftsConfig)||"Configuracin de Turnos",icon:"",available:!0}),Pe.configuration.push({path:"/config-zonas-horarias",label:((ye=c.navigation)==null?void 0:ye.timezonesConfig)||"Configuracin de Zonas Horarias",icon:"",available:!0}),Pe.configuration.push({path:"/config-unidades",label:((_e=c.navigation)==null?void 0:_e.unitsConfig)||"Configuracin de Unidades",icon:"",available:!0}),Pe.configuration.push({path:"/config-monedas",label:((Fe=c.navigation)==null?void 0:Fe.currenciesConfig)||"Configuracin de Monedas",icon:"",available:!0})),l("GrAuriga")&&(Pe.administration.push({path:"/seguridad",label:((Ee=c.navigation)==null?void 0:Ee.security)||"Seguridad",icon:"",available:!0}),Pe.administration.push({path:"/usuarios",label:((je=c.navigation)==null?void 0:je.users)||"Usuarios",icon:"",available:!0}),Pe.administration.push({path:"/roles-permisos",label:((Ue=c.navigation)==null?void 0:Ue.rolesPermissions)||"Roles y Permisos",icon:"",available:!0})),Pe.mobile.push({path:"/mobile/scan",label:((N=c.navigation)==null?void 0:N.scanQR)||"Escanear QR",icon:"",available:!0}),Pe},[a,n,o,l,c]);if(t)return i.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[i.jsx("div",{style:{border:"4px solid #f3f3f3",borderTop:"4px solid #007bff",borderRadius:"50%",width:"40px",height:"40px",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),i.jsx("p",{children:((w=c.common)==null?void 0:w.loading)||"Cargando..."})]});if(r)return i.jsxs("div",{style:{padding:"20px"},children:[i.jsxs("div",{style:{background:"#f8d7da",color:"#721c24",padding:"15px",borderRadius:"5px",marginBottom:"20px"},children:[i.jsxs("strong",{children:[((g=c.common)==null?void 0:g.error)||"Error",":"]})," ",r]}),i.jsxs("button",{onClick:()=>window.location.href="/login",children:[((y=c.common)==null?void 0:y.back)||"Volver"," / ",((v=c.login)==null?void 0:v.title)||"Login"]})]});const m={general:((_=(k=c.dashboard)==null?void 0:k.categories)==null?void 0:_.general)||"General",productive:((b=(F=c.dashboard)==null?void 0:F.categories)==null?void 0:b.productive)||"Gestin Productiva",people:((C=(S=c.dashboard)==null?void 0:S.categories)==null?void 0:C.people)||"Gestin de Personas",quality:((T=(B=c.dashboard)==null?void 0:B.categories)==null?void 0:T.quality)||"Gestin de Calidad",processes:((K=(U=c.dashboard)==null?void 0:U.categories)==null?void 0:K.processes)||"Gestin de Procesos",assets:((oe=(de=c.dashboard)==null?void 0:de.categories)==null?void 0:oe.assets)||"Gestin de Activos",safety:((Z=(ge=c.dashboard)==null?void 0:ge.categories)==null?void 0:Z.safety)||"Seguridad y Salud",configuration:((z=(se=c.dashboard)==null?void 0:se.categories)==null?void 0:z.configuration)||"Configuracin",administration:((be=(xe=c.dashboard)==null?void 0:xe.categories)==null?void 0:be.administration)||"Administracin",mobile:((J=(O=c.dashboard)==null?void 0:O.categories)==null?void 0:J.mobile)||"Mvil"};return i.jsxs("div",{style:{padding:"20px",maxWidth:"1400px",margin:"0 auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px",paddingBottom:"20px",borderBottom:"2px solid #e0e0e0"},children:[i.jsxs("div",{children:[i.jsx("h1",{style:{margin:0,fontSize:"28px",color:"#333"},children:((W=c.dashboard)==null?void 0:W.title)||"Dashboard"}),(e==null?void 0:e.user)&&i.jsxs("p",{style:{margin:"5px 0 0 0",color:"#666",fontSize:"16px"},children:[((V=c.dashboard)==null?void 0:V.welcome)||"Bienvenido",", ",i.jsx("strong",{children:e.user.name||"Usuario"})]})]}),i.jsx("button",{onClick:ep,style:{background:"#dc3545",color:"white",border:"none",padding:"10px 20px",borderRadius:"5px",cursor:"pointer",fontSize:"14px"},children:((le=c.common)==null?void 0:le.logout)||"Cerrar Sesin"})]}),(e==null?void 0:e.user)&&i.jsx("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"20px",borderRadius:"10px",marginBottom:"30px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"20px"},children:[i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 5px 0",opacity:.9,fontSize:"14px"},children:((we=c.dashboard)==null?void 0:we.email)||"Email"}),i.jsx("p",{style:{margin:0,fontSize:"16px",fontWeight:"bold"},children:e.user.email||"N/A"})]}),((R=a==null?void 0:a.permissions)==null?void 0:R.factories)&&a.permissions.factories.length>0&&i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 5px 0",opacity:.9,fontSize:"14px"},children:((X=c.dashboard)==null?void 0:X.factories)||"Fbricas"}),i.jsxs("p",{style:{margin:0,fontSize:"16px",fontWeight:"bold"},children:[a.permissions.factories.slice(0,5).join(", "),a.permissions.factories.length>5&&` +${a.permissions.factories.length-5}`]})]}),((q=a==null?void 0:a.permissions)==null?void 0:q.roles)&&a.permissions.roles.length>0&&i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 5px 0",opacity:.9,fontSize:"14px"},children:((ce=c.dashboard)==null?void 0:ce.roles)||"Roles"}),i.jsx("p",{style:{margin:0,fontSize:"16px",fontWeight:"bold"},children:a.permissions.roles.join(", ")})]}),((P=a==null?void 0:a.user)==null?void 0:P.groups)&&a.user.groups.length>0&&i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 5px 0",opacity:.9,fontSize:"14px"},children:((Se=c.dashboard)==null?void 0:Se.groups)||"Grupos"}),i.jsx("p",{style:{margin:0,fontSize:"16px",fontWeight:"bold"},children:a.user.groups.join(", ")})]})]})}),!h&&d&&i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsxs("h2",{style:{fontSize:"20px",marginBottom:"15px",color:"#333",paddingBottom:"10px",borderBottom:"2px solid #e0e0e0"},children:[((Ce=c.dashboard)==null?void 0:Ce.statistics)||"Estadsticas",u&&` - ${u}`]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"15px",marginBottom:"20px"},children:[i.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",border:"1px solid #e0e0e0",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[i.jsx(br,{size:24,color:"#3b82f6"}),i.jsx("h3",{style:{margin:0,fontSize:"14px",color:"#666"},children:((Te=c.dashboard)==null?void 0:Te.totalLines)||"Lneas Totales"})]}),i.jsx("p",{style:{margin:0,fontSize:"28px",fontWeight:"bold",color:"#333"},children:((fe=d==null?void 0:d.productionLines)==null?void 0:fe.total)||0})]}),i.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",border:"1px solid #e0e0e0",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[i.jsx(ZS,{size:24,color:"#10b981"}),i.jsx("h3",{style:{margin:0,fontSize:"14px",color:"#666"},children:((ve=c.dashboard)==null?void 0:ve.operationalLines)||"Lneas Operativas"})]}),i.jsx("p",{style:{margin:0,fontSize:"28px",fontWeight:"bold",color:"#333"},children:((ze=d==null?void 0:d.productionLines)==null?void 0:ze.operativas)||0})]}),i.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",border:"1px solid #e0e0e0",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[i.jsx(Of,{size:24,color:"#f59e0b"}),i.jsx("h3",{style:{margin:0,fontSize:"14px",color:"#666"},children:((Ze=c.dashboard)==null?void 0:Ze.maintenanceLines)||"En Mantenimiento"})]}),i.jsx("p",{style:{margin:0,fontSize:"28px",fontWeight:"bold",color:"#333"},children:((dt=d==null?void 0:d.productionLines)==null?void 0:dt.mantenimiento)||0})]}),i.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",border:"1px solid #e0e0e0",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[i.jsx(La,{size:24,color:"#ef4444"}),i.jsx("h3",{style:{margin:0,fontSize:"14px",color:"#666"},children:((Wt=c.dashboard)==null?void 0:Wt.unavailableLines)||"Indisponibles"})]}),i.jsx("p",{style:{margin:0,fontSize:"28px",fontWeight:"bold",color:"#333"},children:((_r=d==null?void 0:d.productionLines)==null?void 0:_r.indisponibles)||0})]}),i.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",border:"1px solid #e0e0e0",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[i.jsx(el,{size:24,color:"#8b5cf6"}),i.jsx("h3",{style:{margin:0,fontSize:"14px",color:"#666"},children:((Yt=c.dashboard)==null?void 0:Yt.totalEmployees)||"Total Empleados"})]}),i.jsx("p",{style:{margin:0,fontSize:"28px",fontWeight:"bold",color:"#333"},children:((Et=d==null?void 0:d.employees)==null?void 0:Et.total)||0})]})]})]}),Object.entries(x).map(([Pe,jt])=>!jt||jt.length===0?null:i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsx("h2",{style:{fontSize:"20px",marginBottom:"15px",color:"#333",paddingBottom:"10px",borderBottom:"2px solid #e0e0e0"},children:m[Pe]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"15px"},children:jt.map(ot=>i.jsxs(Ty,{to:ot.path,style:{display:"flex",alignItems:"center",gap:"12px",padding:"15px",background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",textDecoration:"none",color:"#333",transition:"all 0.3s ease",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},onMouseEnter:wt=>{wt.currentTarget.style.transform="translateY(-2px)",wt.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.1)"},onMouseLeave:wt=>{wt.currentTarget.style.transform="translateY(0)",wt.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.05)"},children:[i.jsx("span",{style:{fontSize:"24px"},children:ot.icon}),i.jsx("span",{style:{fontSize:"14px",fontWeight:"500"},children:ot.label})]},ot.path))})]},Pe)),Object.values(x).every(Pe=>!Pe||Pe.length===0)&&i.jsx("div",{style:{background:"#fff3cd",padding:"20px",borderRadius:"5px",textAlign:"center"},children:i.jsx("p",{style:{margin:0,color:"#856404"},children:((sr=c.dashboard)==null?void 0:sr.noAccess)||"No tienes acceso a ninguna seccin."})}),i.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `})]})},IC=()=>{var a,n,s,o,l,c,u,d,f,h;const e=xu(),{permissions:t}=yo(),{t:r}=He();return e.isLoading?i.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[i.jsx("div",{style:{border:"4px solid #f3f3f3",borderTop:"4px solid #007bff",borderRadius:"50%",width:"40px",height:"40px",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),i.jsx("p",{children:((a=r.common)==null?void 0:a.loading)||"Cargando..."})]}):i.jsxs("div",{style:{padding:"20px",maxWidth:"800px",margin:"0 auto"},children:[i.jsx("h1",{style:{marginBottom:"20px"},children:"Perfil de Usuario"}),(e==null?void 0:e.user)&&i.jsxs("div",{style:{background:"#e8f5e8",padding:"20px",borderRadius:"8px",marginBottom:"20px"},children:[i.jsx("h2",{style:{marginBottom:"15px"},children:e.user.name||"Usuario"}),i.jsxs("p",{children:[i.jsx("strong",{children:"Email:"})," ",e.user.email||"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"ID:"})," ",e.user.id||"N/A"]})]}),t&&t.organization&&i.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"20px"},children:[i.jsx("h3",{style:{marginBottom:"15px"},children:"Informacin de Organizacin"}),i.jsxs("p",{children:[i.jsx("strong",{children:"Organizacin:"})," ",t.organization.name||"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Departamento:"})," ",t.organization.departamento||"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Cargo:"})," ",t.organization.cargo||"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Estado:"})," ",t.organization.status||"N/A"]})]}),t&&i.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",marginBottom:"20px"},children:[i.jsx("h3",{style:{marginBottom:"15px"},children:"Permisos y Accesos"}),i.jsxs("p",{children:[i.jsx("strong",{children:"Fbricas:"})," ",((s=(n=t.permissions)==null?void 0:n.factories)==null?void 0:s.join(", "))||"Ninguna"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Roles:"})," ",((l=(o=t.permissions)==null?void 0:o.roles)==null?void 0:l.join(", "))||"Ninguno"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Departamentos:"})," ",((u=(c=t.permissions)==null?void 0:c.departments)==null?void 0:u.join(", "))||"Ninguno"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Grupos:"})," ",((f=(d=t.user)==null?void 0:d.groups)==null?void 0:f.join(", "))||"Ninguno"]})]}),i.jsx("div",{style:{marginTop:"20px"},children:i.jsx("button",{onClick:ep,style:{background:"#dc3545",color:"white",border:"none",padding:"10px 20px",borderRadius:"5px",cursor:"pointer"},children:((h=r.common)==null?void 0:h.logout)||"Cerrar Sesin"})}),i.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `})]})};function $e({className:e="",children:t,...r}){return i.jsx("div",{className:Ks("bg-gray-800 rounded-2xl shadow-lg border border-gray-700",e),...r,children:t})}function St({className:e="",children:t,...r}){return i.jsx("span",{className:Ks("inline-flex items-center gap-1 text-xs font-medium px-2 py-1 rounded-full",e),...r,children:t})}function Iy(e,t){return function(){return e.apply(t,arguments)}}const{toString:LC}=Object.prototype,{getPrototypeOf:tp}=Object,{iterator:mu,toStringTag:Ly}=Symbol,gu=(e=>t=>{const r=LC.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Wa=e=>(e=e.toLowerCase(),t=>gu(t)===e),vu=e=>t=>typeof t===e,{isArray:wo}=Array,uo=vu("undefined");function nc(e){return e!==null&&!uo(e)&&e.constructor!==null&&!uo(e.constructor)&&qr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const My=Wa("ArrayBuffer");function MC(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&My(e.buffer),t}const BC=vu("string"),qr=vu("function"),By=vu("number"),sc=e=>e!==null&&typeof e=="object",UC=e=>e===!0||e===!1,t0=e=>{if(gu(e)!=="object")return!1;const t=tp(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Ly in e)&&!(mu in e)},zC=e=>{if(!sc(e)||nc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},$C=Wa("Date"),HC=Wa("File"),VC=Wa("Blob"),WC=Wa("FileList"),GC=e=>sc(e)&&qr(e.pipe),XC=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||qr(e.append)&&((t=gu(e))==="formdata"||t==="object"&&qr(e.toString)&&e.toString()==="[object FormData]"))},qC=Wa("URLSearchParams"),[QC,KC,YC,JC]=["ReadableStream","Request","Response","Headers"].map(Wa),ZC=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ic(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let a,n;if(typeof e!="object"&&(e=[e]),wo(e))for(a=0,n=e.length;a<n;a++)t.call(null,e[a],a,e);else{if(nc(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let l;for(a=0;a<o;a++)l=s[a],t.call(null,e[l],l,e)}}function Uy(e,t){if(nc(e))return null;t=t.toLowerCase();const r=Object.keys(e);let a=r.length,n;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const Is=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),zy=e=>!uo(e)&&e!==Is;function If(){const{caseless:e,skipUndefined:t}=zy(this)&&this||{},r={},a=(n,s)=>{const o=e&&Uy(r,s)||s;t0(r[o])&&t0(n)?r[o]=If(r[o],n):t0(n)?r[o]=If({},n):wo(n)?r[o]=n.slice():(!t||!uo(n))&&(r[o]=n)};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&ic(arguments[n],a);return r}const e_=(e,t,r,{allOwnKeys:a}={})=>(ic(t,(n,s)=>{r&&qr(n)?e[s]=Iy(n,r):e[s]=n},{allOwnKeys:a}),e),t_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),r_=(e,t,r,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},a_=(e,t,r,a)=>{let n,s,o;const l={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),s=n.length;s-- >0;)o=n[s],(!a||a(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&tp(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},n_=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const a=e.indexOf(t,r);return a!==-1&&a===r},s_=e=>{if(!e)return null;if(wo(e))return e;let t=e.length;if(!By(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},i_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&tp(Uint8Array)),o_=(e,t)=>{const a=(e&&e[mu]).call(e);let n;for(;(n=a.next())&&!n.done;){const s=n.value;t.call(e,s[0],s[1])}},l_=(e,t)=>{let r;const a=[];for(;(r=e.exec(t))!==null;)a.push(r);return a},c_=Wa("HTMLFormElement"),u_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,n){return a.toUpperCase()+n}),gm=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),d_=Wa("RegExp"),$y=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),a={};ic(r,(n,s)=>{let o;(o=t(n,s,e))!==!1&&(a[s]=o||n)}),Object.defineProperties(e,a)},f_=e=>{$y(e,(t,r)=>{if(qr(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=e[r];if(qr(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},h_=(e,t)=>{const r={},a=n=>{n.forEach(s=>{r[s]=!0})};return wo(e)?a(e):a(String(e).split(t)),r},p_=()=>{},x_=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function m_(e){return!!(e&&qr(e.append)&&e[Ly]==="FormData"&&e[mu])}const g_=e=>{const t=new Array(10),r=(a,n)=>{if(sc(a)){if(t.indexOf(a)>=0)return;if(nc(a))return a;if(!("toJSON"in a)){t[n]=a;const s=wo(a)?[]:{};return ic(a,(o,l)=>{const c=r(o,n+1);!uo(c)&&(s[l]=c)}),t[n]=void 0,s}}return a};return r(e,0)},v_=Wa("AsyncFunction"),y_=e=>e&&(sc(e)||qr(e))&&qr(e.then)&&qr(e.catch),Hy=((e,t)=>e?setImmediate:t?((r,a)=>(Is.addEventListener("message",({source:n,data:s})=>{n===Is&&s===r&&a.length&&a.shift()()},!1),n=>{a.push(n),Is.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",qr(Is.postMessage)),w_=typeof queueMicrotask<"u"?queueMicrotask.bind(Is):typeof process<"u"&&process.nextTick||Hy,k_=e=>e!=null&&qr(e[mu]),ie={isArray:wo,isArrayBuffer:My,isBuffer:nc,isFormData:XC,isArrayBufferView:MC,isString:BC,isNumber:By,isBoolean:UC,isObject:sc,isPlainObject:t0,isEmptyObject:zC,isReadableStream:QC,isRequest:KC,isResponse:YC,isHeaders:JC,isUndefined:uo,isDate:$C,isFile:HC,isBlob:VC,isRegExp:d_,isFunction:qr,isStream:GC,isURLSearchParams:qC,isTypedArray:i_,isFileList:WC,forEach:ic,merge:If,extend:e_,trim:ZC,stripBOM:t_,inherits:r_,toFlatObject:a_,kindOf:gu,kindOfTest:Wa,endsWith:n_,toArray:s_,forEachEntry:o_,matchAll:l_,isHTMLForm:c_,hasOwnProperty:gm,hasOwnProp:gm,reduceDescriptors:$y,freezeMethods:f_,toObjectSet:h_,toCamelCase:u_,noop:p_,toFiniteNumber:x_,findKey:Uy,global:Is,isContextDefined:zy,isSpecCompliantForm:m_,toJSONObject:g_,isAsyncFn:v_,isThenable:y_,setImmediate:Hy,asap:w_,isIterable:k_};function Ke(e,t,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}ie.inherits(Ke,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ie.toJSONObject(this.config),code:this.code,status:this.status}}});const Vy=Ke.prototype,Wy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Wy[e]={value:e}});Object.defineProperties(Ke,Wy);Object.defineProperty(Vy,"isAxiosError",{value:!0});Ke.from=(e,t,r,a,n,s)=>{const o=Object.create(Vy);ie.toFlatObject(e,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Ke.call(o,l,c,r,a,n),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",s&&Object.assign(o,s),o};const b_=null;function Lf(e){return ie.isPlainObject(e)||ie.isArray(e)}function Gy(e){return ie.endsWith(e,"[]")?e.slice(0,-2):e}function vm(e,t,r){return e?e.concat(t).map(function(n,s){return n=Gy(n),!r&&s?"["+n+"]":n}).join(r?".":""):t}function E_(e){return ie.isArray(e)&&!e.some(Lf)}const S_=ie.toFlatObject(ie,{},null,function(t){return/^is[A-Z]/.test(t)});function yu(e,t,r){if(!ie.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=ie.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,w){return!ie.isUndefined(w[m])});const a=r.metaTokens,n=r.visitor||d,s=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&ie.isSpecCompliantForm(t);if(!ie.isFunction(n))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(ie.isDate(x))return x.toISOString();if(ie.isBoolean(x))return x.toString();if(!c&&ie.isBlob(x))throw new Ke("Blob is not supported. Use a Buffer instead.");return ie.isArrayBuffer(x)||ie.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,m,w){let g=x;if(x&&!w&&typeof x=="object"){if(ie.endsWith(m,"{}"))m=a?m:m.slice(0,-2),x=JSON.stringify(x);else if(ie.isArray(x)&&E_(x)||(ie.isFileList(x)||ie.endsWith(m,"[]"))&&(g=ie.toArray(x)))return m=Gy(m),g.forEach(function(v,k){!(ie.isUndefined(v)||v===null)&&t.append(o===!0?vm([m],k,s):o===null?m:m+"[]",u(v))}),!1}return Lf(x)?!0:(t.append(vm(w,m,s),u(x)),!1)}const f=[],h=Object.assign(S_,{defaultVisitor:d,convertValue:u,isVisitable:Lf});function p(x,m){if(!ie.isUndefined(x)){if(f.indexOf(x)!==-1)throw Error("Circular reference detected in "+m.join("."));f.push(x),ie.forEach(x,function(g,y){(!(ie.isUndefined(g)||g===null)&&n.call(t,g,ie.isString(y)?y.trim():y,m,h))===!0&&p(g,m?m.concat(y):[y])}),f.pop()}}if(!ie.isObject(e))throw new TypeError("data must be an object");return p(e),t}function ym(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function rp(e,t){this._pairs=[],e&&yu(e,this,t)}const Xy=rp.prototype;Xy.append=function(t,r){this._pairs.push([t,r])};Xy.toString=function(t){const r=t?function(a){return t.call(this,a,ym)}:ym;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function N_(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function qy(e,t,r){if(!t)return e;const a=r&&r.encode||N_;ie.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let s;if(n?s=n(t,r):s=ie.isURLSearchParams(t)?t.toString():new rp(t,r).toString(a),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class C_{constructor(){this.handlers=[]}use(t,r,a){return this.handlers.push({fulfilled:t,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ie.forEach(this.handlers,function(a){a!==null&&t(a)})}}const wm=C_,Qy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},__=typeof URLSearchParams<"u"?URLSearchParams:rp,T_=typeof FormData<"u"?FormData:null,j_=typeof Blob<"u"?Blob:null,A_={isBrowser:!0,classes:{URLSearchParams:__,FormData:T_,Blob:j_},protocols:["http","https","file","blob","url","data"]},ap=typeof window<"u"&&typeof document<"u",Mf=typeof navigator=="object"&&navigator||void 0,F_=ap&&(!Mf||["ReactNative","NativeScript","NS"].indexOf(Mf.product)<0),P_=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),D_=ap&&window.location.href||"http://localhost",O_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ap,hasStandardBrowserEnv:F_,hasStandardBrowserWebWorkerEnv:P_,navigator:Mf,origin:D_},Symbol.toStringTag,{value:"Module"})),yr={...O_,...A_};function R_(e,t){return yu(e,new yr.classes.URLSearchParams,{visitor:function(r,a,n,s){return yr.isNode&&ie.isBuffer(r)?(this.append(a,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function I_(e){return ie.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function L_(e){const t={},r=Object.keys(e);let a;const n=r.length;let s;for(a=0;a<n;a++)s=r[a],t[s]=e[s];return t}function Ky(e){function t(r,a,n,s){let o=r[s++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=s>=r.length;return o=!o&&ie.isArray(n)?n.length:o,c?(ie.hasOwnProp(n,o)?n[o]=[n[o],a]:n[o]=a,!l):((!n[o]||!ie.isObject(n[o]))&&(n[o]=[]),t(r,a,n[o],s)&&ie.isArray(n[o])&&(n[o]=L_(n[o])),!l)}if(ie.isFormData(e)&&ie.isFunction(e.entries)){const r={};return ie.forEachEntry(e,(a,n)=>{t(I_(a),n,r,0)}),r}return null}function M_(e,t,r){if(ie.isString(e))try{return(t||JSON.parse)(e),ie.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(e)}const np={transitional:Qy,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const a=r.getContentType()||"",n=a.indexOf("application/json")>-1,s=ie.isObject(t);if(s&&ie.isHTMLForm(t)&&(t=new FormData(t)),ie.isFormData(t))return n?JSON.stringify(Ky(t)):t;if(ie.isArrayBuffer(t)||ie.isBuffer(t)||ie.isStream(t)||ie.isFile(t)||ie.isBlob(t)||ie.isReadableStream(t))return t;if(ie.isArrayBufferView(t))return t.buffer;if(ie.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(s){if(a.indexOf("application/x-www-form-urlencoded")>-1)return R_(t,this.formSerializer).toString();if((l=ie.isFileList(t))||a.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return yu(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||n?(r.setContentType("application/json",!1),M_(t)):t}],transformResponse:[function(t){const r=this.transitional||np.transitional,a=r&&r.forcedJSONParsing,n=this.responseType==="json";if(ie.isResponse(t)||ie.isReadableStream(t))return t;if(t&&ie.isString(t)&&(a&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?Ke.from(l,Ke.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:yr.classes.FormData,Blob:yr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ie.forEach(["delete","get","head","post","put","patch"],e=>{np.headers[e]={}});const sp=np,B_=ie.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),U_=e=>{const t={};let r,a,n;return e&&e.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),a=o.substring(n+1).trim(),!(!r||t[r]&&B_[r])&&(r==="set-cookie"?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t},km=Symbol("internals");function Oo(e){return e&&String(e).trim().toLowerCase()}function r0(e){return e===!1||e==null?e:ie.isArray(e)?e.map(r0):String(e)}function z_(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(e);)t[a[1]]=a[2];return t}const $_=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function sd(e,t,r,a,n){if(ie.isFunction(a))return a.call(this,t,r);if(n&&(t=r),!!ie.isString(t)){if(ie.isString(a))return t.indexOf(a)!==-1;if(ie.isRegExp(a))return a.test(t)}}function H_(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,a)=>r.toUpperCase()+a)}function V_(e,t){const r=ie.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+r,{value:function(n,s,o){return this[a].call(this,t,n,s,o)},configurable:!0})})}class wu{constructor(t){t&&this.set(t)}set(t,r,a){const n=this;function s(l,c,u){const d=Oo(c);if(!d)throw new Error("header name must be a non-empty string");const f=ie.findKey(n,d);(!f||n[f]===void 0||u===!0||u===void 0&&n[f]!==!1)&&(n[f||c]=r0(l))}const o=(l,c)=>ie.forEach(l,(u,d)=>s(u,d,c));if(ie.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(ie.isString(t)&&(t=t.trim())&&!$_(t))o(U_(t),r);else if(ie.isObject(t)&&ie.isIterable(t)){let l={},c,u;for(const d of t){if(!ie.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?ie.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,r)}else t!=null&&s(r,t,a);return this}get(t,r){if(t=Oo(t),t){const a=ie.findKey(this,t);if(a){const n=this[a];if(!r)return n;if(r===!0)return z_(n);if(ie.isFunction(r))return r.call(this,n,a);if(ie.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Oo(t),t){const a=ie.findKey(this,t);return!!(a&&this[a]!==void 0&&(!r||sd(this,this[a],a,r)))}return!1}delete(t,r){const a=this;let n=!1;function s(o){if(o=Oo(o),o){const l=ie.findKey(a,o);l&&(!r||sd(a,a[l],l,r))&&(delete a[l],n=!0)}}return ie.isArray(t)?t.forEach(s):s(t),n}clear(t){const r=Object.keys(this);let a=r.length,n=!1;for(;a--;){const s=r[a];(!t||sd(this,this[s],s,t,!0))&&(delete this[s],n=!0)}return n}normalize(t){const r=this,a={};return ie.forEach(this,(n,s)=>{const o=ie.findKey(a,s);if(o){r[o]=r0(n),delete r[s];return}const l=t?H_(s):String(s).trim();l!==s&&delete r[s],r[l]=r0(n),a[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return ie.forEach(this,(a,n)=>{a!=null&&a!==!1&&(r[n]=t&&ie.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const a=new this(t);return r.forEach(n=>a.set(n)),a}static accessor(t){const a=(this[km]=this[km]={accessors:{}}).accessors,n=this.prototype;function s(o){const l=Oo(o);a[l]||(V_(n,o),a[l]=!0)}return ie.isArray(t)?t.forEach(s):s(t),this}}wu.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ie.reduceDescriptors(wu.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[r]=a}}});ie.freezeMethods(wu);const $a=wu;function id(e,t){const r=this||sp,a=t||r,n=$a.from(a.headers);let s=a.data;return ie.forEach(e,function(l){s=l.call(r,s,n.normalize(),t?t.status:void 0)}),n.normalize(),s}function Yy(e){return!!(e&&e.__CANCEL__)}function ko(e,t,r){Ke.call(this,e??"canceled",Ke.ERR_CANCELED,t,r),this.name="CanceledError"}ie.inherits(ko,Ke,{__CANCEL__:!0});function Jy(e,t,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?e(r):t(new Ke("Request failed with status code "+r.status,[Ke.ERR_BAD_REQUEST,Ke.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function W_(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function G_(e,t){e=e||10;const r=new Array(e),a=new Array(e);let n=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=a[s];o||(o=u),r[n]=c,a[n]=u;let f=s,h=0;for(;f!==n;)h+=r[f++],f=f%e;if(n=(n+1)%e,n===s&&(s=(s+1)%e),u-o<t)return;const p=d&&u-d;return p?Math.round(h*1e3/p):void 0}}function X_(e,t){let r=0,a=1e3/t,n,s;const o=(u,d=Date.now())=>{r=d,n=null,s&&(clearTimeout(s),s=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=a?o(u,d):(n=u,s||(s=setTimeout(()=>{s=null,o(n)},a-f)))},()=>n&&o(n)]}const I0=(e,t,r=3)=>{let a=0;const n=G_(50,250);return X_(s=>{const o=s.loaded,l=s.lengthComputable?s.total:void 0,c=o-a,u=n(c),d=o<=l;a=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:s,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},bm=(e,t)=>{const r=e!=null;return[a=>t[0]({lengthComputable:r,total:e,loaded:a}),t[1]]},Em=e=>(...t)=>ie.asap(()=>e(...t)),q_=yr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,yr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(yr.origin),yr.navigator&&/(msie|trident)/i.test(yr.navigator.userAgent)):()=>!0,Q_=yr.hasStandardBrowserEnv?{write(e,t,r,a,n,s,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];ie.isNumber(r)&&l.push(`expires=${new Date(r).toUTCString()}`),ie.isString(a)&&l.push(`path=${a}`),ie.isString(n)&&l.push(`domain=${n}`),s===!0&&l.push("secure"),ie.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function K_(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Y_(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Zy(e,t,r){let a=!K_(t);return e&&(a||r==!1)?Y_(e,t):t}const Sm=e=>e instanceof $a?{...e}:e;function si(e,t){t=t||{};const r={};function a(u,d,f,h){return ie.isPlainObject(u)&&ie.isPlainObject(d)?ie.merge.call({caseless:h},u,d):ie.isPlainObject(d)?ie.merge({},d):ie.isArray(d)?d.slice():d}function n(u,d,f,h){if(ie.isUndefined(d)){if(!ie.isUndefined(u))return a(void 0,u,f,h)}else return a(u,d,f,h)}function s(u,d){if(!ie.isUndefined(d))return a(void 0,d)}function o(u,d){if(ie.isUndefined(d)){if(!ie.isUndefined(u))return a(void 0,u)}else return a(void 0,d)}function l(u,d,f){if(f in t)return a(u,d);if(f in e)return a(void 0,u)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,f)=>n(Sm(u),Sm(d),f,!0)};return ie.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||n,h=f(e[d],t[d],d);ie.isUndefined(h)&&f!==l||(r[d]=h)}),r}const e2=e=>{const t=si({},e);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:s,headers:o,auth:l}=t;if(t.headers=o=$a.from(o),t.url=qy(Zy(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),ie.isFormData(r)){if(yr.hasStandardBrowserEnv||yr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(ie.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,f])=>{u.includes(d.toLowerCase())&&o.set(d,f)})}}if(yr.hasStandardBrowserEnv&&(a&&ie.isFunction(a)&&(a=a(t)),a||a!==!1&&q_(t.url))){const c=n&&s&&Q_.read(s);c&&o.set(n,c)}return t},J_=typeof XMLHttpRequest<"u",Z_=J_&&function(e){return new Promise(function(r,a){const n=e2(e);let s=n.data;const o=$a.from(n.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=n,d,f,h,p,x;function m(){p&&p(),x&&x(),n.cancelToken&&n.cancelToken.unsubscribe(d),n.signal&&n.signal.removeEventListener("abort",d)}let w=new XMLHttpRequest;w.open(n.method.toUpperCase(),n.url,!0),w.timeout=n.timeout;function g(){if(!w)return;const v=$a.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),_={data:!l||l==="text"||l==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:v,config:e,request:w};Jy(function(b){r(b),m()},function(b){a(b),m()},_),w=null}"onloadend"in w?w.onloadend=g:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(g)},w.onabort=function(){w&&(a(new Ke("Request aborted",Ke.ECONNABORTED,e,w)),w=null)},w.onerror=function(k){const _=k&&k.message?k.message:"Network Error",F=new Ke(_,Ke.ERR_NETWORK,e,w);F.event=k||null,a(F),w=null},w.ontimeout=function(){let k=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const _=n.transitional||Qy;n.timeoutErrorMessage&&(k=n.timeoutErrorMessage),a(new Ke(k,_.clarifyTimeoutError?Ke.ETIMEDOUT:Ke.ECONNABORTED,e,w)),w=null},s===void 0&&o.setContentType(null),"setRequestHeader"in w&&ie.forEach(o.toJSON(),function(k,_){w.setRequestHeader(_,k)}),ie.isUndefined(n.withCredentials)||(w.withCredentials=!!n.withCredentials),l&&l!=="json"&&(w.responseType=n.responseType),u&&([h,x]=I0(u,!0),w.addEventListener("progress",h)),c&&w.upload&&([f,p]=I0(c),w.upload.addEventListener("progress",f),w.upload.addEventListener("loadend",p)),(n.cancelToken||n.signal)&&(d=v=>{w&&(a(!v||v.type?new ko(null,e,w):v),w.abort(),w=null)},n.cancelToken&&n.cancelToken.subscribe(d),n.signal&&(n.signal.aborted?d():n.signal.addEventListener("abort",d)));const y=W_(n.url);if(y&&yr.protocols.indexOf(y)===-1){a(new Ke("Unsupported protocol "+y+":",Ke.ERR_BAD_REQUEST,e));return}w.send(s||null)})},eT=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let a=new AbortController,n;const s=function(u){if(!n){n=!0,l();const d=u instanceof Error?u:this.reason;a.abort(d instanceof Ke?d:new ko(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,s(new Ke(`timeout ${t} of ms exceeded`,Ke.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),e=null)};e.forEach(u=>u.addEventListener("abort",s));const{signal:c}=a;return c.unsubscribe=()=>ie.asap(l),c}},tT=eT,rT=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let a=0,n;for(;a<r;)n=a+t,yield e.slice(a,n),a=n},aT=async function*(e,t){for await(const r of nT(e))yield*rT(r,t)},nT=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)break;yield a}}finally{await t.cancel()}},Nm=(e,t,r,a)=>{const n=aT(e,t);let s=0,o,l=c=>{o||(o=!0,a&&a(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await n.next();if(u){l(),c.close();return}let f=d.byteLength;if(r){let h=s+=f;r(h)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),n.return()}},{highWaterMark:2})},Cm=64*1024,{isFunction:Dc}=ie,sT=(({Request:e,Response:t})=>({Request:e,Response:t}))(ie.global),{ReadableStream:_m,TextEncoder:Tm}=ie.global,jm=(e,...t)=>{try{return!!e(...t)}catch{return!1}},iT=e=>{e=ie.merge.call({skipUndefined:!0},sT,e);const{fetch:t,Request:r,Response:a}=e,n=t?Dc(t):typeof fetch=="function",s=Dc(r),o=Dc(a);if(!n)return!1;const l=n&&Dc(_m),c=n&&(typeof Tm=="function"?(x=>m=>x.encode(m))(new Tm):async x=>new Uint8Array(await new r(x).arrayBuffer())),u=s&&l&&jm(()=>{let x=!1;const m=new r(yr.origin,{body:new _m,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!m}),d=o&&l&&jm(()=>ie.isReadableStream(new a("").body)),f={stream:d&&(x=>x.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!f[x]&&(f[x]=(m,w)=>{let g=m&&m[x];if(g)return g.call(m);throw new Ke(`Response type '${x}' is not supported`,Ke.ERR_NOT_SUPPORT,w)})});const h=async x=>{if(x==null)return 0;if(ie.isBlob(x))return x.size;if(ie.isSpecCompliantForm(x))return(await new r(yr.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(ie.isArrayBufferView(x)||ie.isArrayBuffer(x))return x.byteLength;if(ie.isURLSearchParams(x)&&(x=x+""),ie.isString(x))return(await c(x)).byteLength},p=async(x,m)=>{const w=ie.toFiniteNumber(x.getContentLength());return w??h(m)};return async x=>{let{url:m,method:w,data:g,signal:y,cancelToken:v,timeout:k,onDownloadProgress:_,onUploadProgress:F,responseType:b,headers:S,withCredentials:C="same-origin",fetchOptions:B}=e2(x),T=t||fetch;b=b?(b+"").toLowerCase():"text";let U=tT([y,v&&v.toAbortSignal()],k),K=null;const de=U&&U.unsubscribe&&(()=>{U.unsubscribe()});let oe;try{if(F&&u&&w!=="get"&&w!=="head"&&(oe=await p(S,g))!==0){let be=new r(m,{method:"POST",body:g,duplex:"half"}),O;if(ie.isFormData(g)&&(O=be.headers.get("content-type"))&&S.setContentType(O),be.body){const[J,W]=bm(oe,I0(Em(F)));g=Nm(be.body,Cm,J,W)}}ie.isString(C)||(C=C?"include":"omit");const ge=s&&"credentials"in r.prototype,Z={...B,signal:U,method:w.toUpperCase(),headers:S.normalize().toJSON(),body:g,duplex:"half",credentials:ge?C:void 0};K=s&&new r(m,Z);let se=await(s?T(K,B):T(m,Z));const z=d&&(b==="stream"||b==="response");if(d&&(_||z&&de)){const be={};["status","statusText","headers"].forEach(V=>{be[V]=se[V]});const O=ie.toFiniteNumber(se.headers.get("content-length")),[J,W]=_&&bm(O,I0(Em(_),!0))||[];se=new a(Nm(se.body,Cm,J,()=>{W&&W(),de&&de()}),be)}b=b||"text";let xe=await f[ie.findKey(f,b)||"text"](se,x);return!z&&de&&de(),await new Promise((be,O)=>{Jy(be,O,{data:xe,headers:$a.from(se.headers),status:se.status,statusText:se.statusText,config:x,request:K})})}catch(ge){throw de&&de(),ge&&ge.name==="TypeError"&&/Load failed|fetch/i.test(ge.message)?Object.assign(new Ke("Network Error",Ke.ERR_NETWORK,x,K),{cause:ge.cause||ge}):Ke.from(ge,ge&&ge.code,x,K)}}},oT=new Map,t2=e=>{let t=e&&e.env||{};const{fetch:r,Request:a,Response:n}=t,s=[a,n,r];let o=s.length,l=o,c,u,d=oT;for(;l--;)c=s[l],u=d.get(c),u===void 0&&d.set(c,u=l?new Map:iT(t)),d=u;return u};t2();const ip={http:b_,xhr:Z_,fetch:{get:t2}};ie.forEach(ip,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Am=e=>`- ${e}`,lT=e=>ie.isFunction(e)||e===null||e===!1;function cT(e,t){e=ie.isArray(e)?e:[e];const{length:r}=e;let a,n;const s={};for(let o=0;o<r;o++){a=e[o];let l;if(n=a,!lT(a)&&(n=ip[(l=String(a)).toLowerCase()],n===void 0))throw new Ke(`Unknown adapter '${l}'`);if(n&&(ie.isFunction(n)||(n=n.get(t))))break;s[l||"#"+o]=n}if(!n){const o=Object.entries(s).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(Am).join(`
`):" "+Am(o[0]):"as no adapter specified";throw new Ke("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return n}const r2={getAdapter:cT,adapters:ip};function od(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ko(null,e)}function Fm(e){return od(e),e.headers=$a.from(e.headers),e.data=id.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),r2.getAdapter(e.adapter||sp.adapter,e)(e).then(function(a){return od(e),a.data=id.call(e,e.transformResponse,a),a.headers=$a.from(a.headers),a},function(a){return Yy(a)||(od(e),a&&a.response&&(a.response.data=id.call(e,e.transformResponse,a.response),a.response.headers=$a.from(a.response.headers))),Promise.reject(a)})}const a2="1.13.2",ku={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{ku[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const Pm={};ku.transitional=function(t,r,a){function n(s,o){return"[Axios v"+a2+"] Transitional option '"+s+"'"+o+(a?". "+a:"")}return(s,o,l)=>{if(t===!1)throw new Ke(n(o," has been removed"+(r?" in "+r:"")),Ke.ERR_DEPRECATED);return r&&!Pm[o]&&(Pm[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,o,l):!0}};ku.spelling=function(t){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function uT(e,t,r){if(typeof e!="object")throw new Ke("options must be an object",Ke.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let n=a.length;for(;n-- >0;){const s=a[n],o=t[s];if(o){const l=e[s],c=l===void 0||o(l,s,e);if(c!==!0)throw new Ke("option "+s+" must be "+c,Ke.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Ke("Unknown option "+s,Ke.ERR_BAD_OPTION)}}const a0={assertOptions:uT,validators:ku},Ya=a0.validators;class L0{constructor(t){this.defaults=t||{},this.interceptors={request:new wm,response:new wm}}async request(t,r){try{return await this._request(t,r)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const s=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?s&&!String(a.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+s):a.stack=s}catch{}}throw a}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=si(this.defaults,r);const{transitional:a,paramsSerializer:n,headers:s}=r;a!==void 0&&a0.assertOptions(a,{silentJSONParsing:Ya.transitional(Ya.boolean),forcedJSONParsing:Ya.transitional(Ya.boolean),clarifyTimeoutError:Ya.transitional(Ya.boolean)},!1),n!=null&&(ie.isFunction(n)?r.paramsSerializer={serialize:n}:a0.assertOptions(n,{encode:Ya.function,serialize:Ya.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),a0.assertOptions(r,{baseUrl:Ya.spelling("baseURL"),withXsrfToken:Ya.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&ie.merge(s.common,s[r.method]);s&&ie.forEach(["delete","get","head","post","put","patch","common"],x=>{delete s[x]}),r.headers=$a.concat(o,s);const l=[];let c=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(r)===!1||(c=c&&m.synchronous,l.unshift(m.fulfilled,m.rejected))});const u=[];this.interceptors.response.forEach(function(m){u.push(m.fulfilled,m.rejected)});let d,f=0,h;if(!c){const x=[Fm.bind(this),void 0];for(x.unshift(...l),x.push(...u),h=x.length,d=Promise.resolve(r);f<h;)d=d.then(x[f++],x[f++]);return d}h=l.length;let p=r;for(;f<h;){const x=l[f++],m=l[f++];try{p=x(p)}catch(w){m.call(this,w);break}}try{d=Fm.call(this,p)}catch(x){return Promise.reject(x)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=si(this.defaults,t);const r=Zy(t.baseURL,t.url,t.allowAbsoluteUrls);return qy(r,t.params,t.paramsSerializer)}}ie.forEach(["delete","get","head","options"],function(t){L0.prototype[t]=function(r,a){return this.request(si(a||{},{method:t,url:r,data:(a||{}).data}))}});ie.forEach(["post","put","patch"],function(t){function r(a){return function(s,o,l){return this.request(si(l||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}L0.prototype[t]=r(),L0.prototype[t+"Form"]=r(!0)});const n0=L0;class op{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const a=this;this.promise.then(n=>{if(!a._listeners)return;let s=a._listeners.length;for(;s-- >0;)a._listeners[s](n);a._listeners=null}),this.promise.then=n=>{let s;const o=new Promise(l=>{a.subscribe(l),s=l}).then(n);return o.cancel=function(){a.unsubscribe(s)},o},t(function(s,o,l){a.reason||(a.reason=new ko(s,o,l),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=a=>{t.abort(a)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new op(function(n){t=n}),cancel:t}}}const dT=op;function fT(e){return function(r){return e.apply(null,r)}}function hT(e){return ie.isObject(e)&&e.isAxiosError===!0}const Bf={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Bf).forEach(([e,t])=>{Bf[t]=e});const pT=Bf;function n2(e){const t=new n0(e),r=Iy(n0.prototype.request,t);return ie.extend(r,n0.prototype,t,{allOwnKeys:!0}),ie.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return n2(si(e,n))},r}const Vt=n2(sp);Vt.Axios=n0;Vt.CanceledError=ko;Vt.CancelToken=dT;Vt.isCancel=Yy;Vt.VERSION=a2;Vt.toFormData=yu;Vt.AxiosError=Ke;Vt.Cancel=Vt.CanceledError;Vt.all=function(t){return Promise.all(t)};Vt.spread=fT;Vt.isAxiosError=hT;Vt.mergeConfig=si;Vt.AxiosHeaders=$a;Vt.formToJSON=e=>Ky(ie.isHTMLForm(e)?new FormData(e):e);Vt.getAdapter=r2.getAdapter;Vt.HttpStatusCode=pT;Vt.default=Vt;const xT=Vt,s2=xT.create({baseURL:"http://18.213.58.26:8081",withCredentials:!0,headers:{"Content-Type":"application/json"}});s2.interceptors.response.use(e=>e,async e=>{var r,a,n,s;const t=e.config;if(((r=e.response)==null?void 0:r.status)===401){if(t._retry)return Promise.reject(e);t._retry=!0,console.warn(" 401 Unauthorized - Verificando sesin...");try{return(await fetch("http://18.213.58.26:8081/api/auth/check",{credentials:"include"})).ok?(console.warn(" Sesin vlida pero recibiendo 401 - puede ser un problema de permisos"),Promise.reject(e)):(console.error(" Sesin invlida, redirigiendo a login..."),window._redirectingToLogin||(window._redirectingToLogin=!0,setTimeout(()=>{window.location.href="/login"},500)),Promise.reject(e))}catch(o){return console.error(" Error verificando autenticacin:",o),window._redirectingToLogin||(window._redirectingToLogin=!0,setTimeout(()=>{window.location.href="/login"},500)),Promise.reject(e)}}return((a=e.response)==null?void 0:a.status)===403&&console.error(" 403 Forbidden - Sin permisos para este recurso"),((n=e.response)==null?void 0:n.status)===500&&console.error(" 500 Internal Server Error:",(s=e.response)==null?void 0:s.data),Promise.reject(e)});function mT(e,t=!1){return tE({queryKey:["orders",e==null?void 0:e.factory,e==null?void 0:e.code,t],queryFn:async()=>{var r;console.log(" Cargando rdenes para lnea:",{factory:e==null?void 0:e.factory,code:e==null?void 0:e.code,sap_code:e==null?void 0:e.sap_code,fromSAP:t});try{const{data:a}=await s2.post("/sap/orders",{},{headers:{Factory:e.factory||"",ProdLine:e.code||"",SapCode:e.sap_code||e.code||"",SapRequest:t?"true":"false"}}),n=Array.isArray(a)?a:a?[a]:[];return console.log(" rdenes cargadas:",n.length,"rdenes para lnea",e==null?void 0:e.code),n.length>0&&console.log(" Primera orden:",{OrderNumber:n[0].OrderNumber,ProductName:n[0].ProductName,Status:n[0].StarteddAt?"Con fecha inicio":"Sin fecha inicio"}),n}catch(a){throw console.error(" Error al cargar rdenes:",{error:a.message,factory:e==null?void 0:e.factory,code:e==null?void 0:e.code,response:(r=a.response)==null?void 0:r.data}),a}},staleTime:1*60*1e3,refetchInterval:5*60*1e3,enabled:!!(e!=null&&e.factory&&(e!=null&&e.code)),retry:1})}function gT(){var se,z,xe,be,O,J,W,V,le,we;const e=_s(),{t}=He(),[r,a]=D.useState(()=>{const R=localStorage.getItem("selectedFactory");return R&&R!=="CX"?R:null}),[n,s]=D.useState(null),[o,l]=D.useState(null),[c,u]=D.useState(!1),[d,f]=D.useState({});D.useEffect(()=>{const R=X=>{let q="";if(X.reason&&(typeof X.reason=="object"&&X.reason.message?q=X.reason.message:typeof X.reason=="string"?q=X.reason:q=String(X.reason)),q.includes("A listener indicated an asynchronous response")||q.includes("message channel closed")||q.includes("message channel closed before a response was received")||q.includes("Extension context invalidated")||q.includes("Receiving end does not exist")||q.includes("asynchronous response"))return X.preventDefault(),X.stopPropagation(),!1};return window.addEventListener("unhandledrejection",R,!0),()=>{window.removeEventListener("unhandledrejection",R,!0)}},[]),D.useEffect(()=>{const R=()=>{const q=localStorage.getItem("selectedFactory"),ce=q&&q!=="CX"?q:null;ce!==r&&(a(ce),s(null))};window.addEventListener("storage",R);const X=setInterval(R,1e3);return()=>{window.removeEventListener("storage",R),clearInterval(X)}},[r]);const[h,p]=D.useState([]),[x,m]=D.useState([]),[w,g]=D.useState(!0),[y,v]=D.useState(null),[k,_]=D.useState(!1),F=R=>{var X;return R!=null&&R.factory?R.factory:(X=R==null?void 0:R.hierarchical_level)!=null&&X[0]?R.hierarchical_level[0]:""},b=async()=>{var R;try{g(!0),v(null),console.log(" Cargando lneas - OrdenesFabricacion"),console.log(" Factory seleccionada:",r);const X=await Ye.get("/asset/list");console.log(" Assets recibidos de la API:",(X==null?void 0:X.length)||0);let q=null;if(r){const Se=(X||[]).find(Ce=>(Ce.Code===r||Ce.code===r)&&(Ce.ParentID===null||Ce.parentID===null));Se&&(q=Se.ID||Se.id,console.log(" Fbrica seleccionada encontrada:",{code:Se.Code||Se.code,id:q}))}let ce=(X||[]).filter(Se=>{const Ce=Se.Code||Se.code||"",Te=Se.ParentID||Se.parentID,fe=Se.hierarchical_level||Se.HierarchicalLevel,ve=Ce&&(Ce.startsWith("Line_")||Ce.startsWith("L")||Ce.toLowerCase().includes("line")||Ce.match(/^Line_\d+/i)||Ce.match(/^L\d+/i)),ze=fe&&Array.isArray(fe)&&fe.length===2,Ze=Te!=null;return(ve||ze)&&Ze});if(console.log(" Lneas encontradas despus del filtro inicial:",ce.length),q!==null&&(ce=ce.filter(Se=>(Se.ParentID||Se.parentID)===q),console.log(` Filtrado: ${ce.length} lneas despus del filtro por fbrica ${r}`)),ce.length===0&&X&&X.length>0){console.warn(" No se encontraron lneas con el filtro estricto, intentando filtro ms permisivo...");const Se=(X||[]).filter(Ce=>{const Te=Ce.ParentID||Ce.parentID,fe=Ce.hierarchical_level||Ce.HierarchicalLevel,ve=Te!=null,ze=fe&&Array.isArray(fe)&&fe.length===2;return ve&&ze});Se.length>0&&(console.warn(` Encontradas ${Se.length} lneas con filtro permisivo`),ce=Se)}const P=ce.map(Se=>{const Ce=Se.ParentID||Se.parentID,Te=Se.Code||Se.code||"";let fe=r||"";if(Ce!=null&&X){const ve=X.find(ze=>(ze.ID||ze.id)===Ce);ve&&(fe=ve.Code||ve.code||r||"")}return fe||(fe=r||""),{...Se,code:Te,id:Se.ID||Se.id||`line-${Te}`,parentId:Ce,factory:fe,line:Te,hierarchical_level:Se.hierarchical_level||[fe,Te]}});console.log(" Lneas cargadas:",P.length),p(P),v(null)}catch(X){(R=X.message)!=null&&R.includes("Unauthorized")||X.status===401?(console.warn(" Sesin expirada, se redirigir al login"),v(null),p([])):(console.error(" Error loading lines:",X),v(X),p([]))}finally{g(!1)}},S=async()=>{var R;if(h.length===0){console.log(" No hay lneas para cargar datos"),m([]),_(!1);return}try{_(!0);const X=h.slice(0,10);console.log(" Cargando datos completos para",X.length,"lneas");const q=await Promise.all(X.map(async P=>{try{let Se=F(P);!Se&&r&&(Se=r);const Ce=P.line||P.code||"",Te=P.sap_code||P.code||P.line||"";if(!Se||!Ce)return{...P,orders:[],activeOrder:null,recipe:null};let fe;try{fe=await Ye.post("/sap/orders",{},{headers:{"Content-Type":"application/json",Factory:Se,ProdLine:Ce,SapCode:Te}})}catch(Ze){try{fe=await Ye.post("/sap/orders",{},{headers:{"Content-Type":"application/json",Factory:Se,ProdLine:Ce,SapCode:Te,SapRequest:"false"}})}catch{throw Ze}}const ve=Array.isArray(fe)?fe:[];console.log(` rdenes cargadas para ${Ce}:`,ve.length);const ze=ve.find(Ze=>Ze.StarteddAt&&!Ze.FinishedAt)||ve[0];return{...P,orders:ve,activeOrder:ze,recipe:null}}catch(Se){return console.error(" Error cargando datos para lnea:",Se),{...P,orders:[],activeOrder:null,recipe:null,error:Se.message}}}));console.log(" Datos completos cargados:",q.length,"lneas");const ce=q.filter(P=>P.id||P.code);m(ce)}catch(X){(R=X.message)!=null&&R.includes("Unauthorized")||X.status===401?console.warn(" Sesin expirada al cargar datos de lneas"):console.error("Error loading lines with data:",X)}finally{_(!1)}};D.useEffect(()=>{b()},[r]),D.useEffect(()=>{h.length>0&&S()},[h]),D.useEffect(()=>{console.log(" Estado de lneas:",{linesLength:h.length,linesWithDataLength:x.length,loadingLines:w,loadingLineData:k,linesError:y==null?void 0:y.message,selectedFactory:r})},[h,x,w,k,y,r]),x.map(R=>({line:R,orders:R.orders||[],activeOrder:R.activeOrder||null,isLoading:k,error:R.error}));const{data:C=[],isLoading:B,error:T,refetch:U}=mT(n,!1);D.useEffect(()=>{n&&(console.log(" Lnea seleccionada:",{code:n.code,factory:n.factory,sap_code:n.sap_code,id:n.id}),console.log(" Estado de rdenes:",{ordersCount:C.length,loadingOrders:B,ordersError:T==null?void 0:T.message,orders:C.slice(0,2)}))},[n,C,B,T]);const K=async()=>{n?await U():(await b(),h.length>0&&await S())},de=R=>{if(!R)return"N/A";try{return new Date(R).toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return R}},oe=R=>{const X=new Date,q=new Date(R.StarteddAt),ce=new Date(R.FinishedAt);return X<q?{text:"Programada",color:"info",icon:O0}:X>=q&&X<=ce?{text:"En Produccin",color:"success",icon:ws}:{text:"Finalizada",color:"secondary",icon:aN}},ge=(R,X)=>{if(!R||!X)return 0;const q=parseFloat(R)||0,ce=parseFloat(X)||0;return ce===0?0:Math.min(100,Math.round(q/ce*100))},Z=!r;return D.useEffect(()=>{(async()=>{var X;if(!(x.length===0||k))try{const q=x.map(Te=>Te.code).filter(Te=>Te);if(q.length===0)return;const ce=r||((X=x[0])==null?void 0:X.factory)||"";if(!ce)return;console.log(" Cargando estado de InfluxDB para lneas:",{factory:ce,lineCodes:q});const P=await Ye.get(`/asset/lines/status?factory=${ce}&lines=${q.join(",")}`),Se=P.data||P,Ce={};Object.keys(Se).forEach(Te=>{const fe=Se[Te];fe&&typeof fe=="object"?Ce[Te]={status:fe.status||"unknown",influx_available:fe.status!=="unknown"&&fe.status!==void 0,last_seen:fe.last_seen}:Ce[Te]={status:"unknown",influx_available:!1}}),q.forEach(Te=>{Ce[Te]||(Ce[Te]={status:"unknown",influx_available:!1})}),console.log(" Estado de InfluxDB cargado:",Ce),f(Ce)}catch(q){console.error(" Error al cargar estado de InfluxDB:",q);const ce={};x.forEach(P=>{P.code&&(ce[P.code]={status:"unknown",influx_available:!1})}),f(ce)}})()},[x,k,r]),D.useEffect(()=>{console.log(" Estado de carga:",{loadingLines:w,loadingLineData:k,linesLength:h.length,linesWithDataLength:x.length,hasError:!!y,errorMessage:y==null?void 0:y.message,linesStatusCount:Object.keys(d).length})},[w,k,h.length,x.length,y,d]),i.jsx("div",{className:"min-h-screen bg-gray-900 p-6",children:i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(rr,{className:"w-8 h-8 text-blue-400"}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-white",children:((z=(se=t.produccion)==null?void 0:se.ordenesFabricacion)==null?void 0:z.title)||"rdenes de Fabricacin"}),i.jsx("p",{className:"text-gray-400 mt-1",children:Z?"Todas las fbricas":`Fbrica: ${r}`})]})]})}),i.jsxs("nav",{className:"flex items-center gap-2 text-sm text-gray-400 mb-4",children:[i.jsxs("button",{onClick:()=>e("/dashboard"),className:"hover:text-white transition-colors flex items-center gap-1",children:[i.jsx(Fy,{className:"w-4 h-4"}),((xe=t.dashboard)==null?void 0:xe.title)||"Dashboard"]}),i.jsx(ba,{className:"w-4 h-4"}),i.jsx("span",{className:"text-white",children:((O=(be=t.produccion)==null?void 0:be.ordenesFabricacion)==null?void 0:O.title)||"rdenes de Fabricacin"})]})]}),o&&i.jsxs("div",{className:"mb-6 bg-red-900/20 border border-red-500 rounded-lg p-4 flex items-center gap-3",children:[i.jsx(La,{className:"w-5 h-5 text-red-400"}),i.jsx("span",{className:"text-red-400",children:o})]}),!n&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[i.jsx($e,{children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx(br,{className:"w-8 h-8 text-blue-400"}),w&&i.jsx(ft,{className:"w-4 h-4 text-gray-400 animate-spin"})]}),i.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:w?"...":x.length||h.length}),i.jsx("p",{className:"text-sm text-gray-400",children:"Lneas de Produccin"})]})}),i.jsx($e,{children:i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"flex items-center justify-between mb-2",children:i.jsx(ws,{className:"w-8 h-8 text-green-400"})}),i.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:x.filter(R=>{const X=d[R.code];return(X==null?void 0:X.status)==="operativa"}).length}),i.jsx("p",{className:"text-sm text-gray-400",children:"Lneas Operativas"})]})}),i.jsx($e,{children:i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"flex items-center justify-between mb-2",children:i.jsx(rr,{className:"w-8 h-8 text-purple-400"})}),i.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:x.reduce((R,X)=>{var q;return R+(((q=X.orders)==null?void 0:q.length)||0)},0)}),i.jsx("p",{className:"text-sm text-gray-400",children:"Total de rdenes"})]})}),i.jsx($e,{children:i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"flex items-center justify-between mb-2",children:i.jsx(ms,{className:"w-8 h-8 text-orange-400"})}),i.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:x.filter(R=>R.activeOrder).length}),i.jsx("p",{className:"text-sm text-gray-400",children:"Lneas con Orden Activa"})]})})]}),c&&i.jsx($e,{className:"mb-6",children:i.jsxs("div",{className:"p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-white",children:" Debug Logs"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>setDebugLogs([]),className:"px-3 py-1 text-sm bg-gray-700 hover:bg-gray-600 text-white rounded",children:"Limpiar"}),i.jsx("button",{onClick:()=>u(!1),className:"px-3 py-1 text-sm bg-gray-700 hover:bg-gray-600 text-white rounded",children:"Ocultar"})]})]}),i.jsx("div",{className:"bg-gray-950 rounded-lg p-4 max-h-96 overflow-y-auto font-mono text-xs",children:debugLogs.length===0?i.jsx("p",{className:"text-gray-500",children:"No hay logs an. Recarga la pgina para ver los logs."}):debugLogs.map((R,X)=>i.jsxs("div",{className:`mb-2 ${R.type==="error"?"text-red-400":R.type==="warn"?"text-yellow-400":"text-gray-300"}`,children:[i.jsxs("span",{className:"text-gray-500",children:["[",R.timestamp,"]"]})," ",i.jsx("span",{className:R.type==="error"?"text-red-400":R.type==="warn"?"text-yellow-400":"",children:R.message})]},X))})]})}),!c&&i.jsx("div",{className:"mb-6",children:i.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 text-sm bg-gray-800 hover:bg-gray-700 text-white rounded",children:"Mostrar Debug Logs"})}),!n&&i.jsx($e,{className:"mb-6",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:((W=(J=t.produccion)==null?void 0:J.ordenesFabricacion)==null?void 0:W.selectLine)||"Seleccionar Lnea de Produccin"}),(()=>(console.log(" Estado de renderizado en UI:",{loadingLines:w,loadingLineData:k,linesError:y==null?void 0:y.message,linesLength:h.length,linesWithDataLength:x.length,selectedFactory:r}),null))(),w||k?i.jsxs("div",{className:"flex items-center justify-center py-8",children:[i.jsx(ft,{className:"w-6 h-6 text-blue-500 animate-spin mr-2"}),i.jsx("p",{className:"text-gray-400",children:"Cargando lneas de produccin..."})]}):y?i.jsxs("div",{className:"flex items-center justify-center py-8",children:[i.jsx(La,{className:"w-6 h-6 text-red-500 mr-2"}),i.jsxs("p",{className:"text-red-400",children:["Error al cargar lneas: ",y.message||"Error desconocido"]})]}):x.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx(br,{className:"w-12 h-12 text-gray-600 mx-auto mb-2 opacity-50"}),i.jsx("p",{className:"text-gray-400",children:((V=t.common)==null?void 0:V.noData)||"No hay lneas disponibles"}),r&&i.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Fbrica seleccionada: ",r]}),h.length>0&&x.length===0&&i.jsx("p",{className:"text-sm text-yellow-400 mt-2",children:"Lneas encontradas pero sin datos cargados"}),i.jsxs("div",{className:"mt-4 text-xs text-gray-600",children:[i.jsxs("p",{children:["Debug: loadingLines=",String(w),", loadingLineData=",String(k)]}),i.jsxs("p",{children:["lines.length=",h.length,", linesWithData.length=",x.length]}),y&&i.jsxs("p",{className:"text-red-400",children:["Error: ",y.message]})]})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map((R,X)=>{var Ze;const q=R.activeOrder||((Ze=R.orders)==null?void 0:Ze[0])||null,ce=q?oe(q):null,P=q?ge(q.QuantityProduced,q.QuantityToProduce):0,Se=d[R.code]||{status:"unknown",influx_available:R.influx_available||!1},Ce=Se.status==="operativa",Te=Se.status==="apagada",fe=Ce?"Operativo":Te?"Apagada":"Sin datos",ve=Ce?"success":"secondary",ze=R.id||R.code||`line-${X}`;return i.jsxs("button",{onClick:()=>{console.log(" Lnea seleccionada:",{id:R.id,code:R.code,factory:R.factory,sap_code:R.sap_code,location:R.location}),s(R)},className:"p-4 bg-gray-800 hover:bg-gray-700 rounded-lg border border-gray-700 hover:border-blue-500 transition-all text-left",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx(br,{className:`w-5 h-5 ${Ce?"text-green-400":Te?"text-gray-500":"text-blue-400"}`}),i.jsx(St,{variant:ve,children:fe})]}),i.jsx("h3",{className:"font-semibold text-white mb-1",children:R.line}),i.jsx("p",{className:"text-sm text-gray-400 mb-3",children:R.location||R.factory}),q?i.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-700",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"text-xs text-gray-400",children:"Orden de Fabricacin"}),ce&&i.jsx(St,{variant:ce.color,className:"text-xs",children:ce.text})]}),i.jsxs("div",{className:"space-y-1.5",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-xs text-gray-400",children:"OF:"}),i.jsx("span",{className:"text-sm font-semibold text-white",children:q.OrderNumber})]}),q.ProductName&&i.jsx("p",{className:"text-xs font-medium text-white",children:q.ProductName}),q.ProductDescription&&i.jsx("p",{className:"text-xs text-gray-300 line-clamp-2",children:q.ProductDescription}),i.jsx("div",{className:"flex items-center justify-between text-xs",children:i.jsxs("span",{className:"text-gray-400",children:["Producido: ",i.jsx("span",{className:"text-white font-medium",children:q.QuantityProduced||"0"})," / ",i.jsx("span",{className:"text-gray-400",children:q.QuantityToProduce||"0"})," ",q.MeasurementUnit||""]})}),q.QuantityRemainedToProduce&&i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("span",{className:"text-xs text-orange-400 font-medium",children:["Pendiente: ",q.QuantityRemainedToProduce," ",q.MeasurementUnit||""]})}),P>0&&i.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1.5 mt-1",children:i.jsx("div",{className:"h-full bg-blue-600 rounded-full transition-all",style:{width:`${P}%`}})})]})]}):i.jsx("div",{className:"mt-3 pt-3 border-t border-gray-700",children:i.jsx("p",{className:"text-xs text-gray-500",children:"Sin orden de fabricacin"})})]},ze)})})]})}),n&&i.jsxs(i.Fragment,{children:[i.jsx($e,{className:"mb-6",children:i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>s(null),className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",children:i.jsx(ba,{className:"w-5 h-5 text-gray-400 rotate-180"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:n.line}),i.jsx("p",{className:"text-gray-400",children:n.location||n.factory})]})]}),i.jsxs("button",{onClick:K,disabled:B,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed rounded-lg transition-colors",children:[B?i.jsx(ft,{className:"w-4 h-4 animate-spin"}):i.jsx(Zr,{className:"w-4 h-4"}),i.jsx("span",{className:"text-white",children:"Actualizar desde SAP"})]})]})})}),B?i.jsx($e,{children:i.jsxs("div",{className:"p-12 text-center",children:[i.jsx(ft,{className:"w-12 h-12 text-blue-500 animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-400",children:((le=t.common)==null?void 0:le.loading)||"Cargando rdenes de produccin..."}),n&&i.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:["Lnea: ",n.code," | Fbrica: ",n.factory||"N/A"]})]})}):T?i.jsx($e,{children:i.jsxs("div",{className:"p-12 text-center",children:[i.jsx(La,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),i.jsx("p",{className:"text-red-400 text-lg",children:"Error al cargar rdenes"}),i.jsx("p",{className:"text-gray-500 text-sm mt-2",children:T.message||"Error desconocido"}),i.jsx("button",{onClick:()=>U(),className:"mt-4 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg",children:"Reintentar"})]})}):C.length===0?i.jsx($e,{children:i.jsxs("div",{className:"p-12 text-center",children:[i.jsx(rr,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-400 text-lg",children:((we=t.common)==null?void 0:we.noData)||"No hay rdenes de produccin disponibles"}),n&&i.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:[i.jsxs("p",{children:["Lnea: ",n.code]}),i.jsxs("p",{children:["Fbrica: ",n.factory||"N/A"]}),i.jsxs("p",{children:["SAP Code: ",n.sap_code||"N/A"]})]}),i.jsx("p",{className:"text-gray-500 text-sm mt-4",children:'Haz clic en "Actualizar desde SAP" para sincronizar las rdenes'})]})}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"space-y-4 mb-6",children:C.map((R,X)=>{const q=oe(R),ce=ge(R.QuantityProduced,R.QuantityToProduce),P=q.icon;return i.jsx($e,{className:"overflow-hidden",children:i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"flex items-start justify-between mb-4",children:i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h3",{className:"text-xl font-bold text-white",children:R.OrderNumber}),i.jsxs(St,{variant:q.color,children:[i.jsx(P,{className:"w-3 h-3 mr-1"}),q.text]}),R.OrderNType&&i.jsx(St,{variant:"secondary",children:R.OrderNType})]}),i.jsx("p",{className:"text-lg text-gray-300 mb-1",children:R.ProductName}),R.ProductDescription&&i.jsx("p",{className:"text-sm text-gray-400",children:R.ProductDescription})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"text-sm text-gray-400",children:"Progreso de Produccin"}),i.jsxs("span",{className:"text-sm font-semibold text-white",children:[ce,"%"]})]}),i.jsx("div",{className:"w-full bg-gray-700 rounded-full h-3 overflow-hidden",children:i.jsx("div",{className:"h-full bg-blue-600 transition-all duration-500",style:{width:`${ce}%`}})}),i.jsxs("div",{className:"flex items-center justify-between mt-2 text-sm",children:[i.jsxs("span",{className:"text-gray-400",children:["Producido: ",i.jsx("span",{className:"text-white font-medium",children:R.QuantityProduced||"0"})," ",R.MeasurementUnit||""]}),i.jsxs("span",{className:"text-gray-400",children:["Objetivo: ",i.jsx("span",{className:"text-white font-medium",children:R.QuantityToProduce||"0"})," ",R.MeasurementUnit||""]}),R.QuantityRemainedToProduce&&i.jsxs("span",{className:"text-gray-400",children:["Restante: ",i.jsx("span",{className:"text-white font-medium",children:R.QuantityRemainedToProduce})," ",R.MeasurementUnit||""]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t border-gray-700",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx(ms,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"text-sm text-gray-400",children:"Inicio Programado"})]}),i.jsx("p",{className:"text-white font-medium",children:de(R.StarteddAt)})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx(ms,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"text-sm text-gray-400",children:"Fin Programado"})]}),i.jsx("p",{className:"text-white font-medium",children:de(R.FinishedAt)})]})]})]})},X)})}),C.length>0&&i.jsx($e,{className:"mb-6",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[i.jsx(O0,{className:"w-5 h-5 text-blue-400"}),"Historial de rdenes de Fabricacin"]}),i.jsxs(St,{variant:"secondary",children:["ltimas ",Math.min(10,C.length)," rdenes"]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-gray-700",children:[i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-400",children:"Orden"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-400",children:"Producto"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-400",children:"Estado"}),i.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-400",children:"Progreso"}),i.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-400",children:"Producido"}),i.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-400",children:"Objetivo"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-400",children:"Inicio"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-400",children:"Fin"})]})}),i.jsx("tbody",{children:C.sort((R,X)=>{const q=R.StarteddAt?new Date(R.StarteddAt):new Date(0);return(X.StarteddAt?new Date(X.StarteddAt):new Date(0))-q}).slice(0,10).map((R,X)=>{const q=oe(R),ce=ge(R.QuantityProduced,R.QuantityToProduce),P=q.icon;return i.jsxs("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50 transition-colors",children:[i.jsxs("td",{className:"py-3 px-4",children:[i.jsx("span",{className:"font-semibold text-white",children:R.OrderNumber}),R.OrderNType&&i.jsx(St,{variant:"secondary",className:"ml-2 text-xs",children:R.OrderNType})]}),i.jsx("td",{className:"py-3 px-4",children:i.jsxs("div",{children:[i.jsx("p",{className:"text-white text-sm font-medium",children:R.ProductName||"N/A"}),R.ProductDescription&&i.jsx("p",{className:"text-gray-400 text-xs line-clamp-1",children:R.ProductDescription})]})}),i.jsx("td",{className:"py-3 px-4",children:i.jsxs(St,{variant:q.color,className:"text-xs",children:[i.jsx(P,{className:"w-3 h-3 mr-1 inline"}),q.text]})}),i.jsx("td",{className:"py-3 px-4 text-right",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsxs("span",{className:"text-white text-sm font-medium",children:[ce,"%"]}),i.jsx("div",{className:"w-16 bg-gray-700 rounded-full h-2 overflow-hidden",children:i.jsx("div",{className:"h-full bg-blue-600 transition-all",style:{width:`${ce}%`}})})]})}),i.jsx("td",{className:"py-3 px-4 text-right",children:i.jsxs("span",{className:"text-white text-sm",children:[R.QuantityProduced||"0"," ",R.MeasurementUnit||""]})}),i.jsx("td",{className:"py-3 px-4 text-right",children:i.jsxs("span",{className:"text-gray-400 text-sm",children:[R.QuantityToProduce||"0"," ",R.MeasurementUnit||""]})}),i.jsx("td",{className:"py-3 px-4",children:i.jsx("span",{className:"text-gray-400 text-sm",children:de(R.StarteddAt)})}),i.jsx("td",{className:"py-3 px-4",children:i.jsx("span",{className:"text-gray-400 text-sm",children:de(R.FinishedAt)})})]},R.OrderNumber||X)})})]})}),C.length===0&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx(rr,{className:"w-12 h-12 text-gray-600 mx-auto mb-2 opacity-50"}),i.jsx("p",{className:"text-gray-400",children:"No hay rdenes en el historial"})]})]})})]})]})]})})}const vT=()=>{var t,r,a,n;const{t:e}=He();return i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:((r=(t=e.produccion)==null?void 0:t.programacion)==null?void 0:r.title)||"Programacin de Produccin"}),i.jsx("p",{children:((n=(a=e.produccion)==null?void 0:a.programacion)==null?void 0:n.description)||"Programacin de produccin"})]})},yT=()=>{var t,r,a,n;const{t:e}=He();return i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:((r=(t=e.produccion)==null?void 0:t.oeeMetricas)==null?void 0:r.title)||"Mtricas OEE"}),i.jsx("p",{children:((n=(a=e.produccion)==null?void 0:a.oeeMetricas)==null?void 0:n.description)||"Mtricas OEE (Overall Equipment Effectiveness)"})]})};function wT(){const[e,t]=D.useState(null),[r,a]=D.useState(null),n=D.useCallback((u,d=null)=>{t(u),d&&setTimeout(()=>t(null),d)},[]),s=D.useCallback((u,d=3e3)=>{a(u),d&&setTimeout(()=>a(null),d)},[]),o=D.useCallback(()=>{t(null)},[]),l=D.useCallback(()=>{a(null)},[]),c=D.useCallback(()=>{t(null),a(null)},[]);return{error:e,success:r,showError:n,showSuccess:s,clearError:o,clearSuccess:l,clearAll:c}}function kT({error:e,success:t,onClearError:r,onClearSuccess:a}){return!e&&!t?null:i.jsxs("div",{className:"mb-6 space-y-3",children:[e&&i.jsxs("div",{className:"bg-red-900/20 border border-red-500 rounded-lg p-4 flex items-start gap-3",role:"alert","aria-live":"assertive",children:[i.jsx(La,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),i.jsx("span",{className:"text-red-400 flex-1",children:e}),r&&i.jsx("button",{onClick:r,className:"p-1 hover:bg-red-900/30 rounded transition-colors","aria-label":"Cerrar mensaje de error",children:i.jsx(co,{className:"w-4 h-4 text-red-400"})})]}),t&&i.jsxs("div",{className:"bg-green-900/20 border border-green-500 rounded-lg p-4 flex items-start gap-3",role:"status","aria-live":"polite",children:[i.jsx(ws,{className:"w-5 h-5 text-green-400 flex-shrink-0 mt-0.5"}),i.jsx("span",{className:"text-green-400 flex-1",children:t}),a&&i.jsx("button",{onClick:a,className:"p-1 hover:bg-green-900/30 rounded transition-colors","aria-label":"Cerrar mensaje de xito",children:i.jsx(co,{className:"w-4 h-4 text-green-400"})})]})]})}function Dm({message:e="Cargando...",fullScreen:t=!1}){const r=t?"min-h-screen bg-gray-900 p-6 flex items-center justify-center":"p-12 text-center";return i.jsx("div",{className:r,children:i.jsxs("div",{className:"text-center",children:[i.jsx(ft,{className:"w-12 h-12 text-blue-500 animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-400",children:e})]})})}function bT({icon:e,title:t,description:r,action:a}){return i.jsxs("div",{className:"p-12 text-center",children:[e&&i.jsx(e,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-400 text-lg mb-2",children:t}),r&&i.jsx("p",{className:"text-gray-500 text-sm",children:r}),a&&i.jsx("div",{className:"mt-4",children:a})]})}function ET({currentFactory:e,isGlobalView:t,lastUpdate:r}){const a=_s();return i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Dy,{className:"w-8 h-8 text-blue-400"}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-white",children:"Materiales y Consumibles"}),i.jsx("p",{className:"text-gray-400 mt-1",children:t?"Todas las fbricas":`Fbrica: ${e}`})]})]}),r&&i.jsxs("div",{className:"text-sm text-gray-400",children:["ltima actualizacin: ",r.toLocaleTimeString("es-ES")]})]}),i.jsxs("nav",{className:"flex items-center gap-2 text-sm text-gray-400 mb-4","aria-label":"Breadcrumb",children:[i.jsxs("button",{onClick:()=>a("/dashboard"),className:"hover:text-white transition-colors flex items-center gap-1",children:[i.jsx(Fy,{className:"w-4 h-4"}),"Dashboard"]}),i.jsx(ba,{className:"w-4 h-4"}),i.jsx("span",{className:"text-white",children:"Materiales y Consumibles"})]})]})}function ST({isOpen:e,onClose:t,consumption:r,onSave:a}){return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[i.jsx("h2",{className:"text-xl font-bold mb-4",children:"Editar Consumo"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Funcionalidad en desarrollo"}),i.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Cerrar"})]})}):null}function NT({isOpen:e,onClose:t,line:r,onSave:a}){return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[i.jsx("h2",{className:"text-xl font-bold mb-4",children:"Gestionar Dosificadores"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Funcionalidad en desarrollo"}),i.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Cerrar"})]})}):null}function CT({isOpen:e,onClose:t,line:r,onSave:a}){return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[i.jsx("h2",{className:"text-xl font-bold mb-4",children:"Gestionar Hoppers"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Funcionalidad en desarrollo"}),i.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Cerrar"})]})}):null}function _T({isOpen:e,onClose:t,line:r,onSave:a}){return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[i.jsx("h2",{className:"text-xl font-bold mb-4",children:"Gestionar Componentes"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Funcionalidad en desarrollo"}),i.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Cerrar"})]})}):null}const TT=D.memo(({line:e,onClick:t})=>{const r=e.activeOrder&&e.activeOrder.QuantityToProduce>0?Math.round(e.activeOrder.QuantityProduced/e.activeOrder.QuantityToProduce*100):0;return i.jsx($e,{className:"cursor-pointer hover:border-blue-500 transition-all",onClick:t,children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-gray-700 pb-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(br,{className:"w-8 h-8 text-blue-400"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-2xl font-bold text-white",children:e.line}),i.jsx("p",{className:"text-sm text-gray-400",children:e.factory})]})]}),i.jsx(ba,{className:"w-6 h-6 text-gray-400"})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-3 uppercase",children:"Mtricas de Lnea"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-xs text-gray-400",children:"Estado:"}),i.jsx(St,{variant:e.activeOrder?"success":"secondary",className:"text-xs",children:e.activeOrder?"Activa":"Inactiva"})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-xs text-gray-400",children:"rdenes:"}),i.jsx("span",{className:"text-sm text-white font-medium",children:e.ordersCount||0})]})]})]}),i.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-3 uppercase",children:"Orden Activa"}),e.activeOrder?i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-sm font-mono text-blue-400",children:e.activeOrder.OrderNumber}),i.jsx("p",{className:"text-xs text-gray-300 truncate",children:e.activeOrder.ProductName}),i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[i.jsx("span",{className:"text-gray-400",children:"Progreso"}),i.jsxs("span",{className:"text-white font-medium",children:[r,"%"]})]}),i.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-2 rounded-full transition-all",style:{width:`${r}%`}})})]})]}):i.jsx("p",{className:"text-sm text-gray-500",children:"Sin orden activa"})]}),i.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-3 uppercase",children:"Receta"}),e.recipe&&e.recipe.Components?i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-sm font-mono text-purple-400",children:e.recipe.SapCode}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(rr,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{className:"text-xs text-gray-300",children:[e.recipe.Components.length," componentes"]})]})]}):i.jsx("p",{className:"text-sm text-gray-500",children:"Sin receta cargada"})]})]})]})})},(e,t)=>{var o,l;const r=e.line.activeOrder,a=t.line.activeOrder,n=e.line.recipe,s=t.line.recipe;return e.line.id===t.line.id&&(r==null?void 0:r.OrderNumber)===(a==null?void 0:a.OrderNumber)&&(r==null?void 0:r.QuantityProduced)===(a==null?void 0:a.QuantityProduced)&&((o=n==null?void 0:n.Components)==null?void 0:o.length)===((l=s==null?void 0:s.Components)==null?void 0:l.length)});TT.displayName="LineCard";const ld=!1,he={log:()=>{},error:()=>{},warn:()=>{}};function jT(){He(),_s();const{error:e,success:t,showError:r,showSuccess:a,clearError:n,clearSuccess:s}=wT(),[o,l]=D.useState(()=>{const N=localStorage.getItem("selectedFactory");return N&&N!=="CX"?N:null}),c=!o;D.useEffect(()=>{const N=Q=>{var H;if(Q.reason&&typeof Q.reason=="object"&&Q.reason.message){const Y=Q.reason.message;if(Y.includes("A listener indicated an asynchronous response")||Y.includes("message channel closed")||Y.includes("Extension context invalidated")||Y.includes("Receiving end does not exist")){Q.preventDefault();return}}const ee=((H=Q.reason)==null?void 0:H.message)||String(Q.reason||"");if(ee.includes("A listener indicated an asynchronous response")||ee.includes("message channel closed")||ee.includes("Extension context invalidated")){Q.preventDefault();return}};return window.addEventListener("unhandledrejection",N),()=>{window.removeEventListener("unhandledrejection",N)}},[]),D.useEffect(()=>{const N=()=>{const Y=localStorage.getItem("selectedFactory"),pe=Y&&Y!=="CX"?Y:null;l(me=>pe!==me?(he.log(" Cambio de fbrica detectado:",{old:me,new:pe}),setTimeout(()=>{x(null),y(null),w([]),F(null),k([])},0),pe):me)};N();const Q=Y=>{Y.key==="selectedFactory"&&N()},ee=Y=>{N()};window.addEventListener("storage",Q),window.addEventListener("factoryChanged",ee);const H=setInterval(N,1e3);return()=>{window.removeEventListener("storage",Q),window.removeEventListener("factoryChanged",ee),clearInterval(H)}},[]);const[u,d]=D.useState([]),[f,h]=D.useState([]),[p,x]=D.useState(null),[m,w]=D.useState([]),[g,y]=D.useState(null),[v,k]=D.useState([]),[_,F]=D.useState(null),[b,S]=D.useState(!0),[C,B]=D.useState(!1),[T,U]=D.useState(!1),[K,de]=D.useState(!1),[oe,ge]=D.useState(!1),[Z,se]=D.useState(null),[z,xe]=D.useState(!1),[be,O]=D.useState(!1),[J,W]=D.useState(!1),[V,le]=D.useState([]),[we,R]=D.useState([]),[X,q]=D.useState(!1),[ce,P]=D.useState({componentSapCode:"",dosifierId:"",hopperId:""}),[Se,Ce]=D.useState(null),[Te,fe]=D.useState(null),[ve,ze]=D.useState(!1),[Ze,dt]=D.useState(!1),[Wt,_r]=D.useState(""),[Yt,Et]=D.useState(""),[sr,Pe]=D.useState(!1),[jt,ot]=D.useState(null),[wt,Ge]=D.useState(!1),[ct,Lt]=D.useState(!1),[ht,Tr]=D.useState(!1),[Na,la]=D.useState([]),[fn,Qr]=D.useState([]),[Ga,Kr]=D.useState([]),[Ca,pt]=D.useState(!1);D.useEffect(()=>{Xa()},[o]),D.useEffect(()=>{u.length>0&&qa()},[u]),D.useEffect(()=>{p&&Qa()},[p]),D.useEffect(()=>{g&&p&&(hr(),Yr())},[g,p]);const Mt=N=>{var Q;return N!=null&&N.factory?N.factory:(Q=N==null?void 0:N.hierarchical_level)!=null&&Q[0]?N.hierarchical_level[0]:""},Xa=async()=>{try{S(!0),he.log(" Cargando lneas - Vista Tabla Completa"),he.log(" Factory seleccionada:",o,"isGlobalView:",c);const N=await Ye.get("/asset/list");if(he.log(" Assets recibidos de la API:",(N==null?void 0:N.length)||0),N&&N.length>0&&ld){he.log(" Ejemplos de assets completos (primeros 3):",N.slice(0,3));const Y=new Set;N.slice(0,10).forEach(pe=>{Object.keys(pe).forEach(me=>Y.add(me))}),he.log(" Propiedades encontradas en assets:",Array.from(Y).sort())}let Q=null;if(o){const Y=(N||[]).find(pe=>(pe.Code===o||pe.code===o)&&(pe.ParentID===null||pe.parentID===null));Y?(Q=Y.ID||Y.id,he.log(" Fbrica seleccionada encontrada:",{code:Y.Code||Y.code,id:Q})):he.warn(" No se encontr la fbrica seleccionada:",o)}let ee=(N||[]).filter(Y=>{const pe=Y.Code||Y.code||"",me=Y.ParentID||Y.parentID,ke=Y.hierarchical_level||Y.HierarchicalLevel,De=pe&&(pe.startsWith("Line_")||pe.startsWith("L")||pe.toLowerCase().includes("line")||pe.match(/^Line_\d+/i)||pe.match(/^L\d+/i)),Me=ke&&Array.isArray(ke)&&ke.length===2,Ae=me!=null;return(De||Me)&&Ae});if(he.log(" Lneas encontradas despus del filtro inicial:",ee.length),Q!==null){he.log(" Filtrando lneas por fbrica ID:",Q);const Y=ee.length;ee=ee.filter(pe=>{const me=pe.ParentID||pe.parentID,ke=me===Q;return!ke&&ld&&he.log(" Lnea no coincide con fbrica:",{lineCode:pe.Code||pe.code,lineParentId:me,selectedFactoryId:Q}),ke}),he.log(` Filtrado: ${Y} lneas antes, ${ee.length} despus del filtro por fbrica ${o}`)}if(he.log(" Assets totales:",(N==null?void 0:N.length)||0),he.log(" Lneas filtradas (nivel 1):",ee.length),ee.length===0&&N&&N.length>0){he.warn(" No se encontraron lneas con el filtro estricto, intentando filtro ms permisivo...");const Y=(N||[]).filter(pe=>{const me=pe.ParentID||pe.parentID,ke=pe.hierarchical_level||pe.HierarchicalLevel,De=me!=null,Me=ke&&Array.isArray(ke)&&ke.length===2;return De&&Me});if(Y.length>0)he.warn(` Encontradas ${Y.length} lneas con filtro permisivo`),ee=Y;else{he.warn(" No se encontraron lneas ni con el filtro permisivo");const pe=N.filter(me=>(me.ParentID||me.parentID)!==null&&(me.ParentID||me.parentID)!==void 0);pe.length>0&&he.warn(" Assets con ParentID (primeros 10):",pe.slice(0,10).map(me=>({code:me.Code||me.code,name:me.Name||me.name,parentId:me.ParentID||me.parentID,hierarchical_level:me.hierarchical_level||me.HierarchicalLevel,allKeys:Object.keys(me).slice(0,10)})))}}if(he.log(" Lneas cargadas:",ee.length,"lneas"),ee.length===0&&N&&N.length>0){he.warn(" No se encontraron lneas. Analizando estructura de assets:");const Y=N.filter(Ae=>Ae.hierarchical_level&&Ae.hierarchical_level.length===1),pe=N.filter(Ae=>Ae.hierarchical_level&&Ae.hierarchical_level.length===2),me=N.filter(Ae=>Ae.hierarchical_level&&Ae.hierarchical_level.length===3),ke=N.filter(Ae=>!Ae.hierarchical_level||Ae.hierarchical_level.length!==1&&Ae.hierarchical_level.length!==2&&Ae.hierarchical_level.length!==3);he.warn(" Anlisis de assets:"),he.warn(`  - Assets con 1 nivel: ${Y.length}`),he.warn(`  - Assets con 2 niveles: ${pe.length}`),he.warn(`  - Assets con 3 niveles: ${me.length}`),he.warn(`  - Otros assets: ${ke.length}`),Y.length>0&&he.warn(" Ejemplos de assets con 1 nivel (primeros 10):",Y.slice(0,10).map(Ae=>{var qe;return{code:Ae.code,name:Ae.name,hierarchical_level:Ae.hierarchical_level,firstLevel:(qe=Ae.hierarchical_level)==null?void 0:qe[0],location:Ae.location,factory:Ae.factory}})),ke.length>0&&he.warn(' Ejemplos de "otros assets" (primeros 5 completos):',ke.slice(0,5));const De=N.filter(Ae=>{const qe=String(Ae.code||"").toUpperCase(),Ot=String(Ae.name||"").toUpperCase(),lt=String(Ae.location||"").toUpperCase(),Bt=String(Ae.factory||"").toUpperCase();return qe.includes("CXC")||Ot.includes("CXC")||lt.includes("CXC")||Bt.includes("CXC")});De.length>0&&he.warn(` Assets relacionados con CXC (${De.length}):`,De.slice(0,10).map(Ae=>({code:Ae.code,name:Ae.name,hierarchical_level:Ae.hierarchical_level,location:Ae.location,factory:Ae.factory,allProperties:Object.keys(Ae)})));const Me=N.filter(Ae=>{const qe=String(Ae.code||"").toLowerCase(),Ot=String(Ae.name||"").toLowerCase(),lt=String(Ae.location||"").toLowerCase();return qe.includes("line")||qe.match(/^l\d+/)||Ot.includes("line")||lt.includes("line")});Me.length>0&&he.warn(` Assets que podran ser lneas (${Me.length}):`,Me.slice(0,10).map(Ae=>({code:Ae.code,name:Ae.name,hierarchical_level:Ae.hierarchical_level,location:Ae.location,factory:Ae.factory})))}else ee.length>0&&he.log(" Datos de lneas:",ee.map(Y=>({code:Y.Code||Y.code,id:Y.ID||Y.id,parentId:Y.ParentID||Y.parentID,factory:o})));const H=ee.map(Y=>{const pe=Y.ParentID||Y.parentID,me=Y.Code||Y.code||"";let ke=o||"";if(pe!=null&&N){const De=N.find(Me=>(Me.ID||Me.id)===pe);De?(ke=De.Code||De.code||o||"",he.log(` Fbrica encontrada para lnea ${me}:`,ke,"desde ParentID:",pe)):he.warn(` No se encontr asset padre para lnea ${me} con ParentID:`,pe)}else he.warn(` Lnea ${me} no tiene ParentID vlido:`,pe);return ke||(ke=o||"",he.warn(` Usando selectedFactory como fallback para lnea ${me}:`,ke)),{...Y,code:me,id:Y.ID||Y.id||`line-${me}`,parentId:pe,factory:ke,line:me,hierarchical_level:Y.hierarchical_level||[ke,me]}});he.log(" Lneas mapeadas finales:",H.length),H.length>0&&he.log(" Primeras 3 lneas mapeadas:",H.slice(0,3).map(Y=>({id:Y.id,code:Y.code,factory:Y.factory,parentId:Y.parentId}))),d(H),n()}catch(N){he.error(" Error loading lines:",N),r("Error de conexin")}finally{S(!1)}},qa=async()=>{if(u.length===0){he.log(" No hay lneas para cargar datos"),h([]),W(!1);return}try{W(!0);const N=u.slice(0,10);he.log(" Cargando datos completos para",N.length,"lneas (de",u.length,"totales)");const Q=await Promise.all(N.map(async H=>{var Y,pe;try{let me=Mt(H);!me&&o&&(me=o,he.warn(` Usando selectedFactory como fallback para lnea ${H.code||H.line}:`,me));const ke=H.line||H.code||"",De=H.sap_code||H.code||H.line||"";if(me||he.error(" No se pudo determinar la fbrica para lnea:",{hierarchical_level:H.hierarchical_level,factory:H.factory,location:H.location,selectedFactory:o,line:H}),he.log(" Cargando datos para lnea:",{factory:me,prodLine:ke,sapCode:De,location:H.location,hierarchical_level:H.hierarchical_level}),!me||!ke)return he.error(" Lnea sin factory o prodLine:",{factory:me,prodLine:ke,line:H,selectedFactory:o}),{...H,orders:[],activeOrder:null,recipe:null};let Me;try{Me=await Ye.post("/sap/orders",{},{headers:{"Content-Type":"application/json",Factory:me,ProdLine:ke,SapCode:De}})}catch(lt){he.warn(" Error en primera llamada, reintentando con SapRequest header:",lt.message);try{Me=await Ye.post("/sap/orders",{},{headers:{"Content-Type":"application/json",Factory:me,ProdLine:ke,SapCode:De,SapRequest:"false"}})}catch{throw lt}}const Ae=Array.isArray(Me)?Me:[];he.log(` rdenes cargadas para ${ke}:`,Ae.length);const qe=Ae.find(lt=>lt.StarteddAt&&!lt.FinishedAt)||Ae[0];let Ot=null;if(qe)try{he.log(` Cargando receta para lnea ${ke}, orden ${qe.OrderNumber}`),Ot=await Ye.get("/sap/orderRecipe",{headers:{"Content-Type":"application/json",Factory:me,ProdLine:ke,SapOrderCode:qe.OrderNumber,SapRequest:"true"}})||null,he.log(` Receta cargada para ${ke}:`,Ot?`${((Y=Ot.Components)==null?void 0:Y.length)||0} componentes`:"sin datos")}catch(lt){he.error(` Error cargando receta para ${ke}:`,((pe=lt.response)==null?void 0:pe.data)||lt.message)}else he.log(` Lnea ${ke} no tiene orden activa`);return{...H,orders:Ae,activeOrder:qe,recipe:Ot}}catch(me){return he.error(" Error cargando datos para lnea:",me),{...H,orders:[],activeOrder:null,recipe:null,error:me.message}}}));he.log(" Datos completos cargados:",Q.length,"lneas");const ee=Q.filter(H=>H.id||H.code);h(ee),ee.length===0&&u.length>0&&he.warn(" No se pudieron cargar datos para ninguna lnea, pero hay",u.length,"lneas disponibles")}catch(N){he.error("Error loading lines with data:",N),he.warn(" Error al cargar datos completos, pero se mostrarn las lneas bsicas")}finally{W(!1)}},Qa=async(N=!1)=>{if(!p){he.log(" No selectedLine, retornando de loadOrders");return}try{B(!0),O(N);let Q=Mt(p);!Q&&o&&(Q=o,he.warn(" Usando selectedFactory como fallback en loadOrders:",Q));const ee=p.line||p.code||"",H=p.sap_code||p.code||p.line||"";if(!Q||!ee){he.error(" No se puede cargar rdenes: falta factory o prodLine:",{factory:Q,prodLine:ee,selectedLine:p,selectedFactory:o}),r("No se pudo determinar la fbrica o lnea de produccin");return}he.log(" Cargando rdenes para:",{factory:Q,prodLine:ee,sapCode:H,location:p.location,hierarchical_level:p.hierarchical_level});const Y={"Content-Type":"application/json",Factory:Q,ProdLine:ee,SapCode:H,SapRequest:N?"true":"false"},pe=await Ye.post("/sap/orders",{},{headers:Y}),me=Array.isArray(pe)?pe:Array.isArray(pe==null?void 0:pe.data)?pe.data:[];he.log("Orders loaded:",me.length,me),w(me),n(),N&&a("rdenes actualizadas desde SAP exitosamente")}catch(Q){he.error("Error loading orders:",Q),r("Error al cargar las rdenes de produccin")}finally{B(!1),O(!1)}},hr=async(N=!1)=>{var Q,ee;if(!g||!p){he.log(" No selectedOrder o selectedLine, retornando de loadRecipe");return}try{ge(!0);let H=Mt(p);!H&&o&&(H=o,he.warn(" Usando selectedFactory como fallback en loadRecipe:",H));const Y=p.line||p.code||"";if(!H||!Y){he.error(" No se puede cargar receta: falta factory o prodLine:",{factory:H,prodLine:Y,selectedLine:p,selectedFactory:o}),r("No se pudo determinar la fbrica o lnea de produccin");return}he.log(" Cargando receta para:",{orderNumber:g.OrderNumber,factory:H,prodLine:Y});const pe={"Content-Type":"application/json",SapOrderCode:g.OrderNumber,SapRequest:N?"true":"false",Factory:H,ProdLine:Y},ke=await Ye.get("/sap/orderRecipe",{headers:pe})||null;he.log(" Receta cargada:",ke),F(ke),N&&ke&&a("Receta cargada exitosamente desde SAP")}catch(H){he.error("Error loading recipe:",H);const Y=((ee=(Q=H.response)==null?void 0:Q.data)==null?void 0:ee.message)||"Error al cargar la receta";r(Y),F(null)}finally{ge(!1)}},Yr=async()=>{var N,Q,ee;if(!g||!p){he.log(" No selectedOrder o selectedLine, retornando de loadConsumptions");return}try{U(!0),n();const H=Mt(p),Y=p.line||p.code||"";he.log(" Cargando consumos para:",{orderNumber:g.OrderNumber,factory:H,prodLine:Y});const pe={"Content-Type":"application/json",Factory:H,ProdLine:Y,System:"",SapOrderCode:g.OrderNumber,SapRequest:"false"},me=await Ye.get("/sap/orderConsump/list",{headers:pe}),De=(Array.isArray(me)?me:Array.isArray(me==null?void 0:me.data)?me.data:[]).filter(Me=>Me.ComponentSapCode&&Me.ComponentSapCode.trim()!=="");k(De),se(new Date)}catch(H){if(he.error("Error loading consumptions:",H),H.status===404||(N=H.message)!=null&&N.includes("Not Found")||(Q=H.message)!=null&&Q.includes("404")){he.warn(" Endpoint /sap/orderConsump/list no disponible, usando array vaco"),k([]),se(new Date);return}((ee=H.response)==null?void 0:ee.status)===403?r("No tienes permisos para acceder a los consumos"):r("Error al cargar los consumos de materiales")}finally{U(!1)}},hn=async()=>{var N,Q,ee,H;if(!g||!p){r("Selecciona una orden y lnea primero");return}try{U(!0),n();const Y=p.factory||Mt(p),pe=p.line||p.code||"";if(!Y||!pe){r("Error: Faltan datos requeridos (factory o prodLine)");return}const me={"Content-Type":"application/json",Factory:Y,ProdLine:pe,SapOrderCode:g.OrderNumber.trim()};if(Se&&Te){const Ae=new Date(Se).toISOString(),qe=new Date(Te).toISOString();me.StartDate=Ae,me.EndDate=qe,he.log(" Usando fechas de Inicio/Fin OF:",{startDate:Ae,endDate:qe})}else he.log(" No hay fechas de Inicio/Fin OF, el backend las obtendr de la BD");he.log(" Calculando consumos desde InfluxDB:",{factory:Y,prodLine:pe,orderNumber:g.OrderNumber,hasDates:!!(Se&&Te),headers:me});const ke=await Ye.get("/sap/orderConsump/Calculate",{headers:me}),Me=(Array.isArray(ke)?ke:Array.isArray(ke==null?void 0:ke.data)?ke.data:[]).filter(Ae=>Ae.ComponentSapCode&&Ae.ComponentSapCode.trim()!=="");he.log(" Consumos calculados desde InfluxDB:",{total:Me.length,consumptions:Me}),k(Me),await hr(!0),a(`Consumos calculados exitosamente: ${Me.length} declaraciones encontradas`),se(new Date)}catch(Y){he.error("Error calculating consumptions:",Y);const pe=((Q=(N=Y.response)==null?void 0:N.data)==null?void 0:Q.message)||((H=(ee=Y.response)==null?void 0:ee.data)==null?void 0:H.error)||"Error al calcular los consumos desde InfluxDB";r(pe)}finally{U(!1)}},pn=async()=>{var N,Q,ee,H,Y,pe;if(he.log(" [handleSendToSAP] Botn clicado - Iniciando envo a SAP"),!g||!p){he.log(" [handleSendToSAP] Error: No hay orden o lnea seleccionada"),r("Selecciona una orden y lnea primero");return}if(!v||v.length===0){he.log(" [handleSendToSAP] Error: No hay consumos para enviar"),r("No hay consumos para enviar a SAP. Primero calcula los consumos.");return}if(!Se||!Te){he.log(" [handleSendToSAP] Error: Fechas no configuradas"),r("Las fechas de Inicio OF y Fin OF deben estar configuradas antes de enviar a SAP");return}try{he.log(" [handleSendToSAP] Validaciones pasadas, iniciando envo..."),de(!0),n();const me=p.factory||Mt(p),ke=p.line||p.code||"";if(!me||!ke){r("Error: Faltan datos requeridos (factory o prodLine)");return}const De={"Content-Type":"application/json",Factory:me,ProdLine:ke,SapOrderCode:g.OrderNumber.trim(),StartDate:new Date(Se).toISOString(),EndDate:new Date(Te).toISOString(),WorkdayID:"",Turno:"T1"};he.log(" [handleSendToSAP] Enviando consumos a SAP:",{factory:me,prodLine:ke,orderNumber:g.OrderNumber,consumptionsCount:v.length,startDate:De.StartDate,endDate:De.EndDate,headers:De}),console.log(" [handleSendToSAP] Llamando a API:","/sap/orderConsump/CalcToSAP"),console.log(" [handleSendToSAP] Headers:",De);const Me=await Ye.get("/sap/orderConsump/CalcToSAP",{headers:De});console.log(" [handleSendToSAP] Respuesta recibida:",Me),he.log(" [handleSendToSAP] Respuesta de SAP:",Me);const Ae=(Me==null?void 0:Me.results)||[],qe=(Me==null?void 0:Me.successCount)||0,Ot=(Me==null?void 0:Me.errorCount)||0;if(Ot===0)a(` Todos los consumos (${qe}) fueron enviados exitosamente a SAP`);else if(qe>0){a(` ${qe} consumos enviados exitosamente a SAP`,5e3);const lt=Ae.filter(Bt=>!Bt.success).map(Bt=>{const ua=Bt.componentSapCode||"N/A",xt=Bt.dosingUnit||"N/A",vn=Bt.errorMessage||"Error desconocido";return`${ua} (${xt}): ${vn}`}).join(" | ");r(` ${Ot} consumos fallaron: ${lt}`,15e3)}else{const lt=Ae.map(Bt=>{const ua=Bt.componentSapCode||"N/A",xt=Bt.dosingUnit||"N/A",vn=Bt.errorMessage||"Error desconocido";return`${ua} (${xt}): ${vn}`}).join(" | ");r(` Todos los consumos fallaron: ${lt}`,15e3)}se(new Date)}catch(me){he.error("Error sending to SAP:",me);const ke=((Q=(N=me.response)==null?void 0:N.data)==null?void 0:Q.message)||((H=(ee=me.response)==null?void 0:ee.data)==null?void 0:H.error)||"Error al enviar consumos a SAP";if((pe=(Y=me.response)==null?void 0:Y.data)!=null&&pe.results){const De=me.response.data.results,Me=De.filter(qe=>qe.success).length;De.filter(qe=>!qe.success).length,Me>0&&a(` ${Me} consumos enviados exitosamente`,5e3);const Ae=De.filter(qe=>!qe.success).map(qe=>{const Ot=qe.componentSapCode||"N/A",lt=qe.dosingUnit||"N/A",Bt=qe.errorMessage||"Error desconocido";return`${Ot} (${lt}): ${Bt}`}).join(" | ");r(`${ke} - ${Ae}`,15e3)}else r(ke)}finally{de(!1)}},xn=async N=>{var Q,ee;if(!(!g||!p)&&window.confirm(`Ests seguro de que deseas eliminar la declaracin de ${N.ComponentSapCode||"este componente"}?`))try{xe(!0),n();const H={"Content-Type":"application/json",Factory:p.factory||Mt(p),ProdLine:p.line||p.code,System:"",Machine:N.DosingUnit||"",Part:N.DosingHopper||"",SapOrderCode:g.OrderNumber,SapComponentCode:N.ComponentSapCode||""};await Ye.get("/sap/orderConsump/del",{headers:H}),await Yr(),await hr(!0),a("Declaracin eliminada exitosamente")}catch(H){he.error("Error deleting consumption:",H);const Y=((ee=(Q=H.response)==null?void 0:Q.data)==null?void 0:ee.message)||"Error al eliminar la declaracin";r(Y)}finally{xe(!1)}},_a=async(N,Q)=>{var ee,H;if(!(!g||!p))try{xe(!0),n();const Y={"Content-Type":"application/json",Factory:p.factory,ProdLine:p.line,System:"",Machine:Q.DosingUnit,Part:Q.DosingHopper,SapOrderCode:g.OrderNumber,SapComponentCode:Q.ComponentSapCode};await Ye.get("/sap/orderConsump/del",{headers:Y});const pe={"Content-Type":"application/json",Factory:p.factory,ProdLine:p.line,System:"",Machine:N.DosingUnit.trim(),Part:N.DosingHopper.trim(),SapOrderCode:g.OrderNumber,SapComponentCode:N.ComponentSapCode.trim()};await Ye.get("/sap/orderConsump/add",{headers:pe}),Pe(!1),ot(null),await Yr(),await hr(!0),a("Consumo editado exitosamente")}catch(Y){he.error("Error editing consumption:",Y);const pe=((H=(ee=Y.response)==null?void 0:ee.data)==null?void 0:H.message)||"Error al editar el consumo";r(pe)}finally{xe(!1)}},ca=D.useCallback(async()=>{var N,Q;if(!(!p||!g))try{q(!0),n();const ee=p.id||p.ID||p.code||p.Code||p.line||p.Line||p.sap_code||"",H=g.OrderNumber;if(he.log(" Datos de selectedLine:",{id:p.id,ID:p.ID,code:p.code,Code:p.Code,line:p.line,Line:p.Line,sap_code:p.sap_code,selectedLineCompleto:p}),!ee){const De="No se pudo obtener el ID de la lnea de produccin. Propiedades disponibles: "+Object.keys(p).join(", ");he.error("",De),r(De);return}he.log(" Cargando dosificadores y hoppers desde API:",{prodLineId:ee,orderNumber:H,headers:{ProdLine_ID:String(ee),SapOrderCode:H}});const Y=await Ye.get("/asset/dosingbyline",{headers:{ProdLine_ID:String(ee),SapOrderCode:H}});he.log(" Respuesta completa de /asset/dosingbyline:",JSON.stringify(Y,null,2));let pe=Y;if(Y!=null&&Y.data&&Array.isArray(Y.data))pe=Y.data;else if(Array.isArray(Y))pe=Y;else{he.error(" Respuesta no es un array:",Y),r("La respuesta de la API no tiene el formato esperado"),le([]),R([]);return}if(pe.length===0){he.log(" No se encontraron dosificadores para esta lnea"),le([]),R([]);return}he.log(" Procesando",pe.length,"dosificadores");const me=[],ke=[];pe.forEach((De,Me)=>{he.log(` Dosificador ${Me+1}:`,JSON.stringify(De,null,2));const Ae=String(De.ID||De.Id||De.id||De.DoserID||De.DoserId||`doser_${Me}`),qe=De.Name||De.name||De.DoserName||De.Doser||`Dosificador ${Me+1}`,Ot=De.Description||De.description||qe,lt=De.Location||De.location||"",Bt=De.Code||De.code||De.SapCode||De.sap_code||qe,ua=De.Components||De.components||De.Component||De.component||[];he.log("   Components encontrados:",ua.length,ua),he.log("   Dosificador ID (string):",Ae,"Tipo:",typeof Ae),me.push({id:Ae,name:qe,description:Ot,location:lt,code:Bt,rawData:De}),Array.isArray(ua)&&ua.length>0?ua.forEach((xt,vn)=>{const Rp=String(xt.ID||xt.Id||xt.id||xt.ComponentID||xt.ComponentId||xt.PartID||xt.PartId||`${Ae}_component_${vn}`),Cu=xt.Name||xt.name||xt.ComponentName||xt.Component||xt.PartName||xt.Part||`Component ${vn+1}`,zw=xt.Location||xt.location||"",$w=xt.Code||xt.code||xt.SapCode||xt.sap_code||Cu;ke.push({id:Rp,name:Cu,dosifierId:Ae,dosifierName:qe,location:zw,code:$w,rawData:xt}),he.log("     Component (Hopper) agregado:",{id:Rp,name:Cu,dosifierId:Ae,dosifierIdType:typeof Ae})}):he.warn(`   Dosificador "${qe}" no tiene components o la estructura es diferente`)}),le(me),R(ke),he.log(" Resumen final:",{dosificadores:me.length,hoppers:ke.length,dosersData:me,hoppersData:ke}),ke.length===0&&he.warn(" No se encontraron components (hoppers) en la respuesta. Estructura de datos:",JSON.stringify(pe,null,2))}catch(ee){he.error(" Error cargando dosificadores desde /asset/dosingbyline:",ee);const H=((Q=(N=ee.response)==null?void 0:N.data)==null?void 0:Q.message)||ee.message||"Error al cargar dosificadores y hoppers";r(`Error: ${H}`),le([]),R([])}finally{q(!1)}},[p,g,n,r]),mn=async()=>{if(!g||!p){r("Selecciona una orden y lnea primero");return}if(!ce.componentSapCode.trim()||!ce.dosifierId.trim()||!ce.hopperId.trim()){r("Por favor, completa todos los campos requeridos");return}try{xe(!0),n();const N=V.find(ke=>String(ke.id)===String(ce.dosifierId)),Q=we.find(ke=>String(ke.id)===String(ce.hopperId));if(!N||!Q){he.error(" No se encontraron dosificador o hopper:",{dosifierId:ce.dosifierId,hopperId:ce.hopperId,dosifiersDisponibles:V.map(ke=>({id:ke.id,name:ke.name})),hoppersDisponibles:we.map(ke=>({id:ke.id,name:ke.name,dosifierId:ke.dosifierId}))}),r("Error: No se encontraron los dosificadores o hoppers seleccionados");return}he.log(" Dosificador y hopper seleccionados:",{dosifier:{id:N.id,name:N.name,rawData:N.rawData},hopper:{id:Q.id,name:Q.name,dosifierId:Q.dosifierId,rawData:Q.rawData}});const ee=p.factory||Mt(p),H=p.line||p.code||"";if(he.log(" Propiedades de selectedLine (combinando mtodos de handleEditConsumption y loadOrders):",{factoryDirecta:p.factory,factoryDesdeGetFactory:Mt(p),factoryFinal:ee,lineDirecta:p.line,code:p.code,prodLineFinal:H,hierarchical_level:p.hierarchical_level,selectedLineCompleto:p}),!ee||!H||!N.name||!Q.name||!g.OrderNumber||!ce.componentSapCode.trim()){he.error(" Faltan valores requeridos:",{factory:ee,prodLine:H,machine:N.name,part:Q.name,orderNumber:g.OrderNumber,componentCode:ce.componentSapCode.trim(),selectedLineCompleto:p,hierarchical_level:p.hierarchical_level,factoryDirecta:p.factory,lineDirecta:p.line}),r("Error: Faltan datos requeridos para declarar el consumo. Verifica que la lnea tenga factory y line definidos.");return}const Y={"Content-Type":"application/json",Factory:ee.trim?ee.trim():ee,ProdLine:H.trim?H.trim():H,System:"",Machine:N.name.trim(),Part:Q.name.trim(),SapOrderCode:g.OrderNumber.trim?g.OrderNumber.trim():g.OrderNumber,SapComponentCode:ce.componentSapCode.trim()};Object.keys(Y).forEach(ke=>{(Y[ke]===void 0||Y[ke]===null)&&(he.error(` Header ${ke} tiene valor undefined o null:`,Y[ke]),Y[ke]="")}),he.log(" Headers finales para la API (comparar con handleEditConsumption):",{headers:Y,factory:ee,prodLine:H,machine:N.name.trim(),part:Q.name.trim(),orderNumber:g.OrderNumber,componentCode:ce.componentSapCode.trim()});const pe={"Content-Type":"application/json",Factory:p.factory,ProdLine:p.line,System:"",Machine:N.name.trim(),Part:Q.name.trim(),SapOrderCode:g.OrderNumber,SapComponentCode:ce.componentSapCode.trim()};he.log(" Headers para declarar consumo (comparacin con handleEditConsumption):",{headersActuales:Y,headersEsperados:pe,sonIguales:JSON.stringify(Y)===JSON.stringify(pe),factory:{actual:ee,esperado:p.factory,igual:ee===p.factory},prodLine:{actual:H,esperado:p.line,igual:H===p.line},machine:{actual:N.name.trim(),esperado:N.name.trim(),igual:!0},part:{actual:Q.name.trim(),esperado:Q.name.trim(),igual:!0},orderNumber:g.OrderNumber,componentCode:ce.componentSapCode.trim()}),he.log(" Declarando consumo (se permiten mltiples declaraciones):",{component:ce.componentSapCode,dosifier:N.name,hopper:Q.name,headers:Y,url:`${{}.VITE_API_URL||"http://18.213.58.26:8081"}/sap/orderConsump/add`});const me=ce.componentSapCode.trim();try{he.log(" Llamando a la API /sap/orderConsump/add:",{endpoint:"/sap/orderConsump/add",headers:Y,headersString:JSON.stringify(Y),urlCompleta:`${{}.VITE_API_URL||"http://18.213.58.26:8081"}/sap/orderConsump/add`,comparacionConEdit:{factory:{declarar:ee,editar:p.factory,igual:ee===p.factory},prodLine:{declarar:H,editar:p.line,igual:H===p.line}}}),await Ye.get("/sap/orderConsump/add",{headers:Y}),he.log(" API respondi correctamente, recargando datos..."),await new Promise(ke=>setTimeout(ke,500)),await Yr(),await hr(!0),a("Consumo declarado exitosamente")}catch(ke){he.error(" Error al llamar a la API del backend:",{message:ke.message,status:ke.status,response:ke.response,component:me}),r(ke.message&&ke.message.includes("Registro no insertado")?"El backend no pudo procesar la declaracin":"Error al comunicarse con el backend")}P({componentSapCode:"",dosifierId:"",hopperId:""})}catch(N){const Q={error:N,message:N.message,status:N.status,response:N.response};try{typeof headers<"u"&&(Q.headers=headers),typeof selectedDosifier<"u"&&(Q.selectedDosifier=selectedDosifier),typeof selectedHopper<"u"&&(Q.selectedHopper=selectedHopper)}catch{}Q.selectedLine=p,Q.selectedOrder=g,he.error(" Error crtico al declarar consumo:",Q);let ee="Error al declarar el consumo";N.message&&N.message!==`HTTP error! status: ${N.status}`?(ee=N.message,N.message.includes("Registro no insertado")&&(ee=`No se pudo insertar el registro. Posibles causas:
 Ya existe un consumo duplicado para esta combinacin (componente, dosificador y hopper)
 Los datos enviados no son vlidos segn las reglas del backend
 Falta algn dato requerido que el backend necesita

Verifica los logs de la consola para ver los datos exactos que se estn enviando.`)):N.status===500&&(ee="Error del servidor (500). Verifica los logs del backend para ms detalles. Posibles causas: valores incorrectos en los headers o problema en el procesamiento del servidor."),r(ee)}finally{xe(!1)}},gn=()=>{if(Se){const N=new Date(Se),Q=N.getFullYear(),ee=String(N.getMonth()+1).padStart(2,"0"),H=String(N.getDate()).padStart(2,"0"),Y=String(N.getHours()).padStart(2,"0"),pe=String(N.getMinutes()).padStart(2,"0");_r(`${Q}-${ee}-${H}T${Y}:${pe}`)}else{const N=new Date,Q=N.getFullYear(),ee=String(N.getMonth()+1).padStart(2,"0"),H=String(N.getDate()).padStart(2,"0"),Y=String(N.getHours()).padStart(2,"0"),pe=String(N.getMinutes()).padStart(2,"0");_r(`${Q}-${ee}-${H}T${Y}:${pe}`)}ze(!0)},E=()=>{Wt&&(Ce(new Date(Wt)),a("Fecha y hora de inicio de OF guardada correctamente")),ze(!1)},I=()=>{if(Te){const N=new Date(Te),Q=N.getFullYear(),ee=String(N.getMonth()+1).padStart(2,"0"),H=String(N.getDate()).padStart(2,"0"),Y=String(N.getHours()).padStart(2,"0"),pe=String(N.getMinutes()).padStart(2,"0");Et(`${Q}-${ee}-${H}T${Y}:${pe}`)}else{const N=new Date,Q=N.getFullYear(),ee=String(N.getMonth()+1).padStart(2,"0"),H=String(N.getDate()).padStart(2,"0"),Y=String(N.getHours()).padStart(2,"0"),pe=String(N.getMinutes()).padStart(2,"0");Et(`${Q}-${ee}-${H}T${Y}:${pe}`)}dt(!0)},j=()=>{Yt&&(fe(new Date(Yt)),a("Fecha y hora de fin de OF guardada correctamente")),dt(!1)},A=N=>N?new Date(N).toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"No establecida",L=N=>{if(!N)return"-";const Q=new Date(N),ee=Q.getFullYear(),H=String(Q.getMonth()+1).padStart(2,"0"),Y=String(Q.getDate()).padStart(2,"0"),pe=String(Q.getHours()).padStart(2,"0"),me=String(Q.getMinutes()).padStart(2,"0"),ke=String(Q.getSeconds()).padStart(2,"0"),De=String(Q.getMilliseconds()).padStart(3,"0"),Me=-Q.getTimezoneOffset(),Ae=String(Math.floor(Math.abs(Me)/60)).padStart(2,"0"),qe=String(Math.abs(Me)%60).padStart(2,"0"),Ot=Me>=0?"+":"-";return`${ee}-${H}-${Y} ${pe}:${me}:${ke}.${De} ${Ot}${Ae}${qe}`};D.useEffect(()=>{p&&g?ca():(le([]),R([]))},[p,g,ca]);const M=D.useCallback(()=>{const Q=[...new Set(v.map(ee=>ee.DosingUnit).filter(Boolean))].sort().map(ee=>({id:ee,name:ee}));la(Q)},[v]),re=async N=>{try{pt(!0),n(),la(Q=>[...Q,{id:N.name,name:N.name,description:N.description}]),a("Dosificador agregado exitosamente"),M()}catch(Q){he.error("Error adding dosifier:",Q),r("Error al agregar el dosificador")}finally{pt(!1)}},ue=async(N,Q)=>{try{pt(!0),n(),la(ee=>ee.map(H=>H.id===N?{...H,...Q}:H)),a("Dosificador editado exitosamente")}catch(ee){he.error("Error editing dosifier:",ee),r("Error al editar el dosificador")}finally{pt(!1)}},te=async N=>{try{pt(!0),n(),la(Q=>Q.filter(ee=>ee.id!==N)),a("Dosificador eliminado exitosamente")}catch(Q){he.error("Error deleting dosifier:",Q),r("Error al eliminar el dosificador")}finally{pt(!1)}},ae=D.useCallback(()=>{const N=[],Q=new Set;v.forEach(ee=>{const H=ee.DosingUnit||"Sin Dosificador",Y=ee.DosingHopper||"Sin Hopper",pe=`${H}-${Y}`;Q.has(pe)||(Q.add(pe),N.push({id:pe,name:Y,dosifier:H,dosifierId:H}))}),Qr(N)},[v]),ne=async N=>{try{pt(!0),n(),Qr(Q=>[...Q,{id:`${N.dosifierId}-${N.name}`,name:N.name,dosifier:N.dosifierId,dosifierId:N.dosifierId,description:N.description}]),a("Hopper agregado exitosamente"),ae()}catch(Q){he.error("Error adding hopper:",Q),r("Error al agregar el hopper")}finally{pt(!1)}},ye=async(N,Q)=>{try{pt(!0),n(),Qr(ee=>ee.map(H=>H.id===N?{...H,...Q}:H)),a("Hopper editado exitosamente")}catch(ee){he.error("Error editing hopper:",ee),r("Error al editar el hopper")}finally{pt(!1)}},_e=async N=>{try{pt(!0),n(),Qr(Q=>Q.filter(ee=>ee.id!==N)),a("Hopper eliminado exitosamente")}catch(Q){he.error("Error deleting hopper:",Q),r("Error al eliminar el hopper")}finally{pt(!1)}},Fe=D.useCallback(()=>{const Q=[...new Set(v.map(ee=>ee.ComponentSapCode).filter(Boolean))].sort().map(ee=>({id:ee,sapCode:ee,ComponentSapCode:ee}));Kr(Q)},[v]),Ee=async N=>{try{pt(!0),n(),Kr(Q=>[...Q,{id:N.sapCode,sapCode:N.sapCode,ComponentSapCode:N.sapCode,description:N.description,unit:N.unit}]),a("Componente agregado exitosamente"),Fe()}catch(Q){he.error("Error adding component:",Q),r("Error al agregar el componente")}finally{pt(!1)}},je=async(N,Q)=>{try{pt(!0),n(),Kr(ee=>ee.map(H=>H.id===N?{...H,...Q,ComponentSapCode:Q.sapCode}:H)),a("Componente editado exitosamente")}catch(ee){he.error("Error editing component:",ee),r("Error al editar el componente")}finally{pt(!1)}},Ue=async N=>{try{pt(!0),n(),Kr(Q=>Q.filter(ee=>ee.id!==N)),a("Componente eliminado exitosamente")}catch(Q){he.error("Error deleting component:",Q),r("Error al eliminar el componente")}finally{pt(!1)}};return D.useEffect(()=>{v.length>0&&(M(),ae(),Fe())},[v,M,ae,Fe]),b?i.jsx(Dm,{message:"Cargando lneas de produccin...",fullScreen:!0}):i.jsx("div",{className:"min-h-screen bg-gray-900 p-6",children:i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx(ET,{currentFactory:o,isGlobalView:c,lastUpdate:Z}),i.jsx(kT,{error:e,success:t,onClearError:n,onClearSuccess:s}),!p&&i.jsx($e,{className:"mb-6",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:"Seleccionar Lnea de Produccin"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:()=>{O(!0),Promise.all(u.map(N=>{const Q=N.sap_code||N.code||N.line||"";return Ye.post("/sap/orders",{},{headers:{"Content-Type":"application/json",Factory:N.factory,ProdLine:N.line,SapCode:Q,SapRequest:"true"}}).catch(ee=>(he.error(`Error sincronizando lnea ${N.line}:`,ee),null))})).then(()=>{a("Todas las lneas sincronizadas con SAP exitosamente"),qa()}).catch(N=>{he.error("Error en sincronizacin masiva:",N),r("Error al sincronizar algunas lneas con SAP")}).finally(()=>{O(!1)})},disabled:be,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-700 disabled:cursor-not-allowed rounded-lg transition-colors text-white text-sm",children:[be?i.jsx(ft,{className:"w-4 h-4 animate-spin"}):i.jsx(Zr,{className:"w-4 h-4"}),i.jsx("span",{children:"Sincronizar SAP (Todas)"})]}),i.jsxs("button",{onClick:Xa,disabled:b,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed rounded-lg transition-colors text-white text-sm",children:[b?i.jsx(ft,{className:"w-4 h-4 animate-spin"}):i.jsx(Zr,{className:"w-4 h-4"}),i.jsx("span",{children:"Actualizar"})]})]})]}),J?i.jsx(Dm,{message:"Cargando informacin completa de las lneas..."}):f.length===0&&u.length===0?i.jsx(bT,{icon:br,title:"No hay lneas disponibles",description:`No se encontraron lneas de produccin${o?` para la fbrica ${o}`:""}`}):i.jsxs("div",{className:"space-y-4",children:[f.length>0&&f.map(N=>{var Y,pe,me,ke,De,Me;const Q=N.activeOrder,ee=N.recipe,H=Q&&Q.QuantityToProduce>0?Math.round(Q.QuantityProduced/Q.QuantityToProduce*100):0;return i.jsx($e,{className:"cursor-pointer hover:border-blue-500 transition-all",onClick:()=>x(N),children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-gray-700 pb-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(br,{className:"w-8 h-8 text-blue-400"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-2xl font-bold text-white",children:N.line}),i.jsxs("p",{className:"text-sm text-gray-400",children:[N.location||N.factory,"  ",i.jsx("span",{className:"font-mono",children:N.code||N.sap_code||"N/A"})]})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(St,{variant:N.influx_available?"success":"secondary",children:N.influx_available?"Activa":"Sin datos"}),i.jsx(St,{variant:((Y=N.status)==null?void 0:Y.toLowerCase())==="running"||((pe=N.status)==null?void 0:pe.toLowerCase())==="operando"?"success":((me=N.status)==null?void 0:me.toLowerCase())==="stopped"||((ke=N.status)==null?void 0:ke.toLowerCase())==="detenida"?"danger":((De=N.status)==null?void 0:De.toLowerCase())==="maintenance"||((Me=N.status)==null?void 0:Me.toLowerCase())==="mantenimiento"?"warning":"secondary",children:N.status==="running"?"Operando":N.status==="stopped"?"Detenida":N.status==="maintenance"?"Mantenimiento":N.status||"Desconocido"}),N.oee!==void 0&&N.oee!==null&&i.jsxs("div",{className:"text-right",children:[i.jsx("p",{className:"text-xs text-gray-400",children:"OEE"}),i.jsxs("p",{className:`text-lg font-bold ${N.oee>=85?"text-green-500":N.oee>=70?"text-yellow-500":"text-red-500"}`,children:[N.oee.toFixed(1),"%"]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-3 uppercase",children:"Mtricas de Lnea"}),N.speed!==void 0&&N.speed!==null||N.production!==void 0&&N.production!==null||N.oee!==void 0&&N.oee!==null||N.last_update?i.jsxs("div",{className:"space-y-3",children:[N.speed!==void 0&&N.speed!==null&&i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-xs text-gray-400",children:"Velocidad:"}),i.jsxs("span",{className:"text-lg font-bold text-white font-mono",children:[N.speed.toFixed(1)," ",i.jsx("span",{className:"text-sm text-gray-500",children:"kg/h"})]})]}),N.production!==void 0&&N.production!==null&&i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-xs text-gray-400",children:"Produccin:"}),i.jsxs("span",{className:"text-lg font-bold text-white font-mono",children:[N.production.toFixed(0)," ",i.jsx("span",{className:"text-sm text-gray-500",children:"m"})]})]}),N.oee!==void 0&&N.oee!==null&&i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-xs text-gray-400",children:"OEE:"}),i.jsxs("span",{className:`text-lg font-bold font-mono ${N.oee>=85?"text-green-500":N.oee>=70?"text-yellow-500":"text-red-500"}`,children:[N.oee.toFixed(1),"%"]})]}),N.last_update&&i.jsxs("div",{className:"pt-2 border-t border-gray-700",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"ltima actualizacin"}),i.jsx("p",{className:"text-sm text-gray-300",children:new Date(N.last_update).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}):i.jsx("div",{className:"flex items-center justify-center h-full min-h-[150px]",children:i.jsxs("div",{className:"text-center",children:[i.jsx(rr,{className:"w-12 h-12 text-gray-600 mx-auto mb-2"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Sin mtricas disponibles"})]})})]}),i.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-3 uppercase",children:"Orden de Fabricacin"}),Q?i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Nmero de Orden"}),i.jsx("p",{className:"text-lg font-bold text-white font-mono",children:Q.OrderNumber})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Producto"}),i.jsx("p",{className:"text-sm text-white font-medium line-clamp-2",children:Q.ProductName||"-"})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-2 pt-2 border-t border-gray-700",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"A Producir"}),i.jsx("p",{className:"text-lg font-bold text-blue-400",children:Q.QuantityToProduce||"0"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Producido"}),i.jsx("p",{className:"text-lg font-bold text-green-400",children:Q.QuantityProduced||"0"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Pendiente"}),i.jsx("p",{className:"text-lg font-bold text-orange-400",children:Q.QuantityRemainedToProduce||"0"})]})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-1",children:[i.jsx("p",{className:"text-xs text-gray-400",children:"Progreso"}),i.jsxs("p",{className:"text-sm font-bold text-white",children:[H,"%"]})]}),i.jsx("div",{className:"w-full bg-gray-700 rounded-full h-3 overflow-hidden",children:i.jsx("div",{className:"h-full bg-gradient-to-r from-blue-600 to-green-500 transition-all duration-500",style:{width:`${H}%`}})})]})]}):i.jsx("div",{className:"flex items-center justify-center h-full min-h-[150px]",children:i.jsxs("div",{className:"text-center",children:[i.jsx(rr,{className:"w-12 h-12 text-gray-600 mx-auto mb-2"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Sin orden activa"})]})})]}),i.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-3 uppercase",children:"Receta y Componentes"}),ee&&ee.Components&&ee.Components.length>0?i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Cdigo SAP Receta"}),i.jsx("p",{className:"text-sm font-mono text-white",children:ee.SapCode||(Q==null?void 0:Q.OrderNumber)||"-"})]}),i.jsxs("div",{className:"pt-2 border-t border-gray-700",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Componentes"}),i.jsx(St,{variant:"info",className:"text-xs",children:ee.Components.length})]}),i.jsxs("div",{className:"space-y-1.5 max-h-[120px] overflow-y-auto",children:[ee.Components.slice(0,5).map((Ae,qe)=>i.jsxs("div",{className:"flex items-center justify-between bg-gray-900/50 rounded p-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-xs font-mono text-gray-400 truncate",children:Ae.SapCode||"-"}),i.jsx("p",{className:"text-xs text-gray-500 truncate",children:Ae.Description||"-"})]}),i.jsxs("div",{className:"text-right ml-2",children:[i.jsx("p",{className:"text-xs font-medium text-white",children:Ae.RequiredQuantity||"0"}),i.jsx("p",{className:"text-xs text-gray-500",children:Ae.MeasurementUnitRQ||""})]})]},qe)),ee.Components.length>5&&i.jsxs("p",{className:"text-xs text-gray-500 text-center pt-1",children:["+",ee.Components.length-5," ms..."]})]})]})]}):i.jsx("div",{className:"flex items-center justify-center h-full min-h-[150px]",children:i.jsxs("div",{className:"text-center",children:[i.jsx(rr,{className:"w-12 h-12 text-gray-600 mx-auto mb-2"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Sin receta cargada"})]})})]})]})]})},N.id)}),(u.length>f.length||f.length===0)&&u.filter(N=>f.length===0||!f.find(Q=>(Q.id||Q.code)===(N.id||N.code))).map(N=>i.jsx($e,{className:"cursor-pointer hover:border-blue-500 transition-all",onClick:()=>x(N),children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-gray-700 pb-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(br,{className:"w-8 h-8 text-blue-400"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-2xl font-bold text-white",children:N.line||N.code}),i.jsxs("p",{className:"text-sm text-gray-400",children:[N.location||N.factory,"  ",i.jsx("span",{className:"font-mono",children:N.code||N.sap_code||"N/A"})]})]})]}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsx(St,{variant:"secondary",children:"Sin datos"})})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800/50 rounded-lg",children:[i.jsx("span",{className:"text-sm text-gray-400",children:"Estado:"}),i.jsx(St,{variant:"secondary",children:"Disponible"})]}),i.jsxs("div",{className:"text-center py-4",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Haz clic para ver detalles y rdenes"}),J&&i.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-gray-500",children:[i.jsx(ft,{className:"w-4 h-4 animate-spin"}),i.jsx("span",{children:"Cargando informacin adicional..."})]})]})]})]})},N.id||N.code))]})]})}),p&&!g&&i.jsxs(i.Fragment,{children:[i.jsx($e,{className:"mb-6",children:i.jsx("div",{className:"p-6",children:i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>{x(null),w([])},className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",children:i.jsx(ba,{className:"w-5 h-5 text-gray-400 rotate-180"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:p.line}),i.jsx("p",{className:"text-gray-400",children:p.location||p.factory})]})]})})})}),C?i.jsx($e,{children:i.jsxs("div",{className:"p-12 text-center",children:[i.jsx(ft,{className:"w-12 h-12 text-blue-500 animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-400",children:"Cargando rdenes de produccin..."})]})}):m.length===0?i.jsx($e,{children:i.jsxs("div",{className:"p-12 text-center",children:[i.jsx(rr,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-400 text-lg",children:"No hay rdenes de produccin disponibles"}),i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Selecciona una orden primero"})]})}):i.jsxs(i.Fragment,{children:[i.jsx($e,{className:"mb-6",children:i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h2",{className:"text-xl font-semibold text-white",children:["rdenes de Fabricacin (",m.length,")"]}),i.jsxs("button",{onClick:()=>Qa(!0),disabled:be,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed rounded-lg transition-colors text-white text-sm",children:[be?i.jsx(ft,{className:"w-4 h-4 animate-spin"}):i.jsx(Zr,{className:"w-4 h-4"}),i.jsx("span",{children:"SAP UPDATE"})]})]})})}),i.jsx("div",{className:"space-y-4",children:m.map((N,Q)=>{const ee=N.QuantityToProduce>0?Math.round(N.QuantityProduced/N.QuantityToProduce*100):0,H=N.StarteddAt&&!N.FinishedAt,Y=g&&g.OrderNumber===N.OrderNumber;return i.jsx($e,{className:`transition-all cursor-pointer ${Y?"border-blue-500 border-2":"hover:border-blue-500"}`,onClick:()=>{y(N),setTimeout(()=>{const pe=document.querySelector("[data-recipe-section]");pe&&pe.scrollIntoView({behavior:"smooth",block:"start"})},100)},children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-gray-700 pb-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(rr,{className:"w-8 h-8 text-blue-400"}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h3",{className:"text-2xl font-bold text-white font-mono",children:N.OrderNumber}),Y&&i.jsx(St,{variant:"info",className:"text-xs",children:"Seleccionada"})]}),i.jsx("p",{className:"text-sm text-gray-400",children:N.ProductName||"-"})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(St,{variant:H?"success":N.FinishedAt?"secondary":"warning",children:H?"En Produccin":N.FinishedAt?"Finalizada":"Pendiente"}),N.MeasurementUnit&&i.jsx(St,{variant:"info",children:N.MeasurementUnit})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-3 uppercase",children:"Informacin del Producto"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Cdigo Producto"}),i.jsx("p",{className:"text-lg font-bold text-white font-mono",children:N.ProductName||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Descripcin"}),i.jsx("p",{className:"text-sm text-gray-300 line-clamp-2",title:N.ProductDescription,children:N.ProductDescription||"-"})]})]})]}),i.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-3 uppercase",children:"Progreso de Produccin"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"A Producir"}),i.jsx("p",{className:"text-2xl font-bold text-blue-400",children:N.QuantityToProduce||"0"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Producido"}),i.jsx("p",{className:"text-2xl font-bold text-green-400",children:N.QuantityProduced||"0"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Pendiente"}),i.jsx("p",{className:"text-2xl font-bold text-orange-400",children:N.QuantityRemainedToProduce||"0"})]})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("p",{className:"text-xs text-gray-400",children:"Progreso"}),i.jsxs("p",{className:"text-sm font-bold text-white",children:[ee,"%"]})]}),i.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4 overflow-hidden",children:i.jsx("div",{className:"h-full bg-gradient-to-r from-blue-600 to-green-500 transition-all duration-500",style:{width:`${ee}%`}})})]})]})]})]})]})},Q)})})]})]}),p&&g&&i.jsxs(i.Fragment,{children:[i.jsx($e,{className:"mb-6",children:i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>{y(null),k([]),F(null)},className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",children:i.jsx(ba,{className:"w-5 h-5 text-gray-400 rotate-180"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:g.OrderNumber}),i.jsx("p",{className:"text-gray-400",children:g.ProductDescription||g.ProductName}),i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Lnea: ",p.line," | Fbrica: ",p.factory]})]})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsxs("button",{onClick:()=>{Yr(),hr()},disabled:T||oe,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed rounded-lg transition-colors",children:[T||oe?i.jsx(ft,{className:"w-4 h-4 animate-spin"}):i.jsx(Zr,{className:"w-4 h-4"}),i.jsx("span",{className:"text-white",children:"Actualizar"})]})})]})})}),i.jsx($e,{className:"mb-6",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("h3",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-2",children:[i.jsx(rr,{className:"w-6 h-6 text-blue-400"}),"Resumen de Orden de Fabricacin"]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"lg:col-span-1 bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-3 uppercase",children:"Datos de la OF"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Nmero de Orden"}),i.jsx("p",{className:"text-lg font-bold text-white font-mono",children:g.OrderNumber})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Tipo"}),i.jsx("p",{className:"text-sm text-gray-300",children:g.OrderNType||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Producto"}),i.jsx("p",{className:"text-sm text-white font-medium",children:g.ProductName||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Descripcin"}),i.jsx("p",{className:"text-sm text-gray-300 line-clamp-2",children:g.ProductDescription||"-"})]}),i.jsx("div",{className:"pt-2 border-t border-gray-700",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Unidad de Medida"}),i.jsx(St,{variant:"secondary",children:g.MeasurementUnit||"N/A"})]})})]})]}),i.jsxs("div",{className:"lg:col-span-1 bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-3 uppercase",children:"Estado de Avance"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"A Producir"}),i.jsx("p",{className:"text-2xl font-bold text-blue-400",children:g.QuantityToProduce||"0"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Producido"}),i.jsx("p",{className:"text-2xl font-bold text-green-400",children:g.QuantityProduced||"0"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Pendiente"}),i.jsx("p",{className:"text-2xl font-bold text-orange-400",children:g.QuantityRemainedToProduce||"0"})]})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("p",{className:"text-xs text-gray-400",children:"Progreso de Produccin"}),i.jsxs("p",{className:"text-sm font-bold text-white",children:[g.QuantityToProduce>0?Math.round(g.QuantityProduced/g.QuantityToProduce*100):0,"%"]})]}),i.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4 overflow-hidden",children:i.jsx("div",{className:"h-full bg-gradient-to-r from-blue-600 to-green-500 transition-all duration-500",style:{width:`${g.QuantityToProduce>0?g.QuantityProduced/g.QuantityToProduce*100:0}%`}})})]})]})]})]})]})}),i.jsx("div",{"data-recipe-section":!0,children:oe?i.jsx($e,{className:"mb-6",children:i.jsxs("div",{className:"p-12 text-center",children:[i.jsx(ft,{className:"w-12 h-12 text-blue-500 animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-400",children:"Cargando receta y componentes..."})]})}):_&&_.Components&&_.Components.length>0?i.jsx($e,{className:"mb-6",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-white",children:"Receta y Componentes"}),i.jsxs(St,{variant:"info",children:[_.Components.length," ",_.Components.length===1?"componente":"componentes"]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("p",{className:"text-sm text-gray-400",children:"Cdigo SAP Receta:"}),i.jsx("p",{className:"text-lg font-mono text-white",children:_.SapCode||g.OrderNumber}),_.Description&&i.jsx("p",{className:"text-sm text-gray-300 mt-1",children:_.Description})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-gray-700",children:[i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-300",children:"Cdigo SAP"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-300",children:"Descripcin"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-300",children:"Dosificador(es)"}),i.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-300",children:"Cantidad Requerida"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-300",children:"Unidad"}),i.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-300",children:"Cantidad Declarada"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-300",children:"Unidad"}),i.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-300",children:"Cantidad Retirada"})]})}),i.jsx("tbody",{children:_.Components.map((N,Q)=>{const ee=(N.SapCode||"").trim();return i.jsxs("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50 transition-colors",children:[i.jsx("td",{className:"py-3 px-4 text-gray-300 font-mono text-sm",children:N.SapCode||"-"}),i.jsx("td",{className:"py-3 px-4 text-gray-300",children:N.Description||"-"}),i.jsx("td",{className:"py-3 px-4",children:N.DosingUnits&&N.DosingUnits.length>0?i.jsx("div",{className:"flex flex-wrap gap-1",children:N.DosingUnits.map((H,Y)=>i.jsx(St,{variant:"secondary",className:"text-xs",children:H},Y))}):i.jsx("span",{className:"text-gray-500 text-sm",children:"-"})}),i.jsx("td",{className:"py-3 px-4 text-right text-white font-medium",children:N.RequiredQuantity||"0"}),i.jsx("td",{className:"py-3 px-4 text-gray-400 text-sm",children:N.MeasurementUnitRQ||"-"}),i.jsx("td",{className:"py-3 px-4 text-right",children:(()=>{const H=v.filter(pe=>{const me=(pe.ComponentSapCode||"").trim().toUpperCase(),ke=ee.toUpperCase();return me===ke}).reduce((pe,me)=>{const ke=parseFloat(me.CommittedQuantity)||0;return pe+ke},0),Y=H>0?H.toFixed(3):"0";return i.jsx("span",{className:"text-white font-medium",children:Y})})()}),i.jsx("td",{className:"py-3 px-4 text-gray-400 text-sm",children:N.MeasurementUnitCQ||N.MeasurementUnitRQ||"-"}),i.jsx("td",{className:"py-3 px-4 text-right text-white font-medium",children:N.WithDrawnQuantity||"0"})]},Q)})})]})})]})}):_&&(!_.Components||_.Components.length===0)?i.jsx($e,{className:"mb-6",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-white",children:"Receta"}),i.jsxs("button",{onClick:()=>hr(!0),disabled:oe,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-700 disabled:cursor-not-allowed rounded-lg transition-colors",children:[oe?i.jsx(ft,{className:"w-4 h-4 animate-spin"}):i.jsx(Zr,{className:"w-4 h-4"}),i.jsx("span",{className:"text-white",children:"Cargar desde SAP"})]})]}),i.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:["Cdigo SAP: ",i.jsx("span",{className:"font-mono text-white",children:_.SapCode||g.OrderNumber})]}),_.Description&&i.jsx("p",{className:"text-sm text-gray-300 mb-4",children:_.Description}),i.jsx("p",{className:"text-sm text-gray-500",children:"No hay componentes registrados para esta receta"}),i.jsx("p",{className:"text-xs text-gray-600 mt-2",children:'Haz clic en "Cargar desde SAP" para sincronizar la receta y sus componentes'})]})}):_?null:i.jsx($e,{className:"mb-6",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-white",children:"Receta y Componentes"}),i.jsxs("button",{onClick:()=>hr(!0),disabled:oe,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-700 disabled:cursor-not-allowed rounded-lg transition-colors",children:[oe?i.jsx(ft,{className:"w-4 h-4 animate-spin"}):i.jsx(Zr,{className:"w-4 h-4"}),i.jsx("span",{className:"text-white",children:"Cargar desde SAP"})]})]}),i.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"No hay receta registrada para esta orden"}),i.jsx("p",{className:"text-xs text-gray-600",children:'Haz clic en "Cargar desde SAP" para sincronizar la receta y sus componentes'})]})})}),p&&g&&i.jsx($e,{className:"mb-6",children:i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"flex-1",children:i.jsxs("button",{onClick:gn,className:"w-full flex items-center justify-between gap-3 px-4 py-3 bg-green-600 hover:bg-green-700 rounded-lg transition-colors text-white",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(hm,{className:"w-5 h-5"}),i.jsxs("div",{className:"text-left",children:[i.jsx("div",{className:"font-semibold",children:"Inicio OF"}),i.jsx("div",{className:"text-xs text-green-100",children:A(Se)})]})]}),i.jsx(rd,{className:"w-4 h-4"})]})}),i.jsx("div",{className:"flex-1",children:i.jsxs("button",{onClick:I,className:"w-full flex items-center justify-between gap-3 px-4 py-3 bg-red-600 hover:bg-red-700 rounded-lg transition-colors text-white",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(mm,{className:"w-5 h-5"}),i.jsxs("div",{className:"text-left",children:[i.jsx("div",{className:"font-semibold",children:"Fin OF"}),i.jsx("div",{className:"text-xs text-red-100",children:A(Te)})]})]}),i.jsx(rd,{className:"w-4 h-4"})]})})]})})}),p&&g&&_&&_.Components&&_.Components.length>0&&i.jsx($e,{className:"mb-6",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-white",children:"Declaracin de Consumo"}),i.jsx(St,{variant:"info",children:"Nuevo"})]}),i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Asocia un componente de la receta con un dosificador y hopper para declarar el consumo"}),X?i.jsxs("div",{className:"flex items-center justify-center py-8",children:[i.jsx(ft,{className:"w-6 h-6 text-blue-500 animate-spin mr-3"}),i.jsx("p",{className:"text-gray-400",children:"Cargando dosificadores y hoppers..."})]}):V.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx(La,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),i.jsx("p",{className:"text-gray-400",children:"No se encontraron dosificadores para esta lnea"}),i.jsxs("button",{onClick:ca,className:"mt-3 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors text-white text-sm",children:[i.jsx(Zr,{className:"w-4 h-4 inline mr-2"}),"Recargar"]})]}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Componente de la Receta ",i.jsx("span",{className:"text-red-400",children:"*"})]}),i.jsxs("select",{value:ce.componentSapCode,onChange:N=>{P(Q=>({...Q,componentSapCode:N.target.value,hopperId:""}))},className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Selecciona un componente"}),_.Components.map((N,Q)=>i.jsxs("option",{value:N.SapCode,children:[N.SapCode," - ",N.Description||"Sin descripcin"]},Q))]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Dosificador ",i.jsx("span",{className:"text-red-400",children:"*"})]}),i.jsxs("select",{value:ce.dosifierId,onChange:N=>{P(Q=>({...Q,dosifierId:N.target.value,hopperId:""}))},className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Selecciona un dosificador"}),V.map(N=>i.jsx("option",{value:N.id,children:N.code||N.name},N.id))]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Hopper ",i.jsx("span",{className:"text-red-400",children:"*"})]}),i.jsxs("select",{value:ce.hopperId,onChange:N=>P(Q=>({...Q,hopperId:N.target.value})),disabled:!ce.dosifierId,className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx("option",{value:"",children:ce.dosifierId?"Selecciona un hopper":"Primero selecciona un dosificador"}),we.filter(N=>{const Q=String(N.dosifierId),ee=String(ce.dosifierId);return Q===ee}).map(N=>i.jsx("option",{value:N.id,children:N.code||N.name},N.id))]}),ce.dosifierId&&we.filter(N=>String(N.dosifierId)===String(ce.dosifierId)).length===0&&i.jsxs("div",{className:"mt-2 p-3 bg-yellow-900/20 border border-yellow-700/50 rounded-lg",children:[i.jsx("p",{className:"text-xs text-yellow-400 mb-2",children:" No hay components (hoppers) disponibles para este dosificador"}),i.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[i.jsxs("p",{children:[" Total de components cargados: ",we.length]}),i.jsxs("p",{children:[" Dosificador seleccionado ID: ",ce.dosifierId]}),ld]}),i.jsxs("button",{onClick:ca,className:"mt-2 px-3 py-1.5 bg-yellow-600 hover:bg-yellow-700 rounded text-white text-xs flex items-center gap-1",children:[i.jsx(Zr,{className:"w-3 h-3"}),"Recargar desde API"]})]})]}),i.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-700",children:i.jsx("button",{onClick:mn,disabled:z||!ce.componentSapCode||!ce.dosifierId||!ce.hopperId,className:"flex items-center gap-2 px-6 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-700 disabled:cursor-not-allowed rounded-lg transition-colors text-white font-medium",children:z?i.jsxs(i.Fragment,{children:[i.jsx(ft,{className:"w-4 h-4 animate-spin"}),i.jsx("span",{children:"Declarando..."})]}):i.jsxs(i.Fragment,{children:[i.jsx(VN,{className:"w-4 h-4"}),i.jsx("span",{children:"Declarar Consumo"})]})})})]})]})}),p&&g&&v&&v.length>0&&i.jsx($e,{className:"mb-6",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-white",children:"Declaraciones Registradas"}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs(St,{variant:"secondary",className:"text-sm",children:[v.length," ",v.length===1?"declaracin":"declaraciones"]}),i.jsx("button",{onClick:hn,disabled:T,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-700 disabled:cursor-not-allowed rounded-lg transition-colors text-white text-sm font-medium",title:"Calcular consumos desde InfluxDB y actualizar cantidades declaradas",children:T?i.jsxs(i.Fragment,{children:[i.jsx(ft,{className:"w-4 h-4 animate-spin"}),i.jsx("span",{children:"Calculando..."})]}):i.jsxs(i.Fragment,{children:[i.jsx(zS,{className:"w-4 h-4"}),i.jsx("span",{children:"Calcular"})]})}),i.jsx("button",{onClick:()=>{console.log(' [BOTN] Clic en "Enviar a SAP" detectado'),console.log(" [BOTN] Estado:",{sendingToSAP:K,loadingConsumptions:T,hasConsumptions:!!v,consumptionsLength:(v==null?void 0:v.length)||0,disabled:K||T||!v||v.length===0}),pn()},disabled:K||T||!v||v.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed rounded-lg transition-colors text-white text-sm font-medium",title:"Enviar consumos a SAP y guardar en base de datos",children:K?i.jsxs(i.Fragment,{children:[i.jsx(ft,{className:"w-4 h-4 animate-spin"}),i.jsx("span",{children:"Enviando..."})]}):i.jsxs(i.Fragment,{children:[i.jsx(rr,{className:"w-4 h-4"}),i.jsx("span",{children:"Enviar a SAP"})]})})]})]}),i.jsx("div",{className:"space-y-3",children:v.map((N,Q)=>{var Y;const ee=(Y=_==null?void 0:_.Components)==null?void 0:Y.find(pe=>pe.SapCode===N.ComponentSapCode),H=(ee==null?void 0:ee.MeasurementUnitRQ)||(ee==null?void 0:ee.MeasurementUnitCQ)||"KG";return i.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg border border-gray-700 hover:border-gray-600 transition-colors",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"flex items-center gap-3 mb-2",children:i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"font-mono text-sm font-semibold text-blue-400",children:N.ComponentSapCode||"-"}),(ee==null?void 0:ee.Description)&&i.jsx("span",{className:"text-xs text-gray-400 truncate",children:ee.Description})]}),i.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-400",children:[i.jsxs("span",{children:[i.jsx("span",{className:"text-gray-500",children:"Dosificador:"})," ",i.jsx("span",{className:"text-white font-mono",children:N.DosingUnit||"-"})]}),i.jsxs("span",{children:[i.jsx("span",{className:"text-gray-500",children:"Hopper:"})," ",i.jsx("span",{className:"text-white font-mono",children:N.DosingHopper||"-"})]})]})]})}),N.CommittedQuantity&&i.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[i.jsx("span",{className:"text-sm text-gray-400",children:"Cantidad:"}),i.jsxs("span",{className:"text-lg font-bold text-green-400",children:[parseFloat(N.CommittedQuantity).toFixed(3)," ",H]})]}),(N.CreatedAt||N.UpdatedAt)&&i.jsxs("div",{className:"flex flex-col gap-1 mt-2 text-xs text-gray-500",children:[N.CreatedAt&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-500",children:"Fecha/hora inicio:"}),i.jsx("span",{className:"text-gray-300 font-mono",children:L(N.CreatedAt)})]}),N.UpdatedAt&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-500",children:"Fecha/hora fin:"}),i.jsx("span",{className:"text-gray-300 font-mono",children:L(N.UpdatedAt)})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[i.jsx("button",{onClick:()=>{ot(N),Pe(!0)},disabled:z,className:"p-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed rounded-lg transition-colors",title:"Editar declaracin",children:i.jsx(rd,{className:"w-4 h-4 text-white"})}),i.jsx("button",{onClick:()=>xn(N),disabled:z,className:"p-2 bg-red-600 hover:bg-red-700 disabled:bg-gray-700 disabled:cursor-not-allowed rounded-lg transition-colors",title:"Eliminar declaracin",children:i.jsx(dC,{className:"w-4 h-4 text-white"})})]})]},Q)})}),v.length===0&&i.jsxs("div",{className:"text-center py-8 text-gray-400",children:[i.jsx(rr,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),i.jsx("p",{children:"No hay declaraciones registradas"})]})]})})]}),sr&&jt&&i.jsx(ST,{consumption:jt,selectedOrder:g,onClose:()=>{Pe(!1),ot(null),n()},onSubmit:_a,isSubmitting:z}),i.jsx(NT,{isOpen:wt,onClose:()=>Ge(!1),dosifiers:Na,onAdd:re,onEdit:ue,onDelete:te,isSubmitting:Ca}),i.jsx(CT,{isOpen:ct,onClose:()=>Lt(!1),hoppers:fn,dosifiers:Na,onAdd:ne,onEdit:ye,onDelete:_e,isSubmitting:Ca}),i.jsx(_T,{isOpen:ht,onClose:()=>Tr(!1),components:Ga,onAdd:Ee,onEdit:je,onDelete:Ue,isSubmitting:Ca}),ve&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsx($e,{className:"w-full max-w-md mx-4",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[i.jsx(hm,{className:"w-5 h-5 text-green-500"}),"Inicio de OF"]}),i.jsx("button",{onClick:()=>ze(!1),className:"text-gray-400 hover:text-white transition-colors",children:i.jsx(co,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Fecha y Hora de Inicio"}),i.jsx("input",{type:"datetime-local",value:Wt,onChange:N=>_r(N.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500"})]}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx("button",{onClick:()=>ze(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white transition-colors",children:"Cancelar"}),i.jsx("button",{onClick:E,className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg text-white transition-colors",children:"Guardar"})]})]})})}),Ze&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsx($e,{className:"w-full max-w-md mx-4",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[i.jsx(mm,{className:"w-5 h-5 text-red-500"}),"Fin de OF"]}),i.jsx("button",{onClick:()=>dt(!1),className:"text-gray-400 hover:text-white transition-colors",children:i.jsx(co,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Fecha y Hora de Fin"}),i.jsx("input",{type:"datetime-local",value:Yt,onChange:N=>Et(N.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500"})]}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx("button",{onClick:()=>dt(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white transition-colors",children:"Cancelar"}),i.jsx("button",{onClick:j,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-white transition-colors",children:"Guardar"})]})]})})})]})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var i2=1252,AT=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],lp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},cp=function(e){AT.indexOf(e)!=-1&&(i2=lp[0]=e)};function FT(){cp(1252)}var Ma=function(e){cp(e)};function o2(){Ma(1200),FT()}function Om(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function PT(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function l2(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Uo=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?PT(e.slice(2)):t==254&&r==255?l2(e.slice(2)):t==65279?e.slice(1):e},Oc=function(t){return String.fromCharCode(t)},Rm=function(t){return String.fromCharCode(t)},Wn,ns="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Im(e){for(var t="",r=0,a=0,n=0,s=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,a=e.charCodeAt(u++),o=(r&3)<<4|a>>4,n=e.charCodeAt(u++),l=(a&15)<<2|n>>6,c=n&63,isNaN(a)?l=c=64:isNaN(n)&&(c=64),t+=ns.charAt(s)+ns.charAt(o)+ns.charAt(l)+ns.charAt(c);return t}function sa(e){var t="",r=0,a=0,n=0,s=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=ns.indexOf(e.charAt(u++)),o=ns.indexOf(e.charAt(u++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=ns.indexOf(e.charAt(u++)),a=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(a)),c=ns.indexOf(e.charAt(u++)),n=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var rt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),di=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ks(e){return rt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Lm(e){return rt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ia=function(t){return rt?di(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function fi(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function up(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return up(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Gn=rt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:di(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function DT(e){for(var t=[],r=0,a=e.length+250,n=ks(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|l>>6&15|(o&3)<<4,n[r++]=128|l&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>a&&(t.push(n.slice(0,r)),r=0,n=ks(65535),a=65530)}return t.push(n.slice(0,r)),Gn(t)}var Ir=/\u0000/g,zo=/[\u0001-\u0006]/g;function Ui(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ba(e,t){var r=""+e;return r.length>=t?r:Pt("0",t-r.length)+r}function dp(e,t){var r=""+e;return r.length>=t?r:Pt(" ",t-r.length)+r}function M0(e,t){var r=""+e;return r.length>=t?r:r+Pt(" ",t-r.length)}function OT(e,t){var r=""+Math.round(e);return r.length>=t?r:Pt("0",t-r.length)+r}function RT(e,t){var r=""+e;return r.length>=t?r:Pt("0",t-r.length)+r}var Mm=Math.pow(2,32);function yi(e,t){if(e>Mm||e<-Mm)return OT(e,t);var r=Math.round(e);return RT(r,t)}function B0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Bm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],cd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function IT(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Qe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Um={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},LT={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function U0(e,t,r){for(var a=e<0?-1:1,n=e*a,s=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(n);u<t&&(f=Math.floor(n),l=f*o+s,d=f*u+c,!(n-f<5e-8));)n=1/(n-f),s=o,o=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=s):(d=u,l=o)),!r)return[0,a*l,d];var h=Math.floor(a*l/d);return[h,a*l-h*d,d]}function Ls(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),s=0,o=[],l={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++a,++l.D)),a===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),a<60&&(s=(s+6)%7),r&&(s=HT(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=s,l}var c2=new Date(1899,11,31,0,0,0),MT=c2.getTime(),BT=new Date(1900,2,1,0,0,0);function u2(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=BT&&(r+=24*60*60*1e3),(r-(MT+(e.getTimezoneOffset()-c2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function fp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function UT(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function zT(e){var t=e<0?12:11,r=fp(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function $T(e){var t=fp(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Pl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=zT(e):t===10?r=e.toFixed(10).substr(0,12):r=$T(e),fp(UT(r.toUpperCase()))}function ii(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Pl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ea(14,u2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function HT(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function VT(e,t,r,a){var n="",s=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return cd[r.m-1][1];case 5:return cd[r.m-1][0];default:return cd[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return Bm[r.q][0];default:return Bm[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ba(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(n=Ba(s,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?Ba(c,u):"";return d}function ss(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var d2=/%/g;function WT(e,t,r){var a=t.replace(d2,""),n=t.length-a.length;return Tn(e,a,r*Math.pow(10,2*n))+Pt("%",n)}function GT(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Tn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function f2(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+f2(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(n+s)%n)+"."+d.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var h2=/# (\?+)( ?)\/( ?)(\d+)/;function XT(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),s=Math.floor(n/a),o=n-s*a,l=a;return r+(s===0?"":""+s)+" "+(o===0?Pt(" ",e[1].length+1+e[4].length):dp(o,e[1].length)+e[2]+"/"+e[3]+Ba(l,e[4].length))}function qT(e,t,r){return r+(t===0?"":""+t)+Pt(" ",e[1].length+2+e[4].length)}var p2=/^#*0*\.([0#]+)/,x2=/\).*[0#]/,m2=/\(###\) ###\\?-####/;function Pr(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function zm(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function $m(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function QT(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function KT(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function fa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(x2)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fa("n",a,r):"("+fa("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return GT(e,t,r);if(t.indexOf("%")!==-1)return WT(e,t,r);if(t.indexOf("E")!==-1)return f2(t,r);if(t.charCodeAt(0)===36)return"$"+fa(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+yi(c,t.length);if(t.match(/^[#?]+$/))return n=yi(r,0),n==="0"&&(n=""),n.length>t.length?n:Pr(t.substr(0,t.length-n.length))+n;if(s=t.match(h2))return XT(s,c,u);if(t.match(/^#+0+$/))return u+yi(c,t.length-t.indexOf("0"));if(s=t.match(p2))return n=zm(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Pr(s[1])).replace(/\.$/,"."+Pr(s[1])).replace(/\.(\d*)$/,function(x,m){return"."+m+Pt("0",Pr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+zm(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+ss(yi(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fa(e,t,-r):ss(""+(Math.floor(r)+QT(r,s[1].length)))+"."+Ba($m(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return fa(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Ui(fa(e,t.replace(/[\\-]/g,""),r)),o=0,Ui(Ui(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<n.length?n.charAt(o++):x==="0"?"0":""}));if(t.match(m2))return n=fa(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=U0(c,Math.pow(10,o)-1,!1),n=""+u,d=Tn("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+s[2]+"/"+s[3],d=M0(l[2],o),d.length<s[4].length&&(d=Pr(s[4].substr(s[4].length-d.length))+d),n+=d,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=U0(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?dp(l[1],o)+s[2]+"/"+s[3]+M0(l[2],o):Pt(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=yi(r,0),t.length<=n.length?n:Pr(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var f=t.indexOf(".")-o,h=t.length-n.length-f;return Pr(t.substr(0,f)+n+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=$m(r,s[1].length),r<0?"-"+fa(e,t,-r):ss(KT(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ba(0,3-x.length):"")+x})+"."+Ba(o,s[1].length);switch(t){case"###,##0.00":return fa(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=ss(yi(c,0));return p!=="0"?u+p:"";case"###,###.00":return fa(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return fa(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function YT(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Tn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function JT(e,t,r){var a=t.replace(d2,""),n=t.length-a.length;return Tn(e,a,r*Math.pow(10,2*n))+Pt("%",n)}function g2(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+g2(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(n+s)%n)+"."+d.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Za(e,t,r){if(e.charCodeAt(0)===40&&!t.match(x2)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Za("n",a,r):"("+Za("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return YT(e,t,r);if(t.indexOf("%")!==-1)return JT(e,t,r);if(t.indexOf("E")!==-1)return g2(t,r);if(t.charCodeAt(0)===36)return"$"+Za(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ba(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Pr(t.substr(0,t.length-n.length))+n;if(s=t.match(h2))return qT(s,c,u);if(t.match(/^#+0+$/))return u+Ba(c,t.length-t.indexOf("0"));if(s=t.match(p2))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Pr(s[1])).replace(/\.$/,"."+Pr(s[1])),n=n.replace(/\.(\d*)$/,function(x,m){return"."+m+Pt("0",Pr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+ss(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Za(e,t,-r):ss(""+r)+"."+Pt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Za(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Ui(Za(e,t.replace(/[\\-]/g,""),r)),o=0,Ui(Ui(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<n.length?n.charAt(o++):x==="0"?"0":""}));if(t.match(m2))return n=Za(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=U0(c,Math.pow(10,o)-1,!1),n=""+u,d=Tn("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+s[2]+"/"+s[3],d=M0(l[2],o),d.length<s[4].length&&(d=Pr(s[4].substr(s[4].length-d.length))+d),n+=d,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=U0(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?dp(l[1],o)+s[2]+"/"+s[3]+M0(l[2],o):Pt(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Pr(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var f=t.indexOf(".")-o,h=t.length-n.length-f;return Pr(t.substr(0,f)+n+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Za(e,t,-r):ss(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ba(0,3-x.length):"")+x})+"."+Ba(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=ss(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Za(e,t.slice(0,t.lastIndexOf(".")),r)+Pr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Tn(e,t,r){return(r|0)===r?Za(e,t,r):fa(e,t,r)}function ZT(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var v2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function bo(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":B0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(v2))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function e3(e,t,r,a){for(var n=[],s="",o=0,l="",c="t",u,d,f,h="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!B0(e,o))throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(f);n[n.length]={t:"t",v:s},++o;break;case"\\":var p=e.charAt(++o),x=p==="("||p===")"?p:"t";n[n.length]={t:x,v:p},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Ls(t,r,e.charAt(o+1)==="2"),u==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Ls(t,r),u==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),n[n.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var m={t:l,v:l};if(u==null&&(u=Ls(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(m.v=u.H>=12?"":""),m.t="T",o+=5,h="h"):(m.t="t",++o),u==null&&m.t==="T")return"";n[n.length]=m,c=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(v2)){if(u==null&&(u=Ls(t,r),u==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",bo(e)||(n[n.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;n[n.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;n[n.length]={t:l,v:s},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:a===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:l,v:l},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"t",v:l},++o;break}var w=0,g=0,y;for(o=n.length-1,c="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=h,c="h",w<1&&(w=1);break;case"s":(y=n[o].v.match(/\.0+$/))&&(g=Math.max(g,y[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=n[o].t;break;case"m":c==="s"&&(n[o].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&n[o].v.match(/[Hh]/)&&(w=1),w<2&&n[o].v.match(/[Mm]/)&&(w=2),w<3&&n[o].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var v="",k;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=VT(n[o].t.charCodeAt(0),n[o].v,u,g),n[o].t="t";break;case"n":case"?":for(k=o+1;n[k]!=null&&((l=n[k].t)==="?"||l==="D"||(l===" "||l==="t")&&n[k+1]!=null&&(n[k+1].t==="?"||n[k+1].t==="t"&&n[k+1].v==="/")||n[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[k].v==="/"||n[k].v===" "&&n[k+1]!=null&&n[k+1].t=="?"));)n[o].v+=n[k].v,n[k]={v:"",t:";"},++k;v+=n[o].v,o=k-1;break;case"G":n[o].t="t",n[o].v=ii(t,r);break}var _="",F,b;if(v.length>0){v.charCodeAt(0)==40?(F=t<0&&v.charCodeAt(0)===45?-t:t,b=Tn("n",v,F)):(F=t<0&&a>1?-t:t,b=Tn("n",v,F),F<0&&n[0]&&n[0].t=="t"&&(b=b.substr(1),n[0].v="-"+n[0].v)),k=b.length-1;var S=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){S=o;break}var C=n.length;if(S===n.length&&b.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(k>=n[o].v.length-1?(k-=n[o].v.length,n[o].v=b.substr(k+1,n[o].v.length)):k<0?n[o].v="":(n[o].v=b.substr(0,k+1),k=-1),n[o].t="t",C=o);k>=0&&C<n.length&&(n[C].v=b.substr(0,k+1)+n[C].v)}else if(S!==n.length&&b.indexOf("E")===-1){for(k=b.indexOf(".")-1,o=S;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(d=n[o].v.indexOf(".")>-1&&o===S?n[o].v.indexOf(".")-1:n[o].v.length-1,_=n[o].v.substr(d+1);d>=0;--d)k>=0&&(n[o].v.charAt(d)==="0"||n[o].v.charAt(d)==="#")&&(_=b.charAt(k--)+_);n[o].v=_,n[o].t="t",C=o}for(k>=0&&C<n.length&&(n[C].v=b.substr(0,k+1)+n[C].v),k=b.indexOf(".")+1,o=S;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==S)){for(d=n[o].v.indexOf(".")>-1&&o===S?n[o].v.indexOf(".")+1:0,_=n[o].v.substr(0,d);d<n[o].v.length;++d)k<b.length&&(_+=b.charAt(k++));n[o].v=_,n[o].t="t",C=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(F=a>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=Tn(n[o].t,n[o].v,F),n[o].t="t");var B="";for(o=0;o!==n.length;++o)n[o]!=null&&(B+=n[o].v);return B}var Hm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Vm(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function t3(e,t){var r=ZT(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Hm),l=r[1].match(Hm);return Vm(t,o)?[a,r[0]]:Vm(t,l)?[a,r[1]]:[a,r[o!=null&&l!=null?2:1]]}return[a,s]}function Ea(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Qe)[e],a==null&&(a=r.table&&r.table[Um[e]]||Qe[Um[e]]),a==null&&(a=LT[e]||"General");break}if(B0(a,0))return ii(t,r);t instanceof Date&&(t=u2(t,r.date1904));var n=t3(a,t);if(B0(n[1]))return ii(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return e3(n[1],t,r,n[0])}function Ys(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Qe[r]==null){t<0&&(t=r);continue}if(Qe[r]==e){t=r;break}}t<0&&(t=391)}return Qe[t]=e,t}function y2(){Qe=IT()}var r3={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},w2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function a3(e){var t=typeof e=="number"?Qe[e]:e;return t=t.replace(w2,"(\\d+)"),new RegExp("^"+t+"$")}function n3(e,t,r){var a=-1,n=-1,s=-1,o=-1,l=-1,c=-1;(t.match(w2)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":a=p;break;case"d":s=p;break;case"h":o=p;break;case"s":c=p;break;case"m":o>=0?l=p:n=p;break}}),c>=0&&l==-1&&n>=0&&(l=n,n=-1);var u=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:a==-1&&n==-1&&s==-1?d:u+"T"+d}var s3=function(){var e={};e.version="1.2.0";function t(){for(var b=0,S=new Array(256),C=0;C!=256;++C)b=C,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,S[C]=b;return typeof Int32Array<"u"?new Int32Array(S):S}var r=t();function a(b){var S=0,C=0,B=0,T=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)T[B]=b[B];for(B=0;B!=256;++B)for(C=b[B],S=256+B;S<4096;S+=256)C=T[S]=C>>>8^b[C&255];var U=[];for(B=1;B!=16;++B)U[B-1]=typeof Int32Array<"u"?T.subarray(B*256,B*256+256):T.slice(B*256,B*256+256);return U}var n=a(r),s=n[0],o=n[1],l=n[2],c=n[3],u=n[4],d=n[5],f=n[6],h=n[7],p=n[8],x=n[9],m=n[10],w=n[11],g=n[12],y=n[13],v=n[14];function k(b,S){for(var C=S^-1,B=0,T=b.length;B<T;)C=C>>>8^r[(C^b.charCodeAt(B++))&255];return~C}function _(b,S){for(var C=S^-1,B=b.length-15,T=0;T<B;)C=v[b[T++]^C&255]^y[b[T++]^C>>8&255]^g[b[T++]^C>>16&255]^w[b[T++]^C>>>24]^m[b[T++]]^x[b[T++]]^p[b[T++]]^h[b[T++]]^f[b[T++]]^d[b[T++]]^u[b[T++]]^c[b[T++]]^l[b[T++]]^o[b[T++]]^s[b[T++]]^r[b[T++]];for(B+=15;T<B;)C=C>>>8^r[(C^b[T++])&255];return~C}function F(b,S){for(var C=S^-1,B=0,T=b.length,U=0,K=0;B<T;)U=b.charCodeAt(B++),U<128?C=C>>>8^r[(C^U)&255]:U<2048?(C=C>>>8^r[(C^(192|U>>6&31))&255],C=C>>>8^r[(C^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,K=b.charCodeAt(B++)&1023,C=C>>>8^r[(C^(240|U>>8&7))&255],C=C>>>8^r[(C^(128|U>>2&63))&255],C=C>>>8^r[(C^(128|K>>6&15|(U&3)<<4))&255],C=C>>>8^r[(C^(128|K&63))&255]):(C=C>>>8^r[(C^(224|U>>12&15))&255],C=C>>>8^r[(C^(128|U>>6&63))&255],C=C>>>8^r[(C^(128|U&63))&255]);return~C}return e.table=r,e.bstr=k,e.buf=_,e.str=F,e}(),at=function(){var t={};t.version="1.2.1";function r(E,I){for(var j=E.split("/"),A=I.split("/"),L=0,M=0,re=Math.min(j.length,A.length);L<re;++L){if(M=j[L].length-A[L].length)return M;if(j[L]!=A[L])return j[L]<A[L]?-1:1}return j.length-A.length}function a(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:a(E.slice(0,-1));var I=E.lastIndexOf("/");return I===-1?E:E.slice(0,I+1)}function n(E){if(E.charAt(E.length-1)=="/")return n(E.slice(0,-1));var I=E.lastIndexOf("/");return I===-1?E:E.slice(I+1)}function s(E,I){typeof I=="string"&&(I=new Date(I));var j=I.getHours();j=j<<6|I.getMinutes(),j=j<<5|I.getSeconds()>>>1,E.write_shift(2,j);var A=I.getFullYear()-1980;A=A<<4|I.getMonth()+1,A=A<<5|I.getDate(),E.write_shift(2,A)}function o(E){var I=E.read_shift(2)&65535,j=E.read_shift(2)&65535,A=new Date,L=j&31;j>>>=5;var M=j&15;j>>>=4,A.setMilliseconds(0),A.setFullYear(j+1980),A.setMonth(M-1),A.setDate(L);var re=I&31;I>>>=5;var ue=I&63;return I>>>=6,A.setHours(I),A.setMinutes(ue),A.setSeconds(re<<1),A}function l(E){or(E,0);for(var I={},j=0;E.l<=E.length-4;){var A=E.read_shift(2),L=E.read_shift(2),M=E.l+L,re={};switch(A){case 21589:j=E.read_shift(1),j&1&&(re.mtime=E.read_shift(4)),L>5&&(j&2&&(re.atime=E.read_shift(4)),j&4&&(re.ctime=E.read_shift(4))),re.mtime&&(re.mt=new Date(re.mtime*1e3));break}E.l=M,I[A]=re}return I}var c;function u(){return c||(c={})}function d(E,I){if(E[0]==80&&E[1]==75)return Kr(E,I);if((E[0]|32)==109&&(E[1]|32)==105)return hn(E,I);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var j=3,A=512,L=0,M=0,re=0,ue=0,te=0,ae=[],ne=E.slice(0,512);or(ne,0);var ye=f(ne);switch(j=ye[0],j){case 3:A=512;break;case 4:A=4096;break;case 0:if(ye[1]==0)return Kr(E,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}A!==512&&(ne=E.slice(0,A),or(ne,28));var _e=E.slice(0,A);h(ne,j);var Fe=ne.read_shift(4,"i");if(j===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);ne.l+=4,re=ne.read_shift(4,"i"),ne.l+=4,ne.chk("00100000","Mini Stream Cutoff Size: "),ue=ne.read_shift(4,"i"),L=ne.read_shift(4,"i"),te=ne.read_shift(4,"i"),M=ne.read_shift(4,"i");for(var Ee=-1,je=0;je<109&&(Ee=ne.read_shift(4,"i"),!(Ee<0));++je)ae[je]=Ee;var Ue=p(E,A);w(te,M,Ue,A,ae);var N=y(Ue,re,ae,A);N[re].name="!Directory",L>0&&ue!==K&&(N[ue].name="!MiniFAT"),N[ae[0]].name="!FAT",N.fat_addrs=ae,N.ssz=A;var Q={},ee=[],H=[],Y=[];v(re,N,Ue,ee,L,Q,H,ue),x(H,Y,ee),ee.shift();var pe={FileIndex:H,FullPaths:Y};return I&&I.raw&&(pe.raw={header:_e,sectors:Ue}),pe}function f(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(de,"Header Signature: "),E.l+=16;var I=E.read_shift(2,"u");return[E.read_shift(2,"u"),I]}function h(E,I){var j=9;switch(E.l+=2,j=E.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function p(E,I){for(var j=Math.ceil(E.length/I)-1,A=[],L=1;L<j;++L)A[L-1]=E.slice(L*I,(L+1)*I);return A[j-1]=E.slice(j*I),A}function x(E,I,j){for(var A=0,L=0,M=0,re=0,ue=0,te=j.length,ae=[],ne=[];A<te;++A)ae[A]=ne[A]=A,I[A]=j[A];for(;ue<ne.length;++ue)A=ne[ue],L=E[A].L,M=E[A].R,re=E[A].C,ae[A]===A&&(L!==-1&&ae[L]!==L&&(ae[A]=ae[L]),M!==-1&&ae[M]!==M&&(ae[A]=ae[M])),re!==-1&&(ae[re]=A),L!==-1&&A!=ae[A]&&(ae[L]=ae[A],ne.lastIndexOf(L)<ue&&ne.push(L)),M!==-1&&A!=ae[A]&&(ae[M]=ae[A],ne.lastIndexOf(M)<ue&&ne.push(M));for(A=1;A<te;++A)ae[A]===A&&(M!==-1&&ae[M]!==M?ae[A]=ae[M]:L!==-1&&ae[L]!==L&&(ae[A]=ae[L]));for(A=1;A<te;++A)if(E[A].type!==0){if(ue=A,ue!=ae[ue])do ue=ae[ue],I[A]=I[ue]+"/"+I[A];while(ue!==0&&ae[ue]!==-1&&ue!=ae[ue]);ae[A]=-1}for(I[0]+="/",A=1;A<te;++A)E[A].type!==2&&(I[A]+="/")}function m(E,I,j){for(var A=E.start,L=E.size,M=[],re=A;j&&L>0&&re>=0;)M.push(I.slice(re*U,re*U+U)),L-=U,re=Fs(j,re*4);return M.length===0?Gt(0):Gn(M).slice(0,E.size)}function w(E,I,j,A,L){var M=K;if(E===K){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var re=j[E],ue=(A>>>2)-1;if(!re)return;for(var te=0;te<ue&&(M=Fs(re,te*4))!==K;++te)L.push(M);w(Fs(re,A-4),I-1,j,A,L)}}function g(E,I,j,A,L){var M=[],re=[];L||(L=[]);var ue=A-1,te=0,ae=0;for(te=I;te>=0;){L[te]=!0,M[M.length]=te,re.push(E[te]);var ne=j[Math.floor(te*4/A)];if(ae=te*4&ue,A<4+ae)throw new Error("FAT boundary crossed: "+te+" 4 "+A);if(!E[ne])break;te=Fs(E[ne],ae)}return{nodes:M,data:eg([re])}}function y(E,I,j,A){var L=E.length,M=[],re=[],ue=[],te=[],ae=A-1,ne=0,ye=0,_e=0,Fe=0;for(ne=0;ne<L;++ne)if(ue=[],_e=ne+I,_e>=L&&(_e-=L),!re[_e]){te=[];var Ee=[];for(ye=_e;ye>=0;){Ee[ye]=!0,re[ye]=!0,ue[ue.length]=ye,te.push(E[ye]);var je=j[Math.floor(ye*4/A)];if(Fe=ye*4&ae,A<4+Fe)throw new Error("FAT boundary crossed: "+ye+" 4 "+A);if(!E[je]||(ye=Fs(E[je],Fe),Ee[ye]))break}M[_e]={nodes:ue,data:eg([te])}}return M}function v(E,I,j,A,L,M,re,ue){for(var te=0,ae=A.length?2:0,ne=I[E].data,ye=0,_e=0,Fe;ye<ne.length;ye+=128){var Ee=ne.slice(ye,ye+128);or(Ee,64),_e=Ee.read_shift(2),Fe=gp(Ee,0,_e-ae),A.push(Fe);var je={name:Fe,type:Ee.read_shift(1),color:Ee.read_shift(1),L:Ee.read_shift(4,"i"),R:Ee.read_shift(4,"i"),C:Ee.read_shift(4,"i"),clsid:Ee.read_shift(16),state:Ee.read_shift(4,"i"),start:0,size:0},Ue=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);Ue!==0&&(je.ct=k(Ee,Ee.l-8));var N=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);N!==0&&(je.mt=k(Ee,Ee.l-8)),je.start=Ee.read_shift(4,"i"),je.size=Ee.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=K,je.name=""),je.type===5?(te=je.start,L>0&&te!==K&&(I[te].name="!StreamData")):je.size>=4096?(je.storage="fat",I[je.start]===void 0&&(I[je.start]=g(j,je.start,I.fat_addrs,I.ssz)),I[je.start].name=je.name,je.content=I[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:te!==K&&je.start!==K&&I[te]&&(je.content=m(je,I[te].data,(I[ue]||{}).data))),je.content&&or(je.content,0),M[Fe]=je,re.push(je)}}function k(E,I){return new Date((ea(E,I+4)/1e7*Math.pow(2,32)+ea(E,I)/1e7-11644473600)*1e3)}function _(E,I){return u(),d(c.readFileSync(E),I)}function F(E,I){var j=I&&I.type;switch(j||rt&&Buffer.isBuffer(E)&&(j="buffer"),j||"base64"){case"file":return _(E,I);case"base64":return d(Ia(sa(E)),I);case"binary":return d(Ia(E),I)}return d(E,I)}function b(E,I){var j=I||{},A=j.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=A+"/",E.FileIndex[0]={name:A,type:5}),j.CLSID&&(E.FileIndex[0].clsid=j.CLSID),S(E)}function S(E){var I="Sh33tJ5";if(!at.find(E,"/"+I)){var j=Gt(4);j[0]=55,j[1]=j[3]=50,j[2]=54,E.FileIndex.push({name:I,type:2,content:j,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+I),C(E)}}function C(E,I){b(E);for(var j=!1,A=!1,L=E.FullPaths.length-1;L>=0;--L){var M=E.FileIndex[L];switch(M.type){case 0:A?j=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:A=!0,isNaN(M.R*M.L*M.C)&&(j=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!I)){var re=new Date(1987,1,19),ue=0,te=Object.create?Object.create(null):{},ae=[];for(L=0;L<E.FullPaths.length;++L)te[E.FullPaths[L]]=!0,E.FileIndex[L].type!==0&&ae.push([E.FullPaths[L],E.FileIndex[L]]);for(L=0;L<ae.length;++L){var ne=a(ae[L][0]);A=te[ne],A||(ae.push([ne,{name:n(ne).replace("/",""),type:1,clsid:ge,ct:re,mt:re,content:null}]),te[ne]=!0)}for(ae.sort(function(Fe,Ee){return r(Fe[0],Ee[0])}),E.FullPaths=[],E.FileIndex=[],L=0;L<ae.length;++L)E.FullPaths[L]=ae[L][0],E.FileIndex[L]=ae[L][1];for(L=0;L<ae.length;++L){var ye=E.FileIndex[L],_e=E.FullPaths[L];if(ye.name=n(_e).replace("/",""),ye.L=ye.R=ye.C=-(ye.color=1),ye.size=ye.content?ye.content.length:0,ye.start=0,ye.clsid=ye.clsid||ge,L===0)ye.C=ae.length>1?1:-1,ye.size=0,ye.type=5;else if(_e.slice(-1)=="/"){for(ue=L+1;ue<ae.length&&a(E.FullPaths[ue])!=_e;++ue);for(ye.C=ue>=ae.length?-1:ue,ue=L+1;ue<ae.length&&a(E.FullPaths[ue])!=a(_e);++ue);ye.R=ue>=ae.length?-1:ue,ye.type=1}else a(E.FullPaths[L+1]||"")==a(_e)&&(ye.R=L+1),ye.type=2}}}function B(E,I){var j=I||{};if(j.fileType=="mad")return pn(E,j);switch(C(E),j.fileType){case"zip":return pt(E,j)}var A=function(Fe){for(var Ee=0,je=0,Ue=0;Ue<Fe.FileIndex.length;++Ue){var N=Fe.FileIndex[Ue];if(N.content){var Q=N.content.length;Q>0&&(Q<4096?Ee+=Q+63>>6:je+=Q+511>>9)}}for(var ee=Fe.FullPaths.length+3>>2,H=Ee+7>>3,Y=Ee+127>>7,pe=H+je+ee+Y,me=pe+127>>7,ke=me<=109?0:Math.ceil((me-109)/127);pe+me+ke+127>>7>me;)ke=++me<=109?0:Math.ceil((me-109)/127);var De=[1,ke,me,Y,ee,je,Ee,0];return Fe.FileIndex[0].size=Ee<<6,De[7]=(Fe.FileIndex[0].start=De[0]+De[1]+De[2]+De[3]+De[4]+De[5])+(De[6]+7>>3),De}(E),L=Gt(A[7]<<9),M=0,re=0;{for(M=0;M<8;++M)L.write_shift(1,oe[M]);for(M=0;M<8;++M)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),M=0;M<3;++M)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,A[2]),L.write_shift(4,A[0]+A[1]+A[2]+A[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,A[3]?A[0]+A[1]+A[2]-1:K),L.write_shift(4,A[3]),L.write_shift(-4,A[1]?A[0]-1:K),L.write_shift(4,A[1]),M=0;M<109;++M)L.write_shift(-4,M<A[2]?A[1]+M:-1)}if(A[1])for(re=0;re<A[1];++re){for(;M<236+re*127;++M)L.write_shift(-4,M<A[2]?A[1]+M:-1);L.write_shift(-4,re===A[1]-1?K:re+1)}var ue=function(Fe){for(re+=Fe;M<re-1;++M)L.write_shift(-4,M+1);Fe&&(++M,L.write_shift(-4,K))};for(re=M=0,re+=A[1];M<re;++M)L.write_shift(-4,Z.DIFSECT);for(re+=A[2];M<re;++M)L.write_shift(-4,Z.FATSECT);ue(A[3]),ue(A[4]);for(var te=0,ae=0,ne=E.FileIndex[0];te<E.FileIndex.length;++te)ne=E.FileIndex[te],ne.content&&(ae=ne.content.length,!(ae<4096)&&(ne.start=re,ue(ae+511>>9)));for(ue(A[6]+7>>3);L.l&511;)L.write_shift(-4,Z.ENDOFCHAIN);for(re=M=0,te=0;te<E.FileIndex.length;++te)ne=E.FileIndex[te],ne.content&&(ae=ne.content.length,!(!ae||ae>=4096)&&(ne.start=re,ue(ae+63>>6)));for(;L.l&511;)L.write_shift(-4,Z.ENDOFCHAIN);for(M=0;M<A[4]<<2;++M){var ye=E.FullPaths[M];if(!ye||ye.length===0){for(te=0;te<17;++te)L.write_shift(4,0);for(te=0;te<3;++te)L.write_shift(4,-1);for(te=0;te<12;++te)L.write_shift(4,0);continue}ne=E.FileIndex[M],M===0&&(ne.start=ne.size?ne.start-1:K);var _e=M===0&&j.root||ne.name;if(ae=2*(_e.length+1),L.write_shift(64,_e,"utf16le"),L.write_shift(2,ae),L.write_shift(1,ne.type),L.write_shift(1,ne.color),L.write_shift(-4,ne.L),L.write_shift(-4,ne.R),L.write_shift(-4,ne.C),ne.clsid)L.write_shift(16,ne.clsid,"hex");else for(te=0;te<4;++te)L.write_shift(4,0);L.write_shift(4,ne.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,ne.start),L.write_shift(4,ne.size),L.write_shift(4,0)}for(M=1;M<E.FileIndex.length;++M)if(ne=E.FileIndex[M],ne.size>=4096)if(L.l=ne.start+1<<9,rt&&Buffer.isBuffer(ne.content))ne.content.copy(L,L.l,0,ne.size),L.l+=ne.size+511&-512;else{for(te=0;te<ne.size;++te)L.write_shift(1,ne.content[te]);for(;te&511;++te)L.write_shift(1,0)}for(M=1;M<E.FileIndex.length;++M)if(ne=E.FileIndex[M],ne.size>0&&ne.size<4096)if(rt&&Buffer.isBuffer(ne.content))ne.content.copy(L,L.l,0,ne.size),L.l+=ne.size+63&-64;else{for(te=0;te<ne.size;++te)L.write_shift(1,ne.content[te]);for(;te&63;++te)L.write_shift(1,0)}if(rt)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function T(E,I){var j=E.FullPaths.map(function(te){return te.toUpperCase()}),A=j.map(function(te){var ae=te.split("/");return ae[ae.length-(te.slice(-1)=="/"?2:1)]}),L=!1;I.charCodeAt(0)===47?(L=!0,I=j[0].slice(0,-1)+I):L=I.indexOf("/")!==-1;var M=I.toUpperCase(),re=L===!0?j.indexOf(M):A.indexOf(M);if(re!==-1)return E.FileIndex[re];var ue=!M.match(zo);for(M=M.replace(Ir,""),ue&&(M=M.replace(zo,"!")),re=0;re<j.length;++re)if((ue?j[re].replace(zo,"!"):j[re]).replace(Ir,"")==M||(ue?A[re].replace(zo,"!"):A[re]).replace(Ir,"")==M)return E.FileIndex[re];return null}var U=64,K=-2,de="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],ge="00000000000000000000000000000000",Z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:K,FREESECT:-1,HEADER_SIGNATURE:de,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ge,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(E,I,j){u();var A=B(E,j);c.writeFileSync(I,A)}function z(E){for(var I=new Array(E.length),j=0;j<E.length;++j)I[j]=String.fromCharCode(E[j]);return I.join("")}function xe(E,I){var j=B(E,I);switch(I&&I.type||"buffer"){case"file":return u(),c.writeFileSync(I.filename,j),j;case"binary":return typeof j=="string"?j:z(j);case"base64":return Im(typeof j=="string"?j:z(j));case"buffer":if(rt)return Buffer.isBuffer(j)?j:di(j);case"array":return typeof j=="string"?Ia(j):j}return j}var be;function O(E){try{var I=E.InflateRaw,j=new I;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)be=E;else throw new Error("zlib does not expose bytesRead")}catch(A){console.error("cannot use native zlib: "+(A.message||A))}}function J(E,I){if(!be)return Qr(E,I);var j=be.InflateRaw,A=new j,L=A._processChunk(E.slice(E.l),A._finishFlushFlag);return E.l+=A.bytesRead,L}function W(E){return be?be.deflateRawSync(E):Ge(E)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function R(E){var I=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(I>>16|I>>8|I)&255}for(var X=typeof Uint8Array<"u",q=X?new Uint8Array(256):[],ce=0;ce<256;++ce)q[ce]=R(ce);function P(E,I){var j=q[E&255];return I<=8?j>>>8-I:(j=j<<8|q[E>>8&255],I<=16?j>>>16-I:(j=j<<8|q[E>>16&255],j>>>24-I))}function Se(E,I){var j=I&7,A=I>>>3;return(E[A]|(j<=6?0:E[A+1]<<8))>>>j&3}function Ce(E,I){var j=I&7,A=I>>>3;return(E[A]|(j<=5?0:E[A+1]<<8))>>>j&7}function Te(E,I){var j=I&7,A=I>>>3;return(E[A]|(j<=4?0:E[A+1]<<8))>>>j&15}function fe(E,I){var j=I&7,A=I>>>3;return(E[A]|(j<=3?0:E[A+1]<<8))>>>j&31}function ve(E,I){var j=I&7,A=I>>>3;return(E[A]|(j<=1?0:E[A+1]<<8))>>>j&127}function ze(E,I,j){var A=I&7,L=I>>>3,M=(1<<j)-1,re=E[L]>>>A;return j<8-A||(re|=E[L+1]<<8-A,j<16-A)||(re|=E[L+2]<<16-A,j<24-A)||(re|=E[L+3]<<24-A),re&M}function Ze(E,I,j){var A=I&7,L=I>>>3;return A<=5?E[L]|=(j&7)<<A:(E[L]|=j<<A&255,E[L+1]=(j&7)>>8-A),I+3}function dt(E,I,j){var A=I&7,L=I>>>3;return j=(j&1)<<A,E[L]|=j,I+1}function Wt(E,I,j){var A=I&7,L=I>>>3;return j<<=A,E[L]|=j&255,j>>>=8,E[L+1]=j,I+8}function _r(E,I,j){var A=I&7,L=I>>>3;return j<<=A,E[L]|=j&255,j>>>=8,E[L+1]=j&255,E[L+2]=j>>>8,I+16}function Yt(E,I){var j=E.length,A=2*j>I?2*j:I+5,L=0;if(j>=I)return E;if(rt){var M=Lm(A);if(E.copy)E.copy(M);else for(;L<E.length;++L)M[L]=E[L];return M}else if(X){var re=new Uint8Array(A);if(re.set)re.set(E);else for(;L<j;++L)re[L]=E[L];return re}return E.length=A,E}function Et(E){for(var I=new Array(E),j=0;j<E;++j)I[j]=0;return I}function sr(E,I,j){var A=1,L=0,M=0,re=0,ue=0,te=E.length,ae=X?new Uint16Array(32):Et(32);for(M=0;M<32;++M)ae[M]=0;for(M=te;M<j;++M)E[M]=0;te=E.length;var ne=X?new Uint16Array(te):Et(te);for(M=0;M<te;++M)ae[L=E[M]]++,A<L&&(A=L),ne[M]=0;for(ae[0]=0,M=1;M<=A;++M)ae[M+16]=ue=ue+ae[M-1]<<1;for(M=0;M<te;++M)ue=E[M],ue!=0&&(ne[M]=ae[ue+16]++);var ye=0;for(M=0;M<te;++M)if(ye=E[M],ye!=0)for(ue=P(ne[M],A)>>A-ye,re=(1<<A+4-ye)-1;re>=0;--re)I[ue|re<<ye]=ye&15|M<<4;return A}var Pe=X?new Uint16Array(512):Et(512),jt=X?new Uint16Array(32):Et(32);if(!X){for(var ot=0;ot<512;++ot)Pe[ot]=0;for(ot=0;ot<32;++ot)jt[ot]=0}(function(){for(var E=[],I=0;I<32;I++)E.push(5);sr(E,jt,32);var j=[];for(I=0;I<=143;I++)j.push(8);for(;I<=255;I++)j.push(9);for(;I<=279;I++)j.push(7);for(;I<=287;I++)j.push(8);sr(j,Pe,288)})();var wt=function(){for(var I=X?new Uint8Array(32768):[],j=0,A=0;j<we.length-1;++j)for(;A<we[j+1];++A)I[A]=j;for(;A<32768;++A)I[A]=29;var L=X?new Uint8Array(259):[];for(j=0,A=0;j<le.length-1;++j)for(;A<le[j+1];++A)L[A]=j;function M(ue,te){for(var ae=0;ae<ue.length;){var ne=Math.min(65535,ue.length-ae),ye=ae+ne==ue.length;for(te.write_shift(1,+ye),te.write_shift(2,ne),te.write_shift(2,~ne&65535);ne-- >0;)te[te.l++]=ue[ae++]}return te.l}function re(ue,te){for(var ae=0,ne=0,ye=X?new Uint16Array(32768):[];ne<ue.length;){var _e=Math.min(65535,ue.length-ne);if(_e<10){for(ae=Ze(te,ae,+(ne+_e==ue.length)),ae&7&&(ae+=8-(ae&7)),te.l=ae/8|0,te.write_shift(2,_e),te.write_shift(2,~_e&65535);_e-- >0;)te[te.l++]=ue[ne++];ae=te.l*8;continue}ae=Ze(te,ae,+(ne+_e==ue.length)+2);for(var Fe=0;_e-- >0;){var Ee=ue[ne];Fe=(Fe<<5^Ee)&32767;var je=-1,Ue=0;if((je=ye[Fe])&&(je|=ne&-32768,je>ne&&(je-=32768),je<ne))for(;ue[je+Ue]==ue[ne+Ue]&&Ue<250;)++Ue;if(Ue>2){Ee=L[Ue],Ee<=22?ae=Wt(te,ae,q[Ee+1]>>1)-1:(Wt(te,ae,3),ae+=5,Wt(te,ae,q[Ee-23]>>5),ae+=3);var N=Ee<8?0:Ee-4>>2;N>0&&(_r(te,ae,Ue-le[Ee]),ae+=N),Ee=I[ne-je],ae=Wt(te,ae,q[Ee]>>3),ae-=3;var Q=Ee<4?0:Ee-2>>1;Q>0&&(_r(te,ae,ne-je-we[Ee]),ae+=Q);for(var ee=0;ee<Ue;++ee)ye[Fe]=ne&32767,Fe=(Fe<<5^ue[ne])&32767,++ne;_e-=Ue-1}else Ee<=143?Ee=Ee+48:ae=dt(te,ae,1),ae=Wt(te,ae,q[Ee]),ye[Fe]=ne&32767,++ne}ae=Wt(te,ae,0)-1}return te.l=(ae+7)/8|0,te.l}return function(te,ae){return te.length<8?M(te,ae):re(te,ae)}}();function Ge(E){var I=Gt(50+Math.floor(E.length*1.1)),j=wt(E,I);return I.slice(0,j)}var ct=X?new Uint16Array(32768):Et(32768),Lt=X?new Uint16Array(32768):Et(32768),ht=X?new Uint16Array(128):Et(128),Tr=1,Na=1;function la(E,I){var j=fe(E,I)+257;I+=5;var A=fe(E,I)+1;I+=5;var L=Te(E,I)+4;I+=4;for(var M=0,re=X?new Uint8Array(19):Et(19),ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,ae=X?new Uint8Array(8):Et(8),ne=X?new Uint8Array(8):Et(8),ye=re.length,_e=0;_e<L;++_e)re[V[_e]]=M=Ce(E,I),te<M&&(te=M),ae[M]++,I+=3;var Fe=0;for(ae[0]=0,_e=1;_e<=te;++_e)ne[_e]=Fe=Fe+ae[_e-1]<<1;for(_e=0;_e<ye;++_e)(Fe=re[_e])!=0&&(ue[_e]=ne[Fe]++);var Ee=0;for(_e=0;_e<ye;++_e)if(Ee=re[_e],Ee!=0){Fe=q[ue[_e]]>>8-Ee;for(var je=(1<<7-Ee)-1;je>=0;--je)ht[Fe|je<<Ee]=Ee&7|_e<<3}var Ue=[];for(te=1;Ue.length<j+A;)switch(Fe=ht[ve(E,I)],I+=Fe&7,Fe>>>=3){case 16:for(M=3+Se(E,I),I+=2,Fe=Ue[Ue.length-1];M-- >0;)Ue.push(Fe);break;case 17:for(M=3+Ce(E,I),I+=3;M-- >0;)Ue.push(0);break;case 18:for(M=11+ve(E,I),I+=7;M-- >0;)Ue.push(0);break;default:Ue.push(Fe),te<Fe&&(te=Fe);break}var N=Ue.slice(0,j),Q=Ue.slice(j);for(_e=j;_e<286;++_e)N[_e]=0;for(_e=A;_e<30;++_e)Q[_e]=0;return Tr=sr(N,ct,286),Na=sr(Q,Lt,30),I}function fn(E,I){if(E[0]==3&&!(E[1]&3))return[ks(I),2];for(var j=0,A=0,L=Lm(I||1<<18),M=0,re=L.length>>>0,ue=0,te=0;!(A&1);){if(A=Ce(E,j),j+=3,A>>>1)A>>1==1?(ue=9,te=5):(j=la(E,j),ue=Tr,te=Na);else{j&7&&(j+=8-(j&7));var ae=E[j>>>3]|E[(j>>>3)+1]<<8;if(j+=32,ae>0)for(!I&&re<M+ae&&(L=Yt(L,M+ae),re=L.length);ae-- >0;)L[M++]=E[j>>>3],j+=8;continue}for(;;){!I&&re<M+32767&&(L=Yt(L,M+32767),re=L.length);var ne=ze(E,j,ue),ye=A>>>1==1?Pe[ne]:ct[ne];if(j+=ye&15,ye>>>=4,!(ye>>>8&255))L[M++]=ye;else{if(ye==256)break;ye-=257;var _e=ye<8?0:ye-4>>2;_e>5&&(_e=0);var Fe=M+le[ye];_e>0&&(Fe+=ze(E,j,_e),j+=_e),ne=ze(E,j,te),ye=A>>>1==1?jt[ne]:Lt[ne],j+=ye&15,ye>>>=4;var Ee=ye<4?0:ye-2>>1,je=we[ye];for(Ee>0&&(je+=ze(E,j,Ee),j+=Ee),!I&&re<Fe&&(L=Yt(L,Fe+100),re=L.length);M<Fe;)L[M]=L[M-je],++M}}}return I?[L,j+7>>>3]:[L.slice(0,M),j+7>>>3]}function Qr(E,I){var j=E.slice(E.l||0),A=fn(j,I);return E.l+=A[1],A[0]}function Ga(E,I){if(E)typeof console<"u"&&console.error(I);else throw new Error(I)}function Kr(E,I){var j=E;or(j,0);var A=[],L=[],M={FileIndex:A,FullPaths:L};b(M,{root:I.root});for(var re=j.length-4;(j[re]!=80||j[re+1]!=75||j[re+2]!=5||j[re+3]!=6)&&re>=0;)--re;j.l=re+4,j.l+=4;var ue=j.read_shift(2);j.l+=6;var te=j.read_shift(4);for(j.l=te,re=0;re<ue;++re){j.l+=20;var ae=j.read_shift(4),ne=j.read_shift(4),ye=j.read_shift(2),_e=j.read_shift(2),Fe=j.read_shift(2);j.l+=8;var Ee=j.read_shift(4),je=l(j.slice(j.l+ye,j.l+ye+_e));j.l+=ye+_e+Fe;var Ue=j.l;j.l=Ee+4,Ca(j,ae,ne,M,je),j.l=Ue}return M}function Ca(E,I,j,A,L){E.l+=2;var M=E.read_shift(2),re=E.read_shift(2),ue=o(E);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var te=E.read_shift(4),ae=E.read_shift(4),ne=E.read_shift(4),ye=E.read_shift(2),_e=E.read_shift(2),Fe="",Ee=0;Ee<ye;++Ee)Fe+=String.fromCharCode(E[E.l++]);if(_e){var je=l(E.slice(E.l,E.l+_e));(je[21589]||{}).mt&&(ue=je[21589].mt),((L||{})[21589]||{}).mt&&(ue=L[21589].mt)}E.l+=_e;var Ue=E.slice(E.l,E.l+ae);switch(re){case 8:Ue=J(E,ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+re)}var N=!1;M&8&&(te=E.read_shift(4),te==134695760&&(te=E.read_shift(4),N=!0),ae=E.read_shift(4),ne=E.read_shift(4)),ae!=I&&Ga(N,"Bad compressed size: "+I+" != "+ae),ne!=j&&Ga(N,"Bad uncompressed size: "+j+" != "+ne),_a(A,Fe,Ue,{unsafe:!0,mt:ue})}function pt(E,I){var j=I||{},A=[],L=[],M=Gt(1),re=j.compression?8:0,ue=0,te=0,ae=0,ne=0,ye=0,_e=E.FullPaths[0],Fe=_e,Ee=E.FileIndex[0],je=[],Ue=0;for(te=1;te<E.FullPaths.length;++te)if(Fe=E.FullPaths[te].slice(_e.length),Ee=E.FileIndex[te],!(!Ee.size||!Ee.content||Fe=="Sh33tJ5")){var N=ne,Q=Gt(Fe.length);for(ae=0;ae<Fe.length;++ae)Q.write_shift(1,Fe.charCodeAt(ae)&127);Q=Q.slice(0,Q.l),je[ye]=s3.buf(Ee.content,0);var ee=Ee.content;re==8&&(ee=W(ee)),M=Gt(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,ue),M.write_shift(2,re),Ee.mt?s(M,Ee.mt):M.write_shift(4,0),M.write_shift(-4,je[ye]),M.write_shift(4,ee.length),M.write_shift(4,Ee.content.length),M.write_shift(2,Q.length),M.write_shift(2,0),ne+=M.length,A.push(M),ne+=Q.length,A.push(Q),ne+=ee.length,A.push(ee),M=Gt(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,ue),M.write_shift(2,re),M.write_shift(4,0),M.write_shift(-4,je[ye]),M.write_shift(4,ee.length),M.write_shift(4,Ee.content.length),M.write_shift(2,Q.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,N),Ue+=M.l,L.push(M),Ue+=Q.length,L.push(Q),++ye}return M=Gt(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,ye),M.write_shift(2,ye),M.write_shift(4,Ue),M.write_shift(4,ne),M.write_shift(2,0),Gn([Gn(A),Gn(L),M])}var Mt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Xa(E,I){if(E.ctype)return E.ctype;var j=E.name||"",A=j.match(/\.([^\.]+)$/);return A&&Mt[A[1]]||I&&(A=(j=I).match(/[\.\\]([^\.\\])+$/),A&&Mt[A[1]])?Mt[A[1]]:"application/octet-stream"}function qa(E){for(var I=Im(E),j=[],A=0;A<I.length;A+=76)j.push(I.slice(A,A+76));return j.join(`\r
`)+`\r
`}function Qa(E){var I=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ae){var ne=ae.charCodeAt(0).toString(16).toUpperCase();return"="+(ne.length==1?"0"+ne:ne)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],A=I.split(`\r
`),L=0;L<A.length;++L){var M=A[L];if(M.length==0){j.push("");continue}for(var re=0;re<M.length;){var ue=76,te=M.slice(re,re+ue);te.charAt(ue-1)=="="?ue--:te.charAt(ue-2)=="="?ue-=2:te.charAt(ue-3)=="="&&(ue-=3),te=M.slice(re,re+ue),re+=ue,re<M.length&&(te+="="),j.push(te)}}return j.join(`\r
`)}function hr(E){for(var I=[],j=0;j<E.length;++j){for(var A=E[j];j<=E.length&&A.charAt(A.length-1)=="=";)A=A.slice(0,A.length-1)+E[++j];I.push(A)}for(var L=0;L<I.length;++L)I[L]=I[L].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return Ia(I.join(`\r
`))}function Yr(E,I,j){for(var A="",L="",M="",re,ue=0;ue<10;++ue){var te=I[ue];if(!te||te.match(/^\s*$/))break;var ae=te.match(/^(.*?):\s*([^\s].*)$/);if(ae)switch(ae[1].toLowerCase()){case"content-location":A=ae[2].trim();break;case"content-type":M=ae[2].trim();break;case"content-transfer-encoding":L=ae[2].trim();break}}switch(++ue,L.toLowerCase()){case"base64":re=Ia(sa(I.slice(ue).join("")));break;case"quoted-printable":re=hr(I.slice(ue));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var ne=_a(E,A.slice(j.length),re,{unsafe:!0});M&&(ne.ctype=M)}function hn(E,I){if(z(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=I&&I.root||"",A=(rt&&Buffer.isBuffer(E)?E.toString("binary"):z(E)).split(`\r
`),L=0,M="";for(L=0;L<A.length;++L)if(M=A[L],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),j||(j=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),M.slice(0,j.length)!=j););var re=(A[1]||"").match(/boundary="(.*?)"/);if(!re)throw new Error("MAD cannot find boundary");var ue="--"+(re[1]||""),te=[],ae=[],ne={FileIndex:te,FullPaths:ae};b(ne);var ye,_e=0;for(L=0;L<A.length;++L){var Fe=A[L];Fe!==ue&&Fe!==ue+"--"||(_e++&&Yr(ne,A.slice(ye,L),j),ye=L)}return ne}function pn(E,I){var j=I||{},A=j.boundary||"SheetJS";A="------="+A;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+A.slice(2)+'"',"","",""],M=E.FullPaths[0],re=M,ue=E.FileIndex[0],te=1;te<E.FullPaths.length;++te)if(re=E.FullPaths[te].slice(M.length),ue=E.FileIndex[te],!(!ue.size||!ue.content||re=="Sh33tJ5")){re=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var ae=ue.content,ne=rt&&Buffer.isBuffer(ae)?ae.toString("binary"):z(ae),ye=0,_e=Math.min(1024,ne.length),Fe=0,Ee=0;Ee<=_e;++Ee)(Fe=ne.charCodeAt(Ee))>=32&&Fe<128&&++ye;var je=ye>=_e*4/5;L.push(A),L.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+re),L.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),L.push("Content-Type: "+Xa(ue,re)),L.push(""),L.push(je?Qa(ne):qa(ne))}return L.push(A+`--\r
`),L.join(`\r
`)}function xn(E){var I={};return b(I,E),I}function _a(E,I,j,A){var L=A&&A.unsafe;L||b(E);var M=!L&&at.find(E,I);if(!M){var re=E.FullPaths[0];I.slice(0,re.length)==re?re=I:(re.slice(-1)!="/"&&(re+="/"),re=(re+I).replace("//","/")),M={name:n(I),type:2},E.FileIndex.push(M),E.FullPaths.push(re),L||at.utils.cfb_gc(E)}return M.content=j,M.size=j?j.length:0,A&&(A.CLSID&&(M.clsid=A.CLSID),A.mt&&(M.mt=A.mt),A.ct&&(M.ct=A.ct)),M}function ca(E,I){b(E);var j=at.find(E,I);if(j){for(var A=0;A<E.FileIndex.length;++A)if(E.FileIndex[A]==j)return E.FileIndex.splice(A,1),E.FullPaths.splice(A,1),!0}return!1}function mn(E,I,j){b(E);var A=at.find(E,I);if(A){for(var L=0;L<E.FileIndex.length;++L)if(E.FileIndex[L]==A)return E.FileIndex[L].name=n(j),E.FullPaths[L]=j,!0}return!1}function gn(E){C(E,!0)}return t.find=T,t.read=F,t.parse=d,t.write=xe,t.writeFile=se,t.utils={cfb_new:xn,cfb_add:_a,cfb_del:ca,cfb_mov:mn,cfb_gc:gn,ReadShift:tl,CheckField:H2,prep_blob:or,bconcat:Gn,use_zlib:O,_deflateRaw:Ge,_inflateRaw:Qr,consts:Z},t}();function i3(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function ln(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function hp(e){for(var t=[],r=ln(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}var z0=new Date(1899,11,30,0,0,0);function Lr(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var a=z0.getTime()+(e.getTimezoneOffset()-z0.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var k2=new Date,o3=z0.getTime()+(k2.getTimezoneOffset()-z0.getTimezoneOffset())*6e4,Wm=k2.getTimezoneOffset();function bu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+o3),t.getTimezoneOffset()!==Wm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Wm)*6e4),t}function l3(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[s],10)}return t}var Gm=new Date("2017-02-19T19:06:09.000Z"),b2=isNaN(Gm.getFullYear())?new Date("2/19/17"):Gm,c3=b2.getFullYear()==2017;function nr(e,t){var r=new Date(e);if(c3)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(b2.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function oi(e,t){if(rt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ho(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ho(l2(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ho(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ho(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function ur(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ur(e[r]));return t}function Pt(e,t){for(var r="";r.length<t;)r+=e;return r}function Ha(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return r=-r,s}),!isNaN(t=Number(a)))?t/r:t}var u3=["january","february","march","april","may","june","july","august","september","october","november","december"];function fo(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&u3.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var d3=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var s=r.split(a),o=[s[0]],l=1;l<s.length;++l)o.push(n),o.push(s[l]);return o}}();function E2(e){return e?e.content&&e.type?oi(e.content,!0):e.data?Uo(e.data):e.asNodeBuffer&&rt?Uo(e.asNodeBuffer().toString("binary")):e.asBinary?Uo(e.asBinary()):e._data&&e._data.getContent?Uo(oi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function S2(e){if(!e)return null;if(e.data)return Om(e.data);if(e.asNodeBuffer&&rt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Om(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function f3(e){return e&&e.name.slice(-4)===".bin"?S2(e):E2(e)}function ha(e,t){for(var r=e.FullPaths||ln(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||n==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function pp(e,t){var r=ha(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function zt(e,t,r){if(!r)return f3(pp(e,t));if(!t)return null;try{return zt(e,t)}catch{return null}}function ta(e,t,r){if(!r)return E2(pp(e,t));if(!t)return null;try{return ta(e,t)}catch{return null}}function N2(e,t,r){if(!r)return S2(pp(e,t));if(!t)return null;try{return N2(e,t)}catch{return null}}function Xm(e){for(var t=e.FullPaths||ln(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function h3(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return rt?a=di(r):a=DT(r),at.utils.cfb_add(e,t,a)}at.utils.cfb_add(e,t,r)}else e.file(t,r)}function C2(e,t){switch(t.type){case"base64":return at.read(e,{type:"base64"});case"binary":return at.read(e,{type:"binary"});case"buffer":case"array":return at.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function $o(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var _2=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,p3=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,qm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,x3=/<[^>]*>/g,Cr=_2.match(qm)?qm:x3,m3=/<\w*:/,g3=/<(\/?)\w+:/;function We(e,t,r){for(var a={},n=0,s=0;n!==e.length&&!((s=e.charCodeAt(n))===32||s===10||s===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var o=e.match(p3),l=0,c="",u=0,d="",f="",h=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(n=f.charCodeAt(s+1))==34||n==39?1:0,c=f.slice(s+1+h,f.length-h),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=c,r||(a[d.toLowerCase()]=c);else{var p=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(a[p]&&d.slice(l-3,l)=="ext")continue;a[p]=c,r||(a[p.toLowerCase()]=c)}}return a}function un(e){return e.replace(g3,"<$1")}var T2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},v3=hp(T2),it=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(e,function(l,c){return T2[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=n.indexOf("]]>");return r(n.slice(0,s))+n.slice(s+9,o)+r(n.slice(o+3))}}(),y3=/[&<>'"]/g,w3=/[\u0000-\u001f]/g;function xp(e){var t=e+"";return t.replace(y3,function(r){return v3[r]}).replace(/\n/g,"<br/>").replace(w3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Qm=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function kt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ud(e){for(var t="",r=0,a=0,n=0,s=0,o=0,l=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((a&7)<<18|(n&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Km(e){var t=ks(2*e.length),r,a,n=1,s=0,o=0,l;for(a=0;a<e.length;a+=n)n=1,(l=e.charCodeAt(a))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(a+1)&63),n=2):l<240?(r=(l&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(l&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Ym(e){return di(e,"binary").toString("utf8")}var Rc="foo bar baz",gt=rt&&(Ym(Rc)==ud(Rc)&&Ym||Km(Rc)==ud(Rc)&&Km)||ud,Ho=rt?function(e){return di(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Dl=function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),j2=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),k3=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),b3=/<\/?(?:vt:)?variant>/g,E3=/<(?:vt:)([^>]*)>([\s\S]*)</;function Jm(e,t){var r=We(e),a=e.match(k3(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(s){var o=s.replace(b3,"").match(E3);o&&n.push({v:gt(o[2]),t:o[1]})}),n}var S3=/(^\s|\s$|\n)/;function N3(e){return ln(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function C3(e,t,r){return"<"+e+(r!=null?N3(r):"")+(t!=null?(t.match(S3)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function mp(e){if(rt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return gt(fi(up(e)));throw new Error("Bad input format: expected Buffer or string")}var Ol=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,_3={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},T3=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function j3(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,s=5;s>=0;--s)n=n*256+e[t+s];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function A3(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,o=a?-t:t;isFinite(o)?o==0?n=s=0:(n=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(n&15)<<4|s&15,e[r+7]=n>>4|a}var Zm=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,s=e[0][a].length;n<s;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},eg=rt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:di(t)})):Zm(e)}:Zm,tg=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Cn(e,n)));return a.join("").replace(Ir,"")},gp=rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ir,""):tg(e,t,r)}:tg,rg=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},A2=rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):rg(e,t,r)}:rg,ag=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(wi(e,n)));return a.join("")},oc=rt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):ag(t,r,a)}:ag,F2=function(e,t){var r=ea(e,t);return r>0?oc(e,t+4,t+4+r-1):""},P2=F2,D2=function(e,t){var r=ea(e,t);return r>0?oc(e,t+4,t+4+r-1):""},O2=D2,R2=function(e,t){var r=2*ea(e,t);return r>0?oc(e,t+4,t+4+r-1):""},I2=R2,L2=function(t,r){var a=ea(t,r);return a>0?gp(t,r+4,r+4+a):""},M2=L2,B2=function(e,t){var r=ea(e,t);return r>0?oc(e,t+4,t+4+r):""},U2=B2,z2=function(e,t){return j3(e,t)},$0=z2,$2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};rt&&(P2=function(t,r){if(!Buffer.isBuffer(t))return F2(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},O2=function(t,r){if(!Buffer.isBuffer(t))return D2(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},I2=function(t,r){if(!Buffer.isBuffer(t))return R2(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},M2=function(t,r){if(!Buffer.isBuffer(t))return L2(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},U2=function(t,r){if(!Buffer.isBuffer(t))return B2(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},$0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):z2(t,r)},$2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var wi=function(e,t){return e[t]},Cn=function(e,t){return e[t+1]*256+e[t]},F3=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ea=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Fs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},P3=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function tl(e,t){var r="",a,n,s=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,rt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Cn(this,u)),u+=2;e*=2;break;case"utf8":r=oc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=gp(this,this.l,this.l+e);break;case"wstr":return tl.call(this,e,"dbcs");case"lpstr-ansi":r=P2(this,this.l),e=4+ea(this,this.l);break;case"lpstr-cp":r=O2(this,this.l),e=4+ea(this,this.l);break;case"lpwstr":r=I2(this,this.l),e=4+2*ea(this,this.l);break;case"lpp4":e=4+ea(this,this.l),r=M2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ea(this,this.l),r=U2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=wi(this,this.l+e++))!==0;)s.push(Oc(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=Cn(this,this.l+e))!==0;)s.push(Oc(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=wi(this,u),this.l=u+1,l=tl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Oc(Cn(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=wi(this,u),this.l=u+1,l=tl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Oc(wi(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return a=wi(this,this.l),this.l++,a;case 2:return a=(t==="i"?F3:Cn)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?Fs:P3)(this,this.l),this.l+=4,a):(n=ea(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=$0(this,this.l):n=$0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=A2(this,this.l,e);break}}return this.l+=e,r}var D3=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},O3=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},R3=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function I3(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)R3(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,D3(this,t,this.l);break;case 8:if(a=8,r==="f"){A3(this,t,this.l);break}case 16:break;case-4:a=4,O3(this,t,this.l);break}return this.l+=a,this}function H2(e,t){var r=A2(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function or(e,t){e.l=t,e.read_shift=tl,e.chk=H2,e.write_shift=I3}function Nr(e,t){e.l+=t}function Gt(e){var t=ks(e);return or(t,0),t}function Ln(e,t,r){if(e){var a,n,s;or(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=q0[l]||q0[65535];for(a=e.read_shift(1),s=a&127,n=1;n<4&&a&128;++n)s+=((a=e.read_shift(1))&127)<<7*n;c=e.l+s;var d=u.f&&u.f(e,s,r);if(e.l=c,t(d,u,l))return}}}function Uf(){var e=[],t=rt?256:2048,r=function(u){var d=Gt(u);return or(d,0),d},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},s=function(u){return a&&u<a.length-a.l?a:(n(),a=r(Math.max(u+1,t)))},o=function(){return n(),Gn(e)},l=function(u){n(),a=u,a.l==null&&(a.l=a.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function rl(e,t,r){var a=ur(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function ng(e,t,r){var a=ur(e);return a.s=rl(a.s,t.s,r),a.e=rl(a.e,t.s,r),a}function al(e,t){if(e.cRel&&e.c<0)for(e=ur(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ur(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Xe(e);return!e.cRel&&e.cRel!=null&&(r=B3(r)),!e.rRel&&e.rRel!=null&&(r=L3(r)),r}function dd(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Qt(e.s.c)+":"+(e.e.cRel?"":"$")+Qt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+dr(e.s.r)+":"+(e.e.rRel?"":"$")+dr(e.e.r):al(e.s,t.biff)+":"+al(e.e,t.biff)}function vp(e){return parseInt(M3(e),10)-1}function dr(e){return""+(e+1)}function L3(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function M3(e){return e.replace(/\$(\d+)$/,"$1")}function yp(e){for(var t=U3(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Qt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function B3(e){return e.replace(/^([A-Z])/,"$$$1")}function U3(e){return e.replace(/^\$([A-Z])/,"$1")}function z3(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Or(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Xe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Eo(e){var t=e.indexOf(":");return t==-1?{s:Or(e),e:Or(e)}:{s:Or(e.slice(0,t)),e:Or(e.slice(t+1))}}function nt(e,t){return typeof t>"u"||typeof t=="number"?nt(e.s,e.e):(typeof e!="string"&&(e=Xe(e)),typeof t!="string"&&(t=Xe(t)),e==t?e:e+":"+t)}function Dt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=e.length;for(r=0;a<s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===s||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function sg(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ea(e.z,r?Lr(t):t)}catch{}try{return e.w=Ea((e.XF||{}).numFmtId||(r?14:0),r?Lr(t):t)}catch{return""+t}}function On(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?xi[e.v]||e.v:t==null?sg(e,e.v):sg(e,t))}function Ts(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function V2(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,s=e||(n?[]:{}),o=0,l=0;if(s&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?Or(a.origin):a.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Dt(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var p={v:t[f][h]},x=o+f,m=l+h;if(u.s.r>x&&(u.s.r=x),u.s.c>m&&(u.s.c=m),u.e.r<x&&(u.e.r=x),u.e.c<m&&(u.e.c=m),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))p=t[f][h];else if(Array.isArray(p.v)&&(p.f=t[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(a.nullError)p.t="e",p.v=0;else if(a.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=a.dateNF||Qe[14],a.cellDates?(p.t="d",p.w=Ea(p.z,Lr(p.v))):(p.t="n",p.v=Lr(p.v),p.w=Ea(p.z,p.v))):p.t="s";if(n)s[x]||(s[x]=[]),s[x][m]&&s[x][m].z&&(p.z=s[x][m].z),s[x][m]=p;else{var w=Xe({c:m,r:x});s[w]&&s[w].z&&(p.z=s[w].z),s[w]=p}}}return u.s.c<1e7&&(s["!ref"]=nt(u)),s}function So(e,t){return V2(null,e,t)}function $3(e){return e.read_shift(4,"i")}function Er(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function H3(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function wp(e,t){var r=e.l,a=e.read_shift(1),n=Er(e),s=[],o={t:n,h:n};if(a&1){for(var l=e.read_shift(4),c=0;c!=l;++c)s.push(H3(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var V3=wp;function Sa(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function hi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var W3=Er;function kp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var G3=Er,zf=kp;function bp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?$0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Fs(t,0)>>2;return r?n/100:n}function W2(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var pi=W2;function wr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function X3(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var u=Js[n];u&&(t.rgb=Il(u));break;case 2:t.rgb=Il([o,l,c]);break;case 3:t.theme=n;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function q3(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function G2(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Q3(e){return G2(e,1)}function K3(e){return G2(e,2)}var Ep=2,zr=3,Ic=11,ig=12,H0=19,Lc=64,Y3=65,J3=71,Z3=4108,ej=4126,er=80,X2=81,tj=[er,X2],rj={1:{n:"CodePage",t:Ep},2:{n:"Category",t:er},3:{n:"PresentationFormat",t:er},4:{n:"ByteCount",t:zr},5:{n:"LineCount",t:zr},6:{n:"ParagraphCount",t:zr},7:{n:"SlideCount",t:zr},8:{n:"NoteCount",t:zr},9:{n:"HiddenCount",t:zr},10:{n:"MultimediaClipCount",t:zr},11:{n:"ScaleCrop",t:Ic},12:{n:"HeadingPairs",t:Z3},13:{n:"TitlesOfParts",t:ej},14:{n:"Manager",t:er},15:{n:"Company",t:er},16:{n:"LinksUpToDate",t:Ic},17:{n:"CharacterCount",t:zr},19:{n:"SharedDoc",t:Ic},22:{n:"HyperlinksChanged",t:Ic},23:{n:"AppVersion",t:zr,p:"version"},24:{n:"DigSig",t:Y3},26:{n:"ContentType",t:er},27:{n:"ContentStatus",t:er},28:{n:"Language",t:er},29:{n:"Version",t:er},255:{},2147483648:{n:"Locale",t:H0},2147483651:{n:"Behavior",t:H0},1919054434:{}},aj={1:{n:"CodePage",t:Ep},2:{n:"Title",t:er},3:{n:"Subject",t:er},4:{n:"Author",t:er},5:{n:"Keywords",t:er},6:{n:"Comments",t:er},7:{n:"Template",t:er},8:{n:"LastAuthor",t:er},9:{n:"RevNumber",t:er},10:{n:"EditTime",t:Lc},11:{n:"LastPrinted",t:Lc},12:{n:"CreatedDate",t:Lc},13:{n:"ModifiedDate",t:Lc},14:{n:"PageCount",t:zr},15:{n:"WordCount",t:zr},16:{n:"CharCount",t:zr},17:{n:"Thumbnail",t:J3},18:{n:"Application",t:er},19:{n:"DocSecurity",t:zr},255:{},2147483648:{n:"Locale",t:H0},2147483651:{n:"Behavior",t:H0},1919054434:{}},og={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},nj=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function sj(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var ij=sj([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Js=ur(ij),xi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},q2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},lg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function oj(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function lj(e){var t=oj();if(!e||!e.match)return t;var r={};if((e.match(Cr)||[]).forEach(function(a){var n=We(a);switch(n[0].replace(m3,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[lg[n.ContentType]]!==void 0&&t[lg[n.ContentType]].push(n.PartName);break}}),t.xmlns!==_3.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Di={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function $f(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function nl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(Cr)||[]).forEach(function(n){var s=We(n);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:$o(s.Target,t);r[l]=o,a[s.Id]=o}}),r["!id"]=a,r}var cj="application/vnd.oasis.opendocument.spreadsheet";function uj(e,t){for(var r=mp(e),a,n;a=Ol.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=We(a[0],!1),n.path=="/"&&n.type!==cj)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}var sl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],dj=function(){for(var e=new Array(sl.length),t=0;t<sl.length;++t){var r=sl[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function Q2(e){var t={};e=gt(e);for(var r=0;r<sl.length;++r){var a=sl[r],n=e.match(dj[r]);n!=null&&n.length>0&&(t[a[1]]=it(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=nr(t[a[1]]))}return t}var fj=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function K2(e,t,r,a){var n=[];if(typeof e=="string")n=Jm(e,a);else for(var s=0;s<e.length;++s)n=n.concat(e[s].map(function(d){return{v:d}}));var o=typeof t=="string"?Jm(t,a).map(function(d){return d.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==n.length;u+=2){switch(c=+n[u+1].v,n[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function hj(e,t,r){var a={};return t||(t={}),e=gt(e),fj.forEach(function(n){var s=(e.match(Dl(n[0]))||[])[1];switch(n[2]){case"string":s&&(t[n[1]]=it(s));break;case"bool":t[n[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(a[n[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&K2(a.HeadingPairs,a.TitlesOfParts,t,r),t}var pj=/<[^>]+>[^<]*/g;function xj(e,t){var r={},a="",n=e.match(pj);if(n)for(var s=0;s!=n.length;++s){var o=n[s],l=We(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":a=it(l.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[a]=it(d);break;case"bool":r[a]=kt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(d);break;case"filetime":case"date":r[a]=nr(d);break;case"cy":case"error":r[a]=it(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var mj={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},fd;function gj(e,t,r){fd||(fd=hp(mj)),t=fd[t]||t,e[t]=r}function Sp(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Y2(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function J2(e,t,r){var a=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(a.length+1&3)&3),a}function Z2(e,t,r){return t===31?J2(e):Y2(e,t,r)}function Hf(e,t,r){return Z2(e,t,r===!1?0:4)}function vj(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Z2(e,t,0)}function yj(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Ir,""),e.l-n&2&&(e.l+=2)}return r}function wj(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Ir,"");return r}function kj(e){var t=e.l,r=V0(e,X2);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=V0(e,zr);return[r,a]}function bj(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(kj(e));return r}function cg(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var s=e.read_shift(4),o=e.read_shift(4);a[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Ir,"").replace(zo,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),a}function ew(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Ej(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function V0(e,t,r){var a=e.read_shift(2),n,s=r||{};if(e.l+=2,t!==ig&&a!==t&&tj.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===ig?a:t){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return Y2(e,a,4).replace(Ir,"");case 31:return J2(e);case 64:return Sp(e);case 65:return ew(e);case 71:return Ej(e);case 80:return Hf(e,a,!s.raw).replace(Ir,"");case 81:return vj(e,a).replace(Ir,"");case 4108:return bj(e);case 4126:case 4127:return a==4127?yj(e):wj(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function ug(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=n;++o){var d=e.read_shift(4),f=e.read_shift(4);s[o]=[d,f+r]}s.sort(function(y,v){return y[1]-v[1]});var h={};for(o=0;o!=n;++o){if(e.l!==s[o][1]){var p=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],p=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],p=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(p=!1,e.l=s[o][1]),p)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var x=t[s[o][0]];if(h[x.n]=V0(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ma(l=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(s[o][0]===1){if(l=h.CodePage=V0(e,Ep),Ma(l),c!==-1){var m=e.l;e.l=s[c][1],u=cg(e,l),e.l=m}}else if(s[o][0]===0){if(l===0){c=o,e.l=s[o+1][1];continue}u=cg(e,l)}else{var w=u[s[o][0]],g;switch(e[e.l]){case 65:e.l+=4,g=ew(e);break;case 30:e.l+=4,g=Hf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,g=Hf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Rt(e,4);break;case 64:e.l+=4,g=nr(Sp(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[w]=g}}return e.l=r+a,h}function dg(e,t,r){var a=e.content;if(!a)return{};or(a,0);var n,s,o,l,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var u=a.read_shift(4),d=a.read_shift(16);if(d!==at.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),l=a.read_shift(4),n===1&&l!==a.l)throw new Error("Length mismatch: "+l+" !== "+a.l);n===2&&(o=a.read_shift(16),c=a.read_shift(4));var f=ug(a,t),h={SystemIdentifier:u};for(var p in f)h[p]=f[p];if(h.FMTID=s,n===1)return h;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var x;try{x=ug(a,null)}catch{}for(p in x)h[p]=x[p];return h.FMTID=[s,o],h}function Bn(e,t){return e.read_shift(t),null}function Sj(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function Rt(e,t){return e.read_shift(t)===1}function $t(e){return e.read_shift(2,"u")}function tw(e,t){return Sj(e,t,$t)}function Nj(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function lc(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=a?e.read_shift(a,n):"";return o}function Cj(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,s=1+(r&1),o=0,l,c={};n&&(o=e.read_shift(2)),a&&(l=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return n&&(e.l+=4*o),a&&(e.l+=l),c.t=d,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function li(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function cc(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):li(e,a,r)}function mi(e,t,r){if(r.biff>5)return cc(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function _j(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Tj(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Ir,"");return a&&(e.l+=24),n}function jj(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(Ir,"");return r+o}function Aj(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Tj(e);case"0303000000000000c000000000000046":return jj(e);default:throw new Error("Unsupported Moniker "+r)}}function Mc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Ir,""):"";return r}function Fj(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var s,o,l,c,u="",d,f;n&16&&(s=Mc(e,r-e.l)),n&128&&(o=Mc(e,r-e.l)),(n&257)===257&&(l=Mc(e,r-e.l)),(n&257)===1&&(c=Aj(e,r-e.l)),n&8&&(u=Mc(e,r-e.l)),n&32&&(d=e.read_shift(16)),n&64&&(f=Sp(e)),e.l=r;var h=o||l||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),n&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return d&&(p.guid=d),f&&(p.time=f),s&&(p.Tooltip=s),p}function rw(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function aw(e,t){var r=rw(e);return r[3]=0,r}function dn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Pj(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Dj(e,t,r){return t===0?"":mi(e,t,r)}function Oj(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),s=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[n,s,o]}function nw(e){var t=e.read_shift(2),r=bp(e);return[t,r]}function Rj(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=lc(e,t,r),s=e.read_shift(2);if(a-=e.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return e.l+=s,n}function Eu(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function sw(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var Ij=sw;function iw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function Lj(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Mj(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function mr(e){e.l+=2,e.l+=e.read_shift(2)}var Bj={0:mr,4:mr,5:mr,6:mr,7:Mj,8:mr,9:mr,10:mr,11:mr,12:mr,13:Lj,14:mr,15:mr,16:mr,17:mr,18:mr,19:mr,20:mr,21:iw};function Uj(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(Bj[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Bc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function zj(e,t){return t===0||e.read_shift(2),1200}function $j(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=mi(e,0,r);return e.read_shift(t+a-e.l),n}function Hj(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Vj(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=lc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:n,dt:s,name:o}}function Wj(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),s=[],o=0;o!=n&&e.l<r;++o)s.push(Cj(e));return s.Count=a,s.Unique=n,s}function Gj(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Xj(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function qj(e){var t=Pj(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Qj(e){return e.read_shift(2),e.read_shift(4)}function fg(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,n]}function Kj(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function Yj(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function Jj(){}function Zj(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=lc(e,0,r),a}function eA(e){var t=dn(e);return t.isst=e.read_shift(4),t}function tA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=dn(e);r.biff==2&&e.l++;var s=cc(e,a-e.l,r);return n.val=s,n}function rA(e,t,r){var a=e.read_shift(2),n=mi(e,0,r);return[a,n]}var aA=mi;function hg(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:s,c:l},e:{r:o,c}}}function nA(e){var t=e.read_shift(2),r=e.read_shift(2),a=nw(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function sA(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(nw(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:o,rkrec:s}}function iA(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:o,ixfe:s}}function oA(e,t,r,a){var n={},s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return n.patternType=nj[l>>26],a.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=l&127,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function lA(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=oA(e,t,a.fStyle,r),a}function cA(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function pg(e,t,r){var a=dn(e);(r.biff==2||t==9)&&++e.l;var n=Nj(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function uA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=dn(e),n=wr(e);return a.val=n,a}var xg=Dj;function dA(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=li(e,s),l=[];a>e.l;)l.push(cc(e));return[s,n,o,l]}function mg(e,t,r){var a=e.read_shift(2),n,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=Rj(e,t-2,r)),s.body=n||e.read_shift(t-2),typeof n=="string"&&(s.Name=n),s}var fA=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function gg(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=li(e,o,r);n&32&&(u=fA[u.charCodeAt(0)]);var d=a-e.l;r&&r.biff==2&&--d;var f=a==e.l||l===0||!(d>0)?[]:X5(e,d,r,l);return{chKey:s,Name:u,itab:c,rgce:f}}function ow(e,t,r){if(r.biff<8)return hA(e,t,r);for(var a=[],n=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)a.push(Oj(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function hA(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=lc(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function pA(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),s=li(e,a,r),o=li(e,n,r);return[s,o]}function xA(e,t,r){var a=sw(e);e.l++;var n=e.read_shift(1);return t-=8,[q5(e,t,r),n,a]}function vg(e,t,r){var a=Ij(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,W5(e,t,r)]}function mA(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function gA(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=mi(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},l,o,s]}}function vA(e,t,r){return gA(e,t,r)}function yA(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Eu(e));return r}function wA(e,t,r){if(r&&r.biff<8)return bA(e,t,r);var a=iw(e),n=Uj(e,t-22,a[1]);return{cmo:a,ft:n}}var kA={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function bA(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((kA[a]||Nr)(e,t,r)),{cmo:[n,a,s],ft:o}}function EA(e,t,r){var a=e.l,n="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=_j(e,6,r);var l=e.read_shift(2);e.read_shift(2),$t(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-a!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=li(e,e.lens[u+1]-e.lens[u]-1);if(n+=f,n.length>=(d?l:2*l))break}if(n.length!==l&&n.length!==l*2)throw new Error("cchText: "+l+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function SA(e,t){var r=Eu(e);e.l+=16;var a=Fj(e,t-24);return[r,a]}function NA(e,t){e.read_shift(2);var r=Eu(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Ir,""),[r,a]}function CA(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=og[r]||r,r=e.read_shift(2),t[1]=og[r]||r,t}function _A(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(aw(e));return r}function TA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(aw(e));return r}function jA(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function lw(e,t,r){if(!r.cellStyles)return Nr(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var u={s:n,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function AA(e,t){var r={};return t<32||(e.l+=16,r.header=wr(e),r.footer=wr(e),e.l+=2),r}function FA(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}var PA=dn,DA=tw,OA=cc;function RA(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function IA(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=dn(e);++e.l;var n=mi(e,t-7,r);return a.t="str",a.val=n,a}function LA(e){var t=dn(e);++e.l;var r=wr(e);return t.t="n",t.val=r,t}function MA(e){var t=dn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function BA(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function UA(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function zA(e,t,r){var a=e.l+t,n=dn(e),s=e.read_shift(2),o=li(e,s,r);return e.l=a,n.t="str",n.val=o,n}var $A=[2,3,48,49,131,139,140,245],yg=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=hp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=ks(1);switch(c.type){case"base64":d=Ia(sa(l));break;case"binary":d=Ia(l);break;case"buffer":case"array":d=l;break}or(d,0);var f=d.read_shift(1),h=!!(f&136),p=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,w=521;f==2&&(m=d.read_shift(2)),d.l+=3,f!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(w=d.read_shift(2));var g=d.read_shift(2),y=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var v=[],k={},_=Math.min(d.length,f==2?521:w-10-(p?264:0)),F=x?32:11;d.l<_&&d[d.l]!=13;)switch(k={},k.name=Wn.utils.decode(y,d.slice(d.l,d.l+F)).replace(/[\u0000\r\n].*$/g,""),d.l+=F,k.type=String.fromCharCode(d.read_shift(1)),f!=2&&!x&&(k.offset=d.read_shift(4)),k.len=d.read_shift(1),f==2&&(k.offset=d.read_shift(2)),k.dec=d.read_shift(1),k.name.length&&v.push(k),f!=2&&(d.l+=x?13:14),k.type){case"B":(!p||k.len!=8)&&c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var b=0,S=0;for(u[0]=[],S=0;S!=v.length;++S)u[0][S]=v[S].name;for(;m-- >0;){if(d[d.l]===42){d.l+=g;continue}for(++d.l,u[++b]=[],S=0,S=0;S!=v.length;++S){var C=d.slice(d.l,d.l+v[S].len);d.l+=v[S].len,or(C,0);var B=Wn.utils.decode(y,C);switch(v[S].type){case"C":B.trim().length&&(u[b][S]=B.replace(/\s+$/,""));break;case"D":B.length===8?u[b][S]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):u[b][S]=B;break;case"F":u[b][S]=parseFloat(B.trim());break;case"+":case"I":u[b][S]=x?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":u[b][S]=!0;break;case"N":case"F":u[b][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[b][S]="##MEMO##"+(x?parseInt(B.trim(),10):C.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(u[b][S]=+B||0);break;case"@":u[b][S]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":u[b][S]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":u[b][S]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[b][S]=-C.read_shift(-8,"f");break;case"B":if(p&&v[S].len==8){u[b][S]=C.read_shift(8,"f");break}case"G":case"P":C.l+=v[S].len;break;case"0":if(v[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[S].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=v,u}function a(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=So(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function n(l,c){try{return Ts(a(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&Ma(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Uf(),f=Kf(l,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),x=l["!cols"]||[],m=0,w=0,g=0,y=1;for(m=0;m<h.length;++m){if(((x[m]||{}).DBF||{}).name){h[m]=x[m].DBF.name,++g;continue}if(h[m]!=null){if(++g,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(w=0;w<1024;++w)if(h.indexOf(h[m]+"_"+w)==-1){h[m]+="_"+w;break}}}}var v=Dt(l["!ref"]),k=[],_=[],F=[];for(m=0;m<=v.e.c-v.s.c;++m){var b="",S="",C=0,B=[];for(w=0;w<p.length;++w)p[w][m]!=null&&B.push(p[w][m]);if(B.length==0||h[m]==null){k[m]="?";continue}for(w=0;w<B.length;++w){switch(typeof B[w]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=B[w]instanceof Date?"D":"C";break;default:S="C"}C=Math.max(C,String(B[w]).length),b=b&&b!=S?"C":S}C>250&&(C=250),S=((x[m]||{}).DBF||{}).type,S=="C"&&x[m].DBF.len>C&&(C=x[m].DBF.len),b=="B"&&S=="N"&&(b="N",F[m]=x[m].DBF.dec,C=x[m].DBF.len),_[m]=b=="C"||S=="N"?C:s[b]||0,y+=_[m],k[m]=b}var T=d.next(32);for(T.write_shift(4,318902576),T.write_shift(4,p.length),T.write_shift(2,296+32*g),T.write_shift(2,y),m=0;m<4;++m)T.write_shift(4,0);for(T.write_shift(4,0|(+t[i2]||3)<<8),m=0,w=0;m<h.length;++m)if(h[m]!=null){var U=d.next(32),K=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,K,"sbcs"),U.write_shift(1,k[m]=="?"?"C":k[m],"sbcs"),U.write_shift(4,w),U.write_shift(1,_[m]||s[k[m]]||0),U.write_shift(1,F[m]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),w+=_[m]||s[k[m]]||0}var de=d.next(264);for(de.write_shift(4,13),m=0;m<65;++m)de.write_shift(4,0);for(m=0;m<p.length;++m){var oe=d.next(y);for(oe.write_shift(1,0),w=0;w<h.length;++w)if(h[w]!=null)switch(k[w]){case"L":oe.write_shift(1,p[m][w]==null?63:p[m][w]?84:70);break;case"B":oe.write_shift(8,p[m][w]||0,"f");break;case"N":var ge="0";for(typeof p[m][w]=="number"&&(ge=p[m][w].toFixed(F[w]||0)),g=0;g<_[w]-ge.length;++g)oe.write_shift(1,32);oe.write_shift(1,ge,"sbcs");break;case"D":p[m][w]?(oe.write_shift(4,("0000"+p[m][w].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(p[m][w].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+p[m][w].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var Z=String(p[m][w]!=null?p[m][w]:"").slice(0,_[w]);for(oe.write_shift(1,Z,"sbcs"),g=0;g<_[w]-Z.length;++g)oe.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:a,from_sheet:o}}(),HA=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ln(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var x=e[p];return typeof x=="number"?Rm(x):x},a=function(h,p,x){var m=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return m==59?h:Rm(m)};e["|"]=254;function n(h,p){switch(p.type){case"base64":return s(sa(h),p);case"binary":return s(h,p);case"buffer":return s(rt&&Buffer.isBuffer(h)?h.toString("binary"):fi(h),p);case"array":return s(oi(h),p)}throw new Error("Unrecognized type "+p.type)}function s(h,p){var x=h.split(/[\n\r]+/),m=-1,w=-1,g=0,y=0,v=[],k=[],_=null,F={},b=[],S=[],C=[],B=0,T;for(+p.codepage>=0&&Ma(+p.codepage);g!==x.length;++g){B=0;var U=x[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),K=U.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),de=K[0],oe;if(U.length>0)switch(de){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":K[1].charAt(0)=="P"&&k.push(U.slice(3).replace(/;;/g,";"));break;case"C":var ge=!1,Z=!1,se=!1,z=!1,xe=-1,be=-1;for(y=1;y<K.length;++y)switch(K[y].charAt(0)){case"A":break;case"X":w=parseInt(K[y].slice(1))-1,Z=!0;break;case"Y":for(m=parseInt(K[y].slice(1))-1,Z||(w=0),T=v.length;T<=m;++T)v[T]=[];break;case"K":oe=K[y].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(Ha(oe))?isNaN(fo(oe).getDate())||(oe=nr(oe)):(oe=Ha(oe),_!==null&&bo(_)&&(oe=bu(oe))),ge=!0;break;case"E":z=!0;var O=zi(K[y].slice(1),{r:m,c:w});v[m][w]=[v[m][w],O];break;case"S":se=!0,v[m][w]=[v[m][w],"S5S"];break;case"G":break;case"R":xe=parseInt(K[y].slice(1))-1;break;case"C":be=parseInt(K[y].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+U)}if(ge&&(v[m][w]&&v[m][w].length==2?v[m][w][0]=oe:v[m][w]=oe,_=null),se){if(z)throw new Error("SYLK shared formula cannot have own formula");var J=xe>-1&&v[xe][be];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");v[m][w][1]=vw(J[1],{r:m-xe,c:w-be})}break;case"F":var W=0;for(y=1;y<K.length;++y)switch(K[y].charAt(0)){case"X":w=parseInt(K[y].slice(1))-1,++W;break;case"Y":for(m=parseInt(K[y].slice(1))-1,T=v.length;T<=m;++T)v[T]=[];break;case"M":B=parseInt(K[y].slice(1))/20;break;case"F":break;case"G":break;case"P":_=k[parseInt(K[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=K[y].slice(1).split(" "),T=parseInt(C[0],10);T<=parseInt(C[1],10);++T)B=parseInt(C[2],10),S[T-1]=B===0?{hidden:!0}:{wch:B},ho(S[T-1]);break;case"C":w=parseInt(K[y].slice(1))-1,S[w]||(S[w]={});break;case"R":m=parseInt(K[y].slice(1))-1,b[m]||(b[m]={}),B>0?(b[m].hpt=B,b[m].hpx=Ll(B)):B===0&&(b[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+U)}W<1&&(_=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+U)}}return b.length>0&&(F["!rows"]=b),S.length>0&&(F["!cols"]=S),p&&p.sheetRows&&(v=v.slice(0,p.sheetRows)),[v,F]}function o(h,p){var x=n(h,p),m=x[0],w=x[1],g=So(m,p);return ln(w).forEach(function(y){g[y]=w[y]}),g}function l(h,p){return Ts(o(h,p),p)}function c(h,p,x,m){var w="C;Y"+(x+1)+";X"+(m+1)+";K";switch(h.t){case"n":w+=h.v||0,h.f&&!h.F&&(w+=";E"+j6(h.f,{r:x,c:m}));break;case"b":w+=h.v?"TRUE":"FALSE";break;case"e":w+=h.w||h.v;break;case"d":w+='"'+(h.w||h.v)+'"';break;case"s":w+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(h,p){p.forEach(function(x,m){var w="F;W"+(m+1)+" "+(m+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=G0(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=X0(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&h.push(w)})}function d(h,p){p.forEach(function(x,m){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*xw(x.hpx)+";"),w.length>2&&h.push(w+"R"+(m+1))})}function f(h,p){var x=["ID;PWXL;N;E"],m=[],w=Dt(h["!ref"]),g,y=Array.isArray(h),v=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&u(x,h["!cols"]),h["!rows"]&&d(x,h["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var k=w.s.r;k<=w.e.r;++k)for(var _=w.s.c;_<=w.e.c;++_){var F=Xe({r:k,c:_});g=y?(h[k]||[])[_]:h[F],!(!g||g.v==null&&(!g.f||g.F))&&m.push(c(g,h,k,_))}return x.join(v)+v+m.join(v)+v+"E"+v}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),VA=function(){function e(s,o){switch(o.type){case"base64":return t(sa(s),o);case"binary":return t(s,o);case"buffer":return t(rt&&Buffer.isBuffer(s)?s.toString("binary"):fi(s),o);case"array":return t(oi(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=l[d].trim().split(","),p=h[0],x=h[1];++d;for(var m=l[d]||"";(m.match(/["]/g)||[]).length&1&&d<l.length-1;)m+=`
`+l[++d];switch(m=m.trim(),+p){case-1:if(m==="BOT"){f[++c]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[c][u]=!0:m==="FALSE"?f[c][u]=!1:isNaN(Ha(x))?isNaN(fo(x).getDate())?f[c][u]=x:f[c][u]=nr(x):f[c][u]=Ha(x),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[c][u++]=m!==""?m:null;break}if(m==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return So(e(s,o),o)}function a(s,o){return Ts(r(s,o),o)}var n=function(){var s=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=Dt(c["!ref"]),f,h=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){o(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var m=Xe({r:p,c:x});if(f=h?(c[p]||[])[x]:c[m],!f){o(u,1,0,"");continue}switch(f.t){case"n":var w=f.w;!w&&f.v!=null&&(w=f.v),w==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,w,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Ea(f.z||Qe[14],Lr(nr(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var g=`\r
`,y=u.join(g);return y}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),WA=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),x=-1,m=-1,w=0,g=[];w!==p.length;++w){var y=p[w].trim().split(":");if(y[0]==="cell"){var v=Or(y[1]);if(g.length<=v.r)for(x=g.length;x<=v.r;++x)g[x]||(g[x]=[]);switch(x=v.r,m=v.c,y[2]){case"t":g[x][m]=e(y[3]);break;case"v":g[x][m]=+y[3];break;case"vtf":var k=y[y.length-1];case"vtc":switch(y[3]){case"nl":g[x][m]=!!+y[4];break;default:g[x][m]=+y[4];break}y[2]=="vtf"&&(g[x][m]=[g[x][m],k])}}}return h&&h.sheetRows&&(g=g.slice(0,h.sheetRows)),g}function a(f,h){return So(r(f,h),h)}function n(f,h){return Ts(a(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],x,m="",w=Eo(f["!ref"]),g=Array.isArray(f),y=w.s.r;y<=w.e.r;++y)for(var v=w.s.c;v<=w.e.c;++v)if(m=Xe({r:y,c:v}),x=g?(f[y]||[])[v]:f[m],!(!x||x.v==null||x.t==="z")){switch(p=["cell",m,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var k=Lr(nr(x.v));p[2]="vtc",p[3]="nd",p[4]=""+k,p[5]=x.w||Ea(x.z||Qe[14],k);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[s,o,l,o,u(f),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:d}}(),Rl=function(){function e(d,f,h,p,x){x.raw?f[h][p]=d:d===""||(d==="TRUE"?f[h][p]=!0:d==="FALSE"?f[h][p]=!1:isNaN(Ha(d))?isNaN(fo(d).getDate())?f[h][p]=d:f[h][p]=nr(d):f[h][p]=Ha(d))}function t(d,f){var h=f||{},p=[];if(!d||d.length===0)return p;for(var x=d.split(/[\r\n]/),m=x.length-1;m>=0&&x[m].length===0;)--m;for(var w=10,g=0,y=0;y<=m;++y)g=x[y].indexOf(" "),g==-1?g=x[y].length:g++,w=Math.max(w,g);for(y=0;y<=m;++y){p[y]=[];var v=0;for(e(x[y].slice(0,w).trim(),p,y,v,h),v=1;v<=(x[y].length-w)/10+1;++v)e(x[y].slice(w+(v-1)*10,w+v*10).trim(),p,y,v,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(d){for(var f={},h=!1,p=0,x=0;p<d.length;++p)(x=d.charCodeAt(p))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p]);if(!x.length){f=a;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p])}return x.sort(function(m,w){return m[0]-w[0]||a[m[1]]-a[w[1]]}),r[x.pop()[1]]||44}function s(d,f){var h=f||{},p="",x=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=n(d.slice(0,1024)):h&&h.FS?p=h.FS:p=n(d.slice(0,1024));var w=0,g=0,y=0,v=0,k=0,_=p.charCodeAt(0),F=!1,b=0,S=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var C=h.dateNF!=null?a3(h.dateNF):null;function B(){var T=d.slice(v,k),U={};if(T.charAt(0)=='"'&&T.charAt(T.length-1)=='"'&&(T=T.slice(1,-1).replace(/""/g,'"')),T.length===0)U.t="z";else if(h.raw)U.t="s",U.v=T;else if(T.trim().length===0)U.t="s",U.v=T;else if(T.charCodeAt(0)==61)T.charCodeAt(1)==34&&T.charCodeAt(T.length-1)==34?(U.t="s",U.v=T.slice(2,-1).replace(/""/g,'"')):F6(T)?(U.t="n",U.f=T.slice(1)):(U.t="s",U.v=T);else if(T=="TRUE")U.t="b",U.v=!0;else if(T=="FALSE")U.t="b",U.v=!1;else if(!isNaN(y=Ha(T)))U.t="n",h.cellText!==!1&&(U.w=T),U.v=y;else if(!isNaN(fo(T).getDate())||C&&T.match(C)){U.z=h.dateNF||Qe[14];var K=0;C&&T.match(C)&&(T=n3(T,h.dateNF,T.match(C)||[]),K=1),h.cellDates?(U.t="d",U.v=nr(T,K)):(U.t="n",U.v=Lr(nr(T,K))),h.cellText!==!1&&(U.w=Ea(U.z,U.v instanceof Date?Lr(U.v):U.v)),h.cellNF||delete U.z}else U.t="s",U.v=T;if(U.t=="z"||(h.dense?(x[w]||(x[w]=[]),x[w][g]=U):x[Xe({c:g,r:w})]=U),v=k+1,S=d.charCodeAt(v),m.e.c<g&&(m.e.c=g),m.e.r<w&&(m.e.r=w),b==_)++g;else if(g=0,++w,h.sheetRows&&h.sheetRows<=w)return!0}e:for(;k<d.length;++k)switch(b=d.charCodeAt(k)){case 34:S===34&&(F=!F);break;case _:case 10:case 13:if(!F&&B())break e;break}return k-v>0&&B(),x["!ref"]=nt(m),x}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):So(t(d,f),f)}function l(d,f){var h="",p=f.type=="string"?[0,0,0,0]:Pp(d,f);switch(f.type){case"base64":h=sa(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof Wn<"u"?h=Wn.utils.decode(f.codepage,d):h=rt&&Buffer.isBuffer(d)?d.toString("binary"):fi(d);break;case"array":h=oi(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=gt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=gt(h):f.type=="binary"&&typeof Wn<"u"&&f.codepage&&(h=Wn.utils.decode(f.codepage,Wn.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?WA.to_sheet(f.type=="string"?h:gt(h),f):o(h,f)}function c(d,f){return Ts(l(d,f),f)}function u(d){for(var f=[],h=Dt(d["!ref"]),p,x=Array.isArray(d),m=h.s.r;m<=h.e.r;++m){for(var w=[],g=h.s.c;g<=h.e.c;++g){var y=Xe({r:m,c:g});if(p=x?(d[m]||[])[g]:d[y],!p||p.v==null){w.push("          ");continue}for(var v=(p.w||(On(p),p.w)||"").slice(0,10);v.length<10;)v+=" ";w.push(v+(g===0?" ":""))}f.push(w.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function GA(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=HA.to_workbook(e,r);return r.WTF=a,n}catch(s){if(r.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return Rl.to_workbook(e,t)}}var il=function(){function e(O,J,W){if(O){or(O,O.l||0);for(var V=W.Enum||xe;O.l<O.length;){var le=O.read_shift(2),we=V[le]||V[65535],R=O.read_shift(2),X=O.l+R,q=we.f&&we.f(O,R,W);if(O.l=X,J(q,we,le))return}}}function t(O,J){switch(J.type){case"base64":return r(Ia(sa(O)),J);case"binary":return r(Ia(O),J);case"buffer":case"array":return r(O,J)}throw"Unsupported type "+J.type}function r(O,J){if(!O)return O;var W=J||{},V=W.dense?[]:{},le="Sheet1",we="",R=0,X={},q=[],ce=[],P={s:{r:0,c:0},e:{r:0,c:0}},Se=W.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)W.Enum=xe,e(O,function(ve,ze,Ze){switch(Ze){case 0:W.vers=ve,ve>=4096&&(W.qpro=!0);break;case 6:P=ve;break;case 204:ve&&(we=ve);break;case 222:we=ve;break;case 15:case 51:W.qpro||(ve[1].v=ve[1].v.slice(1));case 13:case 14:case 16:Ze==14&&(ve[2]&112)==112&&(ve[2]&15)>1&&(ve[2]&15)<15&&(ve[1].z=W.dateNF||Qe[14],W.cellDates&&(ve[1].t="d",ve[1].v=bu(ve[1].v))),W.qpro&&ve[3]>R&&(V["!ref"]=nt(P),X[le]=V,q.push(le),V=W.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},R=ve[3],le=we||"Sheet"+(R+1),we="");var dt=W.dense?(V[ve[0].r]||[])[ve[0].c]:V[Xe(ve[0])];if(dt){dt.t=ve[1].t,dt.v=ve[1].v,ve[1].z!=null&&(dt.z=ve[1].z),ve[1].f!=null&&(dt.f=ve[1].f);break}W.dense?(V[ve[0].r]||(V[ve[0].r]=[]),V[ve[0].r][ve[0].c]=ve[1]):V[Xe(ve[0])]=ve[1];break}},W);else if(O[2]==26||O[2]==14)W.Enum=be,O[2]==14&&(W.qpro=!0,O.l=0),e(O,function(ve,ze,Ze){switch(Ze){case 204:le=ve;break;case 22:ve[1].v=ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ve[3]>R&&(V["!ref"]=nt(P),X[le]=V,q.push(le),V=W.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},R=ve[3],le="Sheet"+(R+1)),Se>0&&ve[0].r>=Se)break;W.dense?(V[ve[0].r]||(V[ve[0].r]=[]),V[ve[0].r][ve[0].c]=ve[1]):V[Xe(ve[0])]=ve[1],P.e.c<ve[0].c&&(P.e.c=ve[0].c),P.e.r<ve[0].r&&(P.e.r=ve[0].r);break;case 27:ve[14e3]&&(ce[ve[14e3][0]]=ve[14e3][1]);break;case 1537:ce[ve[0]]=ve[1],ve[0]==R&&(le=ve[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(V["!ref"]=nt(P),X[we||le]=V,q.push(we||le),!ce.length)return{SheetNames:q,Sheets:X};for(var Ce={},Te=[],fe=0;fe<ce.length;++fe)X[q[fe]]?(Te.push(ce[fe]||q[fe]),Ce[ce[fe]]=X[ce[fe]]||X[q[fe]]):(Te.push(ce[fe]),Ce[ce[fe]]={"!ref":"A1"});return{SheetNames:Te,Sheets:Ce}}function a(O,J){var W=J||{};if(+W.codepage>=0&&Ma(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var V=Uf(),le=Dt(O["!ref"]),we=Array.isArray(O),R=[];Aa(V,0,s(1030)),Aa(V,6,c(le));for(var X=Math.min(le.e.r,8191),q=le.s.r;q<=X;++q)for(var ce=dr(q),P=le.s.c;P<=le.e.c;++P){q===le.s.r&&(R[P]=Qt(P));var Se=R[P]+ce,Ce=we?(O[q]||[])[P]:O[Se];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")(Ce.v|0)==Ce.v&&Ce.v>=-32768&&Ce.v<=32767?Aa(V,13,p(q,P,Ce.v)):Aa(V,14,m(q,P,Ce.v));else{var Te=On(Ce);Aa(V,15,f(q,P,Te.slice(0,239)))}}return Aa(V,1),V.end()}function n(O,J){var W=J||{};if(+W.codepage>=0&&Ma(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var V=Uf();Aa(V,0,o(O));for(var le=0,we=0;le<O.SheetNames.length;++le)(O.Sheets[O.SheetNames[le]]||{})["!ref"]&&Aa(V,27,z(O.SheetNames[le],we++));var R=0;for(le=0;le<O.SheetNames.length;++le){var X=O.Sheets[O.SheetNames[le]];if(!(!X||!X["!ref"])){for(var q=Dt(X["!ref"]),ce=Array.isArray(X),P=[],Se=Math.min(q.e.r,8191),Ce=q.s.r;Ce<=Se;++Ce)for(var Te=dr(Ce),fe=q.s.c;fe<=q.e.c;++fe){Ce===q.s.r&&(P[fe]=Qt(fe));var ve=P[fe]+Te,ze=ce?(X[Ce]||[])[fe]:X[ve];if(!(!ze||ze.t=="z"))if(ze.t=="n")Aa(V,23,B(Ce,fe,R,ze.v));else{var Ze=On(ze);Aa(V,22,b(Ce,fe,R,Ze.slice(0,239)))}}++R}}return Aa(V,1),V.end()}function s(O){var J=Gt(2);return J.write_shift(2,O),J}function o(O){var J=Gt(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var W=0,V=0,le=0,we=0;we<O.SheetNames.length;++we){var R=O.SheetNames[we],X=O.Sheets[R];if(!(!X||!X["!ref"])){++le;var q=Eo(X["!ref"]);W<q.e.r&&(W=q.e.r),V<q.e.c&&(V=q.e.c)}}return W>8191&&(W=8191),J.write_shift(2,W),J.write_shift(1,le),J.write_shift(1,V),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function l(O,J,W){var V={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&W.qpro?(V.s.c=O.read_shift(1),O.l++,V.s.r=O.read_shift(2),V.e.c=O.read_shift(1),O.l++,V.e.r=O.read_shift(2),V):(V.s.c=O.read_shift(2),V.s.r=O.read_shift(2),J==12&&W.qpro&&(O.l+=2),V.e.c=O.read_shift(2),V.e.r=O.read_shift(2),J==12&&W.qpro&&(O.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function c(O){var J=Gt(8);return J.write_shift(2,O.s.c),J.write_shift(2,O.s.r),J.write_shift(2,O.e.c),J.write_shift(2,O.e.r),J}function u(O,J,W){var V=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(V[0].c=O.read_shift(1),V[3]=O.read_shift(1),V[0].r=O.read_shift(2),O.l+=2):(V[2]=O.read_shift(1),V[0].c=O.read_shift(2),V[0].r=O.read_shift(2)),V}function d(O,J,W){var V=O.l+J,le=u(O,J,W);if(le[1].t="s",W.vers==20768){O.l++;var we=O.read_shift(1);return le[1].v=O.read_shift(we,"utf8"),le}return W.qpro&&O.l++,le[1].v=O.read_shift(V-O.l,"cstr"),le}function f(O,J,W){var V=Gt(7+W.length);V.write_shift(1,255),V.write_shift(2,J),V.write_shift(2,O),V.write_shift(1,39);for(var le=0;le<V.length;++le){var we=W.charCodeAt(le);V.write_shift(1,we>=128?95:we)}return V.write_shift(1,0),V}function h(O,J,W){var V=u(O,J,W);return V[1].v=O.read_shift(2,"i"),V}function p(O,J,W){var V=Gt(7);return V.write_shift(1,255),V.write_shift(2,J),V.write_shift(2,O),V.write_shift(2,W,"i"),V}function x(O,J,W){var V=u(O,J,W);return V[1].v=O.read_shift(8,"f"),V}function m(O,J,W){var V=Gt(13);return V.write_shift(1,255),V.write_shift(2,J),V.write_shift(2,O),V.write_shift(8,W,"f"),V}function w(O,J,W){var V=O.l+J,le=u(O,J,W);if(le[1].v=O.read_shift(8,"f"),W.qpro)O.l=V;else{var we=O.read_shift(2);k(O.slice(O.l,O.l+we),le),O.l+=we}return le}function g(O,J,W){var V=J&32768;return J&=-32769,J=(V?O:0)+(J>=8192?J-16384:J),(V?"":"$")+(W?Qt(J):dr(J))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(O,J){or(O,0);for(var W=[],V=0,le="",we="",R="",X="";O.l<O.length;){var q=O[O.l++];switch(q){case 0:W.push(O.read_shift(8,"f"));break;case 1:we=g(J[0].c,O.read_shift(2),!0),le=g(J[0].r,O.read_shift(2),!1),W.push(we+le);break;case 2:{var ce=g(J[0].c,O.read_shift(2),!0),P=g(J[0].r,O.read_shift(2),!1);we=g(J[0].c,O.read_shift(2),!0),le=g(J[0].r,O.read_shift(2),!1),W.push(ce+P+":"+we+le)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(O.read_shift(2));break;case 6:{for(var Se="";q=O[O.l++];)Se+=String.fromCharCode(q);W.push('"'+Se.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:X=W.pop(),R=W.pop(),W.push(["AND","OR"][q-20]+"("+R+","+X+")");break;default:if(q<32&&v[q])X=W.pop(),R=W.pop(),W.push(R+v[q]+X);else if(y[q]){if(V=y[q][1],V==69&&(V=O[O.l++]),V>W.length){console.error("WK1 bad formula parse 0x"+q.toString(16)+":|"+W.join("|")+"|");return}var Ce=W.slice(-V);W.length-=V,W.push(y[q][0]+"("+Ce.join(",")+")")}else return q<=7?console.error("WK1 invalid opcode "+q.toString(16)):q<=24?console.error("WK1 unsupported op "+q.toString(16)):q<=30?console.error("WK1 invalid opcode "+q.toString(16)):q<=115?console.error("WK1 unsupported function opcode "+q.toString(16)):console.error("WK1 unrecognized opcode "+q.toString(16))}}W.length==1?J[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function _(O){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=O.read_shift(2),J[3]=O[O.l++],J[0].c=O[O.l++],J}function F(O,J){var W=_(O);return W[1].t="s",W[1].v=O.read_shift(J-4,"cstr"),W}function b(O,J,W,V){var le=Gt(6+V.length);le.write_shift(2,O),le.write_shift(1,W),le.write_shift(1,J),le.write_shift(1,39);for(var we=0;we<V.length;++we){var R=V.charCodeAt(we);le.write_shift(1,R>=128?95:R)}return le.write_shift(1,0),le}function S(O,J){var W=_(O);W[1].v=O.read_shift(2);var V=W[1].v>>1;if(W[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return W[1].v=V,W}function C(O,J){var W=_(O),V=O.read_shift(4),le=O.read_shift(4),we=O.read_shift(2);if(we==65535)return V===0&&le===3221225472?(W[1].t="e",W[1].v=15):V===0&&le===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var R=we&32768;return we=(we&32767)-16446,W[1].v=(1-R*2)*(le*Math.pow(2,we+32)+V*Math.pow(2,we)),W}function B(O,J,W,V){var le=Gt(14);if(le.write_shift(2,O),le.write_shift(1,W),le.write_shift(1,J),V==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var we=0,R=0,X=0,q=0;return V<0&&(we=1,V=-V),R=Math.log2(V)|0,V/=Math.pow(2,R-31),q=V>>>0,q&2147483648||(V/=2,++R,q=V>>>0),V-=q,q|=2147483648,q>>>=0,V*=Math.pow(2,32),X=V>>>0,le.write_shift(4,X),le.write_shift(4,q),R+=16383+(we?32768:0),le.write_shift(2,R),le}function T(O,J){var W=C(O);return O.l+=J-14,W}function U(O,J){var W=_(O),V=O.read_shift(4);return W[1].v=V>>6,W}function K(O,J){var W=_(O),V=O.read_shift(8,"f");return W[1].v=V,W}function de(O,J){var W=K(O);return O.l+=J-10,W}function oe(O,J){return O[O.l+J-1]==0?O.read_shift(J,"cstr"):""}function ge(O,J){var W=O[O.l++];W>J-1&&(W=J-1);for(var V="";V.length<W;)V+=String.fromCharCode(O[O.l++]);return V}function Z(O,J,W){if(!(!W.qpro||J<21)){var V=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var le=O.read_shift(J-21,"cstr");return[V,le]}}function se(O,J){for(var W={},V=O.l+J;O.l<V;){var le=O.read_shift(2);if(le==14e3){for(W[le]=[0,""],W[le][0]=O.read_shift(2);O[O.l];)W[le][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return W}function z(O,J){var W=Gt(5+O.length);W.write_shift(2,14e3),W.write_shift(2,J);for(var V=0;V<O.length;++V){var le=O.charCodeAt(V);W[W.l++]=le>127?95:le}return W[W.l++]=0,W}var xe={0:{n:"BOF",f:$t},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:ge},65535:{n:""}},be={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:T},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:K},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}();function XA(e){var t={},r=e.match(Cr),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=We(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=lp[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return t}var qA=function(){var e=Dl("t"),t=Dl("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:it(o[1])},c=s.match(t);return c&&(l.s=XA(c[1])),l}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(n).map(r).filter(function(l){return l.v})}}(),QA=function(){var t=/(\r\n|\n)/g;function r(n,s,o){var l=[];n.u&&l.push("text-decoration: underline;"),n.uval&&l.push("text-underline-style:"+n.uval+";"),n.sz&&l.push("font-size:"+n.sz+"pt;"),n.outline&&l.push("text-effect: outline;"),n.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),n.b&&(s.push("<b>"),o.push("</b>")),n.i&&(s.push("<i>"),o.push("</i>")),n.strike&&(s.push("<s>"),o.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),n}function a(n){var s=[[],n.v,[]];return n.v?(n.s&&r(n.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}}(),KA=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,YA=/<(?:\w+:)?r>/,JA=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Np(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=it(gt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=gt(e),r&&(a.h=xp(a.t))):e.match(YA)&&(a.r=gt(e),a.t=it(gt((e.replace(JA,"").match(KA)||[]).join("").replace(Cr,""))),r&&(a.h=QA(qA(a.r)))),a):{t:""}}var ZA=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,eF=/<(?:\w+:)?(?:si|sstItem)>/g,tF=/<\/(?:\w+:)?(?:si|sstItem)>/;function rF(e,t){var r=[],a="";if(!e)return r;var n=e.match(ZA);if(n){a=n[2].replace(eF,"").split(tF);for(var s=0;s!=a.length;++s){var o=Np(a[s].trim(),t);o!=null&&(r[r.length]=o)}n=We(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}function aF(e){return[e.read_shift(4),e.read_shift(4)]}function nF(e,t){var r=[],a=!1;return Ln(e,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function cw(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function jn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function sF(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=jn(e,4),t.U=jn(e,4),t.W=jn(e,4),t}function iF(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),s=[];n-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function oF(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(iF(e));return t}function lF(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function cF(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=jn(e,4),t.U=jn(e,4),t.W=jn(e,4),t}function uF(e){var t=cF(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function uw(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function dw(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function dF(e){var t=jn(e);switch(t.Minor){case 2:return[t.Minor,fF(e)];case 3:return[t.Minor,hF()];case 4:return[t.Minor,pF(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function fF(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=uw(e,r),n=dw(e,e.length-e.l);return{t:"Std",h:a,v:n}}function hF(){throw new Error("File is password-protected: ECMA-376 Extensible")}function pF(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Cr,function(s){var o=We(s);switch(un(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){a[l]=o[l]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function xF(e,t){var r={},a=r.EncryptionVersionInfo=jn(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=uw(e,n),t-=n,r.EncryptionVerifier=dw(e,t),r}function mF(e){var t={},r=t.EncryptionVersionInfo=jn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function gF(e){var t=0,r,a=cw(e),n=a.length+1,s,o,l,c,u;for(r=ks(n),r[0]=a.length,s=1;s!=n;++s)r[s]=a[s-1];for(s=n-1;s>=0;--s)o=r[s],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var fw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},n=function(o,l){return a(o^l)},s=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=cw(o),c=s(l),u=l.length,d=ks(16),f=0;f!=16;++f)d[f]=0;var h,p,x;for((u&1)===1&&(h=c>>8,d[u]=n(e[0],h),--u,h=c&255,p=l[l.length-1],d[u]=n(p,h));u>0;)--u,h=c>>8,d[u]=n(l[u],h),--u,h=c&255,d[u]=n(l[u],h);for(u=15,x=15-l.length;x>0;)h=c>>8,d[u]=n(e[x],h),--u,--x,h=c&255,d[u]=n(l[u],h),--u,--x;return d}}(),vF=function(e,t,r,a,n){n||(n=t),a||(a=fw(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=a[r],o=(o>>5|o<<3)&255,n[s]=o,++r;return[n,r,a]},yF=function(e){var t=0,r=fw(e);return function(a){var n=vF("",a,t,r);return t=n[1],n[0]}};function wF(e,t,r,a){var n={key:$t(e),verificationBytes:$t(e)};return r.password&&(n.verifier=gF(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=yF(r.password)),n}function kF(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=mF(e):a.Data=xF(e,t),a}function bF(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?kF(e,t-2,a):wF(e,r.biff>=8?t:t-2,r,a),a}var EF=function(){function e(n,s){switch(s.type){case"base64":return t(sa(n),s);case"binary":return t(n,s);case"buffer":return t(rt&&Buffer.isBuffer(n)?n.toString("binary"):fi(n),s);case"array":return t(oi(n),s)}throw new Error("Unrecognized type "+s.type)}function t(n,s){var o=s||{},l=o.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,p=0,x,m=-1;x=h.exec(d);){switch(x[0]){case"\\cell":var w=d.slice(p,h.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++m,w.length){var g={v:w,t:"s"};Array.isArray(l)?l[f][m]=g:l[Xe({r:f,c:m})]=g}break}p=h.lastIndex}m>u.e.c&&(u.e.c=m)}),l["!ref"]=nt(u),l}function r(n,s){return Ts(e(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],o=Dt(n["!ref"]),l,c=Array.isArray(n),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=Xe({r:u,c:d});l=c?(n[u]||[])[d]:n[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(On(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function SF(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Il(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function NF(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),s=Math.min(t,r,a),o=n-s;if(o===0)return[0,0,t];var l=0,c=0,u=n+s;switch(c=o/(u>1?2-u:u),n){case t:l=((r-a)/o+6)%6;break;case r:l=(a-t)/o+2;break;case a:l=(t-r)/o+4;break}return[l/6,c,u/2]}function CF(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),s=a-n/2,o=[s,s,s],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=n*l,o[0]+=n,o[1]+=c;break;case 1:c=n*(2-l),o[0]+=c,o[1]+=n;break;case 2:c=n*(l-2),o[1]+=n,o[2]+=c;break;case 3:c=n*(4-l),o[1]+=c,o[2]+=n;break;case 4:c=n*(l-4),o[2]+=n,o[0]+=c;break;case 5:c=n*(6-l),o[2]+=c,o[0]+=n;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function W0(e,t){if(t===0)return e;var r=NF(SF(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Il(CF(r))}var hw=6,_F=15,TF=1,Dr=hw;function G0(e){return Math.floor((e+Math.round(128/Dr)/256)*Dr)}function X0(e){return Math.floor((e-5)/Dr*100+.5)/100}function Vf(e){return Math.round((e*Dr+5)/Dr*256)/256}function hd(e){return Vf(X0(G0(e)))}function Cp(e){var t=Math.abs(e-hd(e)),r=Dr;if(t>.005)for(Dr=TF;Dr<_F;++Dr)Math.abs(e-hd(e))<=t&&(t=Math.abs(e-hd(e)),r=Dr);Dr=r}function ho(e){e.width?(e.wpx=G0(e.width),e.wch=X0(e.wpx),e.MDW=Dr):e.wpx?(e.wch=X0(e.wpx),e.width=Vf(e.wch),e.MDW=Dr):typeof e.wch=="number"&&(e.width=Vf(e.wch),e.wpx=G0(e.width),e.MDW=Dr),e.customWidth&&delete e.customWidth}var jF=96,pw=jF;function xw(e){return e*96/pw}function Ll(e){return e*pw/96}var AF={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function FF(e,t,r,a){t.Borders=[];var n={},s=!1;(e[0].match(Cr)||[]).forEach(function(o){var l=We(o);switch(un(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},l.diagonalUp&&(n.diagonalUp=kt(l.diagonalUp)),l.diagonalDown&&(n.diagonalDown=kt(l.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function PF(e,t,r,a){t.Fills=[];var n={},s=!1;(e[0].match(Cr)||[]).forEach(function(o){var l=We(o);switch(un(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":l.patternType&&(n.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),l.indexed&&(n.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(n.bgColor.theme=parseInt(l.theme,10)),l.tint&&(n.bgColor.tint=parseFloat(l.tint)),l.rgb&&(n.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),l.theme&&(n.fgColor.theme=parseInt(l.theme,10)),l.tint&&(n.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(n.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function DF(e,t,r,a){t.Fonts=[];var n={},s=!1;(e[0].match(Cr)||[]).forEach(function(o){var l=We(o);switch(un(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":l.val&&(n.name=gt(l.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=l.val?kt(l.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=l.val?kt(l.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(l.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=l.val?kt(l.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=l.val?kt(l.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=l.val?kt(l.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=l.val?kt(l.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=l.val?kt(l.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":l.val&&(n.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(n.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(n.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(n.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=lp[parseInt(l.val,10)];break;case"<color":if(n.color||(n.color={}),l.auto&&(n.color.auto=kt(l.auto)),l.rgb)n.color.rgb=l.rgb.slice(-6);else if(l.indexed){n.color.index=parseInt(l.indexed,10);var c=Js[n.color.index];n.color.index==81&&(c=Js[1]),c||(c=Js[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(n.color.theme=parseInt(l.theme,10),l.tint&&(n.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=W0(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function OF(e,t,r){t.NumberFmt=[];for(var a=ln(Qe),n=0;n<a.length;++n)t.NumberFmt[a[n]]=Qe[a[n]];var s=e[0].match(Cr);if(s)for(n=0;n<s.length;++n){var o=We(s[n]);switch(un(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=it(gt(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}Ys(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var Uc=["numFmtId","fillId","fontId","borderId","xfId"],zc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function RF(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(Cr)||[]).forEach(function(s){var o=We(s),l=0;switch(un(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],l=0;l<Uc.length;++l)a[Uc[l]]&&(a[Uc[l]]=parseInt(a[Uc[l]],10));for(l=0;l<zc.length;++l)a[zc[l]]&&(a[zc[l]]=kt(a[zc[l]]));if(t.NumberFmt&&a.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[l]){a.numFmtId=l;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=kt(o.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var IF=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&OF(f,d,u),(f=l.match(n))&&DF(f,d,c,u),(f=l.match(a))&&PF(f,d,c,u),(f=l.match(s))&&FF(f,d,c,u),(f=l.match(r))&&RF(f,d,u),d}}();function LF(e,t){var r=e.read_shift(2),a=Er(e);return[r,a]}function MF(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=q3(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=e.read_shift(2);switch(s===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var l=e.read_shift(1);l>0&&(a.family=l);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=X3(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Er(e),a}var BF=Nr;function UF(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}var zF=Nr;function $F(e,t,r){var a={};a.NumberFmt=[];for(var n in Qe)a.NumberFmt[n]=Qe[n];a.CellXf=[],a.Fonts=[];var s=[],o=!1;return Ln(e,function(c,u,d){switch(d){case 44:a.NumberFmt[c[0]]=c[1],Ys(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=W0(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}var HF=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function VF(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Cr)||[]).forEach(function(n){var s=We(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[HF.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function WF(){}function GF(){}var XF=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,qF=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,QF=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function KF(e,t,r){t.themeElements={};var a;[["clrScheme",XF,VF],["fontScheme",qF,WF],["fmtScheme",QF,GF]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var YF=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function mw(e,t){(!e||e.length===0)&&(e=JF());var r,a={};if(!(r=e.match(YF)))throw new Error("themeElements not found in theme");return KF(r[0],a,t),a.raw=e,a}function JF(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[_2];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function ZF(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var s=e.slice(e.l);e.l=a;var o;try{o=C2(s,{type:"array"})}catch{return}var l=ta(o,"theme/theme/theme1.xml",!0);if(l)return mw(l,r)}}function e6(e){return e.read_shift(4)}function t6(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=r6(e,4);break;case 2:t.xclrValue=rw(e);break;case 3:t.xclrValue=e6(e);break;case 4:e.l+=4;break}return e.l+=8,t}function r6(e,t){return Nr(e,t)}function a6(e,t){return Nr(e,t)}function n6(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=t6(e);break;case 6:a[1]=a6(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function s6(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),s=[];n-- >0;)s.push(n6(e,r-e.l));return{ixfe:a,ext:s}}function i6(e,t){t.forEach(function(r){switch(r[0]){}})}function o6(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Er(e)}}function l6(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function c6(e){return e.l+=4,e.read_shift(4)!=0}function u6(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},s=[],o=!1,l=2;return Ln(e,function(c,u,d){switch(d){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?a.Cell.push({type:a.Types[f[0]-1].name,index:f[1]}):l==0&&a.Value.push({type:a.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(d),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),a}function d6(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,s=2,o;return e.replace(Cr,function(l){var c=We(l);switch(un(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<a.Types.length;++u)a.Types[u].name==c.name&&(o=a.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):s==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),a}function f6(e){var t=[];if(!e)return t;var r=1;return(e.match(Cr)||[]).forEach(function(a){var n=We(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function h6(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Xe(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function p6(e,t,r){var a=[];return Ln(e,function(s,o,l){switch(l){case 63:a.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),a}function x6(e,t,r,a){if(!e)return e;var n=a||{},s=!1;Ln(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},n)}function m6(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function wg(e,t,r,a){var n=Array.isArray(e),s;t.forEach(function(o){var l=Or(o.ref);if(n?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[o.ref],!s){s={t:"z"},n?e[l.r][l.c]=s:e[o.ref]=s;var c=Dt(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=nt(c);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&a){for(f=0;f<a.length;++f)if(d.a==a[f].id){d.a=a[f].name||d.a;break}}s.c.push(d)})}function g6(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=We(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Or(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Np(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),a.push(u)}}}}),a}function v6(e,t){var r=[],a=!1,n={},s=0;return e.replace(Cr,function(l,c){var u=We(l);switch(un(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":n.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function y6(e,t){var r=[],a=!1;return e.replace(Cr,function(s){var o=We(s);switch(un(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function w6(e){var t={};t.iauthor=e.read_shift(4);var r=pi(e);return t.rfx=r.s,t.ref=Xe(r.s),e.l+=16,t}var k6=Er;function b6(e,t){var r=[],a=[],n={},s=!1;return Ln(e,function(l,c,u){switch(u){case 632:a.push(l);break;case 635:n=l;break;case 637:n.t=l.t,n.h=l.h,n.r=l.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var E6="application/vnd.ms-office.vbaProject";function S6(e){var t=at.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");at.utils.cfb_add(t,n,e.FileIndex[a].content)}}),at.write(t)}function N6(){return{"!type":"dialog"}}function C6(){return{"!type":"dialog"}}function _6(){return{"!type":"macro"}}function T6(){return{"!type":"macro"}}var zi=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,n+(l?"":"$")+Qt(d)+(c?"":"$")+dr(u)}return function(n,s){return t=s,n.replace(e,r)}}(),gw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,j6=function(){return function(t,r){return t.replace(gw,function(a,n,s,o,l,c){var u=yp(o)-(s?0:r.c),d=vp(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",h=u==0?"":s?u+1:"["+u+"]";return n+"R"+f+"C"+h})}}();function vw(e,t){return e.replace(gw,function(r,a,n,s,o,l){return a+(n=="$"?n+s:Qt(yp(s)+t.c))+(o=="$"?o+l:dr(vp(l)+t.r))})}function A6(e,t,r){var a=Eo(t),n=a.s,s=Or(r),o={r:s.r-n.r,c:s.c-n.c};return vw(e,o)}function F6(e){return e.length!=1}function kg(e){return e.replace(/_xlfn\./g,"")}function Ut(e){e.l+=1}function bs(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function yw(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return ww(e);r.biff==12&&(a=4)}var n=e.read_shift(a),s=e.read_shift(a),o=bs(e,2),l=bs(e,2);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function ww(e){var t=bs(e,2),r=bs(e,2),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function P6(e,t,r){if(r.biff<8)return ww(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),s=bs(e,2),o=bs(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function kw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return D6(e);var a=e.read_shift(r&&r.biff==12?4:2),n=bs(e,2);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function D6(e){var t=bs(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function O6(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function R6(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return I6(e);var n=e.read_shift(a>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;n>524287;)n-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:o,rRel:l}}function I6(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function L6(e,t,r){var a=(e[e.l++]&96)>>5,n=yw(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function M6(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=yw(e,s,r);return[a,n,o]}function B6(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function U6(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[a,n]}function z6(e,t,r){var a=(e[e.l++]&96)>>5,n=P6(e,t-1,r);return[a,n]}function $6(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function bg(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function H6(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function V6(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function W6(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function G6(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function X6(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function bw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function q6(e){return e.read_shift(2),bw(e)}function Q6(e){return e.read_shift(2),bw(e)}function K6(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=kw(e,0,r);return[a,n]}function Y6(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=R6(e,0,r);return[a,n]}function J6(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=kw(e,0,r);return[a,n,s]}function Z6(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[e8[n],Nw[n],a]}function e5(e,t,r){var a=e[e.l++],n=e.read_shift(1),s=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:t5(e);return[n,(s[0]===0?Nw:Z5)[s[1]]]}function t5(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function r5(e,t,r){e.l+=r&&r.biff==2?3:4}function a5(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function n5(e){return e.l++,xi[e.read_shift(1)]}function s5(e){return e.l++,e.read_shift(2)}function i5(e){return e.l++,e.read_shift(1)!==0}function o5(e){return e.l++,wr(e)}function l5(e,t,r){return e.l++,lc(e,t-1,r)}function c5(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Rt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=xi[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=wr(e);break;case 2:r[1]=mi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function u5(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((r.biff==12?pi:Eu)(e));return n}function d5(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var s=0,o=[];s!=a&&(o[s]=[]);++s)for(var l=0;l!=n;++l)o[s][l]=c5(e,r.biff);return o}function f5(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,s]}function h5(e,t,r){if(r.biff==5)return p5(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),s=e.read_shift(4);return[a,n,s]}function p5(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function x5(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function m5(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function g5(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function v5(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[a,n]}var y5=Nr,w5=Nr,k5=Nr;function uc(e,t,r){return e.l+=2,[O6(e)]}function _p(e){return e.l+=6,[]}var b5=uc,E5=_p,S5=_p,N5=uc;function Ew(e){return e.l+=2,[$t(e),e.read_shift(2)&1]}var C5=uc,_5=Ew,T5=_p,j5=uc,A5=uc,F5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function P5(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2),o=F5[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:n,C:s}}function D5(e){return e.l+=2,[e.read_shift(4)]}function O5(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function R5(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function I5(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function L5(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function M5(e){return e.l+=4,[0,0]}var Eg={1:{n:"PtgExp",f:a5},2:{n:"PtgTbl",f:k5},3:{n:"PtgAdd",f:Ut},4:{n:"PtgSub",f:Ut},5:{n:"PtgMul",f:Ut},6:{n:"PtgDiv",f:Ut},7:{n:"PtgPower",f:Ut},8:{n:"PtgConcat",f:Ut},9:{n:"PtgLt",f:Ut},10:{n:"PtgLe",f:Ut},11:{n:"PtgEq",f:Ut},12:{n:"PtgGe",f:Ut},13:{n:"PtgGt",f:Ut},14:{n:"PtgNe",f:Ut},15:{n:"PtgIsect",f:Ut},16:{n:"PtgUnion",f:Ut},17:{n:"PtgRange",f:Ut},18:{n:"PtgUplus",f:Ut},19:{n:"PtgUminus",f:Ut},20:{n:"PtgPercent",f:Ut},21:{n:"PtgParen",f:Ut},22:{n:"PtgMissArg",f:Ut},23:{n:"PtgStr",f:l5},26:{n:"PtgSheet",f:O5},27:{n:"PtgEndSheet",f:R5},28:{n:"PtgErr",f:n5},29:{n:"PtgBool",f:i5},30:{n:"PtgInt",f:s5},31:{n:"PtgNum",f:o5},32:{n:"PtgArray",f:$6},33:{n:"PtgFunc",f:Z6},34:{n:"PtgFuncVar",f:e5},35:{n:"PtgName",f:f5},36:{n:"PtgRef",f:K6},37:{n:"PtgArea",f:L6},38:{n:"PtgMemArea",f:x5},39:{n:"PtgMemErr",f:y5},40:{n:"PtgMemNoMem",f:w5},41:{n:"PtgMemFunc",f:m5},42:{n:"PtgRefErr",f:g5},43:{n:"PtgAreaErr",f:B6},44:{n:"PtgRefN",f:Y6},45:{n:"PtgAreaN",f:z6},46:{n:"PtgMemAreaN",f:I5},47:{n:"PtgMemNoMemN",f:L5},57:{n:"PtgNameX",f:h5},58:{n:"PtgRef3d",f:J6},59:{n:"PtgArea3d",f:M6},60:{n:"PtgRefErr3d",f:v5},61:{n:"PtgAreaErr3d",f:U6},255:{}},B5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},U5={1:{n:"PtgElfLel",f:Ew},2:{n:"PtgElfRw",f:j5},3:{n:"PtgElfCol",f:b5},6:{n:"PtgElfRwV",f:A5},7:{n:"PtgElfColV",f:N5},10:{n:"PtgElfRadical",f:C5},11:{n:"PtgElfRadicalS",f:T5},13:{n:"PtgElfColS",f:E5},15:{n:"PtgElfColSV",f:S5},16:{n:"PtgElfRadicalLel",f:_5},25:{n:"PtgList",f:P5},29:{n:"PtgSxName",f:D5},255:{}},z5={0:{n:"PtgAttrNoop",f:M5},1:{n:"PtgAttrSemi",f:X6},2:{n:"PtgAttrIf",f:W6},4:{n:"PtgAttrChoose",f:H6},8:{n:"PtgAttrGoto",f:V6},16:{n:"PtgAttrSum",f:r5},32:{n:"PtgAttrBaxcel",f:bg},33:{n:"PtgAttrBaxcel",f:bg},64:{n:"PtgAttrSpace",f:q6},65:{n:"PtgAttrSpaceSemi",f:Q6},128:{n:"PtgAttrIfError",f:G6},255:{}};function dc(e,t,r,a){if(a.biff<8)return Nr(e,t);for(var n=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=d5(e,0,a),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=u5(e,r[o][1],a),s.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&s.push(Nr(e,t)),s}function fc(e,t,r){for(var a=e.l+t,n,s,o=[];a!=e.l;)t=a-e.l,s=e[e.l],n=Eg[s]||Eg[B5[s]],(s===24||s===25)&&(n=(s===24?U5:z5)[e[e.l+1]]),!n||!n.f?Nr(e,t):o.push([n.n,n.f(e,t,r)]);return o}function $5(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],s=0;s<a.length;++s){var o=a[s];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var H5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function V5(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Sw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Sg(e,t,r){var a=Sw(e,t,r);return a=="#REF"?a:V5(a,r)}function gr(e,t,r,a,n){var s=n&&n.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],c,u,d,f=0,h=0,p,x="";if(!e[0]||!e[0][0])return"";for(var m=-1,w="",g=0,y=e[0].length;g<y;++g){var v=e[0][g];switch(v[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),m>=0){switch(e[0][m][1][0]){case 0:w=Pt(" ",e[0][m][1][1]);break;case 1:w=Pt("\r",e[0][m][1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+w,m=-1}l.push(u+H5[v[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=rl(v[1][1],o,n),l.push(al(d,s));break;case"PtgRefN":d=r?rl(v[1][1],r,n):v[1][1],l.push(al(d,s));break;case"PtgRef3d":f=v[1][1],d=rl(v[1][2],o,n),x=Sg(a,f,n),l.push(x+"!"+al(d,s));break;case"PtgFunc":case"PtgFuncVar":var k=v[1][0],_=v[1][1];k||(k=0),k&=127;var F=k==0?[]:l.slice(-k);l.length-=k,_==="User"&&(_=F.shift()),l.push(_+"("+F.join(",")+")");break;case"PtgBool":l.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(v[1]);break;case"PtgNum":l.push(String(v[1]));break;case"PtgStr":l.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(v[1]);break;case"PtgAreaN":p=ng(v[1][1],r?{s:r}:o,n),l.push(dd(p,n));break;case"PtgArea":p=ng(v[1][1],o,n),l.push(dd(p,n));break;case"PtgArea3d":f=v[1][1],p=v[1][2],x=Sg(a,f,n),l.push(x+"!"+dd(p,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var b=(a.names||[])[h-1]||(a[0]||[])[h],S=b?b.Name:"SH33TJSNAME"+String(h);S&&S.slice(0,6)=="_xlfn."&&!n.xlfn&&(S=S.slice(6)),l.push(S);break;case"PtgNameX":var C=v[1][1];h=v[1][2];var B;if(n.biff<=5)C<0&&(C=-C),a[C]&&(B=a[C][h]);else{var T="";if(((a[C]||[])[0]||[])[0]==14849||(((a[C]||[])[0]||[])[0]==1025?a[C][h]&&a[C][h].itab>0&&(T=a.SheetNames[a[C][h].itab-1]+"!"):T=a.SheetNames[h-1]+"!"),a[C]&&a[C][h])T+=a[C][h].Name;else if(a[0]&&a[0][h])T+=a[0][h].Name;else{var U=(Sw(a,C,n)||"").split(";;");U[h-1]?T=U[h-1]:T+="SH33TJSERRX"}l.push(T);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var K="(",de=")";if(m>=0){switch(w="",e[0][m][1][0]){case 2:K=Pt(" ",e[0][m][1][1])+K;break;case 3:K=Pt("\r",e[0][m][1][1])+K;break;case 4:de=Pt(" ",e[0][m][1][1])+de;break;case 5:de=Pt("\r",e[0][m][1][1])+de;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}l.push(K+l.pop()+de);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:v[1][1],r:v[1][0]};var oe={c:r.c,r:r.r};if(a.sharedf[Xe(d)]){var ge=a.sharedf[Xe(d)];l.push(gr(ge,o,oe,a,n))}else{var Z=!1;for(c=0;c!=a.arrayf.length;++c)if(u=a.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(gr(u[1],o,oe,a,n)),Z=!0;break}Z||l.push(v[1])}break;case"PtgArray":l.push("{"+$5(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&m>=0&&se.indexOf(e[0][g][0])==-1){v=e[0][m];var z=!0;switch(v[1][0]){case 4:z=!1;case 0:w=Pt(" ",v[1][1]);break;case 5:z=!1;case 1:w=Pt("\r",v[1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}l.push((z?w:"")+l.pop()+(z?"":w)),m=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function W5(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,o=e.read_shift(n);if(o==65535)return[[],Nr(e,t-2)];var l=fc(e,o,r);return t!==o+n&&(s=dc(e,t-o-n,l,r)),e.l=a,[l,s]}function G5(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,o=e.read_shift(n);if(o==65535)return[[],Nr(e,t-2)];var l=fc(e,o,r);return t!==o+n&&(s=dc(e,t-o-n,l,r)),e.l=a,[l,s]}function X5(e,t,r,a){var n=e.l+t,s=fc(e,a,r),o;return n!==e.l&&(o=dc(e,n-e.l,s,r)),[s,o]}function q5(e,t,r){var a=e.l+t,n,s=e.read_shift(2),o=fc(e,s,r);return s==65535?[[],Nr(e,t-2)]:(t!==s+2&&(n=dc(e,a-s-2,o,r)),[o,n])}function Q5(e){var t;if(Cn(e,e.l+6)!==65535)return[wr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function pd(e,t,r){var a=e.l+t,n=dn(e);r.biff==2&&++e.l;var s=Q5(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=G5(e,a-e.l,r);return{cell:n,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function Su(e,t,r){var a=e.read_shift(4),n=fc(e,a,r),s=e.read_shift(4),o=s>0?dc(e,s,n,r):null;return[n,o]}var K5=Su,Nu=Su,Y5=Su,J5=Su,Z5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Nw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},e8={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ng(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function xd(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var ol={},$i={};function ll(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Cw(e,t,r,a,n,s){try{a.cellNF&&(e.z=Qe[t])}catch(l){if(a.WTF)throw l}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=nr(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Qe[t]==null&&Ys(r3[t]||"General",t),e.t==="e")e.w=e.w||xi[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pl(e.v);else if(e.t==="d"){var o=Lr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Pl(o)}else{if(e.v===void 0)return"";e.w=ii(e.v,$i)}else e.t==="d"?e.w=Ea(t,Lr(e.v),$i):e.w=Ea(t,e.v,$i)}catch(l){if(a.WTF)throw l}if(a.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=W0(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=W0(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(a.WTF&&s.Fills)throw l}}}function t8(e,t){var r=Dt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=nt(r))}var r8=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,a8=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,n8=/<(?:\w:)?hyperlink [^>]*>/mg,s8=/"(\w*:\w*)"/,i8=/<(?:\w:)?col\b[^>]*[\/]?>/g,o8=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,l8=/<(?:\w:)?pageMargins[^>]*\/>/g,_w=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,c8=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,u8=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function d8(e,t,r,a,n,s,o){if(!e)return e;a||(a={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(a8);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(_w);h?Tp(h[0],l,n,r):(h=u.match(c8))&&f8(h[0],h[1]||"",l,n,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=u.slice(p,p+50).match(s8);x&&t8(l,x[1])}var m=u.match(u8);m&&m[1]&&v8(m[1],n);var w=[];if(t.cellStyles){var g=u.match(i8);g&&x8(w,g)}f&&y8(f[1],l,t,c,s,o);var y=d.match(o8);y&&(l["!autofilter"]=m8(y[0]));var v=[],k=d.match(r8);if(k)for(p=0;p!=k.length;++p)v[p]=Dt(k[p].slice(k[p].indexOf('"')+1));var _=d.match(n8);_&&h8(l,_,a);var F=d.match(l8);if(F&&(l["!margins"]=p8(We(F[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=nt(c)),t.sheetRows>0&&l["!ref"]){var b=Dt(l["!ref"]);t.sheetRows<=+b.e.r&&(b.e.r=t.sheetRows-1,b.e.r>c.e.r&&(b.e.r=c.e.r),b.e.r<b.s.r&&(b.s.r=b.e.r),b.e.c>c.e.c&&(b.e.c=c.e.c),b.e.c<b.s.c&&(b.s.c=b.e.c),l["!fullref"]=l["!ref"],l["!ref"]=nt(b))}return w.length>0&&(l["!cols"]=w),v.length>0&&(l["!merges"]=v),l}function Tp(e,t,r,a){var n=We(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=it(gt(n.codeName)))}function f8(e,t,r,a,n){Tp(e.slice(0,e.indexOf(">")),r,a,n)}function h8(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var s=We(gt(t[n]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+it(s.location))):(s.Target="#"+it(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=Dt(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=Xe({c:u,r:c});a?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function p8(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function x8(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=We(t[a],!0);n.hidden&&(n.hidden=kt(n.hidden));var s=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Cp(n.width)),ho(n);s<=o;)e[s++]=ur(n)}}function m8(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var g8=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function v8(e,t){t.Views||(t.Views=[{}]),(e.match(g8)||[]).forEach(function(r,a){var n=We(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),kt(n.rightToLeft)&&(t.Views[a].RTL=!0)})}var y8=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=Dl("v"),o=Dl("f");return function(c,u,d,f,h,p){for(var x=0,m="",w=[],g=[],y=0,v=0,k=0,_="",F,b,S=0,C=0,B,T,U=0,K=0,de=Array.isArray(p.CellXf),oe,ge=[],Z=[],se=Array.isArray(u),z=[],xe={},be=!1,O=!!d.sheetStubs,J=c.split(t),W=0,V=J.length;W!=V;++W){m=J[W].trim();var le=m.length;if(le!==0){var we=0;e:for(x=0;x<le;++x)switch(m[x]){case">":if(m[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(b=We(m.slice(we,x),!0),S=b.r!=null?parseInt(b.r,10):S+1,C=-1,d.sheetRows&&d.sheetRows<S)continue;xe={},be=!1,b.ht&&(be=!0,xe.hpt=parseFloat(b.ht),xe.hpx=Ll(xe.hpt)),b.hidden=="1"&&(be=!0,xe.hidden=!0),b.outlineLevel!=null&&(be=!0,xe.level=+b.outlineLevel),be&&(z[S-1]=xe)}break;case"<":we=x;break}if(we>=x)break;if(b=We(m.slice(we,x),!0),S=b.r!=null?parseInt(b.r,10):S+1,C=-1,!(d.sheetRows&&d.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),d&&d.cellStyles&&(xe={},be=!1,b.ht&&(be=!0,xe.hpt=parseFloat(b.ht),xe.hpx=Ll(xe.hpt)),b.hidden=="1"&&(be=!0,xe.hidden=!0),b.outlineLevel!=null&&(be=!0,xe.level=+b.outlineLevel),be&&(z[S-1]=xe)),w=m.slice(x).split(e);for(var R=0;R!=w.length&&w[R].trim().charAt(0)=="<";++R);for(w=w.slice(R),x=0;x!=w.length;++x)if(m=w[x].trim(),m.length!==0){if(g=m.match(r),y=x,v=0,k=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,g!=null&&g.length===2){for(y=0,_=g[1],v=0;v!=_.length&&!((k=_.charCodeAt(v)-64)<1||k>26);++v)y=26*y+k;--y,C=y}else++C;for(v=0;v!=m.length&&m.charCodeAt(v)!==62;++v);if(++v,b=We(m.slice(0,v),!0),b.r||(b.r=Xe({r:S-1,c:C})),_=m.slice(v),F={t:""},(g=_.match(s))!=null&&g[1]!==""&&(F.v=it(g[1])),d.cellFormula){if((g=_.match(o))!=null&&g[1]!==""){if(F.f=it(gt(g[1])).replace(/\r\n/g,`
`),d.xlfn||(F.f=kg(F.f)),g[0].indexOf('t="array"')>-1)F.F=(_.match(n)||[])[1],F.F.indexOf(":")>-1&&ge.push([Dt(F.F),F.F]);else if(g[0].indexOf('t="shared"')>-1){T=We(g[0]);var X=it(gt(g[1]));d.xlfn||(X=kg(X)),Z[parseInt(T.si,10)]=[T,X,b.r]}}else(g=_.match(/<f[^>]*\/>/))&&(T=We(g[0]),Z[T.si]&&(F.f=A6(Z[T.si][1],Z[T.si][2],b.r)));var q=Or(b.r);for(v=0;v<ge.length;++v)q.r>=ge[v][0].s.r&&q.r<=ge[v][0].e.r&&q.c>=ge[v][0].s.c&&q.c<=ge[v][0].e.c&&(F.F=ge[v][1])}if(b.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(O)F.t="z";else continue;else F.t=b.t||"n";switch(f.s.c>C&&(f.s.c=C),f.e.c<C&&(f.e.c=C),F.t){case"n":if(F.v==""||F.v==null){if(!O)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!O)continue;F.t="z"}else B=ol[parseInt(F.v,10)],F.v=B.t,F.r=B.r,d.cellHTML&&(F.h=B.h);break;case"str":F.t="s",F.v=F.v!=null?gt(F.v):"",d.cellHTML&&(F.h=xp(F.v));break;case"inlineStr":g=_.match(a),F.t="s",g!=null&&(B=Np(g[1]))?(F.v=B.t,d.cellHTML&&(F.h=B.h)):F.v="";break;case"b":F.v=kt(F.v);break;case"d":d.cellDates?F.v=nr(F.v,1):(F.v=Lr(nr(F.v,1)),F.t="n");break;case"e":(!d||d.cellText!==!1)&&(F.w=F.v),F.v=q2[F.v];break}if(U=K=0,oe=null,de&&b.s!==void 0&&(oe=p.CellXf[b.s],oe!=null&&(oe.numFmtId!=null&&(U=oe.numFmtId),d.cellStyles&&oe.fillId!=null&&(K=oe.fillId))),Cw(F,U,K,d,h,p),d.cellDates&&de&&F.t=="n"&&bo(Qe[U])&&(F.t="d",F.v=bu(F.v)),b.cm&&d.xlmeta){var ce=(d.xlmeta.Cell||[])[+b.cm-1];ce&&ce.type=="XLDAPR"&&(F.D=!0)}if(se){var P=Or(b.r);u[P.r]||(u[P.r]=[]),u[P.r][P.c]=F}else u[b.r]=F}}}}z.length>0&&(u["!rows"]=z)}}();function w8(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=n/20),r}var k8=pi;function b8(){}function E8(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=W3(e),r}function S8(e){var t=Sa(e);return[t]}function N8(e){var t=hi(e);return[t]}function C8(e){var t=Sa(e),r=e.read_shift(1);return[t,r,"b"]}function _8(e){var t=hi(e),r=e.read_shift(1);return[t,r,"b"]}function T8(e){var t=Sa(e),r=e.read_shift(1);return[t,r,"e"]}function j8(e){var t=hi(e),r=e.read_shift(1);return[t,r,"e"]}function A8(e){var t=Sa(e),r=e.read_shift(4);return[t,r,"s"]}function F8(e){var t=hi(e),r=e.read_shift(4);return[t,r,"s"]}function P8(e){var t=Sa(e),r=wr(e);return[t,r,"n"]}function Tw(e){var t=hi(e),r=wr(e);return[t,r,"n"]}function D8(e){var t=Sa(e),r=bp(e);return[t,r,"n"]}function O8(e){var t=hi(e),r=bp(e);return[t,r,"n"]}function R8(e){var t=Sa(e),r=wp(e);return[t,r,"is"]}function I8(e){var t=Sa(e),r=Er(e);return[t,r,"str"]}function L8(e){var t=hi(e),r=Er(e);return[t,r,"str"]}function M8(e,t,r){var a=e.l+t,n=Sa(e);n.r=r["!row"];var s=e.read_shift(1),o=[n,s,"b"];if(r.cellFormula){e.l+=2;var l=Nu(e,a-e.l,r);o[3]=gr(l,null,n,r.supbooks,r)}else e.l=a;return o}function B8(e,t,r){var a=e.l+t,n=Sa(e);n.r=r["!row"];var s=e.read_shift(1),o=[n,s,"e"];if(r.cellFormula){e.l+=2;var l=Nu(e,a-e.l,r);o[3]=gr(l,null,n,r.supbooks,r)}else e.l=a;return o}function U8(e,t,r){var a=e.l+t,n=Sa(e);n.r=r["!row"];var s=wr(e),o=[n,s,"n"];if(r.cellFormula){e.l+=2;var l=Nu(e,a-e.l,r);o[3]=gr(l,null,n,r.supbooks,r)}else e.l=a;return o}function z8(e,t,r){var a=e.l+t,n=Sa(e);n.r=r["!row"];var s=Er(e),o=[n,s,"str"];if(r.cellFormula){e.l+=2;var l=Nu(e,a-e.l,r);o[3]=gr(l,null,n,r.supbooks,r)}else e.l=a;return o}var $8=pi;function H8(e,t){var r=e.l+t,a=pi(e),n=kp(e),s=Er(e),o=Er(e),l=Er(e);e.l=r;var c={rfx:a,relId:n,loc:s,display:l};return o&&(c.Tooltip=o),c}function V8(){}function W8(e,t,r){var a=e.l+t,n=W2(e),s=e.read_shift(1),o=[n];if(o[2]=s,r.cellFormula){var l=K5(e,a-e.l,r);o[1]=l}else e.l=a;return o}function G8(e,t,r){var a=e.l+t,n=pi(e),s=[n];if(r.cellFormula){var o=J5(e,a-e.l,r);s[1]=o,e.l=a}else e.l=a;return s}var X8=["left","right","top","bottom","header","footer"];function q8(e){var t={};return X8.forEach(function(r){t[r]=wr(e)}),t}function Q8(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function K8(){}function Y8(){}function J8(e,t,r,a,n,s,o){if(!e)return e;var l=t||{};a||(a={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,p,x,m,w,g,y,v,k,_,F=[];l.biff=12,l["!row"]=0;var b=0,S=!1,C=[],B={},T=l.supbooks||n.supbooks||[[]];if(T.sharedf=B,T.arrayf=C,T.SheetNames=n.SheetNames||n.Sheets.map(function(se){return se.name}),!l.supbooks&&(l.supbooks=T,n.Names))for(var U=0;U<n.Names.length;++U)T[0][U+1]=n.Names[U];var K=[],de=[],oe=!1;q0[16]={n:"BrtShortReal",f:Tw};var ge;if(Ln(e,function(z,xe,be){if(!h)switch(be){case 148:u=z;break;case 0:p=z,l.sheetRows&&l.sheetRows<=p.r&&(h=!0),k=dr(w=p.r),l["!row"]=p.r,(z.hidden||z.hpt||z.level!=null)&&(z.hpt&&(z.hpx=Ll(z.hpt)),de[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:z[2]},z[2]){case"n":x.v=z[1];break;case"s":v=ol[z[1]],x.v=v.t,x.r=v.r;break;case"b":x.v=!!z[1];break;case"e":x.v=z[1],l.cellText!==!1&&(x.w=xi[x.v]);break;case"str":x.t="s",x.v=z[1];break;case"is":x.t="s",x.v=z[1].t;break}if((m=o.CellXf[z[0].iStyleRef])&&Cw(x,m.numFmtId,null,l,s,o),g=z[0].c==-1?g+1:z[0].c,l.dense?(c[w]||(c[w]=[]),c[w][g]=x):c[Qt(g)+k]=x,l.cellFormula){for(S=!1,b=0;b<C.length;++b){var O=C[b];p.r>=O[0].s.r&&p.r<=O[0].e.r&&g>=O[0].s.c&&g<=O[0].e.c&&(x.F=nt(O[0]),S=!0)}!S&&z.length>3&&(x.f=z[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>g&&(d.s.c=g),d.e.r<p.r&&(d.e.r=p.r),d.e.c<g&&(d.e.c=g),l.cellDates&&m&&x.t=="n"&&bo(Qe[m.numFmtId])){var J=Ls(x.v);J&&(x.t="d",x.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}ge&&(ge.type=="XLDAPR"&&(x.D=!0),ge=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;x={t:"z",v:void 0},g=z[0].c==-1?g+1:z[0].c,l.dense?(c[w]||(c[w]=[]),c[w][g]=x):c[Qt(g)+k]=x,d.s.r>p.r&&(d.s.r=p.r),d.s.c>g&&(d.s.c=g),d.e.r<p.r&&(d.e.r=p.r),d.e.c<g&&(d.e.c=g),ge&&(ge.type=="XLDAPR"&&(x.D=!0),ge=void 0);break;case 176:F.push(z);break;case 49:ge=((l.xlmeta||{}).Cell||[])[z-1];break;case 494:var W=a["!id"][z.relId];for(W?(z.Target=W.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=W):z.relId==""&&(z.Target="#"+z.loc),w=z.rfx.s.r;w<=z.rfx.e.r;++w)for(g=z.rfx.s.c;g<=z.rfx.e.c;++g)l.dense?(c[w]||(c[w]=[]),c[w][g]||(c[w][g]={t:"z",v:void 0}),c[w][g].l=z):(y=Xe({c:g,r:w}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=z);break;case 426:if(!l.cellFormula)break;C.push(z),_=l.dense?c[w][g]:c[Qt(g)+k],_.f=gr(z[1],d,{r:p.r,c:g},T,l),_.F=nt(z[0]);break;case 427:if(!l.cellFormula)break;B[Xe(z[0].s)]=z[1],_=l.dense?c[w][g]:c[Qt(g)+k],_.f=gr(z[1],d,{r:p.r,c:g},T,l);break;case 60:if(!l.cellStyles)break;for(;z.e>=z.s;)K[z.e--]={width:z.w/256,hidden:!!(z.flags&1),level:z.level},oe||(oe=!0,Cp(z.w/256)),ho(K[z.e+1]);break;case 161:c["!autofilter"]={ref:nt(z)};break;case 476:c["!margins"]=z;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),z.name&&(n.Sheets[r].CodeName=z.name),(z.above||z.left)&&(c["!outline"]={above:z.above,left:z.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),z.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!xe.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+be.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=nt(u||d)),l.sheetRows&&c["!ref"]){var Z=Dt(c["!ref"]);l.sheetRows<=+Z.e.r&&(Z.e.r=l.sheetRows-1,Z.e.r>d.e.r&&(Z.e.r=d.e.r),Z.e.r<Z.s.r&&(Z.s.r=Z.e.r),Z.e.c>d.e.c&&(Z.e.c=d.e.c),Z.e.c<Z.s.c&&(Z.s.c=Z.e.c),c["!fullref"]=c["!ref"],c["!ref"]=nt(Z))}return F.length>0&&(c["!merges"]=F),K.length>0&&(c["!cols"]=K),de.length>0&&(c["!rows"]=de),c}function Z8(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var n=it((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[t,n,a]}function eP(e,t,r,a,n,s){var o=s||{"!type":"chart"};if(!e)return s;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Z8(f);d.s.r=d.s.c=0,d.e.c=l,u=Qt(l),h[0].forEach(function(p,x){o[u+dr(x)]={t:"n",v:p,z:h[1]},c=x}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=nt(d)),o}function tP(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(_w);return l&&Tp(l[0],s,n,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function rP(e,t){e.l+=10;var r=Er(e);return{name:r}}function aP(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ln(e,function(c,u,d){switch(d){case 550:s["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var jw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],nP=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],sP=[],iP=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Cg(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var s=t[n];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=kt(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function _g(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=kt(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function Aw(e){_g(e.WBProps,jw),_g(e.CalcPr,iP),Cg(e.WBView,nP),Cg(e.Sheets,sP),$i.date1904=kt(e.WBProps.date1904)}var oP="][*?/\\".split("");function lP(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return oP.forEach(function(a){if(e.indexOf(a)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var cP=/<\w+:workbook/;function uP(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},o=0;if(e.replace(Cr,function(c,u){var d=We(c);switch(un(d[0])){case"<?xml":break;case"<workbook":c.match(cP)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":jw.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=kt(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=gt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=it(gt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=gt(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),kt(d.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=it(gt(e.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),T3.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Aw(r),r}function dP(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=zf(e),r.name=Er(e),r}function fP(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Er(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function hP(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function pP(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),s=G3(e),o=Y5(e,0,r),l=kp(e);e.l=a;var c={Name:s,Ptg:o};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}function xP(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],q0[16]={n:"BrtFRTArchID$",f:hP},Ln(e,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=gr(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(d),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(d),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!u.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),Aw(r),r.Names=s,r.supbooks=o,r}function mP(e,t,r){return t.slice(-4)===".bin"?xP(e,r):uP(e,r)}function gP(e,t,r,a,n,s,o,l){return t.slice(-4)===".bin"?J8(e,a,r,n,s,o,l):d8(e,a,r,n,s,o,l)}function vP(e,t,r,a,n,s,o,l){return t.slice(-4)===".bin"?aP(e,a,r,n,s):tP(e,a,r,n,s)}function yP(e,t,r,a,n,s,o,l){return t.slice(-4)===".bin"?_6():T6()}function wP(e,t,r,a,n,s,o,l){return t.slice(-4)===".bin"?N6():C6()}function kP(e,t,r,a){return t.slice(-4)===".bin"?$F(e,r,a):IF(e,r,a)}function bP(e,t,r){return mw(e,r)}function EP(e,t,r){return t.slice(-4)===".bin"?nF(e,r):rF(e,r)}function SP(e,t,r){return t.slice(-4)===".bin"?b6(e,r):g6(e,r)}function NP(e,t,r){return t.slice(-4)===".bin"?p6(e):f6(e)}function CP(e,t,r,a){return r.slice(-4)===".bin"?x6(e,t,r,a):void 0}function _P(e,t,r){return t.slice(-4)===".bin"?u6(e,t,r):d6(e,t,r)}var Fw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Pw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ja(e,t){var r=e.split(/\s+/),a=[];if(t||(a[0]=r[0]),r.length===1)return a;var n=e.match(Fw),s,o,l,c;if(n)for(c=0;c!=n.length;++c)s=n[c].match(Pw),(o=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),a[l]=s[2].slice(1,s[2].length-1));return a}function TP(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(Fw),n,s,o,l;if(a)for(l=0;l!=a.length;++l)n=a[l].match(Pw),(s=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(s+1),r[o]=n[2].slice(1,n[2].length-1));return r}var cl;function jP(e,t){var r=cl[e]||it(e);return r==="General"?ii(t):Ea(r,t)}function AP(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=kt(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=nr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[it(t)]=n}function FP(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||xi[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pl(e.v):e.w=ii(e.v):e.w=jP(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var a=cl[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&bo(a)){var n=Ls(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(r.WTF)throw s}}}function PP(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=AF[a.Pattern]||a.Pattern)}e[t.ID]=t}function DP(e,t,r,a,n,s,o,l,c,u){var d="General",f=a.StyleID,h={};u=u||{};var p=[],x=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&p.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=kt(e);break;case"String":a.t="s",a.r=Qm(it(e)),a.v=e.indexOf("<")>-1?it(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(nr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=it(e):a.v<60&&(a.v=a.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=q2[e],u.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=Qm(t||e));break}if(FP(a,d,u),u.cellFormula!==!1)if(a.Formula){var m=it(a.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),a.f=zi(m,n),delete a.Formula,a.ArrayRange=="RC"?a.F=zi("RC:RC",n):a.ArrayRange&&(a.F=zi(a.ArrayRange,n),c.push([Dt(a.F),a.F]))}else for(x=0;x<c.length;++x)n.r>=c[x][0].s.r&&n.r<=c[x][0].e.r&&n.c>=c[x][0].s.c&&n.c<=c[x][0].e.c&&(a.F=c[x][1]);u.cellStyles&&(p.forEach(function(w){!h.patternType&&w.patternType&&(h.patternType=w.patternType)}),a.s=h),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function OP(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function md(e,t){var r=t||{};y2();var a=Uo(mp(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=gt(a));var n=a.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=ur(r);return o.type="string",Rl.to_workbook(a,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ze){n.indexOf("<"+ze)>=0&&(s=!0)}),s)return HP(a,r);cl={"General Number":"General","General Date":Qe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Qe[15],"Short Date":Qe[14],"Long Time":Qe[19],"Medium Time":Qe[18],"Short Time":Qe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Qe[2],Standard:Qe[4],Percent:Qe[10],Scientific:Qe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],h=r.dense?[]:{},p="",x={},m={},w=ja('<Data ss:Type="String">'),g=0,y=0,v=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},F={},b="",S=0,C=[],B={},T={},U=0,K=[],de=[],oe={},ge=[],Z,se=!1,z=[],xe=[],be={},O=0,J=0,W={Sheets:[],WBProps:{date1904:!1}},V={};Ol.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";l=Ol.exec(a);)switch(l[3]=(le=l[3]).toLowerCase()){case"data":if(le=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?DP(a.slice(g,l.index),b,w,c[c.length-1][0]=="comment"?oe:x,{c:y,r:v},_,ge[y],m,z,r):(b="",w=ja(l[0]),g=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(de.length>0&&(x.c=de),(!r.sheetRows||r.sheetRows>v)&&x.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][y]=x):h[Qt(y)+dr(v)]=x),x.HRef&&(x.l={Target:it(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(O=y+(parseInt(x.MergeAcross,10)|0),J=v+(parseInt(x.MergeDown,10)|0),C.push({s:{c:y,r:v},e:{c:O,r:J}})),!r.sheetStubs)x.MergeAcross?y=O+1:++y;else if(x.MergeAcross||x.MergeDown){for(var we=y;we<=O;++we)for(var R=v;R<=J;++R)(we>y||R>v)&&(r.dense?(h[R]||(h[R]=[]),h[R][we]={t:"z"}):h[Qt(we)+dr(R)]={t:"z"});y=O+1}else++y;else x=TP(l[0]),x.Index&&(y=+x.Index-1),y<k.s.c&&(k.s.c=y),y>k.e.c&&(k.e.c=y),l[0].slice(-2)==="/>"&&++y,de=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(v<k.s.r&&(k.s.r=v),v>k.e.r&&(k.e.r=v),l[0].slice(-2)==="/>"&&(m=ja(l[0]),m.Index&&(v=+m.Index-1)),y=0,++v):(m=ja(l[0]),m.Index&&(v=+m.Index-1),be={},(m.AutoFitHeight=="0"||m.Height)&&(be.hpx=parseInt(m.Height,10),be.hpt=xw(be.hpx),xe[v]=be),m.Hidden=="1"&&(be.hidden=!0,xe[v]=be));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(p),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(h["!ref"]=nt(k),r.sheetRows&&r.sheetRows<=k.e.r&&(h["!fullref"]=h["!ref"],k.e.r=r.sheetRows-1,h["!ref"]=nt(k))),C.length&&(h["!merges"]=C),ge.length>0&&(h["!cols"]=ge),xe.length>0&&(h["!rows"]=xe),d[p]=h}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=y=0,c.push([l[3],!1]),u=ja(l[0]),p=it(u.Name),h=r.dense?[]:{},C=[],z=[],xe=[],V={name:p,Hidden:0},W.Sheets.push(V);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),ge=[],se=!1}break;case"style":l[1]==="/"?PP(_,F,r):F=ja(l[0]);break;case"numberformat":F.nf=it(ja(l[0]).Format||"General"),cl[F.nf]&&(F.nf=cl[F.nf]);for(var X=0;X!=392&&Qe[X]!=F.nf;++X);if(X==392){for(X=57;X!=392;++X)if(Qe[X]==null){Ys(F.nf,X);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Z=ja(l[0]),Z.Hidden&&(Z.hidden=!0,delete Z.Hidden),Z.Width&&(Z.wpx=parseInt(Z.Width,10)),!se&&Z.wpx>10){se=!0,Dr=hw;for(var q=0;q<ge.length;++q)ge[q]&&ho(ge[q])}se&&ho(Z),ge[Z.Index-1||ge.length]=Z;for(var ce=0;ce<+Z.Span;++ce)ge[ge.length]=ur(Z);break;case"namedrange":if(l[1]==="/")break;W.Names||(W.Names=[]);var P=We(l[0]),Se={Name:P.Name,Ref:zi(P.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(Se.Sheet=W.Sheets.length-1),W.Names.push(Se);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?b+=a.slice(S,l.index):S=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;F.Interior=ja(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?gj(B,le,a.slice(U,l.index)):U=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));OP(oe),de.push(oe)}else c.push([l[3],!1]),u=ja(l[0]),oe={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Ce=ja(l[0]);h["!autofilter"]={ref:zi(Ce.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return Dg(a,r);var Te=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Te=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Te=!1}break;case"excelworkbook":switch(l[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Te=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Te=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(a.slice(U,l.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else U=l.index+l[0].length;break;case"header":h["!margins"]||ll(h["!margins"]={},"xlml"),isNaN(+We(l[0]).Margin)||(h["!margins"].header=+We(l[0]).Margin);break;case"footer":h["!margins"]||ll(h["!margins"]={},"xlml"),isNaN(+We(l[0]).Margin)||(h["!margins"].footer=+We(l[0]).Margin);break;case"pagemargins":var fe=We(l[0]);h["!margins"]||ll(h["!margins"]={},"xlml"),isNaN(+fe.Top)||(h["!margins"].top=+fe.Top),isNaN(+fe.Left)||(h["!margins"].left=+fe.Left),isNaN(+fe.Right)||(h["!margins"].right=+fe.Right),isNaN(+fe.Bottom)||(h["!margins"].bottom=+fe.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Te=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Te=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Te=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Te=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Te=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Te=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Te=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Te=!1}break;case"smarttags":break;default:Te=!1;break}if(Te||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?AP(T,le,K,a.slice(U,l.index)):(K=l,U=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ve={};return!r.bookSheets&&!r.bookProps&&(ve.Sheets=d),ve.SheetNames=f,ve.Workbook=W,ve.SSF=ur(Qe),ve.Props=B,ve.Custprops=T,ve}function Wf(e,t){switch(Fp(t=t||{}),t.type||"base64"){case"base64":return md(sa(e),t);case"binary":case"buffer":case"file":return md(e,t);case"array":return md(fi(e),t)}}function RP(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Q3(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=K3(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var IP=[60,1084,2066,2165,2175];function LP(e,t,r,a,n){var s=a,o=[],l=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(l)}o.push(l),r.l+=s;for(var c=Cn(r,r.l),u=Gf[c],d=0;u!=null&&IP.indexOf(c)>-1;)s=Cn(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+s),o.push(l),r.l+=4+s,u=Gf[c=Cn(r,r.l)];var f=Gn(o);or(f,0);var h=0;f.lens=[];for(var p=0;p<o.length;++p)f.lens.push(h),h+=o[p].length;if(f.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+a;return t.f(f,f.length,n)}function Ja(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Qe[a])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||xi[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pl(e.v):e.w=ii(e.v):e.w=Ea(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&a&&e.t=="n"&&bo(Qe[a]||String(a))){var n=Ls(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function $c(e,t,r){return{v:e,ixfe:t,t:r}}function MP(e,t){var r={opts:{}},a={},n=t.dense?[]:{},s={},o={},l=null,c=[],u="",d={},f,h="",p,x,m,w,g={},y=[],v,k,_=[],F=[],b={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},C=function(Ge){return Ge<8?Js[Ge]:Ge<64&&F[Ge-8]||Js[Ge]},B=function(Ge,ct,Lt){var ht=ct.XF.data;if(!(!ht||!ht.patternType||!Lt||!Lt.cellStyles)){ct.s={},ct.s.patternType=ht.patternType;var Tr;(Tr=Il(C(ht.icvFore)))&&(ct.s.fgColor={rgb:Tr}),(Tr=Il(C(ht.icvBack)))&&(ct.s.bgColor={rgb:Tr})}},T=function(Ge,ct,Lt){if(!(be>1)&&!(Lt.sheetRows&&Ge.r>=Lt.sheetRows)){if(Lt.cellStyles&&ct.XF&&ct.XF.data&&B(Ge,ct,Lt),delete ct.ixfe,delete ct.XF,f=Ge,h=Xe(Ge),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ge.r<o.s.r&&(o.s.r=Ge.r),Ge.c<o.s.c&&(o.s.c=Ge.c),Ge.r+1>o.e.r&&(o.e.r=Ge.r+1),Ge.c+1>o.e.c&&(o.e.c=Ge.c+1),Lt.cellFormula&&ct.f){for(var ht=0;ht<y.length;++ht)if(!(y[ht][0].s.c>Ge.c||y[ht][0].s.r>Ge.r)&&!(y[ht][0].e.c<Ge.c||y[ht][0].e.r<Ge.r)){ct.F=nt(y[ht][0]),(y[ht][0].s.c!=Ge.c||y[ht][0].s.r!=Ge.r)&&delete ct.f,ct.f&&(ct.f=""+gr(y[ht][1],o,Ge,z,U));break}}Lt.dense?(n[Ge.r]||(n[Ge.r]=[]),n[Ge.r][Ge.c]=ct):n[h]=ct}},U={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(U.password=t.password);var K,de=[],oe=[],ge=[],Z=[],se=!1,z=[];z.SheetNames=U.snames,z.sharedf=U.sharedf,z.arrayf=U.arrayf,z.names=[],z.XTI=[];var xe=0,be=0,O=0,J=[],W=[],V;U.codepage=1200,Ma(1200);for(var le=!1;e.l<e.length-1;){var we=e.l,R=e.read_shift(2);if(R===0&&xe===10)break;var X=e.l===e.length?0:e.read_shift(2),q=Gf[R];if(q&&q.f){if(t.bookSheets&&xe===133&&R!==133)break;if(xe=R,q.r===2||q.r==12){var ce=e.read_shift(2);if(X-=2,!U.enc&&ce!==R&&((ce&255)<<8|ce>>8)!==R)throw new Error("rt mismatch: "+ce+"!="+R);q.r==12&&(e.l+=10,X-=10)}var P={};if(R===10?P=q.f(e,X,U):P=LP(R,q,e,X,U),be==0&&[9,521,1033,2057].indexOf(xe)===-1)continue;switch(R){case 34:r.opts.Date1904=b.WBProps.date1904=P;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(U.enc||(e.l=0),U.enc=P,!t.password)throw new Error("File is password-protected");if(P.valid==null)throw new Error("Encryption scheme unsupported");if(!P.valid)throw new Error("Password is incorrect");break;case 92:U.lastuser=P;break;case 66:var Se=Number(P);switch(Se){case 21010:Se=1200;break;case 32768:Se=1e4;break;case 32769:Se=1252;break}Ma(U.codepage=Se),le=!0;break;case 317:U.rrtabid=P;break;case 25:U.winlocked=P;break;case 439:r.opts.RefreshAll=P;break;case 12:r.opts.CalcCount=P;break;case 16:r.opts.CalcDelta=P;break;case 17:r.opts.CalcIter=P;break;case 13:r.opts.CalcMode=P;break;case 14:r.opts.CalcPrecision=P;break;case 95:r.opts.CalcSaveRecalc=P;break;case 15:U.CalcRefMode=P;break;case 2211:r.opts.FullCalc=P;break;case 129:P.fDialog&&(n["!type"]="dialog"),P.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),P.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:_.push(P);break;case 430:z.push([P]),z[z.length-1].XTI=[];break;case 35:case 547:z[z.length-1].push(P);break;case 24:case 536:V={Name:P.Name,Ref:gr(P.rgce,o,null,z,U)},P.itab>0&&(V.Sheet=P.itab-1),z.names.push(V),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(P),P.Name=="_xlnm._FilterDatabase"&&P.itab>0&&P.rgce&&P.rgce[0]&&P.rgce[0][0]&&P.rgce[0][0][0]=="PtgArea3d"&&(W[P.itab-1]={ref:nt(P.rgce[0][0][1][2])});break;case 22:U.ExternCount=P;break;case 23:z.length==0&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(P),z.XTI=z.XTI.concat(P);break;case 2196:if(U.biff<8)break;V!=null&&(V.Comment=P[1]);break;case 18:n["!protect"]=P;break;case 19:P!==0&&U.WTF&&console.error("Password verifier: "+P);break;case 133:s[P.pos]=P,U.snames.push(P.name);break;case 10:{if(--be)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=nt(o),t.sheetRows&&t.sheetRows<=o.e.r){var Ce=o.e.r;o.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=nt(o),o.e.r=Ce}o.e.r++,o.e.c++}de.length>0&&(n["!merges"]=de),oe.length>0&&(n["!objects"]=oe),ge.length>0&&(n["!cols"]=ge),Z.length>0&&(n["!rows"]=Z),b.Sheets.push(S)}u===""?d=n:a[u]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(U.biff===8&&(U.biff={9:2,521:3,1033:4}[R]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[P.BIFFVer]||8),U.biffguess=P.BIFFVer==0,P.BIFFVer==0&&P.dt==4096&&(U.biff=5,le=!0,Ma(U.codepage=28591)),U.biff==8&&P.BIFFVer==0&&P.dt==16&&(U.biff=2),be++)break;if(n=t.dense?[]:{},U.biff<8&&!le&&(le=!0,Ma(U.codepage=t.codepage||1252)),U.biff<5||P.BIFFVer==0&&P.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Te={pos:e.l-X,name:u};s[Te.pos]=Te,U.snames.push(u)}else u=(s[we]||{name:""}).name;P.dt==32&&(n["!type"]="chart"),P.dt==64&&(n["!type"]="macro"),de=[],oe=[],U.arrayf=y=[],ge=[],Z=[],se=!1,S={Hidden:(s[we]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[P.r]||[])[P.c]:n[Xe({c:P.c,r:P.r})])&&++P.c,v={ixfe:P.ixfe,XF:_[P.ixfe]||{},v:P.val,t:"n"},O>0&&(v.z=J[v.ixfe>>8&63]),Ja(v,t,r.opts.Date1904),T({c:P.c,r:P.r},v,t);break;case 5:case 517:v={ixfe:P.ixfe,XF:_[P.ixfe],v:P.val,t:P.t},O>0&&(v.z=J[v.ixfe>>8&63]),Ja(v,t,r.opts.Date1904),T({c:P.c,r:P.r},v,t);break;case 638:v={ixfe:P.ixfe,XF:_[P.ixfe],v:P.rknum,t:"n"},O>0&&(v.z=J[v.ixfe>>8&63]),Ja(v,t,r.opts.Date1904),T({c:P.c,r:P.r},v,t);break;case 189:for(var fe=P.c;fe<=P.C;++fe){var ve=P.rkrec[fe-P.c][0];v={ixfe:ve,XF:_[ve],v:P.rkrec[fe-P.c][1],t:"n"},O>0&&(v.z=J[v.ixfe>>8&63]),Ja(v,t,r.opts.Date1904),T({c:fe,r:P.r},v,t)}break;case 6:case 518:case 1030:{if(P.val=="String"){l=P;break}if(v=$c(P.val,P.cell.ixfe,P.tt),v.XF=_[v.ixfe],t.cellFormula){var ze=P.formula;if(ze&&ze[0]&&ze[0][0]&&ze[0][0][0]=="PtgExp"){var Ze=ze[0][0][1][0],dt=ze[0][0][1][1],Wt=Xe({r:Ze,c:dt});g[Wt]?v.f=""+gr(P.formula,o,P.cell,z,U):v.F=((t.dense?(n[Ze]||[])[dt]:n[Wt])||{}).F}else v.f=""+gr(P.formula,o,P.cell,z,U)}O>0&&(v.z=J[v.ixfe>>8&63]),Ja(v,t,r.opts.Date1904),T(P.cell,v,t),l=P}break;case 7:case 519:if(l)l.val=P,v=$c(P,l.cell.ixfe,"s"),v.XF=_[v.ixfe],t.cellFormula&&(v.f=""+gr(l.formula,o,l.cell,z,U)),O>0&&(v.z=J[v.ixfe>>8&63]),Ja(v,t,r.opts.Date1904),T(l.cell,v,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(P);var _r=Xe(P[0].s);if(p=t.dense?(n[P[0].s.r]||[])[P[0].s.c]:n[_r],t.cellFormula&&p){if(!l||!_r||!p)break;p.f=""+gr(P[1],o,P[0],z,U),p.F=nt(P[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;g[Xe(l.cell)]=P[0],p=t.dense?(n[l.cell.r]||[])[l.cell.c]:n[Xe(l.cell)],(p||{}).f=""+gr(P[0],o,f,z,U)}}break;case 253:v=$c(c[P.isst].t,P.ixfe,"s"),c[P.isst].h&&(v.h=c[P.isst].h),v.XF=_[v.ixfe],O>0&&(v.z=J[v.ixfe>>8&63]),Ja(v,t,r.opts.Date1904),T({c:P.c,r:P.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:P.ixfe,XF:_[P.ixfe],t:"z"},O>0&&(v.z=J[v.ixfe>>8&63]),Ja(v,t,r.opts.Date1904),T({c:P.c,r:P.r},v,t));break;case 190:if(t.sheetStubs)for(var Yt=P.c;Yt<=P.C;++Yt){var Et=P.ixfe[Yt-P.c];v={ixfe:Et,XF:_[Et],t:"z"},O>0&&(v.z=J[v.ixfe>>8&63]),Ja(v,t,r.opts.Date1904),T({c:Yt,r:P.r},v,t)}break;case 214:case 516:case 4:v=$c(P.val,P.ixfe,"s"),v.XF=_[v.ixfe],O>0&&(v.z=J[v.ixfe>>8&63]),Ja(v,t,r.opts.Date1904),T({c:P.c,r:P.r},v,t);break;case 0:case 512:be===1&&(o=P);break;case 252:c=P;break;case 1054:if(U.biff==4){J[O++]=P[1];for(var sr=0;sr<O+163&&Qe[sr]!=P[1];++sr);sr>=163&&Ys(P[1],O+163)}else Ys(P[1],P[0]);break;case 30:{J[O++]=P;for(var Pe=0;Pe<O+163&&Qe[Pe]!=P;++Pe);Pe>=163&&Ys(P,O+163)}break;case 229:de=de.concat(P);break;case 93:oe[P.cmo[0]]=U.lastobj=P;break;case 438:U.lastobj.TxO=P;break;case 127:U.lastobj.ImData=P;break;case 440:for(w=P[0].s.r;w<=P[0].e.r;++w)for(m=P[0].s.c;m<=P[0].e.c;++m)p=t.dense?(n[w]||[])[m]:n[Xe({c:m,r:w})],p&&(p.l=P[1]);break;case 2048:for(w=P[0].s.r;w<=P[0].e.r;++w)for(m=P[0].s.c;m<=P[0].e.c;++m)p=t.dense?(n[w]||[])[m]:n[Xe({c:m,r:w})],p&&p.l&&(p.l.Tooltip=P[1]);break;case 28:{if(U.biff<=5&&U.biff>=2)break;p=t.dense?(n[P[0].r]||[])[P[0].c]:n[Xe(P[0])];var jt=oe[P[2]];p||(t.dense?(n[P[0].r]||(n[P[0].r]=[]),p=n[P[0].r][P[0].c]={t:"z"}):p=n[Xe(P[0])]={t:"z"},o.e.r=Math.max(o.e.r,P[0].r),o.s.r=Math.min(o.s.r,P[0].r),o.e.c=Math.max(o.e.c,P[0].c),o.s.c=Math.min(o.s.c,P[0].c)),p.c||(p.c=[]),x={a:P[1],t:jt.TxO.t},p.c.push(x)}break;case 2173:i6(_[P.ixfe],P.ext);break;case 125:{if(!U.cellStyles)break;for(;P.e>=P.s;)ge[P.e--]={width:P.w/256,level:P.level||0,hidden:!!(P.flags&1)},se||(se=!0,Cp(P.w/256)),ho(ge[P.e+1])}break;case 520:{var ot={};P.level!=null&&(Z[P.r]=ot,ot.level=P.level),P.hidden&&(Z[P.r]=ot,ot.hidden=!0),P.hpt&&(Z[P.r]=ot,ot.hpt=P.hpt,ot.hpx=Ll(P.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||ll(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[R]]=P;break;case 161:n["!margins"]||ll(n["!margins"]={}),n["!margins"].header=P.header,n["!margins"].footer=P.footer;break;case 574:P.RTL&&(b.Views[0].RTL=!0);break;case 146:F=P;break;case 2198:K=P;break;case 140:k=P;break;case 442:u?S.CodeName=P||S.name:b.WBProps.CodeName=P||"ThisWorkbook";break}}else q||console.error("Missing Info for XLS Record 0x"+R.toString(16)),e.l+=X}return r.SheetNames=ln(s).sort(function(wt,Ge){return Number(wt)-Number(Ge)}).map(function(wt){return s[wt].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&W.forEach(function(wt,Ge){r.Sheets[r.SheetNames[Ge]]["!autofilter"]=wt}),r.Strings=c,r.SSF=ur(Qe),U.enc&&(r.Encryption=U.enc),K&&(r.Themes=K),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),z.names.length>0&&(b.Names=z.names),r.Workbook=b,r}var Tg={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function BP(e,t,r){var a=at.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=dg(a,rj,Tg.DSI);for(var s in n)t[s]=n[s]}catch(u){if(r.WTF)throw u}var o=at.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=dg(o,aj,Tg.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(K2(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Dw(e,t){t||(t={}),Fp(t),o2(),t.codepage&&cp(t.codepage);var r,a;if(e.FullPaths){if(at.find(e,"/encryption"))throw new Error("File is password-protected");r=at.find(e,"!CompObj"),a=at.find(e,"/Workbook")||at.find(e,"/Book")}else{switch(t.type){case"base64":e=Ia(sa(e));break;case"binary":e=Ia(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}or(e,0),a={content:e}}var n,s;if(r&&RP(r),t.bookProps&&!t.bookSheets)n={};else{var o=rt?"buffer":"array";if(a&&a.content)n=MP(a.content,t);else if((s=at.find(e,"PerfectOffice_MAIN"))&&s.content)n=il.to_workbook(s.content,(t.type=o,t));else if((s=at.find(e,"NativeContent_MAIN"))&&s.content)n=il.to_workbook(s.content,(t.type=o,t));else throw(s=at.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&at.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=S6(e))}var l={};return e.FullPaths&&BP(e,l,t),n.Props=n.Custprops=l,t.bookFiles&&(n.cfb=e),n}var q0={0:{f:w8},1:{f:S8},2:{f:D8},3:{f:T8},4:{f:C8},5:{f:P8},6:{f:I8},7:{f:A8},8:{f:z8},9:{f:U8},10:{f:M8},11:{f:B8},12:{f:N8},13:{f:O8},14:{f:j8},15:{f:_8},16:{f:Tw},17:{f:L8},18:{f:F8},19:{f:wp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:pP},40:{},42:{},43:{f:MF},44:{f:LF},45:{f:BF},46:{f:zF},47:{f:UF},48:{},49:{f:$3},50:{},51:{f:l6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:lw},62:{f:R8},63:{f:h6},64:{f:K8},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Nr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Q8},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:E8},148:{f:k8,p:16},151:{f:V8},152:{},153:{f:fP},154:{},155:{},156:{f:dP},157:{},158:{},159:{T:1,f:aF},160:{T:-1},161:{T:1,f:pi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:$8},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:o6},336:{T:-1},337:{f:c6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:zf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ow},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:W8},427:{f:G8},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:q8},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:b8},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:H8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:zf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:k6},633:{T:1},634:{T:-1},635:{T:1,f:w6},636:{T:-1},637:{f:V3},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:rP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Y8},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Gf={6:{f:pd},10:{f:Bn},12:{f:$t},13:{f:$t},14:{f:Rt},15:{f:Rt},16:{f:wr},17:{f:Rt},18:{f:Rt},19:{f:$t},20:{f:xg},21:{f:xg},23:{f:ow},24:{f:gg},25:{f:Rt},26:{},27:{},28:{f:vA},29:{},34:{f:Rt},35:{f:mg},38:{f:wr},39:{f:wr},40:{f:wr},41:{f:wr},42:{f:Rt},43:{f:Rt},47:{f:bF},49:{f:Zj},51:{f:$t},60:{},61:{f:Kj},64:{f:Rt},65:{f:Jj},66:{f:$t},77:{},80:{},81:{},82:{},85:{f:$t},89:{},90:{},91:{},92:{f:$j},93:{f:wA},94:{},95:{f:Rt},96:{},97:{},99:{f:Rt},125:{f:lw},128:{f:cA},129:{f:Hj},130:{f:$t},131:{f:Rt},132:{f:Rt},133:{f:Vj},134:{},140:{f:CA},141:{f:$t},144:{},146:{f:TA},151:{},152:{},153:{},154:{},155:{},156:{f:$t},157:{},158:{},160:{f:DA},161:{f:AA},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:sA},190:{f:iA},193:{f:Bn},197:{},198:{},199:{},200:{},201:{},202:{f:Rt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:$t},220:{},221:{f:Rt},222:{},224:{f:lA},225:{f:zj},226:{f:Bn},227:{},229:{f:yA},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Wj},253:{f:eA},255:{f:Gj},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:tw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Rt},353:{f:Bn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:dA},431:{f:Rt},432:{},433:{},434:{},437:{},438:{f:EA},439:{f:Rt},440:{f:SA},441:{},442:{f:cc},443:{},444:{f:$t},445:{},446:{},448:{f:Bn},449:{f:Qj,r:2},450:{f:Bn},512:{f:hg},513:{f:PA},515:{f:uA},516:{f:tA},517:{f:pg},519:{f:OA},520:{f:Xj},523:{},545:{f:vg},549:{f:fg},566:{},574:{f:Yj},638:{f:nA},659:{},1048:{},1054:{f:rA},1084:{},1212:{f:xA},2048:{f:NA},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Bc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Bn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:jA,r:12},2173:{f:s6,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Rt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:pA,r:12},2197:{},2198:{f:ZF,r:12},2199:{},2200:{},2201:{},2202:{f:mA,r:12},2203:{f:Bn},2204:{},2205:{},2206:{},2207:{},2211:{f:qj},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:$t},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:FA},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_A},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:hg},1:{},2:{f:MA},3:{f:LA},4:{f:IA},5:{f:pg},7:{f:BA},8:{},9:{f:Bc},11:{},22:{f:$t},30:{f:aA},31:{},32:{},33:{f:vg},36:{},37:{f:fg},50:{f:UA},62:{},52:{},67:{},68:{f:$t},69:{},86:{},126:{},127:{f:RA},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:zA},223:{},234:{},354:{},421:{},518:{f:pd},521:{f:Bc},536:{f:gg},547:{f:mg},561:{},579:{},1030:{f:pd},1033:{f:Bc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Aa(e,t,r,a){var n=t;if(!isNaN(n)){var s=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,s),s>0&&$2(r)&&e.push(r)}}function jg(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=n.index,l=s&&s.index||e.length,c=d3(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(o=0;o<c.length;++o){var m=c[o].trim(),w=m.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(w!="<td"&&w!="<th")){var g=m.split(/<\/t[dh]>/i);for(l=0;l<g.length;++l){var y=g[l].trim();if(y.match(/<t[dh]/i)){for(var v=y,k=0;v.charAt(0)=="<"&&(k=v.indexOf(">"))>-1;)v=v.slice(k+1);for(var _=0;_<x.length;++_){var F=x[_];F.s.c==d&&F.s.r<u&&u<=F.e.r&&(d=F.e.c+1,_=-1)}var b=We(y.slice(0,y.indexOf(">")));h=b.colspan?+b.colspan:1,((f=+b.rowspan)>1||h>1)&&x.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var S=b.t||b["data-t"]||"";if(!v.length){d+=h;continue}if(v=j2(v),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!v.length){d+=h;continue}var C={t:"s",v};r.raw||!v.trim().length||S=="s"||(v==="TRUE"?C={t:"b",v:!0}:v==="FALSE"?C={t:"b",v:!1}:isNaN(Ha(v))?isNaN(fo(v).getDate())||(C={t:"d",v:nr(v)},r.cellDates||(C={t:"n",v:Lr(C.v)}),C.z=r.dateNF||Qe[14]):C={t:"n",v:Ha(v)}),r.dense?(a[u]||(a[u]=[]),a[u][d]=C):a[Xe({r:u,c:d})]=C,d+=h}}}}return a["!ref"]=nt(p),x.length&&(a["!merges"]=x),a}function UP(e,t,r,a){for(var n=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<n.length;++u)if(!(n[u].s.r>r||n[u].s.c>o)&&!(n[u].e.r<r||n[u].e.c<o)){if(n[u].s.r<r||n[u].s.c<o){l=-1;break}l=n[u].e.r-n[u].s.r+1,c=n[u].e.c-n[u].s.c+1;break}if(!(l<0)){var d=Xe({r,c:o}),f=a.dense?(e[r]||[])[o]:e[d],h=f&&f.v!=null&&(f.h||xp(f.w||(On(f),f.w)||""))||"",p={};l>1&&(p.rowspan=l),c>1&&(p.colspan=c),a.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(a.id||"sjs")+"-"+d,s.push(C3("td",h,p))}}var x="<tr>";return x+s.join("")+"</tr>"}var zP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$P="</body></html>";function HP(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ts(jg(r[0],t),t);var a=Dp();return r.forEach(function(n,s){Op(a,jg(n,t),"Sheet"+(s+1))}),a}function VP(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function WP(e,t){var r=t||{},a=r.header!=null?r.header:zP,n=r.footer!=null?r.footer:$P,s=[a],o=Eo(e["!ref"]);r.dense=Array.isArray(e),s.push(VP(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(UP(e,o,l,r));return s.push("</table>"+n),s.join("")}function Ow(e,t,r){var a=r||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var o=typeof a.origin=="string"?Or(a.origin):a.origin;n=o.r,s=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var d=Eo(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),n==-1&&(u.e.r=n=d.e.r+1)}var f=[],h=0,p=e["!rows"]||(e["!rows"]=[]),x=0,m=0,w=0,g=0,y=0,v=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&m<c;++x){var k=l[x];if(Ag(k)){if(a.display)continue;p[m]={hidden:!0}}var _=k.children;for(w=g=0;w<_.length;++w){var F=_[w];if(!(a.display&&Ag(F))){var b=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):j2(F.innerHTML),S=F.getAttribute("data-z")||F.getAttribute("z");for(h=0;h<f.length;++h){var C=f[h];C.s.c==g+s&&C.s.r<m+n&&m+n<=C.e.r&&(g=C.e.c+1-s,h=-1)}v=+F.getAttribute("colspan")||1,((y=+F.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:m+n,c:g+s},e:{r:m+n+(y||1)-1,c:g+s+(v||1)-1}});var B={t:"s",v:b},T=F.getAttribute("data-t")||F.getAttribute("t")||"";b!=null&&(b.length==0?B.t=T||"z":a.raw||b.trim().length==0||T=="s"||(b==="TRUE"?B={t:"b",v:!0}:b==="FALSE"?B={t:"b",v:!1}:isNaN(Ha(b))?isNaN(fo(b).getDate())||(B={t:"d",v:nr(b)},a.cellDates||(B={t:"n",v:Lr(B.v)}),B.z=a.dateNF||Qe[14]):B={t:"n",v:Ha(b)})),B.z===void 0&&S!=null&&(B.z=S);var U="",K=F.getElementsByTagName("A");if(K&&K.length)for(var de=0;de<K.length&&!(K[de].hasAttribute("href")&&(U=K[de].getAttribute("href"),U.charAt(0)!="#"));++de);U&&U.charAt(0)!="#"&&(B.l={Target:U}),a.dense?(e[m+n]||(e[m+n]=[]),e[m+n][g+s]=B):e[Xe({c:g+s,r:m+n})]=B,u.e.c<g+s&&(u.e.c=g+s),g+=v}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,m-1+n),e["!ref"]=nt(u),m>=c&&(e["!fullref"]=nt((u.e.r=l.length-x+m-1+n,u))),e}function Rw(e,t){var r=t||{},a=r.dense?[]:{};return Ow(a,e,t)}function GP(e,t){return Ts(Rw(e,t),t)}function Ag(e){var t="",r=XP(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function XP(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function qP(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=it(t.replace(/<[^>]*>/g,""));return[r]}var Fg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Iw(e,t){var r=t||{},a=mp(e),n=[],s,o,l={name:""},c="",u=0,d,f,h={},p=[],x=r.dense?[]:{},m,w,g={value:""},y="",v=0,k=[],_=-1,F=-1,b={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,C={},B=[],T={},U=0,K=0,de=[],oe=1,ge=1,Z=[],se={Names:[]},z={},xe=["",""],be=[],O={},J="",W=0,V=!1,le=!1,we=0;for(Ol.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Ol.exec(a);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(b.e.c>=b.s.c&&b.e.r>=b.s.r?x["!ref"]=nt(b):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=b.e.r&&(x["!fullref"]=x["!ref"],b.e.r=r.sheetRows-1,x["!ref"]=nt(b)),B.length&&(x["!merges"]=B),de.length&&(x["!rows"]=de),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),h[d.name]=x,le=!1):m[0].charAt(m[0].length-2)!=="/"&&(d=We(m[0],!1),_=F=-1,b.s.r=b.s.c=1e7,b.e.r=b.e.c=0,x=r.dense?[]:{},B=[],de=[],le=!0);break;case"table-row-group":m[1]==="/"?--S:++S;break;case"table-row":case"":if(m[1]==="/"){_+=oe,oe=1;break}if(f=We(m[0],!1),f.?_=f.-1:_==-1&&(_=0),oe=+f["number-rows-repeated"]||1,oe<10)for(we=0;we<oe;++we)S>0&&(de[_+we]={level:S});F=-1;break;case"covered-table-cell":m[1]!=="/"&&++F,r.sheetStubs&&(r.dense?(x[_]||(x[_]=[]),x[_][F]={t:"z"}):x[Xe({r:_,c:F})]={t:"z"}),y="",k=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++F,g=We(m[0],!1),ge=parseInt(g["number-columns-repeated"]||"1",10),w={t:"z",v:null},g.formula&&r.cellFormula!=!1&&(w.f=Ng(it(g.formula))),(g.||g["value-type"])=="string"&&(w.t="s",w.v=it(g["string-value"]||""),r.dense?(x[_]||(x[_]=[]),x[_][F]=w):x[Xe({r:_,c:F})]=w),F+=ge-1;else if(m[1]!=="/"){++F,y="",v=0,k=[],ge=1;var R=oe?_+oe-1:_;if(F>b.e.c&&(b.e.c=F),F<b.s.c&&(b.s.c=F),_<b.s.r&&(b.s.r=_),R>b.e.r&&(b.e.r=R),g=We(m[0],!1),be=[],O={},w={t:g.||g["value-type"],v:null},r.cellFormula)if(g.formula&&(g.formula=it(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(U=parseInt(g["number-matrix-rows-spanned"],10)||0,K=parseInt(g["number-matrix-columns-spanned"],10)||0,T={s:{r:_,c:F},e:{r:_+U-1,c:F+K-1}},w.F=nt(T),Z.push([T,w.F])),g.formula)w.f=Ng(g.formula);else for(we=0;we<Z.length;++we)_>=Z[we][0].s.r&&_<=Z[we][0].e.r&&F>=Z[we][0].s.c&&F<=Z[we][0].e.c&&(w.F=Z[we][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(U=parseInt(g["number-rows-spanned"],10)||0,K=parseInt(g["number-columns-spanned"],10)||0,T={s:{r:_,c:F},e:{r:_+U-1,c:F+K-1}},B.push(T)),g["number-columns-repeated"]&&(ge=parseInt(g["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=kt(g["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(g.value);break;case"percentage":w.t="n",w.v=parseFloat(g.value);break;case"currency":w.t="n",w.v=parseFloat(g.value);break;case"date":w.t="d",w.v=nr(g["date-value"]),r.cellDates||(w.t="n",w.v=Lr(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=l3(g["time-value"])/86400,r.cellDates&&(w.t="d",w.v=bu(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(g.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",g["string-value"]!=null&&(y=it(g["string-value"]),k=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(V=!1,w.t==="s"&&(w.v=y||"",k.length&&(w.R=k),V=v==0),z.Target&&(w.l=z),be.length>0&&(w.c=be,be=[]),y&&r.cellText!==!1&&(w.w=y),V&&(w.t="z",delete w.v),(!V||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=_))for(var X=0;X<oe;++X){if(ge=parseInt(g["number-columns-repeated"]||"1",10),r.dense)for(x[_+X]||(x[_+X]=[]),x[_+X][F]=X==0?w:ur(w);--ge>0;)x[_+X][F+ge]=ur(w);else for(x[Xe({r:_+X,c:F})]=w;--ge>0;)x[Xe({r:_+X,c:F+ge})]=ur(w);b.e.c<=F&&(b.e.c=F)}ge=parseInt(g["number-columns-repeated"]||"1",10),F+=ge-1,ge=0,w={},y="",k=[]}z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=n.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=n.pop())[0]!==m[3])throw"Bad state: "+s;O.t=y,k.length&&(O.R=k),O.a=J,be.push(O)}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!1]);J="",W=0,y="",v=0,k=[];break;case"creator":m[1]==="/"?J=a.slice(W,m.index):W=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=n.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!1]);y="",v=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(C[l.name]=c,(s=n.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(c="",l=We(m[0],!1),n.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=We(m[0],!1),c+=Fg[m[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=We(m[0],!1),c+=Fg[m[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(u,m.index);break}else u=m.index+m[0].length;break;case"named-range":o=We(m[0],!1),xe=xd(o["cell-range-address"]);var q={Name:o.name,Ref:xe[0]+"!"+xe[1]};le&&(q.Sheet=p.length),se.Names.push(q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(m[1]==="/"&&(!g||!g["string-value"])){var ce=qP(a.slice(v,m.index));y=(y.length>0?y+`
`:"")+ce[0]}else We(m[0],!1),v=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{xe=xd(We(m[0])["target-range-address"]),h[xe[0]]["!autofilter"]={ref:xe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(z=We(m[0],!1),!z.href)break;z.Target=it(z.href),delete z.href,z.Target.charAt(0)=="#"&&z.Target.indexOf(".")>-1?(xe=xd(z.Target.slice(1)),z.Target="#"+xe[0]+"!"+xe[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var P={Sheets:h,SheetNames:p,Workbook:se};return r.bookSheets&&delete P.Sheets,P}function Pg(e,t){t=t||{},ha(e,"META-INF/manifest.xml")&&uj(zt(e,"META-INF/manifest.xml"),t);var r=ta(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=Iw(gt(r),t);return ha(e,"meta.xml")&&(a.Props=Q2(zt(e,"meta.xml"))),a}function Dg(e,t){return Iw(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function jp(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Xf(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):gt(fi(e))}function qf(e){var t=e.reduce(function(n,s){return n+s.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function Og(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function QP(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function Ml(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Kt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function kr(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=Ml(e,r),s=n&7;n=Math.floor(n/8);var o=0,l;if(n==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Ml(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var u={data:l,type:s};t[n]==null?t[n]=[u]:t[n].push(u)}return t}function Ap(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function KP(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=Ml(e,a),s=kr(e.slice(a[0],a[0]+n));a[0]+=n;var o={id:Kt(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=kr(l.data),u=Kt(c[3][0].data);o.messages.push({meta:c,data:e.slice(a[0],a[0]+u)}),a[0]+=u}),(t=s[3])!=null&&t[0]&&(o.merge=Kt(s[3][0].data)>>>0>0),r.push(o)}return r}function YP(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Ml(t,r),n=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[qf(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(n.push(n[0].slice(-c)),u-=c;u>=n[n.length-1].length;)n.push(n[n.length-1]),u-=n[n.length-1].length;n.push(n[0].slice(-c,-c+u))}}var d=qf(n);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function JP(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(YP(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return qf(t)}function ZP(e,t,r,a){var n=jp(e),s=n.getUint32(4,!0),o=(a>1?12:8)+Og(s&(a>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);s&512&&(l=n.getUint32(o,!0),o+=4),o+=Og(s&(a>1?12288:4096))*4,s&16&&(c=n.getUint32(o,!0),o+=4),s&32&&(u=n.getFloat64(o,!0),o+=8),s&64&&(d.setTime(d.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function eD(e,t,r){var a=jp(e),n=a.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);n&1&&(c=QP(e,s),s+=16),n&2&&(u=a.getFloat64(s,!0),s+=8),n&4&&(d.setTime(d.getTime()+a.getFloat64(s,!0)*1e3),s+=8),n&8&&(l=a.getUint32(s,!0),s+=4),n&16&&(o=a.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return f}function tD(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return ZP(e,t,r,e[0]);case 5:return eD(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function gs(e){var t=kr(e);return Ml(t[1][0].data)}function Rg(e,t){var r=kr(t.data),a=Kt(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(o){var l=kr(o.data),c=Kt(l[1][0].data)>>>0;switch(a){case 1:s[c]=Xf(l[3][0].data);break;case 8:{var u=e[gs(l[9][0].data)][0],d=kr(u.data),f=e[gs(d[1][0].data)][0],h=Kt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=kr(f.data);s[c]=p[3].map(function(x){return Xf(x.data)}).join("")}break}}),s}function rD(e,t){var r,a,n,s,o,l,c,u,d,f,h,p,x,m,w=kr(e),g=Kt(w[1][0].data)>>>0,y=Kt(w[2][0].data)>>>0,v=((a=(r=w[8])==null?void 0:r[0])==null?void 0:a.data)&&Kt(w[8][0].data)>0||!1,k,_;if((s=(n=w[7])==null?void 0:n[0])!=null&&s.data&&t!=0)k=(l=(o=w[7])==null?void 0:o[0])==null?void 0:l.data,_=(u=(c=w[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=w[4])==null?void 0:d[0])!=null&&f.data&&t!=1)k=(p=(h=w[4])==null?void 0:h[0])==null?void 0:p.data,_=(m=(x=w[3])==null?void 0:x[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var F=v?4:1,b=jp(k),S=[],C=0;C<k.length/2;++C){var B=b.getUint16(C*2,!0);B<65535&&S.push([C,B])}if(S.length!=y)throw"Expected ".concat(y," cells, found ").concat(S.length);var T=[];for(C=0;C<S.length-1;++C)T[S[C][0]]=_.subarray(S[C][1]*F,S[C+1][1]*F);return S.length>=1&&(T[S[S.length-1][0]]=_.subarray(S[S.length-1][1]*F)),{R:g,cells:T}}function aD(e,t){var r,a=kr(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?Kt(a[7][0].data)>>>0>0?1:0:-1,s=Ap(a[5],function(o){return rD(o,n)});return{nrows:Kt(a[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function nD(e,t,r){var a,n=kr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Kt(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(Kt(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=nt(s);var o=kr(n[4][0].data),l=Rg(e,e[gs(o[4][0].data)][0]),c=(a=o[17])!=null&&a[0]?Rg(e,e[gs(o[17][0].data)][0]):[],u=kr(o[3][0].data),d=0;u[1].forEach(function(f){var h=kr(f.data),p=e[gs(h[2][0].data)][0],x=Kt(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var m=aD(e,p);m.data.forEach(function(w,g){w.forEach(function(y,v){var k=Xe({r:d+g,c:v}),_=tD(y,l,c);_&&(r[k]=_)})}),d+=m.nrows})}function sD(e,t){var r=kr(t.data),a={"!ref":"A1"},n=e[gs(r[2][0].data)],s=Kt(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return nD(e,n[0],a),a}function iD(e,t){var r,a=kr(t.data),n={name:(r=a[1])!=null&&r[0]?Xf(a[1][0].data):"",sheets:[]},s=Ap(a[2],gs);return s.forEach(function(o){e[o].forEach(function(l){var c=Kt(l.meta[1][0].data);c==6e3&&n.sheets.push(sD(e,l))})}),n}function oD(e,t){var r=Dp(),a=kr(t.data),n=Ap(a[1],gs);if(n.forEach(function(s){e[s].forEach(function(o){var l=Kt(o.meta[1][0].data);if(l==2){var c=iD(e,o);c.sheets.forEach(function(u,d){Op(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function gd(e){var t,r,a,n,s={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=JP(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=KP(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((n=(a=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&Kt(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var d=Kt(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return oD(s,l)}function lD(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Fp(e){lD([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function cD(e){return Di.WS.indexOf(e)>-1?"sheet":e==Di.CS?"chart":e==Di.DS?"dialog":e==Di.MS?"macro":e&&e.length?e:"sheet"}function uD(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,cD(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function dD(e,t,r,a,n,s,o,l,c,u,d,f){try{s[a]=nl(ta(e,r,!0),t);var h=zt(e,t),p;switch(l){case"sheet":p=gP(h,t,n,c,s[a],u,d,f);break;case"chart":if(p=vP(h,t,n,c,s[a],u,d,f),!p||!p["!drawel"])break;var x=$o(p["!drawel"].Target,t),m=$f(x),w=m6(ta(e,x,!0),nl(ta(e,m,!0),x)),g=$o(w,x),y=$f(g);p=eP(ta(e,g,!0),g,c,nl(ta(e,y,!0),g),u,p);break;case"macro":p=yP(h,t,n,c,s[a],u,d,f);break;case"dialog":p=wP(h,t,n,c,s[a],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[a]=p;var v=[];s&&s[a]&&ln(s[a]).forEach(function(k){var _="";if(s[a][k].Type==Di.CMNT){_=$o(s[a][k].Target,t);var F=SP(zt(e,_,!0),_,c);if(!F||!F.length)return;wg(p,F,!1)}s[a][k].Type==Di.TCMNT&&(_=$o(s[a][k].Target,t),v=v.concat(v6(zt(e,_,!0),c)))}),v&&v.length&&wg(p,v,!0,c.people||[])}catch(k){if(c.WTF)throw k}}function da(e){return e.charAt(0)=="/"?e.slice(1):e}function fD(e,t){if(y2(),t=t||{},Fp(t),ha(e,"META-INF/manifest.xml")||ha(e,"objectdata.xml"))return Pg(e,t);if(ha(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof gd<"u"){if(e.FileIndex)return gd(e);var r=at.utils.cfb_new();return Xm(e).forEach(function(de){h3(r,de,N2(e,de))}),gd(r)}throw new Error("Unsupported NUMBERS file")}if(!ha(e,"[Content_Types].xml"))throw ha(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ha(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Xm(e),n=lj(ta(e,"[Content_Types].xml")),s=!1,o,l;if(n.workbooks.length===0&&(l="xl/workbook.xml",zt(e,l,!0)&&n.workbooks.push(l)),n.workbooks.length===0){if(l="xl/workbook.bin",!zt(e,l,!0))throw new Error("Could not find workbook");n.workbooks.push(l),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(ol=[],n.sst)try{ol=EP(zt(e,da(n.sst)),n.sst,t)}catch(de){if(t.WTF)throw de}t.cellStyles&&n.themes.length&&(c=bP(ta(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(u=kP(zt(e,da(n.style)),n.style,c,t))}n.links.map(function(de){try{var oe=nl(ta(e,$f(da(de))),de);return CP(zt(e,da(de)),oe,de,t)}catch{}});var d=mP(zt(e,da(n.workbooks[0])),n.workbooks[0],t),f={},h="";n.coreprops.length&&(h=zt(e,da(n.coreprops[0]),!0),h&&(f=Q2(h)),n.extprops.length!==0&&(h=zt(e,da(n.extprops[0]),!0),h&&hj(h,f,t)));var p={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(h=ta(e,da(n.custprops[0]),!0),h&&(p=xj(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(oe){return oe.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=p),t.bookSheets&&typeof o<"u"&&(x.SheetNames=o),t.bookSheets?x.SheetNames:t.bookProps))return x;o={};var m={};t.bookDeps&&n.calcchain&&(m=NP(zt(e,da(n.calcchain)),n.calcchain));var w=0,g={},y,v;{var k=d.Sheets;f.Worksheets=k.length,f.SheetNames=[];for(var _=0;_!=k.length;++_)f.SheetNames[_]=k[_].name}var F=s?"bin":"xml",b=n.workbooks[0].lastIndexOf("/"),S=(n.workbooks[0].slice(0,b+1)+"_rels/"+n.workbooks[0].slice(b+1)+".rels").replace(/^\//,"");ha(e,S)||(S="xl/_rels/workbook."+F+".rels");var C=nl(ta(e,S,!0),S.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=_P(zt(e,da(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=y6(zt(e,da(n.people[0])),t)),C&&(C=uD(C,d.Sheets));var B=zt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=f.Worksheets;++w){var T="sheet";if(C&&C[w]?(y="xl/"+C[w][1].replace(/[\/]?xl\//,""),ha(e,y)||(y=C[w][1]),ha(e,y)||(y=S.replace(/_rels\/.*$/,"")+C[w][1]),T=C[w][2]):(y="xl/worksheets/sheet"+(w+1-B)+"."+F,y=y.replace(/sheet0\./,"sheet.")),v=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(f.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var U=!1,K=0;K!=t.sheets.length;++K)typeof t.sheets[K]=="number"&&t.sheets[K]==w&&(U=1),typeof t.sheets[K]=="string"&&t.sheets[K].toLowerCase()==f.SheetNames[w].toLowerCase()&&(U=1);if(!U)continue e}}dD(e,y,v,f.SheetNames[w],w,g,o,T,t,d,c,u)}return x={Directory:n,Workbook:d,Props:f,Custprops:p,Deps:m,Sheets:o,SheetNames:f.SheetNames,Strings:ol,Styles:u,Themes:c,SSF:ur(Qe)},t&&t.bookFiles&&(e.files?(x.keys=a,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(de,oe){de=de.replace(/^Root Entry[\/]/,""),x.keys.push(de),x.files[de]=e.FileIndex[oe]}))),t&&t.bookVBA&&(n.vba.length>0?x.vbaraw=zt(e,da(n.vba[0]),!0):n.defaults&&n.defaults.bin===E6&&(x.vbaraw=zt(e,"xl/vbaProject.bin",!0))),x}function hD(e,t){var r=t||{},a="Workbook",n=at.find(e,a);try{if(a="/!DataSpaces/Version",n=at.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(sF(n.content),a="/!DataSpaces/DataSpaceMap",n=at.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=oF(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=at.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=lF(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=at.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);uF(n.content)}catch{}if(a="/EncryptionInfo",n=at.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=dF(n.content);if(a="/EncryptedPackage",n=at.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],n.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function Pp(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=sa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function pD(e,t){return at.find(e,"EncryptedPackage")?hD(e,t):Dw(e,t)}function xD(e,t){var r,a=e,n=t||{};return n.type||(n.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),r=C2(a,n),fD(r,n)}function Lw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Wf(e.slice(r),t);default:break e}return Rl.to_workbook(e,t)}function mD(e,t){var r="",a=Pp(e,t);switch(t.type){case"base64":r=sa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=oi(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=gt(r)),t.type="binary",Lw(r,t)}function gD(e,t){var r=e;return t.type=="base64"&&(r=sa(r)),r=Wn.utils.decode(1200,r.slice(2),"str"),t.type="binary",Lw(r,t)}function vD(e){return e.match(/[^\x00-\x7F]/)?Ho(e):e}function vd(e,t,r,a){return a?(r.type="string",Rl.to_workbook(e,r)):Rl.to_workbook(t,r)}function Qf(e,t){o2();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Qf(new Uint8Array(e),(r=ur(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),$i={},r.dateNF&&($i.dateNF=r.dateNF),r.type||(r.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=rt?"buffer":"binary",a=i3(e),typeof Uint8Array<"u"&&!rt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,a=vD(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=ur(r),r.type="array",Qf(up(a),r)}switch((n=Pp(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return pD(at.read(a,r),r);break;case 9:if(n[1]<=8)return Dw(a,r);break;case 60:return Wf(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return GA(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return VA.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?xD(a,r):vd(e,a,r,s);case 239:return n[3]===60?Wf(a,r):vd(e,a,r,s);case 255:if(n[1]===254)return gD(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return il.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return il.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return yg.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return EF.to_workbook(a,r);break;case 10:case 13:case 32:return mD(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return $A.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?yg.to_workbook(a,r):vd(e,a,r,s)}function yD(e,t,r,a,n,s,o,l){var c=dr(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=o?e[r][p]:e[a[p]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;s[p]!=null&&(h[s[p]]=u);continue}var m=x.v;switch(x.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[p]!=null){if(m==null)if(x.t=="e"&&m===null)h[s[p]]=null;else if(u!==void 0)h[s[p]]=u;else if(d&&m===null)h[s[p]]=null;else continue;else h[s[p]]=d&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?m:On(x,m,l);m!=null&&(f=!1)}}return{row:h,isempty:f}}function Kf(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?a=1:u.header==="A"?a=2:Array.isArray(u.header)?a=3:u.header==null&&(a=0),typeof d){case"string":c=Dt(d);break;case"number":c=Dt(e["!ref"]),c.s.r=d;break;default:c=d}a>0&&(n=0);var f=dr(c.s.r),h=[],p=[],x=0,m=0,w=Array.isArray(e),g=c.s.r,y=0,v={};w&&!e[g]&&(e[g]=[]);var k=u.skipHidden&&e["!cols"]||[],_=u.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(k[y]||{}).hidden)switch(h[y]=Qt(y),r=w?e[g][y]:e[h[y]+f],a){case 1:s[y]=y-c.s.c;break;case 2:s[y]=h[y];break;case 3:s[y]=u.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=On(r,null,u),m=v[o]||0,!m)v[o]=1;else{do l=o+"_"+m++;while(v[l]);v[o]=m,v[l]=1}s[y]=l}for(g=c.s.r+n;g<=c.e.r;++g)if(!(_[g]||{}).hidden){var F=yD(e,c,g,h,a,s,w,u);(F.isempty===!1||(a===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=F.row)}return p.length=x,p}var Ig=/"/g;function wD(e,t,r,a,n,s,o,l){for(var c=!0,u=[],d="",f=dr(r),h=t.s.c;h<=t.e.c;++h)if(a[h]){var p=l.dense?(e[r]||[])[h]:e[a[h]+f];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(l.rawNumbers&&p.t=="n"?p.v:On(p,null,l));for(var x=0,m=0;x!==d.length;++x)if((m=d.charCodeAt(x))===n||m===s||m===34||l.forceQuotes){d='"'+d.replace(Ig,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(Ig,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function Mw(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=Dt(e["!ref"]),s=a.FS!==void 0?a.FS:",",o=s.charCodeAt(0),l=a.RS!==void 0?a.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],p=a.skipHidden&&e["!rows"]||[],x=n.s.c;x<=n.e.c;++x)(h[x]||{}).hidden||(f[x]=Qt(x));for(var m=0,w=n.s.r;w<=n.e.r;++w)(p[w]||{}).hidden||(d=wD(e,n,w,f,o,c,s,a),d!=null&&(a.strip&&(d=d.replace(u,"")),(d||a.blankrows!==!1)&&r.push((m++?l:"")+d)));return delete a.dense,r.join("")}function kD(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Mw(e,t);return r}function bD(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=Dt(e["!ref"]),s="",o=[],l,c=[],u=Array.isArray(e);for(l=n.s.c;l<=n.e.c;++l)o[l]=Qt(l);for(var d=n.s.r;d<=n.e.r;++d)for(s=dr(d),l=n.s.c;l<=n.e.c;++l)if(t=o[l]+s,r=u?(e[d]||[])[l]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function Bw(e,t,r){var a=r||{},n=+!a.skipHeader,s=e||{},o=0,l=0;if(s&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?Or(a.origin):a.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+n}};if(s["!ref"]){var f=Dt(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+t.length-1+n)}else o==-1&&(o=0,d.e.r=t.length-1+n);var h=a.header||[],p=0;t.forEach(function(m,w){ln(m).forEach(function(g){(p=h.indexOf(g))==-1&&(h[p=h.length]=g);var y=m[g],v="z",k="",_=Xe({c:l+p,r:o+w+n});u=Bl(s,_),y&&typeof y=="object"&&!(y instanceof Date)?s[_]=y:(typeof y=="number"?v="n":typeof y=="boolean"?v="b":typeof y=="string"?v="s":y instanceof Date?(v="d",a.cellDates||(v="n",y=Lr(y)),k=a.dateNF||Qe[14]):y===null&&a.nullError&&(v="e",y=0),u?(u.t=v,u.v=y,delete u.w,delete u.R,k&&(u.z=k)):s[_]=u={t:v,v:y},k&&(u.z=k))})}),d.e.c=Math.max(d.e.c,l+h.length-1);var x=dr(o);if(n)for(p=0;p<h.length;++p)s[Qt(p+l)+x]={t:"s",v:h[p]};return s["!ref"]=nt(d),s}function ED(e,t){return Bw(null,e,t)}function Bl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Or(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Bl(e,Xe(t)):Bl(e,Xe({r:t,c:r||0}))}function SD(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Dp(){return{SheetNames:[],Sheets:{}}}function Op(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var o=s&&s[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(lP(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function ND(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=SD(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function CD(e,t){return e.z=t,e}function Uw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function _D(e,t,r){return Uw(e,"#"+t,r)}function TD(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function jD(e,t,r,a){for(var n=typeof t!="string"?t:Dt(t),s=typeof t=="string"?t:nt(t),o=n.s.r;o<=n.e.r;++o)for(var l=n.s.c;l<=n.e.c;++l){var c=Bl(e,o,l);c.t="n",c.F=s,delete c.v,o==n.s.r&&l==n.s.c&&(c.f=r,a&&(c.D=!0))}return e}var AD={encode_col:Qt,encode_row:dr,encode_cell:Xe,encode_range:nt,decode_col:yp,decode_row:vp,split_cell:z3,decode_cell:Or,decode_range:Eo,format_cell:On,sheet_add_aoa:V2,sheet_add_json:Bw,sheet_add_dom:Ow,aoa_to_sheet:So,json_to_sheet:ED,table_to_sheet:Rw,table_to_book:GP,sheet_to_csv:Mw,sheet_to_txt:kD,sheet_to_json:Kf,sheet_to_html:WP,sheet_to_formulae:bD,sheet_to_row_object_array:Kf,sheet_get_cell:Bl,book_new:Dp,book_append_sheet:Op,book_set_sheet_visibility:ND,cell_set_number_format:CD,cell_set_hyperlink:Uw,cell_set_internal_link:_D,cell_add_comment:TD,sheet_set_array_formula:jD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function FD(){var xe,be,O,J,W,V,le,we,R,X,q,ce,P,Se,Ce,Te,fe,ve,ze,Ze,dt,Wt,_r,Yt,Et,sr,Pe,jt,ot,wt,Ge,ct,Lt,ht,Tr,Na,la,fn,Qr,Ga,Kr,Ca,pt,Mt,Xa,qa,Qa,hr,Yr,hn,pn,xn,_a,ca,mn,gn,E,I,j,A,L,M,re,ue,te,ae,ne,ye,_e,Fe,Ee,je,Ue,N,Q,ee;const{t:e}=He(),t=D.useMemo(()=>{const H=localStorage.getItem("selectedFactory");return H&&H!=="CX"?H:""},[]),[r,a]=D.useState(null),[n,s]=D.useState([]),[o,l]=D.useState([]),[c,u]=D.useState(!1),[d,f]=D.useState(!1),[h,p]=D.useState({type:"",text:""}),[x,m]=D.useState([]),w=D.useRef(null),[g,y]=D.useState("import"),[v,k]=D.useState([]),[_,F]=D.useState([]),[b,S]=D.useState(!1),[C,B]=D.useState(!1),[T,U]=D.useState({factory:t,materialCode:"",batchNumber:"",orderNumber:""}),K=H=>{const Y=H.target.files[0];Y&&(a(Y),p({type:"",text:""}),de(Y))},de=H=>{u(!0);const Y=new FileReader;Y.onload=pe=>{try{const me=Qf(pe.target.result,{type:"binary"}),ke=me.SheetNames[0],De=me.Sheets[ke],Me=AD.sheet_to_json(De,{header:1,defval:""});if(Me.length===0){p({type:"error",text:"El archivo Excel est vaco"}),u(!1);return}const Ae=Me[0].map(lt=>String(lt).trim()).filter(lt=>lt),qe=Me.slice(1).filter(lt=>lt.some(Bt=>Bt!==""));l(Ae);const Ot=qe.map((lt,Bt)=>{const ua={_rowIndex:Bt+2};return Ae.forEach((xt,vn)=>{ua[xt]=lt[vn]!==void 0?String(lt[vn]).trim():""}),ua});s(Ot),m(Ot.slice(0,10)),p({type:"success",text:`Archivo procesado: ${Ot.length} registros encontrados, ${Ae.length} columnas`})}catch(me){console.error("Error processing Excel:",me),p({type:"error",text:`Error al procesar el archivo: ${me.message}`})}finally{u(!1)}},Y.onerror=()=>{p({type:"error",text:"Error al leer el archivo"}),u(!1)},Y.readAsBinaryString(H)},oe=async()=>{if(!n||n.length===0){p({type:"error",text:"No hay datos para subir"});return}f(!0),p({type:"",text:""});try{const H=await Ye.post("/batch/import",{data:n,columns:o,filename:(r==null?void 0:r.name)||"mb51.xlsx"});p({type:"success",text:` ${H.message||`Se importaron ${H.count||n.length} registros exitosamente`}`}),g==="batches"?Z():g==="traceability"&&se(),setTimeout(()=>{a(null),s([]),m([]),l([]),w.current&&(w.current.value="")},3e3)}catch(H){console.error("Error uploading data:",H),p({type:"error",text:`Error al subir los datos: ${H.message}`})}finally{f(!1)}},ge=()=>{a(null),s([]),m([]),l([]),p({type:"",text:""}),w.current&&(w.current.value="")},Z=async()=>{S(!0);try{const H=new URLSearchParams;T.factory&&H.append("factory",T.factory),T.materialCode&&H.append("material_code",T.materialCode),T.batchNumber&&H.append("batch_number",T.batchNumber),T.orderNumber&&H.append("order_number",T.orderNumber);const Y=await Ye.get(`/batch/list?${H.toString()}`);k(Array.isArray(Y)?Y:[])}catch(H){console.error("Error loading batches:",H),p({type:"error",text:`Error al cargar lotes: ${H.message}`})}finally{S(!1)}},se=async()=>{B(!0);try{const H=new URLSearchParams;T.factory&&H.append("factory",T.factory),T.materialCode&&H.append("material_code",T.materialCode);const Y=await Ye.get(`/batch/traceability?${H.toString()}`);F(Array.isArray(Y)?Y:[])}catch(H){console.error("Error loading traceability:",H),p({type:"error",text:`Error al cargar trazabilidad: ${H.message}`})}finally{B(!1)}};D.useEffect(()=>{g==="batches"?Z():g==="traceability"&&se()},[g]),D.useEffect(()=>{g==="batches"?Z():g==="traceability"&&se()},[T.factory,T.materialCode,T.batchNumber,T.orderNumber]);const z=H=>{if(!H)return"-";try{return new Date(H).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return H}};return i.jsx("div",{className:"min-h-screen bg-gray-900 p-6",children:i.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsxs("h1",{className:"text-3xl font-bold text-white mb-2 flex items-center gap-3",children:[i.jsx(xm,{className:"w-8 h-8 text-blue-400"}),((be=(xe=e.produccion)==null?void 0:xe.lotesTrazabilidad)==null?void 0:be.title)||"Lotes y Trazabilidad"]}),i.jsx("p",{className:"text-gray-400",children:((J=(O=e.produccion)==null?void 0:O.lotesTrazabilidad)==null?void 0:J.description)||"Importa y visualiza datos de lotes y trazabilidad desde archivos Excel (MB51)"})]})}),i.jsxs("div",{className:"flex gap-2 border-b border-gray-700",children:[i.jsxs("button",{onClick:()=>y("import"),className:`px-6 py-3 font-medium transition-colors ${g==="import"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"}`,children:[i.jsx(nd,{className:"w-4 h-4 inline mr-2"}),((W=e.common)==null?void 0:W.import)||"Importar"]}),i.jsxs("button",{onClick:()=>y("batches"),className:`px-6 py-3 font-medium transition-colors ${g==="batches"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"}`,children:[i.jsx(rr,{className:"w-4 h-4 inline mr-2"}),((le=(V=e.produccion)==null?void 0:V.lotesTrazabilidad)==null?void 0:le.batches)||"Lotes"," (",v.length,")"]}),i.jsxs("button",{onClick:()=>y("traceability"),className:`px-6 py-3 font-medium transition-colors ${g==="traceability"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"}`,children:[i.jsx(R0,{className:"w-4 h-4 inline mr-2"}),((R=(we=e.produccion)==null?void 0:we.lotesTrazabilidad)==null?void 0:R.traceability)||"Trazabilidad"," (",_.length,")"]})]}),g==="import"&&i.jsx($e,{className:"p-6",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("label",{className:"flex-1",children:[i.jsx("input",{ref:w,type:"file",accept:".xlsx,.xls",onChange:K,className:"hidden"}),i.jsxs("div",{className:"flex items-center gap-3 p-4 border-2 border-dashed border-gray-600 rounded-lg hover:border-blue-500 cursor-pointer transition-colors",children:[i.jsx(nd,{className:"w-6 h-6 text-gray-400"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("span",{className:"text-white font-medium",children:r?r.name:"Seleccionar archivo Excel (.xlsx, .xls)"}),i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:r?"Click para cambiar el archivo":"Click para seleccionar un archivo"})]})]})]}),r&&i.jsxs("button",{onClick:ge,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors flex items-center gap-2",children:[i.jsx(co,{className:"w-4 h-4"}),((X=e.common)==null?void 0:X.clear)||"Limpiar"]})]}),c&&i.jsxs("div",{className:"flex items-center gap-2 text-blue-400",children:[i.jsx(ft,{className:"w-5 h-5 animate-spin"}),i.jsx("span",{children:((q=e.common)==null?void 0:q.processing)||"Procesando archivo..."})]}),h.text&&i.jsxs("div",{className:`p-4 rounded-lg flex items-center gap-2 ${h.type==="success"?"bg-green-500/10 border border-green-500/50 text-green-400":"bg-red-500/10 border border-red-500/50 text-red-400"}`,children:[h.type==="success"?i.jsx(ws,{className:"w-5 h-5"}):i.jsx(La,{className:"w-5 h-5"}),i.jsx("span",{children:h.text})]}),n.length>0&&i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:oe,disabled:d,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center gap-2",children:d?i.jsxs(i.Fragment,{children:[i.jsx(ft,{className:"w-4 h-4 animate-spin"}),((ce=e.common)==null?void 0:ce.uploading)||"Subiendo..."]}):i.jsxs(i.Fragment,{children:[i.jsx(nd,{className:"w-4 h-4"}),((P=e.common)==null?void 0:P.import)||"Importar"," ",n.length," ",((Se=e.common)==null?void 0:Se.records)||"registros"]})}),i.jsxs("div",{className:"px-4 py-2 bg-gray-800 rounded-lg text-gray-300 flex items-center gap-2",children:[i.jsx(xm,{className:"w-4 h-4"}),i.jsxs("span",{children:[n.length," ",((Ce=e.common)==null?void 0:Ce.records)||"registros","  ",o.length," ",((Te=e.common)==null?void 0:Te.columns)||"columnas"]})]})]})]})}),g==="import"&&x.length>0&&i.jsxs($e,{className:"p-6",children:[i.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[i.jsxs("h2",{className:"text-xl font-semibold text-white",children:[((fe=e.common)==null?void 0:fe.preview)||"Vista Previa"," (",x.length," ",((ve=e.common)==null?void 0:ve.of)||"de"," ",n.length," ",((ze=e.common)==null?void 0:ze.records)||"registros",")"]}),x.length<n.length&&i.jsxs("span",{className:"text-sm text-gray-400",children:[((Ze=e.common)==null?void 0:Ze.showingFirst)||"Mostrando primeras"," ",x.length," ",((dt=e.common)==null?void 0:dt.rows)||"filas"]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full border-collapse",children:[i.jsx("thead",{children:i.jsx("tr",{className:"bg-gray-800",children:o.map((H,Y)=>i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:H},Y))})}),i.jsx("tbody",{children:x.map((H,Y)=>i.jsx("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50 transition-colors",children:o.map((pe,me)=>i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:H[pe]||"-"},me))},Y))})]})})]}),g==="batches"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs($e,{className:"p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Pf,{className:"w-5 h-5 text-gray-400"}),i.jsx("h3",{className:"text-lg font-semibold text-white",children:((Wt=e.common)==null?void 0:Wt.filters)||"Filtros"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:((_r=e.common)==null?void 0:_r.factory)||"Fbrica"}),i.jsx("input",{type:"text",value:T.factory,onChange:H=>U({...T,factory:H.target.value}),placeholder:"Ej: CXC",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:((Et=(Yt=e.produccion)==null?void 0:Yt.lotesTrazabilidad)==null?void 0:Et.materialCode)||"Cdigo Material"}),i.jsx("input",{type:"text",value:T.materialCode,onChange:H=>U({...T,materialCode:H.target.value}),placeholder:((Pe=(sr=e.produccion)==null?void 0:sr.lotesTrazabilidad)==null?void 0:Pe.materialCode)||"Cdigo material",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:((ot=(jt=e.produccion)==null?void 0:jt.lotesTrazabilidad)==null?void 0:ot.batchNumber)||"Nmero de Lote"}),i.jsx("input",{type:"text",value:T.batchNumber,onChange:H=>U({...T,batchNumber:H.target.value}),placeholder:((Ge=(wt=e.produccion)==null?void 0:wt.lotesTrazabilidad)==null?void 0:Ge.batchNumber)||"Nmero de lote",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:((Lt=(ct=e.produccion)==null?void 0:ct.lotesTrazabilidad)==null?void 0:Lt.orderNumber)||"Orden de Fabricacin"}),i.jsx("input",{type:"text",value:T.orderNumber,onChange:H=>U({...T,orderNumber:H.target.value}),placeholder:((Tr=(ht=e.produccion)==null?void 0:ht.lotesTrazabilidad)==null?void 0:Tr.orderNumber)||"Orden",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500"})]})]})]}),i.jsxs($e,{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:((la=(Na=e.produccion)==null?void 0:Na.lotesTrazabilidad)==null?void 0:la.batches)||"Lotes"}),i.jsxs("button",{onClick:Z,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors flex items-center gap-2",children:[i.jsx(ft,{className:`w-4 h-4 ${b?"animate-spin":""}`}),((fn=e.common)==null?void 0:fn.refresh)||"Actualizar"]})]}),b?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx(ft,{className:"w-8 h-8 animate-spin text-blue-400"})}):v.length===0?i.jsxs("div",{className:"text-center py-12 text-gray-400",children:[i.jsx(rr,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),i.jsx("p",{children:((Qr=e.common)==null?void 0:Qr.noData)||"No hay lotes disponibles"})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-800",children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((Kr=(Ga=e.produccion)==null?void 0:Ga.lotesTrazabilidad)==null?void 0:Kr.batch)||"Lote"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((pt=(Ca=e.produccion)==null?void 0:Ca.lotesTrazabilidad)==null?void 0:pt.material)||"Material"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((Mt=e.common)==null?void 0:Mt.description)||"Descripcin"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((Xa=e.common)==null?void 0:Xa.quantity)||"Cantidad"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((qa=e.common)==null?void 0:qa.unit)||"Unidad"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((hr=(Qa=e.produccion)==null?void 0:Qa.lotesTrazabilidad)==null?void 0:hr.movementType)||"Tipo Movimiento"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((Yr=e.common)==null?void 0:Yr.factory)||"Fbrica"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((pn=(hn=e.produccion)==null?void 0:hn.lotesTrazabilidad)==null?void 0:pn.orderNumber)||"Orden Fabricacin"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((xn=e.common)==null?void 0:xn.date)||"Fecha"})]})}),i.jsx("tbody",{children:v.map(H=>{var Y,pe;return i.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50 transition-colors",children:[i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:H.BatchNumber||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300 font-mono",children:H.MaterialCode||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:H.MaterialName||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:H.Quantity||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:H.Unit||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:i.jsx("span",{className:`px-2 py-1 rounded ${(Y=H.MovementType)!=null&&Y.includes("Alta")?"bg-green-500/20 text-green-400":(pe=H.MovementType)!=null&&pe.includes("Eliminacin")?"bg-red-500/20 text-red-400":"bg-gray-700 text-gray-300"}`,children:H.MovementType||"-"})}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300 font-semibold",children:H.Factory||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300 font-mono",children:H.OrderNumber||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-400",children:z(H.DocumentDate)})]},H.ID)})})]})})]})]}),g==="traceability"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs($e,{className:"p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Pf,{className:"w-5 h-5 text-gray-400"}),i.jsx("h3",{className:"text-lg font-semibold text-white",children:((_a=e.common)==null?void 0:_a.filters)||"Filtros"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:((ca=e.common)==null?void 0:ca.factory)||"Fbrica"}),i.jsx("input",{type:"text",value:T.factory,onChange:H=>U({...T,factory:H.target.value}),placeholder:"Ej: CXC",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:((gn=(mn=e.produccion)==null?void 0:mn.lotesTrazabilidad)==null?void 0:gn.materialCode)||"Cdigo Material"}),i.jsx("input",{type:"text",value:T.materialCode,onChange:H=>U({...T,materialCode:H.target.value}),placeholder:((I=(E=e.produccion)==null?void 0:E.lotesTrazabilidad)==null?void 0:I.materialCode)||"Cdigo material",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500"})]})]})]}),i.jsxs($e,{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:((A=(j=e.produccion)==null?void 0:j.lotesTrazabilidad)==null?void 0:A.traceability)||"Trazabilidad"}),i.jsxs("button",{onClick:se,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors flex items-center gap-2",children:[i.jsx(ft,{className:`w-4 h-4 ${C?"animate-spin":""}`}),((L=e.common)==null?void 0:L.refresh)||"Actualizar"]})]}),C?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx(ft,{className:"w-8 h-8 animate-spin text-blue-400"})}):_.length===0?i.jsxs("div",{className:"text-center py-12 text-gray-400",children:[i.jsx(R0,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),i.jsx("p",{children:((M=e.common)==null?void 0:M.noData)||"No hay datos de trazabilidad disponibles"})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-800",children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((ue=(re=e.produccion)==null?void 0:re.lotesTrazabilidad)==null?void 0:ue.material)||"Material"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((te=e.common)==null?void 0:te.description)||"Descripcin"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((ae=e.common)==null?void 0:ae.quantity)||"Cantidad"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((ye=(ne=e.produccion)==null?void 0:ne.lotesTrazabilidad)==null?void 0:ye.movementType)||"Tipo Movimiento"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((_e=e.common)==null?void 0:_e.factory)||"Fbrica"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((Ee=(Fe=e.produccion)==null?void 0:Fe.lotesTrazabilidad)==null?void 0:Ee.orderNumber)||"Orden Fabricacin"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((Ue=(je=e.produccion)==null?void 0:je.lotesTrazabilidad)==null?void 0:Ue.sourceBatch)||"Lote Origen"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((Q=(N=e.produccion)==null?void 0:N.lotesTrazabilidad)==null?void 0:Q.destinationBatch)||"Lote Destino"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-300 border-b border-gray-700",children:((ee=e.common)==null?void 0:ee.date)||"Fecha"})]})}),i.jsx("tbody",{children:_.map(H=>{var Y,pe;return i.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50 transition-colors",children:[i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300 font-mono",children:H.MaterialCode||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:H.MaterialName||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:H.Quantity||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:i.jsx("span",{className:`px-2 py-1 rounded ${(Y=H.MovementType)!=null&&Y.includes("Alta")?"bg-green-500/20 text-green-400":(pe=H.MovementType)!=null&&pe.includes("Eliminacin")?"bg-red-500/20 text-red-400":"bg-gray-700 text-gray-300"}`,children:H.MovementType||"-"})}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300 font-semibold",children:H.Factory||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300 font-mono",children:H.OrderNumber||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:H.SourceBatch||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:H.DestinationBatch||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-400",children:z(H.DocumentDate)})]},H.ID)})})]})})]})]})]})})}const PD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Turnos"}),i.jsx("p",{children:"Gestin de turnos de trabajo"})]})),DD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Empleados"}),i.jsx("p",{children:"Gestin de empleados"})]})),OD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Turnos Asignados"}),i.jsx("p",{children:"Asignacin de turnos a empleados"})]})),RD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Horarios de Trabajo"}),i.jsx("p",{children:"Horarios de trabajo diarios"})]})),ID=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Asistencia"}),i.jsx("p",{children:"Control de asistencia"})]})),LD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Asignaciones"}),i.jsx("p",{children:"Asignaciones de personal"})]})),yd={async getLineas(){try{const e=await Ye.get("/api/lines");return Array.isArray(e)?e:(e==null?void 0:e.data)||[]}catch(e){return console.error("Error obteniendo lneas:",e),[]}},async getEmpleados(){try{const e=await Ye.get("/api/employees");return Array.isArray(e)?e:(e==null?void 0:e.data)||[]}catch(e){return console.error("Error obteniendo empleados:",e),[]}},async getAsignaciones(e){try{const t=await Ye.get(`/api/assignments?shift_id=${e}`);return Array.isArray(t)?t:(t==null?void 0:t.data)||[]}catch(t){return console.error("Error obteniendo asignaciones:",t),[]}},async createAsignacion(e){try{return await Ye.post("/api/assignments",e)}catch(t){throw console.error("Error creando asignacin:",t),t}},async updateAsignacion(e,t){try{return await Ye.put(`/api/assignments/${e}`,t)}catch(r){throw console.error("Error actualizando asignacin:",r),r}},async deleteAsignacion(e){try{return await Ye.delete(`/api/assignments/${e}`)}catch(t){throw console.error("Error eliminando asignacin:",t),t}}},MD=()=>{const[e,t]=D.useState([]),[r,a]=D.useState(null),[n,s]=D.useState(!0),[o,l]=D.useState(null),c=async()=>{try{s(!0),l(null);const d=[{id:1,nombre:"Da",hora_inicio:"07:00:00",hora_fin:"15:00:00",activo:!0},{id:2,nombre:"Tarde",hora_inicio:"15:00:00",hora_fin:"23:00:00",activo:!0},{id:3,nombre:"Noche",hora_inicio:"23:00:00",hora_fin:"07:00:00",activo:!0}];if(t(d),!r&&d.length>0){const f=d.find(h=>h.activo)||d[0];a(f)}}catch(d){console.error("Error cargando turnos:",d),l("Error al cargar los turnos")}finally{s(!1)}};D.useEffect(()=>{c()},[]);const u=[...e].sort((d,f)=>d.activo!==f.activo?d.activo?-1:1:d.hora_inicio.localeCompare(f.hora_inicio));return{turnos:e,turnosOrdenados:u,turnoSeleccionado:r,setTurnoSeleccionado:a,loading:n,error:o,cargarTurnos:c}},BD=()=>{const e=xu(),[t,r]=D.useState({country:null,plant:null,factory:null});return D.useEffect(()=>{if(e!=null&&e.apiUserData){const a=e.apiUserData;r({country:a.country||"Chile",plant:a.plant||"Planta Principal CXC",factory:a.factory||"CXC"})}else e!=null&&e.user&&r({country:"Chile",plant:"Planta Principal CXC",factory:"CXC"})},[e]),{tenant:t}},UD=()=>{He();const{tenant:e}=BD(),[t,r]=D.useState("Todas"),[a,n]=D.useState([]),[s,o]=D.useState([]),[l,c]=D.useState([]),[u,d]=D.useState([]),[f,h]=D.useState(!0),[p,x]=D.useState(null),{turnoSeleccionado:m,turnosOrdenados:w}=MD(),g=["Todas","Extrusin","Termoformado","Impresin","Etiquetado"],y={extrusion:"Extrusin",termoformado:"Termoformado",impresion:"Impresin",etiquetado:"Etiquetado"},v=T=>{if(!T)return null;try{if(typeof T=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(T)){const[U,K,de]=T.split("-");return new Date(Date.UTC(parseInt(U),parseInt(K)-1,parseInt(de)))}if(typeof T=="string"&&T.includes("T")){const U=T.split("T")[0];if(/^\d{4}-\d{2}-\d{2}$/.test(U)){const[K,de,oe]=U.split("-");return new Date(Date.UTC(parseInt(K),parseInt(de)-1,parseInt(oe)))}}return new Date(T)}catch(U){return console.error("Error parseando fecha:",U,T),null}},k=async()=>{h(!0),x(null);try{const T=await yd.getLineas();n(T);const U=await yd.getEmpleados();if(d(U),m){const K=await yd.getAsignaciones(m.id);o(K)}try{const K=await Ye.get("/api/OF");console.log(" rdenes de fabricacin cargadas:",K);let de=K;K&&K.data&&Array.isArray(K.data)&&(de=K.data),Array.isArray(de)?(console.log(` ${de.length} rdenes de fabricacin disponibles`),c(de)):(console.warn("Las rdenes de fabricacin no son un array:",K),c([]))}catch(K){console.warn("No se pudieron cargar las rdenes de fabricacin:",K),c([])}}catch(T){console.error("Error cargando datos:",T),x("Error al cargar los datos del dashboard")}finally{h(!1)}};D.useEffect(()=>{k()},[m,e.country,e.plant]);const _=T=>{if(!Array.isArray(s)||s.length===0)return[];try{return s.filter(K=>K&&K.linea_id===T).map(K=>{if(!K||!K.empleado_id||!Array.isArray(u))return null;const de=u.find(oe=>oe&&oe.id===K.empleado_id);return de?{nombre:`${de.primer_nombre||""} ${de.apellido_paterno||""}`.trim()||"Sin nombre",posicion:K.posicion}:null}).filter(K=>K!==null)}catch(U){return console.error("Error al obtener empleados asignados:",U),[]}},F=T=>{if(!Array.isArray(l)||l.length===0)return null;const U=new Date,K=new Date(Date.UTC(U.getUTCFullYear(),U.getUTCMonth(),U.getUTCDate()));try{const de=l.filter(se=>se?se.linea_produccion_id===T:!1);if(de.length===0)return null;const oe=de.find(se=>{if(!se.gstri||!se.getri)return!1;const z=v(se.gstri),xe=v(se.getri);if(!z||!xe||isNaN(z.getTime())||isNaN(xe.getTime()))return!1;const be=new Date(Date.UTC(z.getUTCFullYear(),z.getUTCMonth(),z.getUTCDate(),0,0,0,0)),O=new Date(Date.UTC(xe.getUTCFullYear(),xe.getUTCMonth(),xe.getUTCDate(),23,59,59,999));return K>=be&&K<=O});if(oe)return console.log(` Orden activa para lnea ${T}:`,oe.aufnr),{...oe,estado_orden:"activa"};const ge=de.find(se=>{if(!se.gstri||!se.getri||se.cant_res===0)return!1;const z=v(se.getri);if(!z||isNaN(z.getTime()))return!1;const xe=new Date(Date.UTC(z.getUTCFullYear(),z.getUTCMonth(),z.getUTCDate(),23,59,59,999));return K>xe});if(ge)return console.log(` Orden atrasada para lnea ${T}:`,ge.aufnr),{...ge,estado_orden:"atrasada"};const Z=de.filter(se=>{if(!se.gstri)return!1;const z=v(se.gstri);return!z||isNaN(z.getTime())?!1:new Date(Date.UTC(z.getUTCFullYear(),z.getUTCMonth(),z.getUTCDate(),0,0,0,0))>K}).sort((se,z)=>{const xe=v(se.gstri),be=v(z.gstri);return xe-be})[0];return Z?(console.log(` Orden futura para lnea ${T}:`,Z.aufnr),{...Z,estado_orden:"futura"}):null}catch(de){return console.error("Error al buscar orden de fabricacin:",de),null}},b=T=>{switch(T){case"operativa":return"border-green-500 bg-green-50 dark:bg-green-900/20";case"mantenimiento":return"border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20";case"indisponible":return"border-red-500 bg-red-50 dark:bg-red-900/20";default:return"border-gray-300 bg-white dark:bg-gray-800"}},S=T=>{switch(T){case"operativa":return i.jsx(ws,{className:"w-4 h-4 text-green-600"});case"mantenimiento":return i.jsx(Of,{className:"w-4 h-4 text-yellow-600"});case"indisponible":return i.jsx(La,{className:"w-4 h-4 text-red-600"});default:return i.jsx(ms,{className:"w-4 h-4 text-gray-600"})}},C=t==="Todas"?Array.isArray(a)?a:[]:Array.isArray(a)?a.filter(T=>T&&y[T.tipo]===t):[],B={total:Array.isArray(a)?a.length:0,operativas:Array.isArray(a)?a.filter(T=>T&&T.estado==="operativa").length:0,mantenimiento:Array.isArray(a)?a.filter(T=>T&&T.estado==="mantenimiento").length:0,indisponibles:Array.isArray(a)?a.filter(T=>T&&T.estado==="indisponible").length:0,conEmpleados:Array.isArray(a)?a.filter(T=>T&&_(T.id).length>0).length:0};return f?i.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Cargando dashboard..."})]})}):p?i.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx(La,{className:"w-12 h-12 text-red-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:p}),i.jsx("button",{onClick:k,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Reintentar"})]})}):i.jsxs("div",{className:"p-4 max-w-7xl mx-auto",children:[i.jsxs("header",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Asignacin de Personal"}),m&&i.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Turno: ",m.nombre," (",m.hora_inicio," - ",m.hora_fin,")"]})]}),i.jsxs("button",{onClick:k,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors",children:[i.jsx(Zr,{className:"w-4 h-4"}),"Actualizar"]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border-l-4 border-blue-600",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Lneas"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:B.total})]}),i.jsx(el,{className:"w-8 h-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border-l-4 border-green-600",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Operativas"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:B.operativas})]}),i.jsx(ws,{className:"w-8 h-8 text-green-600"})]})}),i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border-l-4 border-yellow-600",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Mantenimiento"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:B.mantenimiento})]}),i.jsx(Of,{className:"w-8 h-8 text-yellow-600"})]})}),i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border-l-4 border-red-600",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Indisponibles"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:B.indisponibles})]}),i.jsx(La,{className:"w-8 h-8 text-red-600"})]})}),i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border-l-4 border-purple-600",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Con Personal"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:B.conEmpleados})]}),i.jsx(el,{className:"w-8 h-8 text-purple-600"})]})})]}),i.jsx("div",{className:"flex gap-3 mb-6 overflow-x-auto pb-2",children:g.map(T=>i.jsxs("button",{className:`flex items-center gap-2 px-4 py-2 rounded-full shadow whitespace-nowrap transition-colors ${t===T?"bg-blue-600 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,onClick:()=>r(T),children:[i.jsx(Pf,{size:16}),T]},T))}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:C.map(T=>{const U=_(T.id),K=F(T.id),de=y[T.tipo]||T.tipo;return i.jsxs("div",{className:`shadow rounded-xl p-4 border-2 hover:shadow-lg transition-all ${b(T.estado)}`,children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white",children:T.nombre}),i.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:de})]}),S(T.estado)]}),i.jsx("div",{className:"mb-3",children:i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${T.estado==="operativa"?"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-200":T.estado==="mantenimiento"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-200"}`,children:T.estado.charAt(0).toUpperCase()+T.estado.slice(1)})}),i.jsxs("div",{className:"mb-3 min-h-[60px]",children:[i.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[i.jsx(el,{className:"w-3 h-3 text-gray-600 dark:text-gray-400"}),i.jsxs("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:["Personal (",U.length,")"]})]}),U.length>0?i.jsxs("div",{className:"space-y-1",children:[U.slice(0,2).map((oe,ge)=>i.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",children:[" ",oe.nombre]},ge)),U.length>2&&i.jsxs("div",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium",children:["+",U.length-2," ms"]})]}):i.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-500 italic",children:"Sin personal asignado"})]}),i.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[i.jsx(rr,{className:"w-3 h-3 text-gray-600 dark:text-gray-400"}),i.jsx("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"Orden de Fabricacin"})]}),K?i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsxs("div",{className:"text-xs font-semibold text-gray-900 dark:text-white",children:["OF: ",K.aufnr]}),K.estado_orden==="atrasada"&&i.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-200",children:"Atrasada"}),K.estado_orden==="futura"&&i.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-200",children:"Programada"})]}),K.maktx&&i.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",children:K.maktx}),K.wemng!==void 0&&i.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Producido: ",K.wemng.toLocaleString()," / ",K.gamng.toLocaleString()]}),K.cant_res>0&&i.jsxs("div",{className:"text-xs text-orange-600 dark:text-orange-400",children:["Pendiente: ",K.cant_res.toLocaleString()]})]}):i.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-500 italic",children:"Sin rdenes"})]})]},T.id)})}),C.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(La,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No hay lneas disponibles"}),i.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t==="Todas"?"No se encontraron lneas de produccin":`No hay lneas de ${t}`})]})]})},zD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Salidas Especiales"}),i.jsx("p",{children:"Gestin de salidas especiales"})]})),$D=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Evaluaciones"}),i.jsx("p",{children:"Evaluaciones de personal"})]})),HD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Planes de Inspeccin"}),i.jsx("p",{children:"Planes de inspeccin y ensayos (ITP)"})]})),VD=()=>{const{planId:e}=PE();return He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Autocontrol de Calidad"}),i.jsxs("p",{children:["Plan ID: ",e]}),i.jsx("p",{children:"Autocontrol de calidad por plan"})]})},WD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Registros de Autocontrol"}),i.jsx("p",{children:"Registros de autocontrol"})]})),GD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Caractersticas de Calidad"}),i.jsx("p",{children:"Caractersticas de calidad"})]})),XD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Defectos"}),i.jsx("p",{children:"Gestin de defectos"})]})),qD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Control Estadstico"}),i.jsx("p",{children:"Control estadstico de procesos"})]})),QD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Acciones Correctivas"}),i.jsx("p",{children:"Acciones correctivas"})]})),KD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Certificados"}),i.jsx("p",{children:"Gestin de certificados"})]})),YD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Datos Maestros de Procesos"}),i.jsx("p",{children:"Datos maestros de procesos"})]})),JD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Parmetros de Procesos"}),i.jsx("p",{children:"Parmetros de procesos"})]})),ZD=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"BOM y Rutas"}),i.jsx("p",{children:"BOM (Bill of Materials) y rutas"})]})),eO=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Instrucciones de Trabajo"}),i.jsx("p",{children:"Instrucciones de trabajo (WI, SOP, ITP)"})]})),tO=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Control de Proceso"}),i.jsx("p",{children:"Control de procesos"})]})),rO=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Procesos Automticos"}),i.jsx("p",{children:"Procesos automticos y sincronizaciones"})]}));function Lg({assetId:e,assetDetails:t,loading:r,onClose:a,isMobile:n=!1}){var w,g,y,v;const[s,o]=D.useState(null),[l,c]=D.useState(!1),[u,d]=D.useState(null);D.useEffect(()=>{t?(o(t),d(null)):e&&!r?f(e):e||o(null)},[e,t,r]);const f=async k=>{var _,F;try{c(!0),d(null);const b=await Ye.get(`/asset/showdetail/${k}`);o(b)}catch(b){console.error("Error loading asset details:",b),(_=b.message)!=null&&_.includes("404")?d("Activo no encontrado"):(F=b.message)!=null&&F.includes("403")?d("No tienes permisos para ver este activo"):d("Error al cargar detalles del activo")}finally{c(!1)}},h=t||s,p=r!==void 0?r:l;if(!e)return null;const x=n?"fixed inset-0 z-50 bg-gray-900":"w-full h-full min-h-0 flex",m=n?"h-full overflow-auto":"h-full flex flex-col min-h-0 w-full";return p?i.jsx("div",{className:x,children:i.jsx($e,{className:m,children:i.jsx("div",{className:"p-8 flex items-center justify-center h-full",children:i.jsx(ft,{className:"animate-spin text-blue-500",size:48})})})}):u?i.jsx("div",{className:x,children:i.jsx($e,{className:m,children:i.jsxs("div",{className:"p-8 text-center",children:[i.jsx("p",{className:"text-red-500 mb-4",children:u}),n&&i.jsx("button",{onClick:a,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded text-white",children:"Cerrar"})]})})}):h?i.jsx("div",{className:x,children:i.jsxs($e,{className:m,children:[i.jsxs("div",{className:"p-6 border-b border-gray-700 flex items-center justify-between flex-shrink-0",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[h.Product&&i.jsxs("h2",{className:"text-2xl font-bold text-white mb-2",children:[h.Product.Manufacturer,"  ",h.Product.Name]}),i.jsxs("div",{className:"space-y-1 text-sm",children:[((w=h.Product)==null?void 0:w.ProductTypeName)&&i.jsx("p",{className:"text-gray-300",children:h.Product.ProductTypeName}),((g=h.Product)==null?void 0:g.Family)&&i.jsx("p",{className:"text-gray-400",children:h.Product.Family}),i.jsxs("div",{className:"flex flex-wrap gap-4 mt-2 text-xs text-gray-500",children:[i.jsxs("span",{children:["Location: ",h.Location]}),i.jsxs("span",{children:["Code: ",h.Code]}),h.SapCode&&i.jsxs("span",{children:["SAP Code: ",h.SapCode||"No code"]}),h.TechCode&&i.jsxs("span",{children:["Technical Code: ",h.TechCode]}),h.Sn&&i.jsxs("span",{children:["S/N: ",h.Sn]})]})]})]}),n&&i.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-800 rounded transition-colors flex-shrink-0 ml-4",children:i.jsx(co,{size:20,className:"text-gray-400"})})]}),i.jsxs("div",{className:"p-6 space-y-6 overflow-auto flex-1",children:[((y=h.Product)==null?void 0:y.FeatureValues)&&h.Product.FeatureValues.length>0&&i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[i.jsx(Df,{size:20}),"Properties"]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-gray-700",children:[i.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-gray-400 uppercase",children:"Property"}),i.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-gray-400 uppercase",children:"Symbol"}),i.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-gray-400 uppercase",children:"Value"}),i.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-gray-400 uppercase",children:"Unity"})]})}),i.jsx("tbody",{children:[...h.Product.FeatureValues].sort((k,_)=>(k.VisuOrder||0)-(_.VisuOrder||0)).map((k,_)=>i.jsxs("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50 transition-colors",children:[i.jsx("td",{className:"py-2.5 px-3 text-sm text-white",children:k.Name}),i.jsx("td",{className:"py-2.5 px-3 text-sm text-gray-400 font-mono",children:k.Symbol||"-"}),i.jsx("td",{className:"py-2.5 px-3 text-sm text-blue-400 font-medium",children:k.ValueType==="number"?k.NumberValue!==0?new Intl.NumberFormat("es-ES",{maximumFractionDigits:2,minimumFractionDigits:k.NumberValue%1===0?0:2}).format(k.NumberValue):"N/A":k.StringValue||"N/A"}),i.jsx("td",{className:"py-2.5 px-3 text-sm text-gray-400",children:k.Unit||"-"})]},_))})]})})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[i.jsx(Ff,{size:20}),"Product Documents"]}),(v=h.Product)!=null&&v.Documents&&h.Product.Documents.length>0?i.jsx("div",{className:"space-y-2",children:h.Product.Documents.map((k,_)=>i.jsx("a",{href:k.URL,target:"_blank",rel:"noopener noreferrer",className:"block bg-gray-800 rounded-lg p-4 hover:bg-gray-700 transition-colors group",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-white font-medium group-hover:text-blue-400 transition-colors truncate",children:k.Nombre}),k.Descripcion&&i.jsx("div",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:k.Descripcion})]}),i.jsx(pm,{size:20,className:"text-gray-500 group-hover:text-blue-400 transition-colors flex-shrink-0 ml-2"})]})},_))}):i.jsx("div",{className:"bg-red-500/10 border border-red-500/50 rounded-lg p-4 text-red-400 text-sm",children:"No documents for this product"})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[i.jsx(Ff,{size:20}),"Asset Documents"]}),h.Documents&&h.Documents.length>0?i.jsx("div",{className:"space-y-2",children:h.Documents.map((k,_)=>i.jsx("a",{href:k.URL,target:"_blank",rel:"noopener noreferrer",className:"block bg-gray-800 rounded-lg p-4 hover:bg-gray-700 transition-colors group",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-white font-medium group-hover:text-blue-400 transition-colors truncate",children:k.Nombre}),k.Descripcion&&i.jsx("div",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:k.Descripcion})]}),i.jsx(pm,{size:20,className:"text-gray-500 group-hover:text-blue-400 transition-colors flex-shrink-0 ml-2"})]})},_))}):i.jsx("div",{className:"bg-red-500/10 border border-red-500/50 rounded-lg p-4 text-red-400 text-sm",children:"No documents for this asset"})]})]})]})}):i.jsx("div",{className:x,children:i.jsx($e,{className:m,children:i.jsxs("div",{className:"p-8 text-center text-gray-500",children:[i.jsx(Df,{size:48,className:"mx-auto mb-4 opacity-50"}),i.jsx("p",{children:"No se encontr informacin del activo"}),e&&i.jsxs("p",{className:"text-xs mt-2",children:["Asset ID: ",e]})]})})})}function aO(){var O,J,W,V,le,we;const e=_s();Cs();const{t}=He(),{permissions:r,checkFactoryAccess:a}=yo(),n=()=>{const R=localStorage.getItem("selectedFactory");return R?R==="CX"?(r&&!a("CX")&&localStorage.removeItem("selectedFactory"),null):r&&!a(R)?(localStorage.removeItem("selectedFactory"),null):R:null},[s,o]=D.useState(n()),[l,c]=D.useState({}),[u,d]=D.useState(null),[f,h]=D.useState(!0),[p,x]=D.useState(null),[m,w]=D.useState(new Set),[g,y]=D.useState(null),[v,k]=D.useState(null),[_,F]=D.useState(!1),[b,S]=D.useState(window.innerWidth<1024),[C,B]=D.useState("");D.useEffect(()=>{const R=()=>{S(window.innerWidth<1024)};return window.addEventListener("resize",R),R(),()=>window.removeEventListener("resize",R)},[]),D.useEffect(()=>{if(r){const R=localStorage.getItem("selectedFactory");if(!R){s&&o(null);return}R==="CX"?!a("CX")&&s&&(localStorage.removeItem("selectedFactory"),o(null)):a(R)?s!==R&&o(R):(localStorage.removeItem("selectedFactory"),s&&o(null))}},[r,a,s]),D.useEffect(()=>{const R=()=>{const q=localStorage.getItem("selectedFactory");if(!q){o(null);return}if(r){if(q==="CX"){if(!a("CX")){localStorage.removeItem("selectedFactory"),o(null);return}}else if(!a(q)){localStorage.removeItem("selectedFactory"),o(null);return}}const ce=q==="CX"?null:q;o(P=>ce!==P?ce:P)},X=q=>{q.key==="selectedFactory"&&R()};return window.addEventListener("storage",X),window.addEventListener("factoryChanged",R),()=>{window.removeEventListener("storage",X),window.removeEventListener("factoryChanged",R)}},[r,a]),D.useEffect(()=>{d(null),y(null),k(null),w(new Set),B(""),U()},[s]),D.useEffect(()=>{g?K(g):k(null)},[g]);const T=R=>{const X={};if(!R||!Array.isArray(R)||R.length===0)return console.warn("buildHierarchy: No assets provided or empty array"),X;console.log("Building hierarchy from",R.length,"assets"),console.log("Sample asset structure:",R[0]);const q=fe=>({id:fe.ID!==void 0?fe.ID:fe.id,parentId:fe.ParentID!==void 0?fe.ParentID:fe.ParentId!==void 0?fe.ParentId:fe.parentId!==void 0?fe.parentId:fe.parent_id,code:fe.Code!==void 0?fe.Code:fe.code,name:fe.Name!==void 0?fe.Name:fe.name,location:fe.Location!==void 0?fe.Location:fe.location,factory:fe.Factory!==void 0?fe.Factory:fe.factory,...fe}),ce=R.map(q),P=new Map;ce.forEach(fe=>{fe.id!=null&&P.set(fe.id,{...fe,children:[]})}),console.log("Asset map created with",P.size,"assets");const Se=[];ce.forEach(fe=>{fe.id!=null&&(fe.parentId==null||fe.parentId===null||fe.parentId==="")&&Se.push(fe)}),console.log("Root nodes found:",Se.length),Se.forEach(fe=>{console.log("  - Root:",fe.code,"ID:",fe.id)});const Ce=fe=>{const ve=P.get(fe.id);if(!ve)return null;const ze=ce.filter(Ze=>{const dt=Ze.parentId;return dt!=null&&dt===fe.id}).map(Ze=>Ce(Ze)).filter(Boolean);return ze.length>0&&(ve.children=ze),ve};Se.forEach(fe=>{const ve=Ce(fe);if(ve){const ze=fe.code||fe.factory||`ROOT_${fe.id}`;X[ze]=ve}});const Te=fe=>{fe.children&&fe.children.length>0&&(fe.children.sort((ve,ze)=>{const Ze=(ve.code||"").toString(),dt=(ze.code||"").toString();return Ze.localeCompare(dt,void 0,{numeric:!0,sensitivity:"base"})}),fe.children.forEach(Te))};return Object.values(X).forEach(Te),console.log(`buildHierarchy completed: ${Object.keys(X).length} root hierarchies built`),console.log("Factory keys:",Object.keys(X)),X},U=async()=>{try{h(!0),x(null);try{if(!(await fetch("/api/auth/check",{credentials:"include"})).ok){console.warn("Sesin no vlida, redirigiendo a login..."),window.location.href="/login";return}}catch(P){console.error("Error verificando autenticacin:",P),window.location.href="/login";return}const R=await Ye.get("/asset/list");let X=[];if(Array.isArray(R))X=R;else if(R&&Array.isArray(R.data))X=R.data;else if(R&&R.assets&&Array.isArray(R.assets))X=R.assets;else if(R&&typeof R=="object"){const Se=Object.keys(R).find(Ce=>Array.isArray(R[Ce]));Se&&(X=R[Se])}if(console.log("API Response:",R),console.log("Assets extracted:",X.length,"items"),console.log("First asset sample:",X[0]),X.length===0){console.warn("No assets found in response"),c({}),h(!1);return}let q=X;console.log("Total assets before filtering:",q.length);const ce=T(q);console.log("Hierarchies built:",Object.keys(ce).length,"factories"),console.log("Factory keys:",Object.keys(ce)),Object.keys(ce).length===0&&console.warn("No hierarchies built from assets. Sample asset:",q[0]),s&&ce[s]?c({[s]:ce[s]}):c(ce)}catch(R){console.error("Error loading hierarchies:",R),console.error("Error details:",{message:R.message,stack:R.stack,name:R.name}),x("Error de conexin: "+(R.message||"Desconocido"))}finally{h(!1)}},K=async R=>{if(!R){k(null);return}try{F(!0);const X=await Ye.get(`/asset/showdetail/${R}`);k(X)}catch(X){console.error("Error loading asset details:",X),k(null)}finally{F(!1)}},de=(R,X)=>{X&&X.target.closest(".detail-button")&&(X.preventDefault(),X.stopPropagation()),y(R)},oe=R=>{w(X=>{const q=new Set(X);return q.has(R)?q.delete(R):q.add(R),q})},ge=()=>{const R=new Set;Object.values(l).forEach(X=>{const q=ce=>{R.add(ce.id),ce.children&&ce.children.forEach(P=>q(P))};q(X)}),w(R)},Z=()=>{w(new Set)},se=R=>{switch(R){case 0:return"text-blue-400";case 1:return"text-green-400";case 2:return"text-yellow-400";default:return"text-gray-300"}},z=R=>{var X,q,ce;if(!R)return null;if(C){if(R.code.toLowerCase().includes(C.toLowerCase())||((X=R.location)==null?void 0:X.toLowerCase().includes(C.toLowerCase())))return{...R,children:(q=R.children)==null?void 0:q.map(z).filter(Boolean)};if(R.children&&R.children.length>0){const Se=R.children.map(z).filter(Boolean);if(Se.length>0)return{...R,children:Se}}return null}return{...R,children:(ce=R.children)==null?void 0:ce.map(z).filter(Boolean)}},xe=(R,X=0)=>{const q=R.children&&R.children.length>0,ce=m.has(R.id),P=g===R.id,Se=X*16,Ce=5;return i.jsxs("div",{children:[i.jsxs("div",{className:`flex items-center gap-1 px-1 py-0.5 hover:bg-gray-800/50 rounded cursor-pointer group transition-colors ${P?"bg-blue-500/20 border-l-2 border-blue-500":""}`,style:{paddingLeft:`${Ce+Se}px`},onClick:()=>{q&&oe(R.id),de(R.id)},children:[q?ce?i.jsx(Fl,{size:12,className:"text-gray-400 flex-shrink-0"}):i.jsx(ba,{size:12,className:"text-gray-400 flex-shrink-0"}):i.jsx("div",{className:"w-3 flex-shrink-0"}),i.jsx("span",{className:`flex-1 min-w-0 truncate text-xs transition-colors ${P?"text-blue-400 font-semibold":se(X)}`,onClick:Te=>{Te.stopPropagation(),de(R.id,Te)},children:R.code})]}),q&&ce&&i.jsx("div",{children:R.children.map(Te=>xe(Te,X+1))})]},R.id)},be=()=>{const R=Object.keys(l).sort();return i.jsx("div",{className:"space-y-0.5",children:R.map(X=>{const q=l[X],ce=z(q);return ce?xe(ce,0):null})})};return f?i.jsx("div",{className:"flex items-center justify-center h-96",children:i.jsx(ft,{className:"animate-spin text-blue-500",size:48})}):p?i.jsx("div",{className:"flex items-center justify-center h-96",children:i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-red-500 text-lg mb-4",children:p}),i.jsx("button",{onClick:()=>e("/jerarquia-activos"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded text-white",children:"Volver al Inicio"})]})}):Object.keys(l).length===0&&!f?i.jsx("div",{className:"flex items-center justify-center h-96",children:i.jsxs("div",{className:"text-center text-gray-500",children:[i.jsx("p",{className:"text-lg mb-4",children:"No hay datos disponibles"}),i.jsx("button",{onClick:()=>U(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded text-white",children:"Recargar"})]})}):i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("div",{className:"mb-4",children:[i.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[i.jsx(br,{size:32}),((J=(O=t.activos)==null?void 0:O.jerarquia)==null?void 0:J.title)||((W=t.activos)==null?void 0:W.jerarquia)||"Jerarqua de Activos"]}),i.jsx("p",{className:"text-gray-400 mt-2",children:"Explorar la estructura jerrquica de activos"})]}),i.jsxs("div",{className:"flex h-[calc(100vh-200px)] gap-4 flex-1 min-h-0 px-2",children:[i.jsxs("div",{className:`flex-shrink-0 bg-gray-900/50 rounded-lg border border-gray-800 overflow-hidden flex flex-col ${b?"w-full lg:w-72":"w-64"}`,children:[i.jsxs("div",{className:"px-3 py-2 border-b border-gray-800 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-sm font-semibold text-white flex items-center gap-1.5",children:[i.jsx(br,{size:16}),((le=(V=t.activos)==null?void 0:V.jerarquia)==null?void 0:le.title)||((we=t.activos)==null?void 0:we.jerarquia)||"Jerarqua"]}),i.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:"Selecciona un activo"})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:ge,className:"p-1 hover:bg-gray-800 rounded text-gray-400 hover:text-white transition-colors",title:"Expandir todo",children:i.jsx(Fl,{size:14})}),i.jsx("button",{onClick:Z,className:"p-1 hover:bg-gray-800 rounded text-gray-400 hover:text-white transition-colors",title:"Colapsar todo",children:i.jsx(ba,{size:14})})]})]}),i.jsx("div",{className:"px-2 py-1.5 border-b border-gray-800",children:i.jsxs("div",{className:"relative",children:[i.jsx(Py,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400",size:14}),i.jsx("input",{type:"text",placeholder:"Buscar...",value:C,onChange:R=>B(R.target.value),className:"w-full pl-7 pr-2 py-1.5 bg-gray-800 border border-gray-700 rounded text-white text-xs placeholder-gray-500 focus:outline-none focus:border-blue-500"})]})}),i.jsx("div",{className:"flex-1 overflow-y-auto py-1",children:f?i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsx(ft,{className:"animate-spin text-blue-500",size:24})}):Object.keys(l).length>0?be():i.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:"No hay datos disponibles"})})]}),!b&&i.jsx("div",{className:"flex-1 min-w-0",children:g?i.jsx(Lg,{assetId:g,assetDetails:v,loading:_,onClose:()=>{y(null)},isMobile:!1}):i.jsx($e,{className:"h-full flex items-center justify-center",children:i.jsxs("div",{className:"text-center text-gray-500",children:[i.jsx(Df,{size:48,className:"mx-auto mb-4 opacity-50"}),i.jsx("p",{className:"text-lg",children:"Selecciona un activo"}),i.jsx("p",{className:"text-sm mt-2",children:"Haz click en un elemento del rbol"})]})})}),b&&g&&i.jsx("div",{className:"fixed inset-0 z-50 bg-black/80 backdrop-blur-sm",children:i.jsx("div",{className:"h-full",children:i.jsx(Lg,{assetId:g,assetDetails:v,loading:_,onClose:()=>{y(null)},isMobile:!0})})})]})]})}const Mg=["FPC","FPL","FSP","CXM","CXF","CXE","CXD","CXC","CXB","EXT","MNT","RTP","ITC"];function nO(){_s(),He();const{permissions:e,checkFactoryAccess:t}=yo(),[r,a]=D.useState(()=>{const S=localStorage.getItem("selectedFactory");return S==="CX"?null:S||null}),[n,s]=D.useState([]),[o,l]=D.useState(!0),[c,u]=D.useState(null),[d,f]=D.useState(null),[h,p]=D.useState(null);D.useEffect(()=>{if(e&&!r){for(const S of Mg)if(t(S)){localStorage.setItem("selectedFactory",S),a(S),window.dispatchEvent(new CustomEvent("factoryChanged",{detail:{factory:S}}));return}}},[e,t]),D.useEffect(()=>{if(e&&r&&!t(r)){localStorage.removeItem("selectedFactory"),a(null);for(const C of Mg)if(t(C)){localStorage.setItem("selectedFactory",C),a(C),window.dispatchEvent(new CustomEvent("factoryChanged",{detail:{factory:C}}));return}}},[e,t,r]),D.useEffect(()=>{const S=B=>{var U;const T=((U=B==null?void 0:B.detail)==null?void 0:U.factory)||localStorage.getItem("selectedFactory");if(!T||T==="CX"){r!==null&&a(null);return}if(e&&!t(T)){localStorage.removeItem("selectedFactory"),r!==null&&a(null);return}r!==T&&a(T)},C=B=>{B.key==="selectedFactory"&&S()};return window.addEventListener("storage",C),window.addEventListener("factoryChanged",S),()=>{window.removeEventListener("storage",C),window.removeEventListener("factoryChanged",S)}},[e,t,r]),D.useEffect(()=>{if(e){const S=localStorage.getItem("selectedFactory");if(!S){r&&a(null);return}S==="CX"?!t("CX")&&r&&(localStorage.removeItem("selectedFactory"),a(null)):t(S)?r!==S&&a(S):(localStorage.removeItem("selectedFactory"),r&&a(null))}},[e,t,r]),D.useEffect(()=>{const S=setTimeout(()=>{x()},100);return()=>clearTimeout(S)},[r]),D.useEffect(()=>{const S=setInterval(()=>{w()},3e4),C=setInterval(()=>{g()},20*60*1e3);return()=>{clearInterval(S),clearInterval(C)}},[]);const x=async()=>{try{l(!0),u(null);const S=await Ye.get("/asset/list");let C=[];if(Array.isArray(S))C=S;else if(S&&Array.isArray(S.data))C=S.data;else if(S&&Array.isArray(S.assets))C=S.assets;else{s([]),u("Formato de respuesta inesperado");return}const B=Z=>({id:Z.ID!==void 0?Z.ID:Z.id,code:Z.Code!==void 0?Z.Code:Z.code,location:Z.Location!==void 0?Z.Location:Z.location,factory:Z.Factory!==void 0?Z.Factory:Z.factory,hierarchical_level:Z.HierarchicalLevel!==void 0?Z.HierarchicalLevel:Z.hierarchical_level,parentId:Z.ParentID!==void 0?Z.ParentID:Z.ParentId!==void 0?Z.ParentId:Z.parentId,sap_code:Z.sap_code||Z.SapCode||Z.sapCode,mr_products:Z.mr_products||Z.MrProducts||Z.mrProducts,...Z}),T=C.map(B),U=new Map;T.forEach(Z=>{Z.id!=null&&U.set(Z.id,Z)});const K=new Set;T.forEach(Z=>{Z.id!=null&&(Z.parentId==null||Z.parentId===null||Z.parentId==="")&&K.add(Z.id)});const de=T.filter(Z=>{if(Z.hierarchical_level&&Array.isArray(Z.hierarchical_level))return Z.hierarchical_level.length===2;if(Z.code){const se=Z.code.toUpperCase();return se.startsWith("LINE_")||se.includes("LINE")}return!!(Z.parentId!=null&&K.has(Z.parentId))}).map(Z=>{let se="";if(Z.hierarchical_level&&Array.isArray(Z.hierarchical_level)&&Z.hierarchical_level.length>0)se=Z.hierarchical_level[0];else if(Z.factory)se=Z.factory;else if(Z.parentId!=null&&K.has(Z.parentId)){const z=U.get(Z.parentId);z&&(se=z.code||"")}return{id:Z.id,line:Z.code||"",factory:se,location:Z.location||"",status:Z.status||"unknown",oee:Z.oee||0,speed:Z.speed||0,throughput:Z.throughput||0,production:Z.production||0,influx_available:Z.influx_available||!1,last_update:Z.last_update||Z.lastUpdate||null}}),oe=r||localStorage.getItem("selectedFactory");let ge=de;oe&&oe!=="CX"&&(ge=de.filter(Z=>{const se=Z.factory?Z.factory.toUpperCase().trim():"",z=oe.toUpperCase().trim();return se===z})),ge.length>0&&oe&&oe!=="CX"?await m(ge,oe,!0):s(ge),f(new Date),u(null)}catch(S){console.error("Error loading lines:",S),console.error("Error details:",{message:S.message,stack:S.stack,name:S.name}),u(`Error de conexin: ${S.message||"No se pudo conectar al servidor"}`),s([])}finally{l(!1)}},m=async(S,C,B=!1)=>{try{const T=S.map(de=>de.line).filter(de=>de);if(T.length===0){s(S);return}const U=await Ye.get(`/asset/lines/status?factory=${C}&lines=${T.join(",")}`),K=S.map(de=>{const oe=U[de.line];if(oe){const ge=B?oe.throughput||0:de.throughput||0;return{...de,status:oe.status==="operativa"?"running":oe.status==="apagada"?"stopped":"unknown",influx_available:oe.status!=="unknown",throughput:ge,last_update:oe.last_seen||de.last_update}}return{...de,status:"unknown",influx_available:!1,throughput:B?0:de.throughput||0}});s(K),B&&p(new Date)}catch(T){console.error("Error loading lines status from InfluxDB:",T),s(S)}},w=async()=>{if(n.length===0||!r)return;const S=n.filter(C=>{const B=C.factory?C.factory.toUpperCase().trim():"",T=r.toUpperCase().trim();return B===T});if(S.length!==0)try{const C=S.map(U=>U.line).filter(U=>U);if(C.length===0)return;const B=await Ye.get(`/asset/lines/status?factory=${r}&lines=${C.join(",")}`),T=S.map(U=>{const K=B[U.line];return K?{...U,status:K.status==="operativa"?"running":K.status==="apagada"?"stopped":"unknown",influx_available:K.status!=="unknown",throughput:U.throughput||0,last_update:K.last_seen||U.last_update}:U});s(T),f(new Date)}catch(C){console.error("Error loading lines status:",C)}},g=async()=>{if(n.length===0||!r)return;const S=n.filter(C=>{const B=C.factory?C.factory.toUpperCase().trim():"",T=r.toUpperCase().trim();return B===T});if(S.length!==0)try{const C=S.map(U=>U.line).filter(U=>U);if(C.length===0)return;const B=await Ye.get(`/asset/lines/status?factory=${r}&lines=${C.join(",")}`),T=S.map(U=>{const K=B[U.line];return K?{...U,throughput:K.throughput||0,last_update:K.last_seen||U.last_update}:U});s(T),p(new Date),console.log("Throughput updated at",new Date().toLocaleTimeString())}catch(C){console.error("Error loading lines throughput:",C)}},y=S=>{switch(S==null?void 0:S.toLowerCase()){case"running":case"operando":return"success";case"stopped":case"detenida":return"danger";case"maintenance":case"mantenimiento":return"warning";case"setup":case"preparacin":return"info";default:return"secondary"}},v=S=>{switch(S==null?void 0:S.toLowerCase()){case"running":case"operando":return i.jsx(td,{className:"text-green-500",size:20});case"stopped":case"detenida":return i.jsx(Rf,{className:"text-red-500",size:20});case"maintenance":case"mantenimiento":return i.jsx(ms,{className:"text-yellow-500",size:20});default:return i.jsx(td,{className:"text-gray-500",size:20})}},k=S=>{switch(S==null?void 0:S.toLowerCase()){case"running":return"Operando";case"stopped":return"Detenida";case"maintenance":return"Mantenimiento";case"setup":return"Preparacin";case"unknown":return"Sin datos";default:return S||"Desconocido"}},_=S=>({CXB:"",CXC:"",CXD:"",CXE:"",CXF:"",CXM:"",EXT:"",FSP:"",FPC:"",FPL:"",MNT:"",RTP:"",ITC:""})[S]||"";if(o&&n.length===0)return i.jsx("div",{className:"flex items-center justify-center h-96",children:i.jsx(ft,{className:"animate-spin text-blue-500",size:48})});if(c&&n.length===0)return i.jsx("div",{className:"flex items-center justify-center h-96",children:i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-red-500 text-lg mb-4",children:c}),i.jsxs("button",{onClick:x,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded text-white flex items-center gap-2 mx-auto",children:[i.jsx(Zr,{size:16}),"Reintentar"]})]})});const F=n.reduce((S,C)=>(S[C.factory]||(S[C.factory]=[]),S[C.factory].push(C),S),{}),b=Object.keys(F).sort();return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[i.jsx(br,{size:32}),r?i.jsxs(i.Fragment,{children:[_(r),"Lneas de ",r]}):"Lneas de Produccin"]}),i.jsxs("p",{className:"text-gray-400 mt-2",children:["Estado en tiempo real de ",n.length," ",n.length===1?"lnea":"lneas"," de produccin"]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[d&&i.jsxs("span",{className:"text-sm text-gray-500",children:["Actualizado: ",d.toLocaleTimeString()]}),i.jsxs("button",{onClick:x,disabled:o,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 rounded text-white flex items-center gap-2",children:[i.jsx(Zr,{size:16,className:o?"animate-spin":""}),"Actualizar"]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx($e,{children:i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-400",children:"Total Lneas"}),i.jsx("p",{className:"text-2xl font-bold text-white",children:n.length})]}),i.jsx(br,{className:"text-blue-500",size:32})]})})}),i.jsx($e,{children:i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-400",children:"Operando"}),i.jsx("p",{className:"text-2xl font-bold text-green-500",children:n.filter(S=>{var C;return((C=S.status)==null?void 0:C.toLowerCase())==="running"}).length})]}),i.jsx(td,{className:"text-green-500",size:32})]})})}),i.jsx($e,{children:i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-400",children:"Detenidas"}),i.jsx("p",{className:"text-2xl font-bold text-red-500",children:n.filter(S=>{var C;return((C=S.status)==null?void 0:C.toLowerCase())==="stopped"}).length})]}),i.jsx(Rf,{className:"text-red-500",size:32})]})})}),i.jsx($e,{children:i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-400",children:"Con Datos"}),i.jsx("p",{className:"text-2xl font-bold text-blue-500",children:n.filter(S=>S.influx_available).length})]}),i.jsx(Oy,{className:"text-blue-500",size:32})]})})})]}),r?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:n.map(S=>{var C,B;return i.jsx($e,{className:"hover:border-blue-500 transition-all",children:i.jsxs("div",{className:"p-4",children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[v(S.status),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-white",children:S.line}),i.jsx("p",{className:"text-xs text-gray-500",children:S.location})]})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx(St,{variant:y(S.status),children:k(S.status)})})]}),S.influx_available?i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-400",children:"OEE"}),i.jsxs("span",{className:`font-semibold ${S.oee>=85?"text-green-500":S.oee>=70?"text-yellow-500":"text-red-500"}`,children:[(C=S.oee)==null?void 0:C.toFixed(1),"%"]})]}),i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-400",children:"Throughput"}),i.jsxs("span",{className:"font-mono text-white",children:[typeof S.throughput=="number"&&!isNaN(S.throughput)?S.throughput.toFixed(1):typeof S.speed=="number"&&!isNaN(S.speed)?S.speed.toFixed(1):"0.0"," kg/h"]})]}),S.production>0&&i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-400",children:"Produccin"}),i.jsxs("span",{className:"font-mono text-white",children:[(B=S.production)==null?void 0:B.toFixed(0)," m"]})]}),S.last_update&&i.jsx("div",{className:"text-xs text-gray-600 mt-2 pt-2 border-t border-gray-700",children:new Date(S.last_update).toLocaleTimeString()})]}):i.jsx("div",{className:"text-center text-gray-600 py-4",children:i.jsx("p",{className:"text-xs",children:"Sin conexin InfluxDB"})})]})},S.id)})}):i.jsx(i.Fragment,{children:b.map(S=>i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h2",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[i.jsx("span",{children:_(S)}),i.jsx("span",{children:S}),i.jsxs("span",{className:"text-sm text-gray-500",children:["(",F[S].length," ",F[S].length===1?"lnea":"lneas",")"]})]}),e&&t("CX")&&i.jsxs("button",{onClick:()=>{localStorage.setItem("selectedFactory",S),window.dispatchEvent(new CustomEvent("factoryChanged",{detail:{factory:S}})),x()},className:"px-4 py-2 text-sm bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors flex items-center gap-2",children:["Ver todas las lneas de ",S,i.jsx(ba,{size:16})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:F[S].map(C=>{var B,T;return i.jsx($e,{className:"hover:border-blue-500 transition-all",children:i.jsxs("div",{className:"p-4",children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[v(C.status),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-white",children:C.line}),i.jsx("p",{className:"text-xs text-gray-500",children:C.location})]})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx(St,{variant:y(C.status),children:k(C.status)})})]}),C.influx_available?i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-400",children:"OEE"}),i.jsxs("span",{className:`font-semibold ${C.oee>=85?"text-green-500":C.oee>=70?"text-yellow-500":"text-red-500"}`,children:[(B=C.oee)==null?void 0:B.toFixed(1),"%"]})]}),i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-400",children:"Throughput"}),i.jsxs("span",{className:"font-mono text-white",children:[typeof C.throughput=="number"&&!isNaN(C.throughput)?C.throughput.toFixed(1):typeof C.speed=="number"&&!isNaN(C.speed)?C.speed.toFixed(1):"0.0"," kg/h"]})]}),C.production>0&&i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-400",children:"Produccin"}),i.jsxs("span",{className:"font-mono text-white",children:[(T=C.production)==null?void 0:T.toFixed(0)," m"]})]}),C.last_update&&i.jsx("div",{className:"text-xs text-gray-600 mt-2 pt-2 border-t border-gray-700",children:new Date(C.last_update).toLocaleTimeString()})]}):i.jsx("div",{className:"text-center text-gray-600 py-4",children:i.jsx("p",{className:"text-xs",children:"Sin conexin InfluxDB"})})]})},C.id)})})]},S))}),n.length===0&&!o&&i.jsx($e,{children:i.jsxs("div",{className:"p-12 text-center text-gray-500",children:[i.jsx(br,{size:48,className:"mx-auto mb-4 opacity-50"}),i.jsx("p",{children:"No se encontraron lneas de produccin"})]})})]})}const sO=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Riesgos"}),i.jsx("p",{children:"Gestin de riesgos"})]})),iO=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Inspecciones de Seguridad"}),i.jsx("p",{children:"Inspecciones de seguridad"})]})),oO=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Accidentes"}),i.jsx("p",{children:"Registro de accidentes"})]})),lO=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Capacitaciones"}),i.jsx("p",{children:"Gestin de capacitaciones"})]})),cO=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"EPP"}),i.jsx("p",{children:"Equipos de proteccin personal"})]})),uO=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Salud Ocupacional"}),i.jsx("p",{children:"Salud ocupacional"})]})),dO=()=>{var s,o,l,c,u,d;const{t:e}=He(),[t,r]=D.useState({nombre:"",nit:"",direccion:"",telefono:"",email:"",sitioWeb:""}),a=f=>{const{name:h,value:p}=f.target;r(x=>({...x,[h]:p}))},n=f=>{f.preventDefault(),console.log("Guardar configuracin de empresa:",t)};return i.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:((o=(s=e.configuracion)==null?void 0:s.empresa)==null?void 0:o.title)||"Configuracin de Empresa"}),i.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:((c=(l=e.configuracion)==null?void 0:l.empresa)==null?void 0:c.description)||"Configuracin general de la empresa"})]}),i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6",children:i.jsxs("form",{onSubmit:n,className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre de la Empresa"}),i.jsx("input",{type:"text",name:"nombre",value:t.nombre,onChange:a,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",placeholder:"Nombre de la empresa"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"NIT / Nmero de Identificacin"}),i.jsx("input",{type:"text",name:"nit",value:t.nit,onChange:a,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",placeholder:"NIT"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Direccin"}),i.jsx("input",{type:"text",name:"direccion",value:t.direccion,onChange:a,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",placeholder:"Direccin"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Telfono"}),i.jsx("input",{type:"tel",name:"telefono",value:t.telefono,onChange:a,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",placeholder:"Telfono"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email"}),i.jsx("input",{type:"email",name:"email",value:t.email,onChange:a,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",placeholder:"email@empresa.com"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sitio Web"}),i.jsx("input",{type:"url",name:"sitioWeb",value:t.sitioWeb,onChange:a,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",placeholder:"https://www.empresa.com"})]})]}),i.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition",children:((u=e.common)==null?void 0:u.cancel)||"Cancelar"}),i.jsx("button",{type:"submit",className:"px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 transition shadow-sm hover:shadow",children:((d=e.common)==null?void 0:d.save)||"Guardar"})]})]})})]})},fO=({data:e,onNodeClick:t,selectedPath:r=null})=>{const[a,n]=D.useState(new Set(["root"])),s=u=>{const d=new Set(a);d.has(u)?d.delete(u):d.add(u),n(d)},o=u=>{const d={0:"",1:"",2:"",3:"",default:""};return i.jsx("span",{className:"text-lg",children:d[u]||d.default})},l=u=>["Fbrica","Lnea","Seccin","Subsistema","Componente"][u]||`Nivel ${u+1}`,c=(u,d=0,f="")=>{const h=f?`${f}.${u.key}`:u.key,p=a.has(h),x=u.children&&Object.keys(u.children).length>0,m=r===h;return i.jsxs("div",{className:"select-none",children:[i.jsxs("div",{className:`
            flex items-center gap-2 px-3 py-2 rounded-md cursor-pointer transition
            ${m?"bg-blue-100 dark:bg-blue-900 text-blue-900 dark:text-blue-100":"hover:bg-gray-100 dark:hover:bg-gray-700"}
          `,style:{paddingLeft:`${d*20+8}px`},onClick:()=>{x&&s(h),t&&t(h,u)},children:[x?i.jsx("span",{className:"text-gray-500 text-sm",children:p?"":""}):i.jsx("div",{className:"w-4"}),o(d),i.jsx("span",{className:"flex-1 font-medium text-sm text-gray-900 dark:text-white",children:u.label}),i.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:l(d)}),u.count!==void 0&&i.jsx("span",{className:"text-xs bg-gray-200 dark:bg-gray-700 px-2 py-1 rounded-full text-gray-700 dark:text-gray-300",children:u.count})]}),x&&p&&i.jsx("div",{className:"ml-4 border-l border-gray-200 dark:border-gray-700",children:Object.entries(u.children).map(([w,g])=>c(g,d+1,h))})]},h)};return!e||Object.keys(e).length===0?i.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[i.jsx("span",{className:"text-5xl mb-4 opacity-50 block",children:""}),i.jsx("p",{children:"No hay datos jerrquicos disponibles"})]}):i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-auto",children:i.jsx("div",{className:"p-4",children:Object.entries(e).map(([u,d])=>c(d,0))})})},hO=e=>{const t={};return e.forEach(r=>{if(!r.hierarchical_level||r.hierarchical_level.length===0)return;let a=t;const n=r.hierarchical_level;n.forEach((s,o)=>{a[s]||(a[s]={key:s,label:s,level:o,path:n.slice(0,o+1),count:0,children:{},assets:[]}),a[s].count+=1,o===n.length-1&&a[s].assets.push(r),a=a[s].children})}),t},pO=()=>{var v,k,_,F;const{t:e}=He(),[t,r]=D.useState(!1),[a,n]=D.useState([]),[s,o]=D.useState({}),[l,c]=D.useState(null),[u,d]=D.useState(null),[f,h]=D.useState(""),[p,x]=D.useState(null);D.useState(!1),D.useState({nombre:"",codigo:"",direccion:"",ciudad:"",pais:"",activa:!0}),D.useEffect(()=>{m()},[]);const m=async()=>{r(!0);try{const b=[{id:1,hierarchical_level:["CXC"]},{id:2,hierarchical_level:["CXC","Line_08"]},{id:3,hierarchical_level:["CXC","Line_08","1_Transport"]},{id:4,hierarchical_level:["CXC","Line_08","1_Transport","TG1"]},{id:5,hierarchical_level:["CXB"]},{id:6,hierarchical_level:["CXB","Line_01"]},{id:7,hierarchical_level:["CXM"]},{id:8,hierarchical_level:["CXM","Line_01"]}];n(b);const S=hO(b);o(S)}catch(b){console.error("Error loading hierarchical data:",b)}finally{r(!1)}},w=D.useMemo(()=>{if(!f&&!p)return s;const b=(C,B,T)=>{if(!C)return null;const U=!B||C.label.toLowerCase().includes(B.toLowerCase())||C.path.some(oe=>oe.toLowerCase().includes(B.toLowerCase())),K=!T||C.path[0]===T;if(!U&&!K){const oe={};return Object.entries(C.children||{}).forEach(([ge,Z])=>{const se=b(Z,B,T);se&&(oe[ge]=se)}),Object.keys(oe).length>0?{...C,children:oe}:null}const de={};return Object.entries(C.children||{}).forEach(([oe,ge])=>{const Z=b(ge,B,T);Z&&(de[oe]=Z)}),{...C,children:de}},S={};return Object.entries(s).forEach(([C,B])=>{const T=b(B,f,p);T&&(S[C]=T)}),S},[s,f,p]),g=D.useMemo(()=>{const b=new Set;return a.forEach(S=>{S.hierarchical_level&&S.hierarchical_level.length>0&&b.add(S.hierarchical_level[0])}),Array.from(b).sort()},[a]),y=(b,S)=>{c(b),d(S)};return i.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:((k=(v=e.configuracion)==null?void 0:v.plantas)==null?void 0:k.title)||"Configuracin de Plantas"}),i.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:((F=(_=e.configuracion)==null?void 0:_.plantas)==null?void 0:F.description)||"Estructura jerrquica de fbricas basada en activos"})]}),i.jsxs("button",{onClick:m,disabled:t,className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 transition shadow-sm hover:shadow disabled:opacity-50",children:[i.jsx("span",{className:t?"animate-spin":"",children:""}),"Actualizar"]})]}),i.jsxs("div",{className:"flex gap-4 items-center mb-4",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:""}),i.jsx("input",{type:"text",placeholder:"Buscar en la jerarqua...",value:f,onChange:b=>h(b.target.value),className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500"})]}),g.length>0&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-500",children:""}),i.jsxs("select",{value:p||"",onChange:b=>x(b.target.value||null),className:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Todas las fbricas"}),g.map(b=>i.jsx("option",{value:b,children:b},b))]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"lg:col-span-2",children:i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow p-4",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[i.jsx("span",{children:""}),"Estructura Jerrquica de Activos"]}),t?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("span",{className:"text-4xl mx-auto animate-spin text-blue-600 mb-4 block",children:""}),i.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Cargando estructura jerrquica..."})]}):i.jsx(fO,{data:w,onNodeClick:y,selectedPath:l})]})}),i.jsx("div",{className:"lg:col-span-1",children:i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6 sticky top-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Detalles"}),u?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Nombre"}),i.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:u.label})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Nivel"}),i.jsx("p",{className:"text-gray-900 dark:text-white",children:u.level===0?"Fbrica":u.level===1?"Lnea":u.level===2?"Seccin":u.level===3?"Subsistema":"Componente"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Ruta Completa"}),i.jsx("p",{className:"text-gray-900 dark:text-white text-sm font-mono bg-gray-100 dark:bg-gray-700 p-2 rounded",children:u.path.join("  ")})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Cantidad de Activos"}),i.jsx("p",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:u.count||0})]}),u.assets&&u.assets.length>0&&i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:["Activos (",u.assets.length,")"]}),i.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1",children:u.assets.map((b,S)=>i.jsxs("div",{className:"p-2 bg-gray-50 dark:bg-gray-700 rounded text-sm",children:[i.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:b.code||`Activo #${b.id}`}),b.sn&&i.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-xs",children:["SN: ",b.sn]})]},S))})]})]}):i.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[i.jsx("span",{className:"text-5xl mb-4 opacity-50 block",children:""}),i.jsx("p",{className:"text-sm",children:"Selecciona un nodo para ver los detalles"})]})]})})]}),!1]})},xO=()=>{var l,c,u,d,f,h;const{t:e}=He(),[t,r]=D.useState({inicioAno:new Date().getFullYear(),inicioSemana:"lunes",diasLaborables:{lunes:!0,martes:!0,miercoles:!0,jueves:!0,viernes:!0,sabado:!1,domingo:!1},festivos:[]}),a=p=>{r(x=>({...x,diasLaborables:{...x.diasLaborables,[p]:!x.diasLaborables[p]}}))},n=p=>{p.preventDefault(),console.log("Guardar configuracin de calendario:",t)},s=["lunes","martes","miercoles","jueves","viernes","sabado","domingo"],o={lunes:"Lunes",martes:"Martes",miercoles:"Mircoles",jueves:"Jueves",viernes:"Viernes",sabado:"Sbado",domingo:"Domingo"};return i.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:((c=(l=e.configuracion)==null?void 0:l.calendario)==null?void 0:c.title)||"Configuracin de Calendario"}),i.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:((d=(u=e.configuracion)==null?void 0:u.calendario)==null?void 0:d.description)||"Configuracin de calendario y das laborables"})]}),i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6",children:i.jsxs("form",{onSubmit:n,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Ao de Inicio"}),i.jsx("input",{type:"number",value:t.inicioAno,onChange:p=>r(x=>({...x,inicioAno:parseInt(p.target.value)})),className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",min:"2020",max:"2100"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Da de Inicio de la Semana"}),i.jsxs("select",{value:t.inicioSemana,onChange:p=>r(x=>({...x,inicioSemana:p.target.value})),className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",children:[i.jsx("option",{value:"lunes",children:"Lunes"}),i.jsx("option",{value:"domingo",children:"Domingo"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-4",children:"Das Laborables"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:s.map(p=>i.jsxs("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 border-gray-200 dark:border-gray-600",children:[i.jsx("input",{type:"checkbox",checked:t.diasLaborables[p],onChange:()=>a(p),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:o[p]})]},p))})]}),i.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition",children:((f=e.common)==null?void 0:f.cancel)||"Cancelar"}),i.jsx("button",{type:"submit",className:"px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 transition shadow-sm hover:shadow",children:((h=e.common)==null?void 0:h.save)||"Guardar"})]})]})})]})},mO=()=>{var u,d,f,h,p,x,m;const{t:e}=He(),[t,r]=D.useState([]),[a,n]=D.useState(!1),[s,o]=D.useState({nombre:"",horaInicio:"",horaFin:"",descanso:!1,duracionDescanso:0,activo:!0}),l=w=>{const{name:g,value:y,type:v,checked:k}=w.target;o(_=>({..._,[g]:v==="checkbox"?k:y}))},c=w=>{w.preventDefault(),console.log("Guardar turno:",s),n(!1),o({nombre:"",horaInicio:"",horaFin:"",descanso:!1,duracionDescanso:0,activo:!0})};return i.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[i.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:((d=(u=e.configuracion)==null?void 0:u.turnos)==null?void 0:d.title)||"Configuracin de Turnos"}),i.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:((h=(f=e.configuracion)==null?void 0:f.turnos)==null?void 0:h.description)||"Gestin de turnos de trabajo"})]}),i.jsx("button",{onClick:()=>n(!a),className:"px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 transition shadow-sm hover:shadow",children:a?((p=e.common)==null?void 0:p.cancel)||"Cancelar":"+ Agregar Turno"})]}),a&&i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6 mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Nuevo Turno"}),i.jsxs("form",{onSubmit:c,className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre del Turno"}),i.jsx("input",{type:"text",name:"nombre",value:s.nombre,onChange:l,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Estado"}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",name:"activo",checked:s.activo,onChange:l,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Activo"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Hora de Inicio"}),i.jsx("input",{type:"time",name:"horaInicio",value:s.horaInicio,onChange:l,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Hora de Fin"}),i.jsx("input",{type:"time",name:"horaFin",value:s.horaFin,onChange:l,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",required:!0})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",name:"descanso",checked:s.descanso,onChange:l,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Incluir Descanso"})]})}),s.descanso&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Duracin del Descanso (minutos)"}),i.jsx("input",{type:"number",name:"duracionDescanso",value:s.duracionDescanso,onChange:l,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",min:"0"})]})]}),i.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[i.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition",children:((x=e.common)==null?void 0:x.cancel)||"Cancelar"}),i.jsx("button",{type:"submit",className:"px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 transition shadow-sm hover:shadow",children:((m=e.common)==null?void 0:m.save)||"Guardar"})]})]})]}),i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Turnos Registrados"}),t.length===0?i.jsx("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:i.jsx("p",{children:"No hay turnos registrados. Agrega un nuevo turno para comenzar."})}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[i.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Nombre"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Horario"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Estado"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Acciones"})]})}),i.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:i.jsx("tr",{children:i.jsx("td",{colSpan:"4",className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"No hay datos disponibles"})})})]})})]})})]})},gO=()=>{var f,h,p,x,m,w,g;const{t:e}=He(),[t,r]=D.useState([]),[a,n]=D.useState(!1),[s,o]=D.useState({nombre:"",utcOffset:"+00:00",activa:!0}),l=[{nombre:"UTC",utc:"+00:00"},{nombre:"GMT-5 (Colombia)",utc:"-05:00"},{nombre:"GMT-6 (Mxico)",utc:"-06:00"},{nombre:"GMT-3 (Argentina)",utc:"-03:00"},{nombre:"GMT-4 (Chile)",utc:"-04:00"},{nombre:"GMT-5 (Per)",utc:"-05:00"}],c=y=>{const{name:v,value:k,type:_,checked:F}=y.target;o(b=>({...b,[v]:_==="checkbox"?F:k}))},u=y=>{o(v=>({...v,nombre:y.nombre,utcOffset:y.utc}))},d=y=>{y.preventDefault(),console.log("Guardar zona horaria:",s),n(!1),o({nombre:"",utcOffset:"+00:00",activa:!0})};return i.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[i.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:((h=(f=e.configuracion)==null?void 0:f.zonasHorarias)==null?void 0:h.title)||"Configuracin de Zonas Horarias"}),i.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:((x=(p=e.configuracion)==null?void 0:p.zonasHorarias)==null?void 0:x.description)||"Gestin de zonas horarias"})]}),i.jsx("button",{onClick:()=>n(!a),className:"px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 transition shadow-sm hover:shadow",children:a?((m=e.common)==null?void 0:m.cancel)||"Cancelar":"+ Agregar Zona Horaria"})]}),a&&i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6 mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Nueva Zona Horaria"}),i.jsxs("form",{onSubmit:d,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Zonas Horarias Comunes"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-4",children:l.map(y=>i.jsxs("button",{type:"button",onClick:()=>u(y),className:`p-2 rounded-md border text-sm transition ${s.nombre===y.nombre?"border-blue-500 bg-blue-50 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[y.nombre," (",y.utc,")"]},y.utc))})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre de la Zona"}),i.jsx("input",{type:"text",name:"nombre",value:s.nombre,onChange:c,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Offset UTC"}),i.jsx("input",{type:"text",name:"utcOffset",value:s.utcOffset,onChange:c,placeholder:"+00:00 o -05:00",className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",required:!0,pattern:"[+-]\\d{2}:\\d{2}"})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",name:"activa",checked:s.activa,onChange:c,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Zona Activa"})]})})]}),i.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[i.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition",children:((w=e.common)==null?void 0:w.cancel)||"Cancelar"}),i.jsx("button",{type:"submit",className:"px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 transition shadow-sm hover:shadow",children:((g=e.common)==null?void 0:g.save)||"Guardar"})]})]})]}),i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Zonas Horarias Registradas"}),t.length===0?i.jsx("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:i.jsx("p",{children:"No hay zonas horarias registradas. Agrega una nueva zona para comenzar."})}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[i.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Nombre"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Offset UTC"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Estado"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Acciones"})]})}),i.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:i.jsx("tr",{children:i.jsx("td",{colSpan:"4",className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"No hay datos disponibles"})})})]})})]})})]})},vO=()=>{var d,f,h,p,x,m,w;const{t:e}=He(),[t,r]=D.useState([]),[a,n]=D.useState(!1),[s,o]=D.useState({nombre:"",simbolo:"",categoria:"longitud",activa:!0}),l=[{value:"longitud",label:"Longitud"},{value:"peso",label:"Peso"},{value:"volumen",label:"Volumen"},{value:"temperatura",label:"Temperatura"},{value:"tiempo",label:"Tiempo"}],c=g=>{const{name:y,value:v,type:k,checked:_}=g.target;o(F=>({...F,[y]:k==="checkbox"?_:v}))},u=g=>{g.preventDefault(),console.log("Guardar unidad:",s),n(!1),o({nombre:"",simbolo:"",categoria:"longitud",activa:!0})};return i.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[i.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:((f=(d=e.configuracion)==null?void 0:d.unidades)==null?void 0:f.title)||"Configuracin de Unidades"}),i.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:((p=(h=e.configuracion)==null?void 0:h.unidades)==null?void 0:p.description)||"Gestin de unidades de medida"})]}),i.jsx("button",{onClick:()=>n(!a),className:"px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 transition shadow-sm hover:shadow",children:a?((x=e.common)==null?void 0:x.cancel)||"Cancelar":"+ Agregar Unidad"})]}),a&&i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6 mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Nueva Unidad"}),i.jsxs("form",{onSubmit:u,className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre de la Unidad"}),i.jsx("input",{type:"text",name:"nombre",value:s.nombre,onChange:c,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",placeholder:"Ej: Metro",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Smbolo"}),i.jsx("input",{type:"text",name:"simbolo",value:s.simbolo,onChange:c,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",placeholder:"Ej: m",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Categora"}),i.jsx("select",{name:"categoria",value:s.categoria,onChange:c,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",required:!0,children:l.map(g=>i.jsx("option",{value:g.value,children:g.label},g.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Estado"}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",name:"activa",checked:s.activa,onChange:c,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Unidad Activa"})]})]})]}),i.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[i.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition",children:((m=e.common)==null?void 0:m.cancel)||"Cancelar"}),i.jsx("button",{type:"submit",className:"px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 transition shadow-sm hover:shadow",children:((w=e.common)==null?void 0:w.save)||"Guardar"})]})]})]}),i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Unidades Registradas"}),t.length===0?i.jsx("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:i.jsx("p",{children:"No hay unidades registradas. Agrega una nueva unidad para comenzar."})}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[i.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Nombre"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Smbolo"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Categora"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Estado"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Acciones"})]})}),i.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:i.jsx("tr",{children:i.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"No hay datos disponibles"})})})]})})]})})]})},yO=()=>{var f,h,p,x,m,w,g;const{t:e}=He(),[t,r]=D.useState([]),[a,n]=D.useState(!1),[s,o]=D.useState({nombre:"",codigo:"",simbolo:"",predeterminada:!1,activa:!0}),l=[{codigo:"USD",nombre:"Dlar Estadounidense",simbolo:"$"},{codigo:"EUR",nombre:"Euro",simbolo:""},{codigo:"COP",nombre:"Peso Colombiano",simbolo:"$"},{codigo:"MXN",nombre:"Peso Mexicano",simbolo:"$"},{codigo:"ARS",nombre:"Peso Argentino",simbolo:"$"},{codigo:"CLP",nombre:"Peso Chileno",simbolo:"$"}],c=y=>{const{name:v,value:k,type:_,checked:F}=y.target;o(b=>({...b,[v]:_==="checkbox"?F:k}))},u=y=>{o(v=>({...v,nombre:y.nombre,codigo:y.codigo,simbolo:y.simbolo}))},d=y=>{y.preventDefault(),console.log("Guardar moneda:",s),n(!1),o({nombre:"",codigo:"",simbolo:"",predeterminada:!1,activa:!0})};return i.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[i.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:((h=(f=e.configuracion)==null?void 0:f.monedas)==null?void 0:h.title)||"Configuracin de Monedas"}),i.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:((x=(p=e.configuracion)==null?void 0:p.monedas)==null?void 0:x.description)||"Gestin de monedas y tasas de cambio"})]}),i.jsx("button",{onClick:()=>n(!a),className:"px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 transition shadow-sm hover:shadow",children:a?((m=e.common)==null?void 0:m.cancel)||"Cancelar":"+ Agregar Moneda"})]}),a&&i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6 mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Nueva Moneda"}),i.jsxs("form",{onSubmit:d,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Monedas Comunes"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-4",children:l.map(y=>i.jsxs("button",{type:"button",onClick:()=>u(y),className:`p-2 rounded-md border text-sm transition ${s.codigo===y.codigo?"border-blue-500 bg-blue-50 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[y.codigo," - ",y.nombre]},y.codigo))})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre de la Moneda"}),i.jsx("input",{type:"text",name:"nombre",value:s.nombre,onChange:c,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Cdigo ISO"}),i.jsx("input",{type:"text",name:"codigo",value:s.codigo,onChange:c,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",placeholder:"USD, EUR, COP...",maxLength:"3",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Smbolo"}),i.jsx("input",{type:"text",name:"simbolo",value:s.simbolo,onChange:c,className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-blue-500 focus:ring-blue-500",placeholder:"$",maxLength:"3",required:!0})]}),i.jsxs("div",{className:"md:col-span-2 space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",name:"predeterminada",checked:s.predeterminada,onChange:c,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Moneda Predeterminada"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",name:"activa",checked:s.activa,onChange:c,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Moneda Activa"})]})]})]}),i.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[i.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition",children:((w=e.common)==null?void 0:w.cancel)||"Cancelar"}),i.jsx("button",{type:"submit",className:"px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 transition shadow-sm hover:shadow",children:((g=e.common)==null?void 0:g.save)||"Guardar"})]})]})]}),i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Monedas Registradas"}),t.length===0?i.jsx("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:i.jsx("p",{children:"No hay monedas registradas. Agrega una nueva moneda para comenzar."})}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[i.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Cdigo"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Nombre"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Smbolo"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Predeterminada"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Estado"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Acciones"})]})}),i.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:i.jsx("tr",{children:i.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"No hay datos disponibles"})})})]})})]})})]})},wO=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Seguridad"}),i.jsx("p",{children:"Configuracin de seguridad"})]})),kO=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Usuarios"}),i.jsx("p",{children:"Gestin de usuarios"})]})),bO=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Roles y Permisos"}),i.jsx("p",{children:"Permisos por rol"})]})),EO=()=>(He(),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("h1",{children:"Escanear QR"}),i.jsx("p",{children:"Escaneo de cdigos QR"}),i.jsx("p",{style:{fontSize:"14px",color:"#666"},children:"Esta pgina est optimizada para dispositivos mviles"})]}));function SO(){var d,f;const e=_s(),t=Cs(),r=xu(),{permissions:a}=yo(),n=D.useMemo(()=>{var h;return(h=a==null?void 0:a.organization)!=null&&h.factory_names?a.organization.factory_names:[]},[a]),[s,o]=D.useState(()=>{const h=localStorage.getItem("selectedFactory");return h&&n.includes(h)?h:n.length>0?n[0]:null});D.useEffect(()=>{if(n.length>0&&!s){const h=localStorage.getItem("selectedFactory");h&&n.includes(h)?o(h):o(n[0])}},[n,s]),D.useEffect(()=>{const h=t.pathname.split("/").filter(Boolean),p=["CXB","CXC","CXD","CXE","CXF","CXM","EXT","FPC","FPL","FSP","MNT","RTP","ITC","CX"];if(h.length>0&&p.includes(h[0].toUpperCase())){const m="/"+h.slice(1).join("/")||"/dashboard";window.history.replaceState({},"",m),e(m,{replace:!0})}},[t.pathname,e]);const l=((d=r==null?void 0:r.user)==null?void 0:d.name)||((f=r==null?void 0:r.apiUserData)==null?void 0:f.name)||"Usuario",c=h=>{o(h),localStorage.setItem("selectedFactory",h)},u=async()=>{await ep(),e("/login")};return i.jsx(AC,{onLogout:u,userName:l,factories:n,selectedFactory:s,onFactoryChange:c,factoryCode:s,navigate:e,children:i.jsx(XE,{})})}function NO(){if(typeof window<"u"&&window.location.pathname.startsWith("/auth/")){const r=`${window.location.hostname==="18.213.58.26"?"http://18.213.58.26:8081":"http://localhost:8081"}${window.location.pathname}${window.location.search}${window.location.hash}`;return window.location.replace(r),i.jsx("div",{style:{padding:"20px",textAlign:"center"},children:i.jsx("p",{children:"Redirigiendo..."})})}return i.jsx(xS,{children:i.jsx(aS,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:i.jsx("div",{className:"App",children:i.jsxs(QE,{children:[i.jsx(Be,{path:"/login",element:i.jsx(PC,{})}),i.jsx(Be,{path:"/mobile/scan",element:i.jsx(EO,{})}),i.jsxs(Be,{element:i.jsx(SO,{}),children:[i.jsx(Be,{path:"/",element:i.jsx(Cy,{to:"/dashboard",replace:!0})}),i.jsx(Be,{path:"/dashboard",element:i.jsx(Ve,{children:i.jsx(RC,{})})}),i.jsx(Be,{path:"/profile",element:i.jsx(Ve,{children:i.jsx(IC,{})})}),i.jsx(Be,{path:"/ordenes-fabricacion",element:i.jsx(Ve,{children:i.jsx(gT,{})})}),i.jsx(Be,{path:"/programacion",element:i.jsx(Ve,{children:i.jsx(vT,{})})}),i.jsx(Be,{path:"/oee-metricas",element:i.jsx(Ve,{children:i.jsx(yT,{})})}),i.jsx(Be,{path:"/materiales-consumos",element:i.jsx(Ve,{children:i.jsx(jT,{})})}),i.jsx(Be,{path:"/lotes-trazabilidad",element:i.jsx(Ve,{children:i.jsx(FD,{})})}),i.jsx(Be,{path:"/turnos",element:i.jsx(Ve,{children:i.jsx(PD,{})})}),i.jsx(Be,{path:"/empleados",element:i.jsx(Ve,{children:i.jsx(DD,{})})}),i.jsx(Be,{path:"/turnos-asignados",element:i.jsx(Ve,{children:i.jsx(OD,{})})}),i.jsx(Be,{path:"/horarios-trabajo",element:i.jsx(Ve,{children:i.jsx(RD,{})})}),i.jsx(Be,{path:"/asistencia",element:i.jsx(Ve,{children:i.jsx(ID,{})})}),i.jsx(Be,{path:"/asignaciones",element:i.jsx(Ve,{children:i.jsx(LD,{})})}),i.jsx(Be,{path:"/asignacion-personal",element:i.jsx(Ve,{children:i.jsx(UD,{})})}),i.jsx(Be,{path:"/salidas-especiales",element:i.jsx(Ve,{children:i.jsx(zD,{})})}),i.jsx(Be,{path:"/evaluaciones",element:i.jsx(Ve,{children:i.jsx($D,{})})}),i.jsx(Be,{path:"/planes-inspeccion",element:i.jsx(Ve,{children:i.jsx(Jt,{factory:"CXC",department:"Quality",role:"Supervisor",redirectTo:"/dashboard",children:i.jsx(HD,{})})})}),i.jsx(Be,{path:"/autocontrol-calidad/:planId",element:i.jsx(Ve,{children:i.jsx(Jt,{factory:"CXC",department:"Quality",role:"Supervisor",redirectTo:"/dashboard",children:i.jsx(VD,{})})})}),i.jsx(Be,{path:"/registros-autocontrol",element:i.jsx(Ve,{children:i.jsx(Jt,{factory:"CXC",department:"Quality",role:"Supervisor",redirectTo:"/dashboard",children:i.jsx(WD,{})})})}),i.jsx(Be,{path:"/caracteristicas-calidad",element:i.jsx(Ve,{children:i.jsx(Jt,{factory:"CXC",department:"Quality",role:"Supervisor",redirectTo:"/dashboard",children:i.jsx(GD,{})})})}),i.jsx(Be,{path:"/defectos",element:i.jsx(Ve,{children:i.jsx(Jt,{factory:"CXC",department:"Quality",role:"Supervisor",redirectTo:"/dashboard",children:i.jsx(XD,{})})})}),i.jsx(Be,{path:"/control-estadistico",element:i.jsx(Ve,{children:i.jsx(Jt,{factory:"CXC",department:"Quality",role:"Supervisor",redirectTo:"/dashboard",children:i.jsx(qD,{})})})}),i.jsx(Be,{path:"/acciones-correctivas",element:i.jsx(Ve,{children:i.jsx(Jt,{factory:"CXC",department:"Quality",role:"Supervisor",redirectTo:"/dashboard",children:i.jsx(QD,{})})})}),i.jsx(Be,{path:"/certificados",element:i.jsx(Ve,{children:i.jsx(Jt,{factory:"CXC",department:"Quality",role:"Supervisor",redirectTo:"/dashboard",children:i.jsx(KD,{})})})}),i.jsx(Be,{path:"/datos-maestros-procesos",element:i.jsx(Ve,{children:i.jsx(YD,{})})}),i.jsx(Be,{path:"/parametros-procesos",element:i.jsx(Ve,{children:i.jsx(JD,{})})}),i.jsx(Be,{path:"/bom-rutas",element:i.jsx(Ve,{children:i.jsx(ZD,{})})}),i.jsx(Be,{path:"/instrucciones-trabajo",element:i.jsx(Ve,{children:i.jsx(eO,{})})}),i.jsx(Be,{path:"/control-proceso",element:i.jsx(Ve,{children:i.jsx(tO,{})})}),i.jsx(Be,{path:"/procesos-automaticos",element:i.jsx(Ve,{children:i.jsx(rO,{})})}),i.jsx(Be,{path:"/jerarquia-activos",element:i.jsx(Ve,{children:i.jsx(aO,{})})}),i.jsx(Be,{path:"/lineas",element:i.jsx(Ve,{children:i.jsx(nO,{})})}),i.jsx(Be,{path:"/riesgos",element:i.jsx(Ve,{children:i.jsx(sO,{})})}),i.jsx(Be,{path:"/inspecciones-seguridad",element:i.jsx(Ve,{children:i.jsx(iO,{})})}),i.jsx(Be,{path:"/accidentes",element:i.jsx(Ve,{children:i.jsx(oO,{})})}),i.jsx(Be,{path:"/capacitaciones",element:i.jsx(Ve,{children:i.jsx(lO,{})})}),i.jsx(Be,{path:"/epp",element:i.jsx(Ve,{children:i.jsx(cO,{})})}),i.jsx(Be,{path:"/salud-ocupacional",element:i.jsx(Ve,{children:i.jsx(uO,{})})}),i.jsx(Be,{path:"/config-empresa",element:i.jsx(Ve,{children:i.jsx(Jt,{group:"GrAuriga",redirectTo:"/dashboard",children:i.jsx(dO,{})})})}),i.jsx(Be,{path:"/config-plantas",element:i.jsx(Ve,{children:i.jsx(Jt,{group:"GrAuriga",redirectTo:"/dashboard",children:i.jsx(pO,{})})})}),i.jsx(Be,{path:"/config-calendario",element:i.jsx(Ve,{children:i.jsx(Jt,{group:"GrAuriga",redirectTo:"/dashboard",children:i.jsx(xO,{})})})}),i.jsx(Be,{path:"/config-turnos",element:i.jsx(Ve,{children:i.jsx(Jt,{group:"GrAuriga",redirectTo:"/dashboard",children:i.jsx(mO,{})})})}),i.jsx(Be,{path:"/config-zonas-horarias",element:i.jsx(Ve,{children:i.jsx(Jt,{group:"GrAuriga",redirectTo:"/dashboard",children:i.jsx(gO,{})})})}),i.jsx(Be,{path:"/config-unidades",element:i.jsx(Ve,{children:i.jsx(Jt,{group:"GrAuriga",redirectTo:"/dashboard",children:i.jsx(vO,{})})})}),i.jsx(Be,{path:"/config-monedas",element:i.jsx(Ve,{children:i.jsx(Jt,{group:"GrAuriga",redirectTo:"/dashboard",children:i.jsx(yO,{})})})}),i.jsx(Be,{path:"/seguridad",element:i.jsx(Ve,{children:i.jsx(Jt,{group:"GrAuriga",redirectTo:"/dashboard",children:i.jsx(wO,{})})})}),i.jsx(Be,{path:"/usuarios",element:i.jsx(Ve,{children:i.jsx(Jt,{group:"GrAuriga",redirectTo:"/dashboard",children:i.jsx(kO,{})})})}),i.jsx(Be,{path:"/roles-permisos",element:i.jsx(Ve,{children:i.jsx(Jt,{group:"GrAuriga",redirectTo:"/dashboard",children:i.jsx(bO,{})})})})]})]})})})})}const CO=new z4({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:5*60*1e3}}}),_O=window.console.error;window.console.error=(...e)=>{const t=e.join(" ");t.includes("message channel closed")||t.includes("asynchronous response")||t.includes("A listener indicated an asynchronous response")||t.includes("Extension context invalidated")||t.includes("Receiving end does not exist")||t.includes("message channel closed before a response was received")||_O.apply(console,e)};window.addEventListener("unhandledrejection",e=>{var r;const t=((r=e.reason)==null?void 0:r.message)||String(e.reason||"");if(t.includes("message channel closed")||t.includes("asynchronous response")||t.includes("A listener indicated an asynchronous response")||t.includes("Extension context invalidated")||t.includes("Receiving end does not exist")||t.includes("message channel closed before a response was received"))return e.preventDefault(),e.stopPropagation(),!1},!0);wd.createRoot(document.getElementById("root")).render(i.jsx(s1.StrictMode,{children:i.jsx(H4,{client:CO,children:i.jsx(NO,{})})}));
//# sourceMappingURL=index-e42c0382.js.map
